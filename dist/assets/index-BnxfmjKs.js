function Zp(t,s){for(var n=0;n<s.length;n++){const r=s[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function ef(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $m={exports:{}},lo={},Fm={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ca=Symbol.for("react.element"),tf=Symbol.for("react.portal"),sf=Symbol.for("react.fragment"),nf=Symbol.for("react.strict_mode"),rf=Symbol.for("react.profiler"),af=Symbol.for("react.provider"),lf=Symbol.for("react.context"),of=Symbol.for("react.forward_ref"),df=Symbol.for("react.suspense"),cf=Symbol.for("react.memo"),uf=Symbol.for("react.lazy"),$c=Symbol.iterator;function mf(t){return t===null||typeof t!="object"?null:(t=$c&&t[$c]||t["@@iterator"],typeof t=="function"?t:null)}var Om={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_m=Object.assign,zm={};function gr(t,s,n){this.props=t,this.context=s,this.refs=zm,this.updater=n||Om}gr.prototype.isReactComponent={};gr.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};gr.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Um(){}Um.prototype=gr.prototype;function Ad(t,s,n){this.props=t,this.context=s,this.refs=zm,this.updater=n||Om}var Dd=Ad.prototype=new Um;Dd.constructor=Ad;_m(Dd,gr.prototype);Dd.isPureReactComponent=!0;var Fc=Array.isArray,Bm=Object.prototype.hasOwnProperty,Td={current:null},Hm={key:!0,ref:!0,__self:!0,__source:!0};function Wm(t,s,n){var r,a={},l=null,o=null;if(s!=null)for(r in s.ref!==void 0&&(o=s.ref),s.key!==void 0&&(l=""+s.key),s)Bm.call(s,r)&&!Hm.hasOwnProperty(r)&&(a[r]=s[r]);var i=arguments.length-2;if(i===1)a.children=n;else if(1<i){for(var c=Array(i),u=0;u<i;u++)c[u]=arguments[u+2];a.children=c}if(t&&t.defaultProps)for(r in i=t.defaultProps,i)a[r]===void 0&&(a[r]=i[r]);return{$$typeof:Ca,type:t,key:l,ref:o,props:a,_owner:Td.current}}function xf(t,s){return{$$typeof:Ca,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function Ed(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ca}function hf(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return s[n]})}var Oc=/\/+/g;function zo(t,s){return typeof t=="object"&&t!==null&&t.key!=null?hf(""+t.key):s.toString(36)}function dl(t,s,n,r,a){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ca:case tf:o=!0}}if(o)return o=t,a=a(o),t=r===""?"."+zo(o,0):r,Fc(a)?(n="",t!=null&&(n=t.replace(Oc,"$&/")+"/"),dl(a,s,n,"",function(u){return u})):a!=null&&(Ed(a)&&(a=xf(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Oc,"$&/")+"/")+t)),s.push(a)),1;if(o=0,r=r===""?".":r+":",Fc(t))for(var i=0;i<t.length;i++){l=t[i];var c=r+zo(l,i);o+=dl(l,s,n,c,a)}else if(c=mf(t),typeof c=="function")for(t=c.call(t),i=0;!(l=t.next()).done;)l=l.value,c=r+zo(l,i++),o+=dl(l,s,n,c,a);else if(l==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return o}function Fa(t,s,n){if(t==null)return t;var r=[],a=0;return dl(t,r,"","",function(l){return s.call(n,l,a++)}),r}function pf(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var xt={current:null},cl={transition:null},ff={ReactCurrentDispatcher:xt,ReactCurrentBatchConfig:cl,ReactCurrentOwner:Td};function Vm(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:Fa,forEach:function(t,s,n){Fa(t,function(){s.apply(this,arguments)},n)},count:function(t){var s=0;return Fa(t,function(){s++}),s},toArray:function(t){return Fa(t,function(s){return s})||[]},only:function(t){if(!Ed(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=gr;be.Fragment=sf;be.Profiler=rf;be.PureComponent=Ad;be.StrictMode=nf;be.Suspense=df;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ff;be.act=Vm;be.cloneElement=function(t,s,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=_m({},t.props),a=t.key,l=t.ref,o=t._owner;if(s!=null){if(s.ref!==void 0&&(l=s.ref,o=Td.current),s.key!==void 0&&(a=""+s.key),t.type&&t.type.defaultProps)var i=t.type.defaultProps;for(c in s)Bm.call(s,c)&&!Hm.hasOwnProperty(c)&&(r[c]=s[c]===void 0&&i!==void 0?i[c]:s[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){i=Array(c);for(var u=0;u<c;u++)i[u]=arguments[u+2];r.children=i}return{$$typeof:Ca,type:t.type,key:a,ref:l,props:r,_owner:o}};be.createContext=function(t){return t={$$typeof:lf,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:af,_context:t},t.Consumer=t};be.createElement=Wm;be.createFactory=function(t){var s=Wm.bind(null,t);return s.type=t,s};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:of,render:t}};be.isValidElement=Ed;be.lazy=function(t){return{$$typeof:uf,_payload:{_status:-1,_result:t},_init:pf}};be.memo=function(t,s){return{$$typeof:cf,type:t,compare:s===void 0?null:s}};be.startTransition=function(t){var s=cl.transition;cl.transition={};try{t()}finally{cl.transition=s}};be.unstable_act=Vm;be.useCallback=function(t,s){return xt.current.useCallback(t,s)};be.useContext=function(t){return xt.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return xt.current.useDeferredValue(t)};be.useEffect=function(t,s){return xt.current.useEffect(t,s)};be.useId=function(){return xt.current.useId()};be.useImperativeHandle=function(t,s,n){return xt.current.useImperativeHandle(t,s,n)};be.useInsertionEffect=function(t,s){return xt.current.useInsertionEffect(t,s)};be.useLayoutEffect=function(t,s){return xt.current.useLayoutEffect(t,s)};be.useMemo=function(t,s){return xt.current.useMemo(t,s)};be.useReducer=function(t,s,n){return xt.current.useReducer(t,s,n)};be.useRef=function(t){return xt.current.useRef(t)};be.useState=function(t){return xt.current.useState(t)};be.useSyncExternalStore=function(t,s,n){return xt.current.useSyncExternalStore(t,s,n)};be.useTransition=function(){return xt.current.useTransition()};be.version="18.3.1";Fm.exports=be;var d=Fm.exports;const ve=ef(d),gf=Zp({__proto__:null,default:ve},[d]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yf=d,bf=Symbol.for("react.element"),vf=Symbol.for("react.fragment"),jf=Object.prototype.hasOwnProperty,Nf=yf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wf={key:!0,ref:!0,__self:!0,__source:!0};function Gm(t,s,n){var r,a={},l=null,o=null;n!==void 0&&(l=""+n),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(o=s.ref);for(r in s)jf.call(s,r)&&!wf.hasOwnProperty(r)&&(a[r]=s[r]);if(t&&t.defaultProps)for(r in s=t.defaultProps,s)a[r]===void 0&&(a[r]=s[r]);return{$$typeof:bf,type:t,key:l,ref:o,props:a,_owner:Nf.current}}lo.Fragment=vf;lo.jsx=Gm;lo.jsxs=Gm;$m.exports=lo;var e=$m.exports,Ym={exports:{}},Dt={},qm={exports:{}},Jm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s($,L){var W=$.length;$.push(L);e:for(;0<W;){var F=W-1>>>1,z=$[F];if(0<a(z,L))$[F]=L,$[W]=z,W=F;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var L=$[0],W=$.pop();if(W!==L){$[0]=W;e:for(var F=0,z=$.length,G=z>>>1;F<G;){var ee=2*(F+1)-1,_=$[ee],te=ee+1,K=$[te];if(0>a(_,W))te<z&&0>a(K,_)?($[F]=K,$[te]=W,F=te):($[F]=_,$[ee]=W,F=ee);else if(te<z&&0>a(K,W))$[F]=K,$[te]=W,F=te;else break e}}return L}function a($,L){var W=$.sortIndex-L.sortIndex;return W!==0?W:$.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var o=Date,i=o.now();t.unstable_now=function(){return o.now()-i}}var c=[],u=[],x=1,m=null,p=3,h=!1,w=!1,N=!1,k=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b($){for(var L=n(u);L!==null;){if(L.callback===null)r(u);else if(L.startTime<=$)r(u),L.sortIndex=L.expirationTime,s(c,L);else break;L=n(u)}}function y($){if(N=!1,b($),!w)if(n(c)!==null)w=!0,E(j);else{var L=n(u);L!==null&&P(y,L.startTime-$)}}function j($,L){w=!1,N&&(N=!1,v(A),A=-1),h=!0;var W=p;try{for(b(L),m=n(c);m!==null&&(!(m.expirationTime>L)||$&&!U());){var F=m.callback;if(typeof F=="function"){m.callback=null,p=m.priorityLevel;var z=F(m.expirationTime<=L);L=t.unstable_now(),typeof z=="function"?m.callback=z:m===n(c)&&r(c),b(L)}else r(c);m=n(c)}if(m!==null)var G=!0;else{var ee=n(u);ee!==null&&P(y,ee.startTime-L),G=!1}return G}finally{m=null,p=W,h=!1}}var S=!1,C=null,A=-1,R=5,O=-1;function U(){return!(t.unstable_now()-O<R)}function I(){if(C!==null){var $=t.unstable_now();O=$;var L=!0;try{L=C(!0,$)}finally{L?M():(S=!1,C=null)}}else S=!1}var M;if(typeof g=="function")M=function(){g(I)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,D=V.port2;V.port1.onmessage=I,M=function(){D.postMessage(null)}}else M=function(){k(I,0)};function E($){C=$,S||(S=!0,M())}function P($,L){A=k(function(){$(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){w||h||(w=!0,E(j))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function($){switch(p){case 1:case 2:case 3:var L=3;break;default:L=p}var W=p;p=L;try{return $()}finally{p=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,L){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var W=p;p=$;try{return L()}finally{p=W}},t.unstable_scheduleCallback=function($,L,W){var F=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?F+W:F):W=F,$){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=W+z,$={id:x++,callback:L,priorityLevel:$,startTime:W,expirationTime:z,sortIndex:-1},W>F?($.sortIndex=W,s(u,$),n(c)===null&&$===n(u)&&(N?(v(A),A=-1):N=!0,P(y,W-F))):($.sortIndex=z,s(c,$),w||h||(w=!0,E(j))),$},t.unstable_shouldYield=U,t.unstable_wrapCallback=function($){var L=p;return function(){var W=p;p=L;try{return $.apply(this,arguments)}finally{p=W}}}})(Jm);qm.exports=Jm;var Sf=qm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kf=d,At=Sf;function ne(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)s+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Qm=new Set,na={};function Pn(t,s){ir(t,s),ir(t+"Capture",s)}function ir(t,s){for(na[t]=s,t=0;t<s.length;t++)Qm.add(s[t])}var ws=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Si=Object.prototype.hasOwnProperty,Cf=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_c={},zc={};function Af(t){return Si.call(zc,t)?!0:Si.call(_c,t)?!1:Cf.test(t)?zc[t]=!0:(_c[t]=!0,!1)}function Df(t,s,n,r){if(n!==null&&n.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Tf(t,s,n,r){if(s===null||typeof s>"u"||Df(t,s,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function ht(t,s,n,r,a,l,o){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=s,this.sanitizeURL=l,this.removeEmptyString=o}var nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){nt[t]=new ht(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];nt[s]=new ht(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){nt[t]=new ht(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){nt[t]=new ht(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){nt[t]=new ht(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){nt[t]=new ht(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){nt[t]=new ht(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){nt[t]=new ht(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){nt[t]=new ht(t,5,!1,t.toLowerCase(),null,!1,!1)});var Md=/[\-:]([a-z])/g;function Ld(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(Md,Ld);nt[s]=new ht(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(Md,Ld);nt[s]=new ht(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(Md,Ld);nt[s]=new ht(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){nt[t]=new ht(t,1,!1,t.toLowerCase(),null,!1,!1)});nt.xlinkHref=new ht("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){nt[t]=new ht(t,1,!1,t.toLowerCase(),null,!0,!0)});function Pd(t,s,n,r){var a=nt.hasOwnProperty(s)?nt[s]:null;(a!==null?a.type!==0:r||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(Tf(s,n,a,r)&&(n=null),r||a===null?Af(s)&&(n===null?t.removeAttribute(s):t.setAttribute(s,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(s=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(s):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,s,n):t.setAttribute(s,n))))}var As=kf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oa=Symbol.for("react.element"),zn=Symbol.for("react.portal"),Un=Symbol.for("react.fragment"),Id=Symbol.for("react.strict_mode"),ki=Symbol.for("react.profiler"),Xm=Symbol.for("react.provider"),Km=Symbol.for("react.context"),Rd=Symbol.for("react.forward_ref"),Ci=Symbol.for("react.suspense"),Ai=Symbol.for("react.suspense_list"),$d=Symbol.for("react.memo"),Bs=Symbol.for("react.lazy"),Zm=Symbol.for("react.offscreen"),Uc=Symbol.iterator;function Ar(t){return t===null||typeof t!="object"?null:(t=Uc&&t[Uc]||t["@@iterator"],typeof t=="function"?t:null)}var Oe=Object.assign,Uo;function _r(t){if(Uo===void 0)try{throw Error()}catch(n){var s=n.stack.trim().match(/\n( *(at )?)/);Uo=s&&s[1]||""}return`
`+Uo+t}var Bo=!1;function Ho(t,s){if(!t||Bo)return"";Bo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(u){var r=u}Reflect.construct(t,[],s)}else{try{s.call()}catch(u){r=u}t.call(s.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),l=r.stack.split(`
`),o=a.length-1,i=l.length-1;1<=o&&0<=i&&a[o]!==l[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==l[i]){if(o!==1||i!==1)do if(o--,i--,0>i||a[o]!==l[i]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=i);break}}}finally{Bo=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?_r(t):""}function Ef(t){switch(t.tag){case 5:return _r(t.type);case 16:return _r("Lazy");case 13:return _r("Suspense");case 19:return _r("SuspenseList");case 0:case 2:case 15:return t=Ho(t.type,!1),t;case 11:return t=Ho(t.type.render,!1),t;case 1:return t=Ho(t.type,!0),t;default:return""}}function Di(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Un:return"Fragment";case zn:return"Portal";case ki:return"Profiler";case Id:return"StrictMode";case Ci:return"Suspense";case Ai:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Km:return(t.displayName||"Context")+".Consumer";case Xm:return(t._context.displayName||"Context")+".Provider";case Rd:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $d:return s=t.displayName||null,s!==null?s:Di(t.type)||"Memo";case Bs:s=t._payload,t=t._init;try{return Di(t(s))}catch{}}return null}function Mf(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Di(s);case 8:return s===Id?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function on(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ex(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Lf(t){var s=ex(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),r=""+t[s];if(!t.hasOwnProperty(s)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,l.call(this,o)}}),Object.defineProperty(t,s,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function _a(t){t._valueTracker||(t._valueTracker=Lf(t))}function tx(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var n=s.getValue(),r="";return t&&(r=ex(t)?t.checked?"true":"false":t.value),t=r,t!==n?(s.setValue(t),!0):!1}function wl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ti(t,s){var n=s.checked;return Oe({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Bc(t,s){var n=s.defaultValue==null?"":s.defaultValue,r=s.checked!=null?s.checked:s.defaultChecked;n=on(s.value!=null?s.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function sx(t,s){s=s.checked,s!=null&&Pd(t,"checked",s,!1)}function Ei(t,s){sx(t,s);var n=on(s.value),r=s.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?Mi(t,s.type,n):s.hasOwnProperty("defaultValue")&&Mi(t,s.type,on(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function Hc(t,s,n){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var r=s.type;if(!(r!=="submit"&&r!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,n||s===t.value||(t.value=s),t.defaultValue=s}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Mi(t,s,n){(s!=="number"||wl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var zr=Array.isArray;function tr(t,s,n,r){if(t=t.options,s){s={};for(var a=0;a<n.length;a++)s["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=s.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+on(n),s=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}s!==null||t[a].disabled||(s=t[a])}s!==null&&(s.selected=!0)}}function Li(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(ne(91));return Oe({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Wc(t,s){var n=s.value;if(n==null){if(n=s.children,s=s.defaultValue,n!=null){if(s!=null)throw Error(ne(92));if(zr(n)){if(1<n.length)throw Error(ne(93));n=n[0]}s=n}s==null&&(s=""),n=s}t._wrapperState={initialValue:on(n)}}function nx(t,s){var n=on(s.value),r=on(s.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),s.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Vc(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function rx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pi(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?rx(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var za,ax=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(s,n,r,a)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(za=za||document.createElement("div"),za.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=za.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function ra(t,s){if(s){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=s;return}}t.textContent=s}var Vr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pf=["Webkit","ms","Moz","O"];Object.keys(Vr).forEach(function(t){Pf.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),Vr[s]=Vr[t]})});function lx(t,s,n){return s==null||typeof s=="boolean"||s===""?"":n||typeof s!="number"||s===0||Vr.hasOwnProperty(t)&&Vr[t]?(""+s).trim():s+"px"}function ox(t,s){t=t.style;for(var n in s)if(s.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=lx(n,s[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var If=Oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ii(t,s){if(s){if(If[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(ne(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(ne(61))}if(s.style!=null&&typeof s.style!="object")throw Error(ne(62))}}function Ri(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $i=null;function Fd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fi=null,sr=null,nr=null;function Gc(t){if(t=Ta(t)){if(typeof Fi!="function")throw Error(ne(280));var s=t.stateNode;s&&(s=mo(s),Fi(t.stateNode,t.type,s))}}function ix(t){sr?nr?nr.push(t):nr=[t]:sr=t}function dx(){if(sr){var t=sr,s=nr;if(nr=sr=null,Gc(t),s)for(t=0;t<s.length;t++)Gc(s[t])}}function cx(t,s){return t(s)}function ux(){}var Wo=!1;function mx(t,s,n){if(Wo)return t(s,n);Wo=!0;try{return cx(t,s,n)}finally{Wo=!1,(sr!==null||nr!==null)&&(ux(),dx())}}function aa(t,s){var n=t.stateNode;if(n===null)return null;var r=mo(n);if(r===null)return null;n=r[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,s,typeof n));return n}var Oi=!1;if(ws)try{var Dr={};Object.defineProperty(Dr,"passive",{get:function(){Oi=!0}}),window.addEventListener("test",Dr,Dr),window.removeEventListener("test",Dr,Dr)}catch{Oi=!1}function Rf(t,s,n,r,a,l,o,i,c){var u=Array.prototype.slice.call(arguments,3);try{s.apply(n,u)}catch(x){this.onError(x)}}var Gr=!1,Sl=null,kl=!1,_i=null,$f={onError:function(t){Gr=!0,Sl=t}};function Ff(t,s,n,r,a,l,o,i,c){Gr=!1,Sl=null,Rf.apply($f,arguments)}function Of(t,s,n,r,a,l,o,i,c){if(Ff.apply(this,arguments),Gr){if(Gr){var u=Sl;Gr=!1,Sl=null}else throw Error(ne(198));kl||(kl=!0,_i=u)}}function In(t){var s=t,n=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(n=s.return),t=s.return;while(t)}return s.tag===3?n:null}function xx(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function Yc(t){if(In(t)!==t)throw Error(ne(188))}function _f(t){var s=t.alternate;if(!s){if(s=In(t),s===null)throw Error(ne(188));return s!==t?null:t}for(var n=t,r=s;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return Yc(a),t;if(l===r)return Yc(a),s;l=l.sibling}throw Error(ne(188))}if(n.return!==r.return)n=a,r=l;else{for(var o=!1,i=a.child;i;){if(i===n){o=!0,n=a,r=l;break}if(i===r){o=!0,r=a,n=l;break}i=i.sibling}if(!o){for(i=l.child;i;){if(i===n){o=!0,n=l,r=a;break}if(i===r){o=!0,r=l,n=a;break}i=i.sibling}if(!o)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:s}function hx(t){return t=_f(t),t!==null?px(t):null}function px(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=px(t);if(s!==null)return s;t=t.sibling}return null}var fx=At.unstable_scheduleCallback,qc=At.unstable_cancelCallback,zf=At.unstable_shouldYield,Uf=At.unstable_requestPaint,Ue=At.unstable_now,Bf=At.unstable_getCurrentPriorityLevel,Od=At.unstable_ImmediatePriority,gx=At.unstable_UserBlockingPriority,Cl=At.unstable_NormalPriority,Hf=At.unstable_LowPriority,yx=At.unstable_IdlePriority,oo=null,ms=null;function Wf(t){if(ms&&typeof ms.onCommitFiberRoot=="function")try{ms.onCommitFiberRoot(oo,t,void 0,(t.current.flags&128)===128)}catch{}}var Xt=Math.clz32?Math.clz32:Yf,Vf=Math.log,Gf=Math.LN2;function Yf(t){return t>>>=0,t===0?32:31-(Vf(t)/Gf|0)|0}var Ua=64,Ba=4194304;function Ur(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Al(t,s){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,l=t.pingedLanes,o=n&268435455;if(o!==0){var i=o&~a;i!==0?r=Ur(i):(l&=o,l!==0&&(r=Ur(l)))}else o=n&~a,o!==0?r=Ur(o):l!==0&&(r=Ur(l));if(r===0)return 0;if(s!==0&&s!==r&&!(s&a)&&(a=r&-r,l=s&-s,a>=l||a===16&&(l&4194240)!==0))return s;if(r&4&&(r|=n&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=r;0<s;)n=31-Xt(s),a=1<<n,r|=t[n],s&=~a;return r}function qf(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jf(t,s){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,l=t.pendingLanes;0<l;){var o=31-Xt(l),i=1<<o,c=a[o];c===-1?(!(i&n)||i&r)&&(a[o]=qf(i,s)):c<=s&&(t.expiredLanes|=i),l&=~i}}function zi(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function bx(){var t=Ua;return Ua<<=1,!(Ua&4194240)&&(Ua=64),t}function Vo(t){for(var s=[],n=0;31>n;n++)s.push(t);return s}function Aa(t,s,n){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-Xt(s),t[s]=n}function Qf(t,s){var n=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-Xt(n),l=1<<a;s[a]=0,r[a]=-1,t[a]=-1,n&=~l}}function _d(t,s){var n=t.entangledLanes|=s;for(t=t.entanglements;n;){var r=31-Xt(n),a=1<<r;a&s|t[r]&s&&(t[r]|=s),n&=~a}}var Se=0;function vx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jx,zd,Nx,wx,Sx,Ui=!1,Ha=[],Xs=null,Ks=null,Zs=null,la=new Map,oa=new Map,Vs=[],Xf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jc(t,s){switch(t){case"focusin":case"focusout":Xs=null;break;case"dragenter":case"dragleave":Ks=null;break;case"mouseover":case"mouseout":Zs=null;break;case"pointerover":case"pointerout":la.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":oa.delete(s.pointerId)}}function Tr(t,s,n,r,a,l){return t===null||t.nativeEvent!==l?(t={blockedOn:s,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[a]},s!==null&&(s=Ta(s),s!==null&&zd(s)),t):(t.eventSystemFlags|=r,s=t.targetContainers,a!==null&&s.indexOf(a)===-1&&s.push(a),t)}function Kf(t,s,n,r,a){switch(s){case"focusin":return Xs=Tr(Xs,t,s,n,r,a),!0;case"dragenter":return Ks=Tr(Ks,t,s,n,r,a),!0;case"mouseover":return Zs=Tr(Zs,t,s,n,r,a),!0;case"pointerover":var l=a.pointerId;return la.set(l,Tr(la.get(l)||null,t,s,n,r,a)),!0;case"gotpointercapture":return l=a.pointerId,oa.set(l,Tr(oa.get(l)||null,t,s,n,r,a)),!0}return!1}function kx(t){var s=jn(t.target);if(s!==null){var n=In(s);if(n!==null){if(s=n.tag,s===13){if(s=xx(n),s!==null){t.blockedOn=s,Sx(t.priority,function(){Nx(n)});return}}else if(s===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ul(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var n=Bi(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);$i=r,n.target.dispatchEvent(r),$i=null}else return s=Ta(n),s!==null&&zd(s),t.blockedOn=n,!1;s.shift()}return!0}function Qc(t,s,n){ul(t)&&n.delete(s)}function Zf(){Ui=!1,Xs!==null&&ul(Xs)&&(Xs=null),Ks!==null&&ul(Ks)&&(Ks=null),Zs!==null&&ul(Zs)&&(Zs=null),la.forEach(Qc),oa.forEach(Qc)}function Er(t,s){t.blockedOn===s&&(t.blockedOn=null,Ui||(Ui=!0,At.unstable_scheduleCallback(At.unstable_NormalPriority,Zf)))}function ia(t){function s(a){return Er(a,t)}if(0<Ha.length){Er(Ha[0],t);for(var n=1;n<Ha.length;n++){var r=Ha[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Xs!==null&&Er(Xs,t),Ks!==null&&Er(Ks,t),Zs!==null&&Er(Zs,t),la.forEach(s),oa.forEach(s),n=0;n<Vs.length;n++)r=Vs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Vs.length&&(n=Vs[0],n.blockedOn===null);)kx(n),n.blockedOn===null&&Vs.shift()}var rr=As.ReactCurrentBatchConfig,Dl=!0;function eg(t,s,n,r){var a=Se,l=rr.transition;rr.transition=null;try{Se=1,Ud(t,s,n,r)}finally{Se=a,rr.transition=l}}function tg(t,s,n,r){var a=Se,l=rr.transition;rr.transition=null;try{Se=4,Ud(t,s,n,r)}finally{Se=a,rr.transition=l}}function Ud(t,s,n,r){if(Dl){var a=Bi(t,s,n,r);if(a===null)ti(t,s,r,Tl,n),Jc(t,r);else if(Kf(a,t,s,n,r))r.stopPropagation();else if(Jc(t,r),s&4&&-1<Xf.indexOf(t)){for(;a!==null;){var l=Ta(a);if(l!==null&&jx(l),l=Bi(t,s,n,r),l===null&&ti(t,s,r,Tl,n),l===a)break;a=l}a!==null&&r.stopPropagation()}else ti(t,s,r,null,n)}}var Tl=null;function Bi(t,s,n,r){if(Tl=null,t=Fd(r),t=jn(t),t!==null)if(s=In(t),s===null)t=null;else if(n=s.tag,n===13){if(t=xx(s),t!==null)return t;t=null}else if(n===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return Tl=t,null}function Cx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bf()){case Od:return 1;case gx:return 4;case Cl:case Hf:return 16;case yx:return 536870912;default:return 16}default:return 16}}var qs=null,Bd=null,ml=null;function Ax(){if(ml)return ml;var t,s=Bd,n=s.length,r,a="value"in qs?qs.value:qs.textContent,l=a.length;for(t=0;t<n&&s[t]===a[t];t++);var o=n-t;for(r=1;r<=o&&s[n-r]===a[l-r];r++);return ml=a.slice(t,1<r?1-r:void 0)}function xl(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function Wa(){return!0}function Xc(){return!1}function Tt(t){function s(n,r,a,l,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=l,this.target=o,this.currentTarget=null;for(var i in t)t.hasOwnProperty(i)&&(n=t[i],this[i]=n?n(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Wa:Xc,this.isPropagationStopped=Xc,this}return Oe(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wa)},persist:function(){},isPersistent:Wa}),s}var yr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hd=Tt(yr),Da=Oe({},yr,{view:0,detail:0}),sg=Tt(Da),Go,Yo,Mr,io=Oe({},Da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Mr&&(Mr&&t.type==="mousemove"?(Go=t.screenX-Mr.screenX,Yo=t.screenY-Mr.screenY):Yo=Go=0,Mr=t),Go)},movementY:function(t){return"movementY"in t?t.movementY:Yo}}),Kc=Tt(io),ng=Oe({},io,{dataTransfer:0}),rg=Tt(ng),ag=Oe({},Da,{relatedTarget:0}),qo=Tt(ag),lg=Oe({},yr,{animationName:0,elapsedTime:0,pseudoElement:0}),og=Tt(lg),ig=Oe({},yr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dg=Tt(ig),cg=Oe({},yr,{data:0}),Zc=Tt(cg),ug={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hg(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=xg[t])?!!s[t]:!1}function Wd(){return hg}var pg=Oe({},Da,{key:function(t){if(t.key){var s=ug[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=xl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?mg[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wd,charCode:function(t){return t.type==="keypress"?xl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fg=Tt(pg),gg=Oe({},io,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eu=Tt(gg),yg=Oe({},Da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wd}),bg=Tt(yg),vg=Oe({},yr,{propertyName:0,elapsedTime:0,pseudoElement:0}),jg=Tt(vg),Ng=Oe({},io,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),wg=Tt(Ng),Sg=[9,13,27,32],Vd=ws&&"CompositionEvent"in window,Yr=null;ws&&"documentMode"in document&&(Yr=document.documentMode);var kg=ws&&"TextEvent"in window&&!Yr,Dx=ws&&(!Vd||Yr&&8<Yr&&11>=Yr),tu=" ",su=!1;function Tx(t,s){switch(t){case"keyup":return Sg.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ex(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Bn=!1;function Cg(t,s){switch(t){case"compositionend":return Ex(s);case"keypress":return s.which!==32?null:(su=!0,tu);case"textInput":return t=s.data,t===tu&&su?null:t;default:return null}}function Ag(t,s){if(Bn)return t==="compositionend"||!Vd&&Tx(t,s)?(t=Ax(),ml=Bd=qs=null,Bn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Dx&&s.locale!=="ko"?null:s.data;default:return null}}var Dg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nu(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!Dg[t.type]:s==="textarea"}function Mx(t,s,n,r){ix(r),s=El(s,"onChange"),0<s.length&&(n=new Hd("onChange","change",null,n,r),t.push({event:n,listeners:s}))}var qr=null,da=null;function Tg(t){Bx(t,0)}function co(t){var s=Vn(t);if(tx(s))return t}function Eg(t,s){if(t==="change")return s}var Lx=!1;if(ws){var Jo;if(ws){var Qo="oninput"in document;if(!Qo){var ru=document.createElement("div");ru.setAttribute("oninput","return;"),Qo=typeof ru.oninput=="function"}Jo=Qo}else Jo=!1;Lx=Jo&&(!document.documentMode||9<document.documentMode)}function au(){qr&&(qr.detachEvent("onpropertychange",Px),da=qr=null)}function Px(t){if(t.propertyName==="value"&&co(da)){var s=[];Mx(s,da,t,Fd(t)),mx(Tg,s)}}function Mg(t,s,n){t==="focusin"?(au(),qr=s,da=n,qr.attachEvent("onpropertychange",Px)):t==="focusout"&&au()}function Lg(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return co(da)}function Pg(t,s){if(t==="click")return co(s)}function Ig(t,s){if(t==="input"||t==="change")return co(s)}function Rg(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var es=typeof Object.is=="function"?Object.is:Rg;function ca(t,s){if(es(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var n=Object.keys(t),r=Object.keys(s);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Si.call(s,a)||!es(t[a],s[a]))return!1}return!0}function lu(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ou(t,s){var n=lu(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=s&&r>=s)return{node:n,offset:s-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lu(n)}}function Ix(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?Ix(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function Rx(){for(var t=window,s=wl();s instanceof t.HTMLIFrameElement;){try{var n=typeof s.contentWindow.location.href=="string"}catch{n=!1}if(n)t=s.contentWindow;else break;s=wl(t.document)}return s}function Gd(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function $g(t){var s=Rx(),n=t.focusedElem,r=t.selectionRange;if(s!==n&&n&&n.ownerDocument&&Ix(n.ownerDocument.documentElement,n)){if(r!==null&&Gd(n)){if(s=r.start,t=r.end,t===void 0&&(t=s),"selectionStart"in n)n.selectionStart=s,n.selectionEnd=Math.min(t,n.value.length);else if(t=(s=n.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,l=Math.min(r.start,a);r=r.end===void 0?l:Math.min(r.end,a),!t.extend&&l>r&&(a=r,r=l,l=a),a=ou(n,l);var o=ou(n,r);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(s=s.createRange(),s.setStart(a.node,a.offset),t.removeAllRanges(),l>r?(t.addRange(s),t.extend(o.node,o.offset)):(s.setEnd(o.node,o.offset),t.addRange(s)))}}for(s=[],t=n;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<s.length;n++)t=s[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Fg=ws&&"documentMode"in document&&11>=document.documentMode,Hn=null,Hi=null,Jr=null,Wi=!1;function iu(t,s,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Wi||Hn==null||Hn!==wl(r)||(r=Hn,"selectionStart"in r&&Gd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Jr&&ca(Jr,r)||(Jr=r,r=El(Hi,"onSelect"),0<r.length&&(s=new Hd("onSelect","select",null,s,n),t.push({event:s,listeners:r}),s.target=Hn)))}function Va(t,s){var n={};return n[t.toLowerCase()]=s.toLowerCase(),n["Webkit"+t]="webkit"+s,n["Moz"+t]="moz"+s,n}var Wn={animationend:Va("Animation","AnimationEnd"),animationiteration:Va("Animation","AnimationIteration"),animationstart:Va("Animation","AnimationStart"),transitionend:Va("Transition","TransitionEnd")},Xo={},$x={};ws&&($x=document.createElement("div").style,"AnimationEvent"in window||(delete Wn.animationend.animation,delete Wn.animationiteration.animation,delete Wn.animationstart.animation),"TransitionEvent"in window||delete Wn.transitionend.transition);function uo(t){if(Xo[t])return Xo[t];if(!Wn[t])return t;var s=Wn[t],n;for(n in s)if(s.hasOwnProperty(n)&&n in $x)return Xo[t]=s[n];return t}var Fx=uo("animationend"),Ox=uo("animationiteration"),_x=uo("animationstart"),zx=uo("transitionend"),Ux=new Map,du="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xn(t,s){Ux.set(t,s),Pn(s,[t])}for(var Ko=0;Ko<du.length;Ko++){var Zo=du[Ko],Og=Zo.toLowerCase(),_g=Zo[0].toUpperCase()+Zo.slice(1);xn(Og,"on"+_g)}xn(Fx,"onAnimationEnd");xn(Ox,"onAnimationIteration");xn(_x,"onAnimationStart");xn("dblclick","onDoubleClick");xn("focusin","onFocus");xn("focusout","onBlur");xn(zx,"onTransitionEnd");ir("onMouseEnter",["mouseout","mouseover"]);ir("onMouseLeave",["mouseout","mouseover"]);ir("onPointerEnter",["pointerout","pointerover"]);ir("onPointerLeave",["pointerout","pointerover"]);Pn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Br="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Br));function cu(t,s,n){var r=t.type||"unknown-event";t.currentTarget=n,Of(r,s,void 0,t),t.currentTarget=null}function Bx(t,s){s=(s&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var l=void 0;if(s)for(var o=r.length-1;0<=o;o--){var i=r[o],c=i.instance,u=i.currentTarget;if(i=i.listener,c!==l&&a.isPropagationStopped())break e;cu(a,i,u),l=c}else for(o=0;o<r.length;o++){if(i=r[o],c=i.instance,u=i.currentTarget,i=i.listener,c!==l&&a.isPropagationStopped())break e;cu(a,i,u),l=c}}}if(kl)throw t=_i,kl=!1,_i=null,t}function Te(t,s){var n=s[Ji];n===void 0&&(n=s[Ji]=new Set);var r=t+"__bubble";n.has(r)||(Hx(s,t,2,!1),n.add(r))}function ei(t,s,n){var r=0;s&&(r|=4),Hx(n,t,r,s)}var Ga="_reactListening"+Math.random().toString(36).slice(2);function ua(t){if(!t[Ga]){t[Ga]=!0,Qm.forEach(function(n){n!=="selectionchange"&&(zg.has(n)||ei(n,!1,t),ei(n,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[Ga]||(s[Ga]=!0,ei("selectionchange",!1,s))}}function Hx(t,s,n,r){switch(Cx(s)){case 1:var a=eg;break;case 4:a=tg;break;default:a=Ud}n=a.bind(null,s,n,t),a=void 0,!Oi||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(s,n,{capture:!0,passive:a}):t.addEventListener(s,n,!0):a!==void 0?t.addEventListener(s,n,{passive:a}):t.addEventListener(s,n,!1)}function ti(t,s,n,r,a){var l=r;if(!(s&1)&&!(s&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var i=r.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;i!==null;){if(o=jn(i),o===null)return;if(c=o.tag,c===5||c===6){r=l=o;continue e}i=i.parentNode}}r=r.return}mx(function(){var u=l,x=Fd(n),m=[];e:{var p=Ux.get(t);if(p!==void 0){var h=Hd,w=t;switch(t){case"keypress":if(xl(n)===0)break e;case"keydown":case"keyup":h=fg;break;case"focusin":w="focus",h=qo;break;case"focusout":w="blur",h=qo;break;case"beforeblur":case"afterblur":h=qo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Kc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=rg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=bg;break;case Fx:case Ox:case _x:h=og;break;case zx:h=jg;break;case"scroll":h=sg;break;case"wheel":h=wg;break;case"copy":case"cut":case"paste":h=dg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=eu}var N=(s&4)!==0,k=!N&&t==="scroll",v=N?p!==null?p+"Capture":null:p;N=[];for(var g=u,b;g!==null;){b=g;var y=b.stateNode;if(b.tag===5&&y!==null&&(b=y,v!==null&&(y=aa(g,v),y!=null&&N.push(ma(g,y,b)))),k)break;g=g.return}0<N.length&&(p=new h(p,w,null,n,x),m.push({event:p,listeners:N}))}}if(!(s&7)){e:{if(p=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",p&&n!==$i&&(w=n.relatedTarget||n.fromElement)&&(jn(w)||w[Ss]))break e;if((h||p)&&(p=x.window===x?x:(p=x.ownerDocument)?p.defaultView||p.parentWindow:window,h?(w=n.relatedTarget||n.toElement,h=u,w=w?jn(w):null,w!==null&&(k=In(w),w!==k||w.tag!==5&&w.tag!==6)&&(w=null)):(h=null,w=u),h!==w)){if(N=Kc,y="onMouseLeave",v="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(N=eu,y="onPointerLeave",v="onPointerEnter",g="pointer"),k=h==null?p:Vn(h),b=w==null?p:Vn(w),p=new N(y,g+"leave",h,n,x),p.target=k,p.relatedTarget=b,y=null,jn(x)===u&&(N=new N(v,g+"enter",w,n,x),N.target=b,N.relatedTarget=k,y=N),k=y,h&&w)t:{for(N=h,v=w,g=0,b=N;b;b=On(b))g++;for(b=0,y=v;y;y=On(y))b++;for(;0<g-b;)N=On(N),g--;for(;0<b-g;)v=On(v),b--;for(;g--;){if(N===v||v!==null&&N===v.alternate)break t;N=On(N),v=On(v)}N=null}else N=null;h!==null&&uu(m,p,h,N,!1),w!==null&&k!==null&&uu(m,k,w,N,!0)}}e:{if(p=u?Vn(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var j=Eg;else if(nu(p))if(Lx)j=Ig;else{j=Lg;var S=Mg}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(j=Pg);if(j&&(j=j(t,u))){Mx(m,j,n,x);break e}S&&S(t,p,u),t==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&Mi(p,"number",p.value)}switch(S=u?Vn(u):window,t){case"focusin":(nu(S)||S.contentEditable==="true")&&(Hn=S,Hi=u,Jr=null);break;case"focusout":Jr=Hi=Hn=null;break;case"mousedown":Wi=!0;break;case"contextmenu":case"mouseup":case"dragend":Wi=!1,iu(m,n,x);break;case"selectionchange":if(Fg)break;case"keydown":case"keyup":iu(m,n,x)}var C;if(Vd)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Bn?Tx(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(Dx&&n.locale!=="ko"&&(Bn||A!=="onCompositionStart"?A==="onCompositionEnd"&&Bn&&(C=Ax()):(qs=x,Bd="value"in qs?qs.value:qs.textContent,Bn=!0)),S=El(u,A),0<S.length&&(A=new Zc(A,t,null,n,x),m.push({event:A,listeners:S}),C?A.data=C:(C=Ex(n),C!==null&&(A.data=C)))),(C=kg?Cg(t,n):Ag(t,n))&&(u=El(u,"onBeforeInput"),0<u.length&&(x=new Zc("onBeforeInput","beforeinput",null,n,x),m.push({event:x,listeners:u}),x.data=C))}Bx(m,s)})}function ma(t,s,n){return{instance:t,listener:s,currentTarget:n}}function El(t,s){for(var n=s+"Capture",r=[];t!==null;){var a=t,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=aa(t,n),l!=null&&r.unshift(ma(t,l,a)),l=aa(t,s),l!=null&&r.push(ma(t,l,a))),t=t.return}return r}function On(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function uu(t,s,n,r,a){for(var l=s._reactName,o=[];n!==null&&n!==r;){var i=n,c=i.alternate,u=i.stateNode;if(c!==null&&c===r)break;i.tag===5&&u!==null&&(i=u,a?(c=aa(n,l),c!=null&&o.unshift(ma(n,c,i))):a||(c=aa(n,l),c!=null&&o.push(ma(n,c,i)))),n=n.return}o.length!==0&&t.push({event:s,listeners:o})}var Ug=/\r\n?/g,Bg=/\u0000|\uFFFD/g;function mu(t){return(typeof t=="string"?t:""+t).replace(Ug,`
`).replace(Bg,"")}function Ya(t,s,n){if(s=mu(s),mu(t)!==s&&n)throw Error(ne(425))}function Ml(){}var Vi=null,Gi=null;function Yi(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var qi=typeof setTimeout=="function"?setTimeout:void 0,Hg=typeof clearTimeout=="function"?clearTimeout:void 0,xu=typeof Promise=="function"?Promise:void 0,Wg=typeof queueMicrotask=="function"?queueMicrotask:typeof xu<"u"?function(t){return xu.resolve(null).then(t).catch(Vg)}:qi;function Vg(t){setTimeout(function(){throw t})}function si(t,s){var n=s,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),ia(s);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);ia(s)}function en(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function hu(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(s===0)return t;s--}else n==="/$"&&s++}t=t.previousSibling}return null}var br=Math.random().toString(36).slice(2),cs="__reactFiber$"+br,xa="__reactProps$"+br,Ss="__reactContainer$"+br,Ji="__reactEvents$"+br,Gg="__reactListeners$"+br,Yg="__reactHandles$"+br;function jn(t){var s=t[cs];if(s)return s;for(var n=t.parentNode;n;){if(s=n[Ss]||n[cs]){if(n=s.alternate,s.child!==null||n!==null&&n.child!==null)for(t=hu(t);t!==null;){if(n=t[cs])return n;t=hu(t)}return s}t=n,n=t.parentNode}return null}function Ta(t){return t=t[cs]||t[Ss],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function mo(t){return t[xa]||null}var Qi=[],Gn=-1;function hn(t){return{current:t}}function Ee(t){0>Gn||(t.current=Qi[Gn],Qi[Gn]=null,Gn--)}function Ae(t,s){Gn++,Qi[Gn]=t.current,t.current=s}var dn={},dt=hn(dn),vt=hn(!1),Dn=dn;function dr(t,s){var n=t.type.contextTypes;if(!n)return dn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===s)return r.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=s[l];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),a}function jt(t){return t=t.childContextTypes,t!=null}function Ll(){Ee(vt),Ee(dt)}function pu(t,s,n){if(dt.current!==dn)throw Error(ne(168));Ae(dt,s),Ae(vt,n)}function Wx(t,s,n){var r=t.stateNode;if(s=s.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in s))throw Error(ne(108,Mf(t)||"Unknown",a));return Oe({},n,r)}function Pl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||dn,Dn=dt.current,Ae(dt,t),Ae(vt,vt.current),!0}function fu(t,s,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=Wx(t,s,Dn),r.__reactInternalMemoizedMergedChildContext=t,Ee(vt),Ee(dt),Ae(dt,t)):Ee(vt),Ae(vt,n)}var ys=null,xo=!1,ni=!1;function Vx(t){ys===null?ys=[t]:ys.push(t)}function qg(t){xo=!0,Vx(t)}function pn(){if(!ni&&ys!==null){ni=!0;var t=0,s=Se;try{var n=ys;for(Se=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ys=null,xo=!1}catch(a){throw ys!==null&&(ys=ys.slice(t+1)),fx(Od,pn),a}finally{Se=s,ni=!1}}return null}var Yn=[],qn=0,Il=null,Rl=0,It=[],Rt=0,Tn=null,bs=1,vs="";function yn(t,s){Yn[qn++]=Rl,Yn[qn++]=Il,Il=t,Rl=s}function Gx(t,s,n){It[Rt++]=bs,It[Rt++]=vs,It[Rt++]=Tn,Tn=t;var r=bs;t=vs;var a=32-Xt(r)-1;r&=~(1<<a),n+=1;var l=32-Xt(s)+a;if(30<l){var o=a-a%5;l=(r&(1<<o)-1).toString(32),r>>=o,a-=o,bs=1<<32-Xt(s)+a|n<<a|r,vs=l+t}else bs=1<<l|n<<a|r,vs=t}function Yd(t){t.return!==null&&(yn(t,1),Gx(t,1,0))}function qd(t){for(;t===Il;)Il=Yn[--qn],Yn[qn]=null,Rl=Yn[--qn],Yn[qn]=null;for(;t===Tn;)Tn=It[--Rt],It[Rt]=null,vs=It[--Rt],It[Rt]=null,bs=It[--Rt],It[Rt]=null}var Ct=null,kt=null,Le=!1,Jt=null;function Yx(t,s){var n=$t(5,null,null,0);n.elementType="DELETED",n.stateNode=s,n.return=t,s=t.deletions,s===null?(t.deletions=[n],t.flags|=16):s.push(n)}function gu(t,s){switch(t.tag){case 5:var n=t.type;return s=s.nodeType!==1||n.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,Ct=t,kt=en(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,Ct=t,kt=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(n=Tn!==null?{id:bs,overflow:vs}:null,t.memoizedState={dehydrated:s,treeContext:n,retryLane:1073741824},n=$t(18,null,null,0),n.stateNode=s,n.return=t,t.child=n,Ct=t,kt=null,!0):!1;default:return!1}}function Xi(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ki(t){if(Le){var s=kt;if(s){var n=s;if(!gu(t,s)){if(Xi(t))throw Error(ne(418));s=en(n.nextSibling);var r=Ct;s&&gu(t,s)?Yx(r,n):(t.flags=t.flags&-4097|2,Le=!1,Ct=t)}}else{if(Xi(t))throw Error(ne(418));t.flags=t.flags&-4097|2,Le=!1,Ct=t}}}function yu(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ct=t}function qa(t){if(t!==Ct)return!1;if(!Le)return yu(t),Le=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!Yi(t.type,t.memoizedProps)),s&&(s=kt)){if(Xi(t))throw qx(),Error(ne(418));for(;s;)Yx(t,s),s=en(s.nextSibling)}if(yu(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(s===0){kt=en(t.nextSibling);break e}s--}else n!=="$"&&n!=="$!"&&n!=="$?"||s++}t=t.nextSibling}kt=null}}else kt=Ct?en(t.stateNode.nextSibling):null;return!0}function qx(){for(var t=kt;t;)t=en(t.nextSibling)}function cr(){kt=Ct=null,Le=!1}function Jd(t){Jt===null?Jt=[t]:Jt.push(t)}var Jg=As.ReactCurrentBatchConfig;function Lr(t,s,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var a=r,l=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===l?s.ref:(s=function(o){var i=a.refs;o===null?delete i[l]:i[l]=o},s._stringRef=l,s)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function Ja(t,s){throw t=Object.prototype.toString.call(s),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function bu(t){var s=t._init;return s(t._payload)}function Jx(t){function s(v,g){if(t){var b=v.deletions;b===null?(v.deletions=[g],v.flags|=16):b.push(g)}}function n(v,g){if(!t)return null;for(;g!==null;)s(v,g),g=g.sibling;return null}function r(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function a(v,g){return v=rn(v,g),v.index=0,v.sibling=null,v}function l(v,g,b){return v.index=b,t?(b=v.alternate,b!==null?(b=b.index,b<g?(v.flags|=2,g):b):(v.flags|=2,g)):(v.flags|=1048576,g)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function i(v,g,b,y){return g===null||g.tag!==6?(g=ci(b,v.mode,y),g.return=v,g):(g=a(g,b),g.return=v,g)}function c(v,g,b,y){var j=b.type;return j===Un?x(v,g,b.props.children,y,b.key):g!==null&&(g.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Bs&&bu(j)===g.type)?(y=a(g,b.props),y.ref=Lr(v,g,b),y.return=v,y):(y=vl(b.type,b.key,b.props,null,v.mode,y),y.ref=Lr(v,g,b),y.return=v,y)}function u(v,g,b,y){return g===null||g.tag!==4||g.stateNode.containerInfo!==b.containerInfo||g.stateNode.implementation!==b.implementation?(g=ui(b,v.mode,y),g.return=v,g):(g=a(g,b.children||[]),g.return=v,g)}function x(v,g,b,y,j){return g===null||g.tag!==7?(g=Cn(b,v.mode,y,j),g.return=v,g):(g=a(g,b),g.return=v,g)}function m(v,g,b){if(typeof g=="string"&&g!==""||typeof g=="number")return g=ci(""+g,v.mode,b),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Oa:return b=vl(g.type,g.key,g.props,null,v.mode,b),b.ref=Lr(v,null,g),b.return=v,b;case zn:return g=ui(g,v.mode,b),g.return=v,g;case Bs:var y=g._init;return m(v,y(g._payload),b)}if(zr(g)||Ar(g))return g=Cn(g,v.mode,b,null),g.return=v,g;Ja(v,g)}return null}function p(v,g,b,y){var j=g!==null?g.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return j!==null?null:i(v,g,""+b,y);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Oa:return b.key===j?c(v,g,b,y):null;case zn:return b.key===j?u(v,g,b,y):null;case Bs:return j=b._init,p(v,g,j(b._payload),y)}if(zr(b)||Ar(b))return j!==null?null:x(v,g,b,y,null);Ja(v,b)}return null}function h(v,g,b,y,j){if(typeof y=="string"&&y!==""||typeof y=="number")return v=v.get(b)||null,i(g,v,""+y,j);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Oa:return v=v.get(y.key===null?b:y.key)||null,c(g,v,y,j);case zn:return v=v.get(y.key===null?b:y.key)||null,u(g,v,y,j);case Bs:var S=y._init;return h(v,g,b,S(y._payload),j)}if(zr(y)||Ar(y))return v=v.get(b)||null,x(g,v,y,j,null);Ja(g,y)}return null}function w(v,g,b,y){for(var j=null,S=null,C=g,A=g=0,R=null;C!==null&&A<b.length;A++){C.index>A?(R=C,C=null):R=C.sibling;var O=p(v,C,b[A],y);if(O===null){C===null&&(C=R);break}t&&C&&O.alternate===null&&s(v,C),g=l(O,g,A),S===null?j=O:S.sibling=O,S=O,C=R}if(A===b.length)return n(v,C),Le&&yn(v,A),j;if(C===null){for(;A<b.length;A++)C=m(v,b[A],y),C!==null&&(g=l(C,g,A),S===null?j=C:S.sibling=C,S=C);return Le&&yn(v,A),j}for(C=r(v,C);A<b.length;A++)R=h(C,v,A,b[A],y),R!==null&&(t&&R.alternate!==null&&C.delete(R.key===null?A:R.key),g=l(R,g,A),S===null?j=R:S.sibling=R,S=R);return t&&C.forEach(function(U){return s(v,U)}),Le&&yn(v,A),j}function N(v,g,b,y){var j=Ar(b);if(typeof j!="function")throw Error(ne(150));if(b=j.call(b),b==null)throw Error(ne(151));for(var S=j=null,C=g,A=g=0,R=null,O=b.next();C!==null&&!O.done;A++,O=b.next()){C.index>A?(R=C,C=null):R=C.sibling;var U=p(v,C,O.value,y);if(U===null){C===null&&(C=R);break}t&&C&&U.alternate===null&&s(v,C),g=l(U,g,A),S===null?j=U:S.sibling=U,S=U,C=R}if(O.done)return n(v,C),Le&&yn(v,A),j;if(C===null){for(;!O.done;A++,O=b.next())O=m(v,O.value,y),O!==null&&(g=l(O,g,A),S===null?j=O:S.sibling=O,S=O);return Le&&yn(v,A),j}for(C=r(v,C);!O.done;A++,O=b.next())O=h(C,v,A,O.value,y),O!==null&&(t&&O.alternate!==null&&C.delete(O.key===null?A:O.key),g=l(O,g,A),S===null?j=O:S.sibling=O,S=O);return t&&C.forEach(function(I){return s(v,I)}),Le&&yn(v,A),j}function k(v,g,b,y){if(typeof b=="object"&&b!==null&&b.type===Un&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Oa:e:{for(var j=b.key,S=g;S!==null;){if(S.key===j){if(j=b.type,j===Un){if(S.tag===7){n(v,S.sibling),g=a(S,b.props.children),g.return=v,v=g;break e}}else if(S.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Bs&&bu(j)===S.type){n(v,S.sibling),g=a(S,b.props),g.ref=Lr(v,S,b),g.return=v,v=g;break e}n(v,S);break}else s(v,S);S=S.sibling}b.type===Un?(g=Cn(b.props.children,v.mode,y,b.key),g.return=v,v=g):(y=vl(b.type,b.key,b.props,null,v.mode,y),y.ref=Lr(v,g,b),y.return=v,v=y)}return o(v);case zn:e:{for(S=b.key;g!==null;){if(g.key===S)if(g.tag===4&&g.stateNode.containerInfo===b.containerInfo&&g.stateNode.implementation===b.implementation){n(v,g.sibling),g=a(g,b.children||[]),g.return=v,v=g;break e}else{n(v,g);break}else s(v,g);g=g.sibling}g=ui(b,v.mode,y),g.return=v,v=g}return o(v);case Bs:return S=b._init,k(v,g,S(b._payload),y)}if(zr(b))return w(v,g,b,y);if(Ar(b))return N(v,g,b,y);Ja(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,g!==null&&g.tag===6?(n(v,g.sibling),g=a(g,b),g.return=v,v=g):(n(v,g),g=ci(b,v.mode,y),g.return=v,v=g),o(v)):n(v,g)}return k}var ur=Jx(!0),Qx=Jx(!1),$l=hn(null),Fl=null,Jn=null,Qd=null;function Xd(){Qd=Jn=Fl=null}function Kd(t){var s=$l.current;Ee($l),t._currentValue=s}function Zi(t,s,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,r!==null&&(r.childLanes|=s)):r!==null&&(r.childLanes&s)!==s&&(r.childLanes|=s),t===n)break;t=t.return}}function ar(t,s){Fl=t,Qd=Jn=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(bt=!0),t.firstContext=null)}function _t(t){var s=t._currentValue;if(Qd!==t)if(t={context:t,memoizedValue:s,next:null},Jn===null){if(Fl===null)throw Error(ne(308));Jn=t,Fl.dependencies={lanes:0,firstContext:t}}else Jn=Jn.next=t;return s}var Nn=null;function Zd(t){Nn===null?Nn=[t]:Nn.push(t)}function Xx(t,s,n,r){var a=s.interleaved;return a===null?(n.next=n,Zd(s)):(n.next=a.next,a.next=n),s.interleaved=n,ks(t,r)}function ks(t,s){t.lanes|=s;var n=t.alternate;for(n!==null&&(n.lanes|=s),n=t,t=t.return;t!==null;)t.childLanes|=s,n=t.alternate,n!==null&&(n.childLanes|=s),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Hs=!1;function ec(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kx(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ns(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function tn(t,s,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,je&2){var a=r.pending;return a===null?s.next=s:(s.next=a.next,a.next=s),r.pending=s,ks(t,n)}return a=r.interleaved,a===null?(s.next=s,Zd(r)):(s.next=a.next,a.next=s),r.interleaved=s,ks(t,n)}function hl(t,s,n){if(s=s.updateQueue,s!==null&&(s=s.shared,(n&4194240)!==0)){var r=s.lanes;r&=t.pendingLanes,n|=r,s.lanes=n,_d(t,n)}}function vu(t,s){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=o:l=l.next=o,n=n.next}while(n!==null);l===null?a=l=s:l=l.next=s}else a=l=s;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=s:t.next=s,n.lastBaseUpdate=s}function Ol(t,s,n,r){var a=t.updateQueue;Hs=!1;var l=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var c=i,u=c.next;c.next=null,o===null?l=u:o.next=u,o=c;var x=t.alternate;x!==null&&(x=x.updateQueue,i=x.lastBaseUpdate,i!==o&&(i===null?x.firstBaseUpdate=u:i.next=u,x.lastBaseUpdate=c))}if(l!==null){var m=a.baseState;o=0,x=u=c=null,i=l;do{var p=i.lane,h=i.eventTime;if((r&p)===p){x!==null&&(x=x.next={eventTime:h,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var w=t,N=i;switch(p=s,h=n,N.tag){case 1:if(w=N.payload,typeof w=="function"){m=w.call(h,m,p);break e}m=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=N.payload,p=typeof w=="function"?w.call(h,m,p):w,p==null)break e;m=Oe({},m,p);break e;case 2:Hs=!0}}i.callback!==null&&i.lane!==0&&(t.flags|=64,p=a.effects,p===null?a.effects=[i]:p.push(i))}else h={eventTime:h,lane:p,tag:i.tag,payload:i.payload,callback:i.callback,next:null},x===null?(u=x=h,c=m):x=x.next=h,o|=p;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;p=i,i=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(x===null&&(c=m),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=x,s=a.shared.interleaved,s!==null){a=s;do o|=a.lane,a=a.next;while(a!==s)}else l===null&&(a.shared.lanes=0);Mn|=o,t.lanes=o,t.memoizedState=m}}function ju(t,s,n){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var r=t[s],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(ne(191,a));a.call(r)}}}var Ea={},xs=hn(Ea),ha=hn(Ea),pa=hn(Ea);function wn(t){if(t===Ea)throw Error(ne(174));return t}function tc(t,s){switch(Ae(pa,s),Ae(ha,t),Ae(xs,Ea),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Pi(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=Pi(s,t)}Ee(xs),Ae(xs,s)}function mr(){Ee(xs),Ee(ha),Ee(pa)}function Zx(t){wn(pa.current);var s=wn(xs.current),n=Pi(s,t.type);s!==n&&(Ae(ha,t),Ae(xs,n))}function sc(t){ha.current===t&&(Ee(xs),Ee(ha))}var Re=hn(0);function _l(t){for(var s=t;s!==null;){if(s.tag===13){var n=s.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var ri=[];function nc(){for(var t=0;t<ri.length;t++)ri[t]._workInProgressVersionPrimary=null;ri.length=0}var pl=As.ReactCurrentDispatcher,ai=As.ReactCurrentBatchConfig,En=0,$e=null,We=null,Je=null,zl=!1,Qr=!1,fa=0,Qg=0;function at(){throw Error(ne(321))}function rc(t,s){if(s===null)return!1;for(var n=0;n<s.length&&n<t.length;n++)if(!es(t[n],s[n]))return!1;return!0}function ac(t,s,n,r,a,l){if(En=l,$e=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,pl.current=t===null||t.memoizedState===null?e0:t0,t=n(r,a),Qr){l=0;do{if(Qr=!1,fa=0,25<=l)throw Error(ne(301));l+=1,Je=We=null,s.updateQueue=null,pl.current=s0,t=n(r,a)}while(Qr)}if(pl.current=Ul,s=We!==null&&We.next!==null,En=0,Je=We=$e=null,zl=!1,s)throw Error(ne(300));return t}function lc(){var t=fa!==0;return fa=0,t}function ds(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Je===null?$e.memoizedState=Je=t:Je=Je.next=t,Je}function zt(){if(We===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=We.next;var s=Je===null?$e.memoizedState:Je.next;if(s!==null)Je=s,We=t;else{if(t===null)throw Error(ne(310));We=t,t={memoizedState:We.memoizedState,baseState:We.baseState,baseQueue:We.baseQueue,queue:We.queue,next:null},Je===null?$e.memoizedState=Je=t:Je=Je.next=t}return Je}function ga(t,s){return typeof s=="function"?s(t):s}function li(t){var s=zt(),n=s.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=We,a=r.baseQueue,l=n.pending;if(l!==null){if(a!==null){var o=a.next;a.next=l.next,l.next=o}r.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,r=r.baseState;var i=o=null,c=null,u=l;do{var x=u.lane;if((En&x)===x)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var m={lane:x,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(i=c=m,o=r):c=c.next=m,$e.lanes|=x,Mn|=x}u=u.next}while(u!==null&&u!==l);c===null?o=r:c.next=i,es(r,s.memoizedState)||(bt=!0),s.memoizedState=r,s.baseState=o,s.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do l=a.lane,$e.lanes|=l,Mn|=l,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[s.memoizedState,n.dispatch]}function oi(t){var s=zt(),n=s.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,l=s.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do l=t(l,o.action),o=o.next;while(o!==a);es(l,s.memoizedState)||(bt=!0),s.memoizedState=l,s.baseQueue===null&&(s.baseState=l),n.lastRenderedState=l}return[l,r]}function eh(){}function th(t,s){var n=$e,r=zt(),a=s(),l=!es(r.memoizedState,a);if(l&&(r.memoizedState=a,bt=!0),r=r.queue,oc(rh.bind(null,n,r,t),[t]),r.getSnapshot!==s||l||Je!==null&&Je.memoizedState.tag&1){if(n.flags|=2048,ya(9,nh.bind(null,n,r,a,s),void 0,null),Xe===null)throw Error(ne(349));En&30||sh(n,s,a)}return a}function sh(t,s,n){t.flags|=16384,t={getSnapshot:s,value:n},s=$e.updateQueue,s===null?(s={lastEffect:null,stores:null},$e.updateQueue=s,s.stores=[t]):(n=s.stores,n===null?s.stores=[t]:n.push(t))}function nh(t,s,n,r){s.value=n,s.getSnapshot=r,ah(s)&&lh(t)}function rh(t,s,n){return n(function(){ah(s)&&lh(t)})}function ah(t){var s=t.getSnapshot;t=t.value;try{var n=s();return!es(t,n)}catch{return!0}}function lh(t){var s=ks(t,1);s!==null&&Kt(s,t,1,-1)}function Nu(t){var s=ds();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:t},s.queue=t,t=t.dispatch=Zg.bind(null,$e,t),[s.memoizedState,t]}function ya(t,s,n,r){return t={tag:t,create:s,destroy:n,deps:r,next:null},s=$e.updateQueue,s===null?(s={lastEffect:null,stores:null},$e.updateQueue=s,s.lastEffect=t.next=t):(n=s.lastEffect,n===null?s.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,s.lastEffect=t)),t}function oh(){return zt().memoizedState}function fl(t,s,n,r){var a=ds();$e.flags|=t,a.memoizedState=ya(1|s,n,void 0,r===void 0?null:r)}function ho(t,s,n,r){var a=zt();r=r===void 0?null:r;var l=void 0;if(We!==null){var o=We.memoizedState;if(l=o.destroy,r!==null&&rc(r,o.deps)){a.memoizedState=ya(s,n,l,r);return}}$e.flags|=t,a.memoizedState=ya(1|s,n,l,r)}function wu(t,s){return fl(8390656,8,t,s)}function oc(t,s){return ho(2048,8,t,s)}function ih(t,s){return ho(4,2,t,s)}function dh(t,s){return ho(4,4,t,s)}function ch(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function uh(t,s,n){return n=n!=null?n.concat([t]):null,ho(4,4,ch.bind(null,s,t),n)}function ic(){}function mh(t,s){var n=zt();s=s===void 0?null:s;var r=n.memoizedState;return r!==null&&s!==null&&rc(s,r[1])?r[0]:(n.memoizedState=[t,s],t)}function xh(t,s){var n=zt();s=s===void 0?null:s;var r=n.memoizedState;return r!==null&&s!==null&&rc(s,r[1])?r[0]:(t=t(),n.memoizedState=[t,s],t)}function hh(t,s,n){return En&21?(es(n,s)||(n=bx(),$e.lanes|=n,Mn|=n,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,bt=!0),t.memoizedState=n)}function Xg(t,s){var n=Se;Se=n!==0&&4>n?n:4,t(!0);var r=ai.transition;ai.transition={};try{t(!1),s()}finally{Se=n,ai.transition=r}}function ph(){return zt().memoizedState}function Kg(t,s,n){var r=nn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},fh(t))gh(s,n);else if(n=Xx(t,s,n,r),n!==null){var a=mt();Kt(n,t,r,a),yh(n,s,r)}}function Zg(t,s,n){var r=nn(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(fh(t))gh(s,a);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=s.lastRenderedReducer,l!==null))try{var o=s.lastRenderedState,i=l(o,n);if(a.hasEagerState=!0,a.eagerState=i,es(i,o)){var c=s.interleaved;c===null?(a.next=a,Zd(s)):(a.next=c.next,c.next=a),s.interleaved=a;return}}catch{}finally{}n=Xx(t,s,a,r),n!==null&&(a=mt(),Kt(n,t,r,a),yh(n,s,r))}}function fh(t){var s=t.alternate;return t===$e||s!==null&&s===$e}function gh(t,s){Qr=zl=!0;var n=t.pending;n===null?s.next=s:(s.next=n.next,n.next=s),t.pending=s}function yh(t,s,n){if(n&4194240){var r=s.lanes;r&=t.pendingLanes,n|=r,s.lanes=n,_d(t,n)}}var Ul={readContext:_t,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},e0={readContext:_t,useCallback:function(t,s){return ds().memoizedState=[t,s===void 0?null:s],t},useContext:_t,useEffect:wu,useImperativeHandle:function(t,s,n){return n=n!=null?n.concat([t]):null,fl(4194308,4,ch.bind(null,s,t),n)},useLayoutEffect:function(t,s){return fl(4194308,4,t,s)},useInsertionEffect:function(t,s){return fl(4,2,t,s)},useMemo:function(t,s){var n=ds();return s=s===void 0?null:s,t=t(),n.memoizedState=[t,s],t},useReducer:function(t,s,n){var r=ds();return s=n!==void 0?n(s):s,r.memoizedState=r.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},r.queue=t,t=t.dispatch=Kg.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var s=ds();return t={current:t},s.memoizedState=t},useState:Nu,useDebugValue:ic,useDeferredValue:function(t){return ds().memoizedState=t},useTransition:function(){var t=Nu(!1),s=t[0];return t=Xg.bind(null,t[1]),ds().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,n){var r=$e,a=ds();if(Le){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=s(),Xe===null)throw Error(ne(349));En&30||sh(r,s,n)}a.memoizedState=n;var l={value:n,getSnapshot:s};return a.queue=l,wu(rh.bind(null,r,l,t),[t]),r.flags|=2048,ya(9,nh.bind(null,r,l,n,s),void 0,null),n},useId:function(){var t=ds(),s=Xe.identifierPrefix;if(Le){var n=vs,r=bs;n=(r&~(1<<32-Xt(r)-1)).toString(32)+n,s=":"+s+"R"+n,n=fa++,0<n&&(s+="H"+n.toString(32)),s+=":"}else n=Qg++,s=":"+s+"r"+n.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},t0={readContext:_t,useCallback:mh,useContext:_t,useEffect:oc,useImperativeHandle:uh,useInsertionEffect:ih,useLayoutEffect:dh,useMemo:xh,useReducer:li,useRef:oh,useState:function(){return li(ga)},useDebugValue:ic,useDeferredValue:function(t){var s=zt();return hh(s,We.memoizedState,t)},useTransition:function(){var t=li(ga)[0],s=zt().memoizedState;return[t,s]},useMutableSource:eh,useSyncExternalStore:th,useId:ph,unstable_isNewReconciler:!1},s0={readContext:_t,useCallback:mh,useContext:_t,useEffect:oc,useImperativeHandle:uh,useInsertionEffect:ih,useLayoutEffect:dh,useMemo:xh,useReducer:oi,useRef:oh,useState:function(){return oi(ga)},useDebugValue:ic,useDeferredValue:function(t){var s=zt();return We===null?s.memoizedState=t:hh(s,We.memoizedState,t)},useTransition:function(){var t=oi(ga)[0],s=zt().memoizedState;return[t,s]},useMutableSource:eh,useSyncExternalStore:th,useId:ph,unstable_isNewReconciler:!1};function Yt(t,s){if(t&&t.defaultProps){s=Oe({},s),t=t.defaultProps;for(var n in t)s[n]===void 0&&(s[n]=t[n]);return s}return s}function ed(t,s,n,r){s=t.memoizedState,n=n(r,s),n=n==null?s:Oe({},s,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var po={isMounted:function(t){return(t=t._reactInternals)?In(t)===t:!1},enqueueSetState:function(t,s,n){t=t._reactInternals;var r=mt(),a=nn(t),l=Ns(r,a);l.payload=s,n!=null&&(l.callback=n),s=tn(t,l,a),s!==null&&(Kt(s,t,a,r),hl(s,t,a))},enqueueReplaceState:function(t,s,n){t=t._reactInternals;var r=mt(),a=nn(t),l=Ns(r,a);l.tag=1,l.payload=s,n!=null&&(l.callback=n),s=tn(t,l,a),s!==null&&(Kt(s,t,a,r),hl(s,t,a))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var n=mt(),r=nn(t),a=Ns(n,r);a.tag=2,s!=null&&(a.callback=s),s=tn(t,a,r),s!==null&&(Kt(s,t,r,n),hl(s,t,r))}};function Su(t,s,n,r,a,l,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,l,o):s.prototype&&s.prototype.isPureReactComponent?!ca(n,r)||!ca(a,l):!0}function bh(t,s,n){var r=!1,a=dn,l=s.contextType;return typeof l=="object"&&l!==null?l=_t(l):(a=jt(s)?Dn:dt.current,r=s.contextTypes,l=(r=r!=null)?dr(t,a):dn),s=new s(n,l),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=po,t.stateNode=s,s._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=l),s}function ku(t,s,n,r){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(n,r),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(n,r),s.state!==t&&po.enqueueReplaceState(s,s.state,null)}function td(t,s,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},ec(t);var l=s.contextType;typeof l=="object"&&l!==null?a.context=_t(l):(l=jt(s)?Dn:dt.current,a.context=dr(t,l)),a.state=t.memoizedState,l=s.getDerivedStateFromProps,typeof l=="function"&&(ed(t,s,l,n),a.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(s=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),s!==a.state&&po.enqueueReplaceState(a,a.state,null),Ol(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function xr(t,s){try{var n="",r=s;do n+=Ef(r),r=r.return;while(r);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:s,stack:a,digest:null}}function ii(t,s,n){return{value:t,source:null,stack:n??null,digest:s??null}}function sd(t,s){try{console.error(s.value)}catch(n){setTimeout(function(){throw n})}}var n0=typeof WeakMap=="function"?WeakMap:Map;function vh(t,s,n){n=Ns(-1,n),n.tag=3,n.payload={element:null};var r=s.value;return n.callback=function(){Hl||(Hl=!0,md=r),sd(t,s)},n}function jh(t,s,n){n=Ns(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=s.value;n.payload=function(){return r(a)},n.callback=function(){sd(t,s)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){sd(t,s),typeof r!="function"&&(sn===null?sn=new Set([this]):sn.add(this));var o=s.stack;this.componentDidCatch(s.value,{componentStack:o!==null?o:""})}),n}function Cu(t,s,n){var r=t.pingCache;if(r===null){r=t.pingCache=new n0;var a=new Set;r.set(s,a)}else a=r.get(s),a===void 0&&(a=new Set,r.set(s,a));a.has(n)||(a.add(n),t=g0.bind(null,t,s,n),s.then(t,t))}function Au(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function Du(t,s,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===s?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(s=Ns(-1,1),s.tag=2,tn(n,s,1))),n.lanes|=1),t)}var r0=As.ReactCurrentOwner,bt=!1;function ut(t,s,n,r){s.child=t===null?Qx(s,null,n,r):ur(s,t.child,n,r)}function Tu(t,s,n,r,a){n=n.render;var l=s.ref;return ar(s,a),r=ac(t,s,n,r,l,a),n=lc(),t!==null&&!bt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~a,Cs(t,s,a)):(Le&&n&&Yd(s),s.flags|=1,ut(t,s,r,a),s.child)}function Eu(t,s,n,r,a){if(t===null){var l=n.type;return typeof l=="function"&&!fc(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(s.tag=15,s.type=l,Nh(t,s,l,r,a)):(t=vl(n.type,null,r,s,s.mode,a),t.ref=s.ref,t.return=s,s.child=t)}if(l=t.child,!(t.lanes&a)){var o=l.memoizedProps;if(n=n.compare,n=n!==null?n:ca,n(o,r)&&t.ref===s.ref)return Cs(t,s,a)}return s.flags|=1,t=rn(l,r),t.ref=s.ref,t.return=s,s.child=t}function Nh(t,s,n,r,a){if(t!==null){var l=t.memoizedProps;if(ca(l,r)&&t.ref===s.ref)if(bt=!1,s.pendingProps=r=l,(t.lanes&a)!==0)t.flags&131072&&(bt=!0);else return s.lanes=t.lanes,Cs(t,s,a)}return nd(t,s,n,r,a)}function wh(t,s,n){var r=s.pendingProps,a=r.children,l=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(Xn,wt),wt|=n;else{if(!(n&1073741824))return t=l!==null?l.baseLanes|n:n,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Ae(Xn,wt),wt|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,Ae(Xn,wt),wt|=r}else l!==null?(r=l.baseLanes|n,s.memoizedState=null):r=n,Ae(Xn,wt),wt|=r;return ut(t,s,a,n),s.child}function Sh(t,s){var n=s.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(s.flags|=512,s.flags|=2097152)}function nd(t,s,n,r,a){var l=jt(n)?Dn:dt.current;return l=dr(s,l),ar(s,a),n=ac(t,s,n,r,l,a),r=lc(),t!==null&&!bt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~a,Cs(t,s,a)):(Le&&r&&Yd(s),s.flags|=1,ut(t,s,n,a),s.child)}function Mu(t,s,n,r,a){if(jt(n)){var l=!0;Pl(s)}else l=!1;if(ar(s,a),s.stateNode===null)gl(t,s),bh(s,n,r),td(s,n,r,a),r=!0;else if(t===null){var o=s.stateNode,i=s.memoizedProps;o.props=i;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=_t(u):(u=jt(n)?Dn:dt.current,u=dr(s,u));var x=n.getDerivedStateFromProps,m=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==r||c!==u)&&ku(s,o,r,u),Hs=!1;var p=s.memoizedState;o.state=p,Ol(s,r,o,a),c=s.memoizedState,i!==r||p!==c||vt.current||Hs?(typeof x=="function"&&(ed(s,n,x,r),c=s.memoizedState),(i=Hs||Su(s,n,i,r,p,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(s.flags|=4194308)):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=r,s.memoizedState=c),o.props=r,o.state=c,o.context=u,r=i):(typeof o.componentDidMount=="function"&&(s.flags|=4194308),r=!1)}else{o=s.stateNode,Kx(t,s),i=s.memoizedProps,u=s.type===s.elementType?i:Yt(s.type,i),o.props=u,m=s.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=_t(c):(c=jt(n)?Dn:dt.current,c=dr(s,c));var h=n.getDerivedStateFromProps;(x=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==m||p!==c)&&ku(s,o,r,c),Hs=!1,p=s.memoizedState,o.state=p,Ol(s,r,o,a);var w=s.memoizedState;i!==m||p!==w||vt.current||Hs?(typeof h=="function"&&(ed(s,n,h,r),w=s.memoizedState),(u=Hs||Su(s,n,u,r,p,w,c)||!1)?(x||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,c)),typeof o.componentDidUpdate=="function"&&(s.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof o.componentDidUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(s.flags|=1024),s.memoizedProps=r,s.memoizedState=w),o.props=r,o.state=w,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(s.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&p===t.memoizedState||(s.flags|=1024),r=!1)}return rd(t,s,n,r,l,a)}function rd(t,s,n,r,a,l){Sh(t,s);var o=(s.flags&128)!==0;if(!r&&!o)return a&&fu(s,n,!1),Cs(t,s,l);r=s.stateNode,r0.current=s;var i=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return s.flags|=1,t!==null&&o?(s.child=ur(s,t.child,null,l),s.child=ur(s,null,i,l)):ut(t,s,i,l),s.memoizedState=r.state,a&&fu(s,n,!0),s.child}function kh(t){var s=t.stateNode;s.pendingContext?pu(t,s.pendingContext,s.pendingContext!==s.context):s.context&&pu(t,s.context,!1),tc(t,s.containerInfo)}function Lu(t,s,n,r,a){return cr(),Jd(a),s.flags|=256,ut(t,s,n,r),s.child}var ad={dehydrated:null,treeContext:null,retryLane:0};function ld(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ch(t,s,n){var r=s.pendingProps,a=Re.current,l=!1,o=(s.flags&128)!==0,i;if((i=o)||(i=t!==null&&t.memoizedState===null?!1:(a&2)!==0),i?(l=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Ae(Re,a&1),t===null)return Ki(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(o=r.children,t=r.fallback,l?(r=s.mode,l=s.child,o={mode:"hidden",children:o},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=o):l=yo(o,r,0,null),t=Cn(t,r,n,null),l.return=s,t.return=s,l.sibling=t,s.child=l,s.child.memoizedState=ld(n),s.memoizedState=ad,t):dc(s,o));if(a=t.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return a0(t,s,o,r,i,a,n);if(l){l=r.fallback,o=s.mode,a=t.child,i=a.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&s.child!==a?(r=s.child,r.childLanes=0,r.pendingProps=c,s.deletions=null):(r=rn(a,c),r.subtreeFlags=a.subtreeFlags&14680064),i!==null?l=rn(i,l):(l=Cn(l,o,n,null),l.flags|=2),l.return=s,r.return=s,r.sibling=l,s.child=r,r=l,l=s.child,o=t.child.memoizedState,o=o===null?ld(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=t.childLanes&~n,s.memoizedState=ad,r}return l=t.child,t=l.sibling,r=rn(l,{mode:"visible",children:r.children}),!(s.mode&1)&&(r.lanes=n),r.return=s,r.sibling=null,t!==null&&(n=s.deletions,n===null?(s.deletions=[t],s.flags|=16):n.push(t)),s.child=r,s.memoizedState=null,r}function dc(t,s){return s=yo({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function Qa(t,s,n,r){return r!==null&&Jd(r),ur(s,t.child,null,n),t=dc(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function a0(t,s,n,r,a,l,o){if(n)return s.flags&256?(s.flags&=-257,r=ii(Error(ne(422))),Qa(t,s,o,r)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(l=r.fallback,a=s.mode,r=yo({mode:"visible",children:r.children},a,0,null),l=Cn(l,a,o,null),l.flags|=2,r.return=s,l.return=s,r.sibling=l,s.child=r,s.mode&1&&ur(s,t.child,null,o),s.child.memoizedState=ld(o),s.memoizedState=ad,l);if(!(s.mode&1))return Qa(t,s,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var i=r.dgst;return r=i,l=Error(ne(419)),r=ii(l,r,void 0),Qa(t,s,o,r)}if(i=(o&t.childLanes)!==0,bt||i){if(r=Xe,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,ks(t,a),Kt(r,t,a,-1))}return pc(),r=ii(Error(ne(421))),Qa(t,s,o,r)}return a.data==="$?"?(s.flags|=128,s.child=t.child,s=y0.bind(null,t),a._reactRetry=s,null):(t=l.treeContext,kt=en(a.nextSibling),Ct=s,Le=!0,Jt=null,t!==null&&(It[Rt++]=bs,It[Rt++]=vs,It[Rt++]=Tn,bs=t.id,vs=t.overflow,Tn=s),s=dc(s,r.children),s.flags|=4096,s)}function Pu(t,s,n){t.lanes|=s;var r=t.alternate;r!==null&&(r.lanes|=s),Zi(t.return,s,n)}function di(t,s,n,r,a){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(l.isBackwards=s,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=a)}function Ah(t,s,n){var r=s.pendingProps,a=r.revealOrder,l=r.tail;if(ut(t,s,r.children,n),r=Re.current,r&2)r=r&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Pu(t,n,s);else if(t.tag===19)Pu(t,n,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ae(Re,r),!(s.mode&1))s.memoizedState=null;else switch(a){case"forwards":for(n=s.child,a=null;n!==null;)t=n.alternate,t!==null&&_l(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=s.child,s.child=null):(a=n.sibling,n.sibling=null),di(s,!1,a,n,l);break;case"backwards":for(n=null,a=s.child,s.child=null;a!==null;){if(t=a.alternate,t!==null&&_l(t)===null){s.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}di(s,!0,n,null,l);break;case"together":di(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function gl(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function Cs(t,s,n){if(t!==null&&(s.dependencies=t.dependencies),Mn|=s.lanes,!(n&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(ne(153));if(s.child!==null){for(t=s.child,n=rn(t,t.pendingProps),s.child=n,n.return=s;t.sibling!==null;)t=t.sibling,n=n.sibling=rn(t,t.pendingProps),n.return=s;n.sibling=null}return s.child}function l0(t,s,n){switch(s.tag){case 3:kh(s),cr();break;case 5:Zx(s);break;case 1:jt(s.type)&&Pl(s);break;case 4:tc(s,s.stateNode.containerInfo);break;case 10:var r=s.type._context,a=s.memoizedProps.value;Ae($l,r._currentValue),r._currentValue=a;break;case 13:if(r=s.memoizedState,r!==null)return r.dehydrated!==null?(Ae(Re,Re.current&1),s.flags|=128,null):n&s.child.childLanes?Ch(t,s,n):(Ae(Re,Re.current&1),t=Cs(t,s,n),t!==null?t.sibling:null);Ae(Re,Re.current&1);break;case 19:if(r=(n&s.childLanes)!==0,t.flags&128){if(r)return Ah(t,s,n);s.flags|=128}if(a=s.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ae(Re,Re.current),r)break;return null;case 22:case 23:return s.lanes=0,wh(t,s,n)}return Cs(t,s,n)}var Dh,od,Th,Eh;Dh=function(t,s){for(var n=s.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};od=function(){};Th=function(t,s,n,r){var a=t.memoizedProps;if(a!==r){t=s.stateNode,wn(xs.current);var l=null;switch(n){case"input":a=Ti(t,a),r=Ti(t,r),l=[];break;case"select":a=Oe({},a,{value:void 0}),r=Oe({},r,{value:void 0}),l=[];break;case"textarea":a=Li(t,a),r=Li(t,r),l=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ml)}Ii(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var i=a[u];for(o in i)i.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(na.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in r){var c=r[u];if(i=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&c!==i&&(c!=null||i!=null))if(u==="style")if(i){for(o in i)!i.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&i[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(l||(l=[]),l.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,i=i?i.__html:void 0,c!=null&&i!==c&&(l=l||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(l=l||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(na.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Te("scroll",t),l||i===c||(l=[])):(l=l||[]).push(u,c))}n&&(l=l||[]).push("style",n);var u=l;(s.updateQueue=u)&&(s.flags|=4)}};Eh=function(t,s,n,r){n!==r&&(s.flags|=4)};function Pr(t,s){if(!Le)switch(t.tailMode){case"hidden":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function lt(t){var s=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(s)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,s}function o0(t,s,n){var r=s.pendingProps;switch(qd(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(s),null;case 1:return jt(s.type)&&Ll(),lt(s),null;case 3:return r=s.stateNode,mr(),Ee(vt),Ee(dt),nc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(qa(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Jt!==null&&(pd(Jt),Jt=null))),od(t,s),lt(s),null;case 5:sc(s);var a=wn(pa.current);if(n=s.type,t!==null&&s.stateNode!=null)Th(t,s,n,r,a),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!r){if(s.stateNode===null)throw Error(ne(166));return lt(s),null}if(t=wn(xs.current),qa(s)){r=s.stateNode,n=s.type;var l=s.memoizedProps;switch(r[cs]=s,r[xa]=l,t=(s.mode&1)!==0,n){case"dialog":Te("cancel",r),Te("close",r);break;case"iframe":case"object":case"embed":Te("load",r);break;case"video":case"audio":for(a=0;a<Br.length;a++)Te(Br[a],r);break;case"source":Te("error",r);break;case"img":case"image":case"link":Te("error",r),Te("load",r);break;case"details":Te("toggle",r);break;case"input":Bc(r,l),Te("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Te("invalid",r);break;case"textarea":Wc(r,l),Te("invalid",r)}Ii(n,l),a=null;for(var o in l)if(l.hasOwnProperty(o)){var i=l[o];o==="children"?typeof i=="string"?r.textContent!==i&&(l.suppressHydrationWarning!==!0&&Ya(r.textContent,i,t),a=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&Ya(r.textContent,i,t),a=["children",""+i]):na.hasOwnProperty(o)&&i!=null&&o==="onScroll"&&Te("scroll",r)}switch(n){case"input":_a(r),Hc(r,l,!0);break;case"textarea":_a(r),Vc(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=Ml)}r=a,s.updateQueue=r,r!==null&&(s.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[cs]=s,t[xa]=r,Dh(t,s,!1,!1),s.stateNode=t;e:{switch(o=Ri(n,r),n){case"dialog":Te("cancel",t),Te("close",t),a=r;break;case"iframe":case"object":case"embed":Te("load",t),a=r;break;case"video":case"audio":for(a=0;a<Br.length;a++)Te(Br[a],t);a=r;break;case"source":Te("error",t),a=r;break;case"img":case"image":case"link":Te("error",t),Te("load",t),a=r;break;case"details":Te("toggle",t),a=r;break;case"input":Bc(t,r),a=Ti(t,r),Te("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=Oe({},r,{value:void 0}),Te("invalid",t);break;case"textarea":Wc(t,r),a=Li(t,r),Te("invalid",t);break;default:a=r}Ii(n,a),i=a;for(l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="style"?ox(t,c):l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ax(t,c)):l==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ra(t,c):typeof c=="number"&&ra(t,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(na.hasOwnProperty(l)?c!=null&&l==="onScroll"&&Te("scroll",t):c!=null&&Pd(t,l,c,o))}switch(n){case"input":_a(t),Hc(t,r,!1);break;case"textarea":_a(t),Vc(t);break;case"option":r.value!=null&&t.setAttribute("value",""+on(r.value));break;case"select":t.multiple=!!r.multiple,l=r.value,l!=null?tr(t,!!r.multiple,l,!1):r.defaultValue!=null&&tr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Ml)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return lt(s),null;case 6:if(t&&s.stateNode!=null)Eh(t,s,t.memoizedProps,r);else{if(typeof r!="string"&&s.stateNode===null)throw Error(ne(166));if(n=wn(pa.current),wn(xs.current),qa(s)){if(r=s.stateNode,n=s.memoizedProps,r[cs]=s,(l=r.nodeValue!==n)&&(t=Ct,t!==null))switch(t.tag){case 3:Ya(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ya(r.nodeValue,n,(t.mode&1)!==0)}l&&(s.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[cs]=s,s.stateNode=r}return lt(s),null;case 13:if(Ee(Re),r=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Le&&kt!==null&&s.mode&1&&!(s.flags&128))qx(),cr(),s.flags|=98560,l=!1;else if(l=qa(s),r!==null&&r.dehydrated!==null){if(t===null){if(!l)throw Error(ne(318));if(l=s.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ne(317));l[cs]=s}else cr(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;lt(s),l=!1}else Jt!==null&&(pd(Jt),Jt=null),l=!0;if(!l)return s.flags&65536?s:null}return s.flags&128?(s.lanes=n,s):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(s.child.flags|=8192,s.mode&1&&(t===null||Re.current&1?Ge===0&&(Ge=3):pc())),s.updateQueue!==null&&(s.flags|=4),lt(s),null);case 4:return mr(),od(t,s),t===null&&ua(s.stateNode.containerInfo),lt(s),null;case 10:return Kd(s.type._context),lt(s),null;case 17:return jt(s.type)&&Ll(),lt(s),null;case 19:if(Ee(Re),l=s.memoizedState,l===null)return lt(s),null;if(r=(s.flags&128)!==0,o=l.rendering,o===null)if(r)Pr(l,!1);else{if(Ge!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(o=_l(t),o!==null){for(s.flags|=128,Pr(l,!1),r=o.updateQueue,r!==null&&(s.updateQueue=r,s.flags|=4),s.subtreeFlags=0,r=n,n=s.child;n!==null;)l=n,t=r,l.flags&=14680066,o=l.alternate,o===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,t=o.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ae(Re,Re.current&1|2),s.child}t=t.sibling}l.tail!==null&&Ue()>hr&&(s.flags|=128,r=!0,Pr(l,!1),s.lanes=4194304)}else{if(!r)if(t=_l(o),t!==null){if(s.flags|=128,r=!0,n=t.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),Pr(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!Le)return lt(s),null}else 2*Ue()-l.renderingStartTime>hr&&n!==1073741824&&(s.flags|=128,r=!0,Pr(l,!1),s.lanes=4194304);l.isBackwards?(o.sibling=s.child,s.child=o):(n=l.last,n!==null?n.sibling=o:s.child=o,l.last=o)}return l.tail!==null?(s=l.tail,l.rendering=s,l.tail=s.sibling,l.renderingStartTime=Ue(),s.sibling=null,n=Re.current,Ae(Re,r?n&1|2:n&1),s):(lt(s),null);case 22:case 23:return hc(),r=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(s.flags|=8192),r&&s.mode&1?wt&1073741824&&(lt(s),s.subtreeFlags&6&&(s.flags|=8192)):lt(s),null;case 24:return null;case 25:return null}throw Error(ne(156,s.tag))}function i0(t,s){switch(qd(s),s.tag){case 1:return jt(s.type)&&Ll(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return mr(),Ee(vt),Ee(dt),nc(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return sc(s),null;case 13:if(Ee(Re),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(ne(340));cr()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return Ee(Re),null;case 4:return mr(),null;case 10:return Kd(s.type._context),null;case 22:case 23:return hc(),null;case 24:return null;default:return null}}var Xa=!1,ot=!1,d0=typeof WeakSet=="function"?WeakSet:Set,ue=null;function Qn(t,s){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ze(t,s,r)}else n.current=null}function id(t,s,n){try{n()}catch(r){ze(t,s,r)}}var Iu=!1;function c0(t,s){if(Vi=Dl,t=Rx(),Gd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var o=0,i=-1,c=-1,u=0,x=0,m=t,p=null;t:for(;;){for(var h;m!==n||a!==0&&m.nodeType!==3||(i=o+a),m!==l||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(h=m.firstChild)!==null;)p=m,m=h;for(;;){if(m===t)break t;if(p===n&&++u===a&&(i=o),p===l&&++x===r&&(c=o),(h=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=h}n=i===-1||c===-1?null:{start:i,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Gi={focusedElem:t,selectionRange:n},Dl=!1,ue=s;ue!==null;)if(s=ue,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,ue=t;else for(;ue!==null;){s=ue;try{var w=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var N=w.memoizedProps,k=w.memoizedState,v=s.stateNode,g=v.getSnapshotBeforeUpdate(s.elementType===s.type?N:Yt(s.type,N),k);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var b=s.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(y){ze(s,s.return,y)}if(t=s.sibling,t!==null){t.return=s.return,ue=t;break}ue=s.return}return w=Iu,Iu=!1,w}function Xr(t,s,n){var r=s.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var l=a.destroy;a.destroy=void 0,l!==void 0&&id(s,n,l)}a=a.next}while(a!==r)}}function fo(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==s)}}function dd(t){var s=t.ref;if(s!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof s=="function"?s(t):s.current=t}}function Mh(t){var s=t.alternate;s!==null&&(t.alternate=null,Mh(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[cs],delete s[xa],delete s[Ji],delete s[Gg],delete s[Yg])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Lh(t){return t.tag===5||t.tag===3||t.tag===4}function Ru(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Lh(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cd(t,s,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,s?n.nodeType===8?n.parentNode.insertBefore(t,s):n.insertBefore(t,s):(n.nodeType===8?(s=n.parentNode,s.insertBefore(t,n)):(s=n,s.appendChild(t)),n=n._reactRootContainer,n!=null||s.onclick!==null||(s.onclick=Ml));else if(r!==4&&(t=t.child,t!==null))for(cd(t,s,n),t=t.sibling;t!==null;)cd(t,s,n),t=t.sibling}function ud(t,s,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,s?n.insertBefore(t,s):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ud(t,s,n),t=t.sibling;t!==null;)ud(t,s,n),t=t.sibling}var tt=null,qt=!1;function $s(t,s,n){for(n=n.child;n!==null;)Ph(t,s,n),n=n.sibling}function Ph(t,s,n){if(ms&&typeof ms.onCommitFiberUnmount=="function")try{ms.onCommitFiberUnmount(oo,n)}catch{}switch(n.tag){case 5:ot||Qn(n,s);case 6:var r=tt,a=qt;tt=null,$s(t,s,n),tt=r,qt=a,tt!==null&&(qt?(t=tt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tt.removeChild(n.stateNode));break;case 18:tt!==null&&(qt?(t=tt,n=n.stateNode,t.nodeType===8?si(t.parentNode,n):t.nodeType===1&&si(t,n),ia(t)):si(tt,n.stateNode));break;case 4:r=tt,a=qt,tt=n.stateNode.containerInfo,qt=!0,$s(t,s,n),tt=r,qt=a;break;case 0:case 11:case 14:case 15:if(!ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var l=a,o=l.destroy;l=l.tag,o!==void 0&&(l&2||l&4)&&id(n,s,o),a=a.next}while(a!==r)}$s(t,s,n);break;case 1:if(!ot&&(Qn(n,s),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){ze(n,s,i)}$s(t,s,n);break;case 21:$s(t,s,n);break;case 22:n.mode&1?(ot=(r=ot)||n.memoizedState!==null,$s(t,s,n),ot=r):$s(t,s,n);break;default:$s(t,s,n)}}function $u(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new d0),s.forEach(function(r){var a=b0.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Vt(t,s){var n=s.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var l=t,o=s,i=o;e:for(;i!==null;){switch(i.tag){case 5:tt=i.stateNode,qt=!1;break e;case 3:tt=i.stateNode.containerInfo,qt=!0;break e;case 4:tt=i.stateNode.containerInfo,qt=!0;break e}i=i.return}if(tt===null)throw Error(ne(160));Ph(l,o,a),tt=null,qt=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){ze(a,s,u)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)Ih(s,t),s=s.sibling}function Ih(t,s){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vt(s,t),os(t),r&4){try{Xr(3,t,t.return),fo(3,t)}catch(N){ze(t,t.return,N)}try{Xr(5,t,t.return)}catch(N){ze(t,t.return,N)}}break;case 1:Vt(s,t),os(t),r&512&&n!==null&&Qn(n,n.return);break;case 5:if(Vt(s,t),os(t),r&512&&n!==null&&Qn(n,n.return),t.flags&32){var a=t.stateNode;try{ra(a,"")}catch(N){ze(t,t.return,N)}}if(r&4&&(a=t.stateNode,a!=null)){var l=t.memoizedProps,o=n!==null?n.memoizedProps:l,i=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&sx(a,l),Ri(i,o);var u=Ri(i,l);for(o=0;o<c.length;o+=2){var x=c[o],m=c[o+1];x==="style"?ox(a,m):x==="dangerouslySetInnerHTML"?ax(a,m):x==="children"?ra(a,m):Pd(a,x,m,u)}switch(i){case"input":Ei(a,l);break;case"textarea":nx(a,l);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var h=l.value;h!=null?tr(a,!!l.multiple,h,!1):p!==!!l.multiple&&(l.defaultValue!=null?tr(a,!!l.multiple,l.defaultValue,!0):tr(a,!!l.multiple,l.multiple?[]:"",!1))}a[xa]=l}catch(N){ze(t,t.return,N)}}break;case 6:if(Vt(s,t),os(t),r&4){if(t.stateNode===null)throw Error(ne(162));a=t.stateNode,l=t.memoizedProps;try{a.nodeValue=l}catch(N){ze(t,t.return,N)}}break;case 3:if(Vt(s,t),os(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ia(s.containerInfo)}catch(N){ze(t,t.return,N)}break;case 4:Vt(s,t),os(t);break;case 13:Vt(s,t),os(t),a=t.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(mc=Ue())),r&4&&$u(t);break;case 22:if(x=n!==null&&n.memoizedState!==null,t.mode&1?(ot=(u=ot)||x,Vt(s,t),ot=u):Vt(s,t),os(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!x&&t.mode&1)for(ue=t,x=t.child;x!==null;){for(m=ue=x;ue!==null;){switch(p=ue,h=p.child,p.tag){case 0:case 11:case 14:case 15:Xr(4,p,p.return);break;case 1:Qn(p,p.return);var w=p.stateNode;if(typeof w.componentWillUnmount=="function"){r=p,n=p.return;try{s=r,w.props=s.memoizedProps,w.state=s.memoizedState,w.componentWillUnmount()}catch(N){ze(r,n,N)}}break;case 5:Qn(p,p.return);break;case 22:if(p.memoizedState!==null){Ou(m);continue}}h!==null?(h.return=p,ue=h):Ou(m)}x=x.sibling}e:for(x=null,m=t;;){if(m.tag===5){if(x===null){x=m;try{a=m.stateNode,u?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,i.style.display=lx("display",o))}catch(N){ze(t,t.return,N)}}}else if(m.tag===6){if(x===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(N){ze(t,t.return,N)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;x===m&&(x=null),m=m.return}x===m&&(x=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Vt(s,t),os(t),r&4&&$u(t);break;case 21:break;default:Vt(s,t),os(t)}}function os(t){var s=t.flags;if(s&2){try{e:{for(var n=t.return;n!==null;){if(Lh(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(ra(a,""),r.flags&=-33);var l=Ru(t);ud(t,l,a);break;case 3:case 4:var o=r.stateNode.containerInfo,i=Ru(t);cd(t,i,o);break;default:throw Error(ne(161))}}catch(c){ze(t,t.return,c)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function u0(t,s,n){ue=t,Rh(t)}function Rh(t,s,n){for(var r=(t.mode&1)!==0;ue!==null;){var a=ue,l=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||Xa;if(!o){var i=a.alternate,c=i!==null&&i.memoizedState!==null||ot;i=Xa;var u=ot;if(Xa=o,(ot=c)&&!u)for(ue=a;ue!==null;)o=ue,c=o.child,o.tag===22&&o.memoizedState!==null?_u(a):c!==null?(c.return=o,ue=c):_u(a);for(;l!==null;)ue=l,Rh(l),l=l.sibling;ue=a,Xa=i,ot=u}Fu(t)}else a.subtreeFlags&8772&&l!==null?(l.return=a,ue=l):Fu(t)}}function Fu(t){for(;ue!==null;){var s=ue;if(s.flags&8772){var n=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:ot||fo(5,s);break;case 1:var r=s.stateNode;if(s.flags&4&&!ot)if(n===null)r.componentDidMount();else{var a=s.elementType===s.type?n.memoizedProps:Yt(s.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=s.updateQueue;l!==null&&ju(s,l,r);break;case 3:var o=s.updateQueue;if(o!==null){if(n=null,s.child!==null)switch(s.child.tag){case 5:n=s.child.stateNode;break;case 1:n=s.child.stateNode}ju(s,o,n)}break;case 5:var i=s.stateNode;if(n===null&&s.flags&4){n=i;var c=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var u=s.alternate;if(u!==null){var x=u.memoizedState;if(x!==null){var m=x.dehydrated;m!==null&&ia(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}ot||s.flags&512&&dd(s)}catch(p){ze(s,s.return,p)}}if(s===t){ue=null;break}if(n=s.sibling,n!==null){n.return=s.return,ue=n;break}ue=s.return}}function Ou(t){for(;ue!==null;){var s=ue;if(s===t){ue=null;break}var n=s.sibling;if(n!==null){n.return=s.return,ue=n;break}ue=s.return}}function _u(t){for(;ue!==null;){var s=ue;try{switch(s.tag){case 0:case 11:case 15:var n=s.return;try{fo(4,s)}catch(c){ze(s,n,c)}break;case 1:var r=s.stateNode;if(typeof r.componentDidMount=="function"){var a=s.return;try{r.componentDidMount()}catch(c){ze(s,a,c)}}var l=s.return;try{dd(s)}catch(c){ze(s,l,c)}break;case 5:var o=s.return;try{dd(s)}catch(c){ze(s,o,c)}}}catch(c){ze(s,s.return,c)}if(s===t){ue=null;break}var i=s.sibling;if(i!==null){i.return=s.return,ue=i;break}ue=s.return}}var m0=Math.ceil,Bl=As.ReactCurrentDispatcher,cc=As.ReactCurrentOwner,Ft=As.ReactCurrentBatchConfig,je=0,Xe=null,Be=null,st=0,wt=0,Xn=hn(0),Ge=0,ba=null,Mn=0,go=0,uc=0,Kr=null,yt=null,mc=0,hr=1/0,fs=null,Hl=!1,md=null,sn=null,Ka=!1,Js=null,Wl=0,Zr=0,xd=null,yl=-1,bl=0;function mt(){return je&6?Ue():yl!==-1?yl:yl=Ue()}function nn(t){return t.mode&1?je&2&&st!==0?st&-st:Jg.transition!==null?(bl===0&&(bl=bx()),bl):(t=Se,t!==0||(t=window.event,t=t===void 0?16:Cx(t.type)),t):1}function Kt(t,s,n,r){if(50<Zr)throw Zr=0,xd=null,Error(ne(185));Aa(t,n,r),(!(je&2)||t!==Xe)&&(t===Xe&&(!(je&2)&&(go|=n),Ge===4&&Gs(t,st)),Nt(t,r),n===1&&je===0&&!(s.mode&1)&&(hr=Ue()+500,xo&&pn()))}function Nt(t,s){var n=t.callbackNode;Jf(t,s);var r=Al(t,t===Xe?st:0);if(r===0)n!==null&&qc(n),t.callbackNode=null,t.callbackPriority=0;else if(s=r&-r,t.callbackPriority!==s){if(n!=null&&qc(n),s===1)t.tag===0?qg(zu.bind(null,t)):Vx(zu.bind(null,t)),Wg(function(){!(je&6)&&pn()}),n=null;else{switch(vx(r)){case 1:n=Od;break;case 4:n=gx;break;case 16:n=Cl;break;case 536870912:n=yx;break;default:n=Cl}n=Hh(n,$h.bind(null,t))}t.callbackPriority=s,t.callbackNode=n}}function $h(t,s){if(yl=-1,bl=0,je&6)throw Error(ne(327));var n=t.callbackNode;if(lr()&&t.callbackNode!==n)return null;var r=Al(t,t===Xe?st:0);if(r===0)return null;if(r&30||r&t.expiredLanes||s)s=Vl(t,r);else{s=r;var a=je;je|=2;var l=Oh();(Xe!==t||st!==s)&&(fs=null,hr=Ue()+500,kn(t,s));do try{p0();break}catch(i){Fh(t,i)}while(!0);Xd(),Bl.current=l,je=a,Be!==null?s=0:(Xe=null,st=0,s=Ge)}if(s!==0){if(s===2&&(a=zi(t),a!==0&&(r=a,s=hd(t,a))),s===1)throw n=ba,kn(t,0),Gs(t,r),Nt(t,Ue()),n;if(s===6)Gs(t,r);else{if(a=t.current.alternate,!(r&30)&&!x0(a)&&(s=Vl(t,r),s===2&&(l=zi(t),l!==0&&(r=l,s=hd(t,l))),s===1))throw n=ba,kn(t,0),Gs(t,r),Nt(t,Ue()),n;switch(t.finishedWork=a,t.finishedLanes=r,s){case 0:case 1:throw Error(ne(345));case 2:bn(t,yt,fs);break;case 3:if(Gs(t,r),(r&130023424)===r&&(s=mc+500-Ue(),10<s)){if(Al(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){mt(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=qi(bn.bind(null,t,yt,fs),s);break}bn(t,yt,fs);break;case 4:if(Gs(t,r),(r&4194240)===r)break;for(s=t.eventTimes,a=-1;0<r;){var o=31-Xt(r);l=1<<o,o=s[o],o>a&&(a=o),r&=~l}if(r=a,r=Ue()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*m0(r/1960))-r,10<r){t.timeoutHandle=qi(bn.bind(null,t,yt,fs),r);break}bn(t,yt,fs);break;case 5:bn(t,yt,fs);break;default:throw Error(ne(329))}}}return Nt(t,Ue()),t.callbackNode===n?$h.bind(null,t):null}function hd(t,s){var n=Kr;return t.current.memoizedState.isDehydrated&&(kn(t,s).flags|=256),t=Vl(t,s),t!==2&&(s=yt,yt=n,s!==null&&pd(s)),t}function pd(t){yt===null?yt=t:yt.push.apply(yt,t)}function x0(t){for(var s=t;;){if(s.flags&16384){var n=s.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],l=a.getSnapshot;a=a.value;try{if(!es(l(),a))return!1}catch{return!1}}}if(n=s.child,s.subtreeFlags&16384&&n!==null)n.return=s,s=n;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Gs(t,s){for(s&=~uc,s&=~go,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var n=31-Xt(s),r=1<<n;t[n]=-1,s&=~r}}function zu(t){if(je&6)throw Error(ne(327));lr();var s=Al(t,0);if(!(s&1))return Nt(t,Ue()),null;var n=Vl(t,s);if(t.tag!==0&&n===2){var r=zi(t);r!==0&&(s=r,n=hd(t,r))}if(n===1)throw n=ba,kn(t,0),Gs(t,s),Nt(t,Ue()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,bn(t,yt,fs),Nt(t,Ue()),null}function xc(t,s){var n=je;je|=1;try{return t(s)}finally{je=n,je===0&&(hr=Ue()+500,xo&&pn())}}function Ln(t){Js!==null&&Js.tag===0&&!(je&6)&&lr();var s=je;je|=1;var n=Ft.transition,r=Se;try{if(Ft.transition=null,Se=1,t)return t()}finally{Se=r,Ft.transition=n,je=s,!(je&6)&&pn()}}function hc(){wt=Xn.current,Ee(Xn)}function kn(t,s){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Hg(n)),Be!==null)for(n=Be.return;n!==null;){var r=n;switch(qd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ll();break;case 3:mr(),Ee(vt),Ee(dt),nc();break;case 5:sc(r);break;case 4:mr();break;case 13:Ee(Re);break;case 19:Ee(Re);break;case 10:Kd(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Xe=t,Be=t=rn(t.current,null),st=wt=s,Ge=0,ba=null,uc=go=Mn=0,yt=Kr=null,Nn!==null){for(s=0;s<Nn.length;s++)if(n=Nn[s],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,l=n.pending;if(l!==null){var o=l.next;l.next=a,r.next=o}n.pending=r}Nn=null}return t}function Fh(t,s){do{var n=Be;try{if(Xd(),pl.current=Ul,zl){for(var r=$e.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}zl=!1}if(En=0,Je=We=$e=null,Qr=!1,fa=0,cc.current=null,n===null||n.return===null){Ge=1,ba=s,Be=null;break}e:{var l=t,o=n.return,i=n,c=s;if(s=st,i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,x=i,m=x.tag;if(!(x.mode&1)&&(m===0||m===11||m===15)){var p=x.alternate;p?(x.updateQueue=p.updateQueue,x.memoizedState=p.memoizedState,x.lanes=p.lanes):(x.updateQueue=null,x.memoizedState=null)}var h=Au(o);if(h!==null){h.flags&=-257,Du(h,o,i,l,s),h.mode&1&&Cu(l,u,s),s=h,c=u;var w=s.updateQueue;if(w===null){var N=new Set;N.add(c),s.updateQueue=N}else w.add(c);break e}else{if(!(s&1)){Cu(l,u,s),pc();break e}c=Error(ne(426))}}else if(Le&&i.mode&1){var k=Au(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Du(k,o,i,l,s),Jd(xr(c,i));break e}}l=c=xr(c,i),Ge!==4&&(Ge=2),Kr===null?Kr=[l]:Kr.push(l),l=o;do{switch(l.tag){case 3:l.flags|=65536,s&=-s,l.lanes|=s;var v=vh(l,c,s);vu(l,v);break e;case 1:i=c;var g=l.type,b=l.stateNode;if(!(l.flags&128)&&(typeof g.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(sn===null||!sn.has(b)))){l.flags|=65536,s&=-s,l.lanes|=s;var y=jh(l,i,s);vu(l,y);break e}}l=l.return}while(l!==null)}zh(n)}catch(j){s=j,Be===n&&n!==null&&(Be=n=n.return);continue}break}while(!0)}function Oh(){var t=Bl.current;return Bl.current=Ul,t===null?Ul:t}function pc(){(Ge===0||Ge===3||Ge===2)&&(Ge=4),Xe===null||!(Mn&268435455)&&!(go&268435455)||Gs(Xe,st)}function Vl(t,s){var n=je;je|=2;var r=Oh();(Xe!==t||st!==s)&&(fs=null,kn(t,s));do try{h0();break}catch(a){Fh(t,a)}while(!0);if(Xd(),je=n,Bl.current=r,Be!==null)throw Error(ne(261));return Xe=null,st=0,Ge}function h0(){for(;Be!==null;)_h(Be)}function p0(){for(;Be!==null&&!zf();)_h(Be)}function _h(t){var s=Bh(t.alternate,t,wt);t.memoizedProps=t.pendingProps,s===null?zh(t):Be=s,cc.current=null}function zh(t){var s=t;do{var n=s.alternate;if(t=s.return,s.flags&32768){if(n=i0(n,s),n!==null){n.flags&=32767,Be=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ge=6,Be=null;return}}else if(n=o0(n,s,wt),n!==null){Be=n;return}if(s=s.sibling,s!==null){Be=s;return}Be=s=t}while(s!==null);Ge===0&&(Ge=5)}function bn(t,s,n){var r=Se,a=Ft.transition;try{Ft.transition=null,Se=1,f0(t,s,n,r)}finally{Ft.transition=a,Se=r}return null}function f0(t,s,n,r){do lr();while(Js!==null);if(je&6)throw Error(ne(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var l=n.lanes|n.childLanes;if(Qf(t,l),t===Xe&&(Be=Xe=null,st=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ka||(Ka=!0,Hh(Cl,function(){return lr(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Ft.transition,Ft.transition=null;var o=Se;Se=1;var i=je;je|=4,cc.current=null,c0(t,n),Ih(n,t),$g(Gi),Dl=!!Vi,Gi=Vi=null,t.current=n,u0(n),Uf(),je=i,Se=o,Ft.transition=l}else t.current=n;if(Ka&&(Ka=!1,Js=t,Wl=a),l=t.pendingLanes,l===0&&(sn=null),Wf(n.stateNode),Nt(t,Ue()),s!==null)for(r=t.onRecoverableError,n=0;n<s.length;n++)a=s[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Hl)throw Hl=!1,t=md,md=null,t;return Wl&1&&t.tag!==0&&lr(),l=t.pendingLanes,l&1?t===xd?Zr++:(Zr=0,xd=t):Zr=0,pn(),null}function lr(){if(Js!==null){var t=vx(Wl),s=Ft.transition,n=Se;try{if(Ft.transition=null,Se=16>t?16:t,Js===null)var r=!1;else{if(t=Js,Js=null,Wl=0,je&6)throw Error(ne(331));var a=je;for(je|=4,ue=t.current;ue!==null;){var l=ue,o=l.child;if(ue.flags&16){var i=l.deletions;if(i!==null){for(var c=0;c<i.length;c++){var u=i[c];for(ue=u;ue!==null;){var x=ue;switch(x.tag){case 0:case 11:case 15:Xr(8,x,l)}var m=x.child;if(m!==null)m.return=x,ue=m;else for(;ue!==null;){x=ue;var p=x.sibling,h=x.return;if(Mh(x),x===u){ue=null;break}if(p!==null){p.return=h,ue=p;break}ue=h}}}var w=l.alternate;if(w!==null){var N=w.child;if(N!==null){w.child=null;do{var k=N.sibling;N.sibling=null,N=k}while(N!==null)}}ue=l}}if(l.subtreeFlags&2064&&o!==null)o.return=l,ue=o;else e:for(;ue!==null;){if(l=ue,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Xr(9,l,l.return)}var v=l.sibling;if(v!==null){v.return=l.return,ue=v;break e}ue=l.return}}var g=t.current;for(ue=g;ue!==null;){o=ue;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ue=b;else e:for(o=g;ue!==null;){if(i=ue,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:fo(9,i)}}catch(j){ze(i,i.return,j)}if(i===o){ue=null;break e}var y=i.sibling;if(y!==null){y.return=i.return,ue=y;break e}ue=i.return}}if(je=a,pn(),ms&&typeof ms.onPostCommitFiberRoot=="function")try{ms.onPostCommitFiberRoot(oo,t)}catch{}r=!0}return r}finally{Se=n,Ft.transition=s}}return!1}function Uu(t,s,n){s=xr(n,s),s=vh(t,s,1),t=tn(t,s,1),s=mt(),t!==null&&(Aa(t,1,s),Nt(t,s))}function ze(t,s,n){if(t.tag===3)Uu(t,t,n);else for(;s!==null;){if(s.tag===3){Uu(s,t,n);break}else if(s.tag===1){var r=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(sn===null||!sn.has(r))){t=xr(n,t),t=jh(s,t,1),s=tn(s,t,1),t=mt(),s!==null&&(Aa(s,1,t),Nt(s,t));break}}s=s.return}}function g0(t,s,n){var r=t.pingCache;r!==null&&r.delete(s),s=mt(),t.pingedLanes|=t.suspendedLanes&n,Xe===t&&(st&n)===n&&(Ge===4||Ge===3&&(st&130023424)===st&&500>Ue()-mc?kn(t,0):uc|=n),Nt(t,s)}function Uh(t,s){s===0&&(t.mode&1?(s=Ba,Ba<<=1,!(Ba&130023424)&&(Ba=4194304)):s=1);var n=mt();t=ks(t,s),t!==null&&(Aa(t,s,n),Nt(t,n))}function y0(t){var s=t.memoizedState,n=0;s!==null&&(n=s.retryLane),Uh(t,n)}function b0(t,s){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(s),Uh(t,n)}var Bh;Bh=function(t,s,n){if(t!==null)if(t.memoizedProps!==s.pendingProps||vt.current)bt=!0;else{if(!(t.lanes&n)&&!(s.flags&128))return bt=!1,l0(t,s,n);bt=!!(t.flags&131072)}else bt=!1,Le&&s.flags&1048576&&Gx(s,Rl,s.index);switch(s.lanes=0,s.tag){case 2:var r=s.type;gl(t,s),t=s.pendingProps;var a=dr(s,dt.current);ar(s,n),a=ac(null,s,r,t,a,n);var l=lc();return s.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,jt(r)?(l=!0,Pl(s)):l=!1,s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,ec(s),a.updater=po,s.stateNode=a,a._reactInternals=s,td(s,r,t,n),s=rd(null,s,r,!0,l,n)):(s.tag=0,Le&&l&&Yd(s),ut(null,s,a,n),s=s.child),s;case 16:r=s.elementType;e:{switch(gl(t,s),t=s.pendingProps,a=r._init,r=a(r._payload),s.type=r,a=s.tag=j0(r),t=Yt(r,t),a){case 0:s=nd(null,s,r,t,n);break e;case 1:s=Mu(null,s,r,t,n);break e;case 11:s=Tu(null,s,r,t,n);break e;case 14:s=Eu(null,s,r,Yt(r.type,t),n);break e}throw Error(ne(306,r,""))}return s;case 0:return r=s.type,a=s.pendingProps,a=s.elementType===r?a:Yt(r,a),nd(t,s,r,a,n);case 1:return r=s.type,a=s.pendingProps,a=s.elementType===r?a:Yt(r,a),Mu(t,s,r,a,n);case 3:e:{if(kh(s),t===null)throw Error(ne(387));r=s.pendingProps,l=s.memoizedState,a=l.element,Kx(t,s),Ol(s,r,null,n);var o=s.memoizedState;if(r=o.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},s.updateQueue.baseState=l,s.memoizedState=l,s.flags&256){a=xr(Error(ne(423)),s),s=Lu(t,s,r,n,a);break e}else if(r!==a){a=xr(Error(ne(424)),s),s=Lu(t,s,r,n,a);break e}else for(kt=en(s.stateNode.containerInfo.firstChild),Ct=s,Le=!0,Jt=null,n=Qx(s,null,r,n),s.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cr(),r===a){s=Cs(t,s,n);break e}ut(t,s,r,n)}s=s.child}return s;case 5:return Zx(s),t===null&&Ki(s),r=s.type,a=s.pendingProps,l=t!==null?t.memoizedProps:null,o=a.children,Yi(r,a)?o=null:l!==null&&Yi(r,l)&&(s.flags|=32),Sh(t,s),ut(t,s,o,n),s.child;case 6:return t===null&&Ki(s),null;case 13:return Ch(t,s,n);case 4:return tc(s,s.stateNode.containerInfo),r=s.pendingProps,t===null?s.child=ur(s,null,r,n):ut(t,s,r,n),s.child;case 11:return r=s.type,a=s.pendingProps,a=s.elementType===r?a:Yt(r,a),Tu(t,s,r,a,n);case 7:return ut(t,s,s.pendingProps,n),s.child;case 8:return ut(t,s,s.pendingProps.children,n),s.child;case 12:return ut(t,s,s.pendingProps.children,n),s.child;case 10:e:{if(r=s.type._context,a=s.pendingProps,l=s.memoizedProps,o=a.value,Ae($l,r._currentValue),r._currentValue=o,l!==null)if(es(l.value,o)){if(l.children===a.children&&!vt.current){s=Cs(t,s,n);break e}}else for(l=s.child,l!==null&&(l.return=s);l!==null;){var i=l.dependencies;if(i!==null){o=l.child;for(var c=i.firstContext;c!==null;){if(c.context===r){if(l.tag===1){c=Ns(-1,n&-n),c.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var x=u.pending;x===null?c.next=c:(c.next=x.next,x.next=c),u.pending=c}}l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),Zi(l.return,n,s),i.lanes|=n;break}c=c.next}}else if(l.tag===10)o=l.type===s.type?null:l.child;else if(l.tag===18){if(o=l.return,o===null)throw Error(ne(341));o.lanes|=n,i=o.alternate,i!==null&&(i.lanes|=n),Zi(o,n,s),o=l.sibling}else o=l.child;if(o!==null)o.return=l;else for(o=l;o!==null;){if(o===s){o=null;break}if(l=o.sibling,l!==null){l.return=o.return,o=l;break}o=o.return}l=o}ut(t,s,a.children,n),s=s.child}return s;case 9:return a=s.type,r=s.pendingProps.children,ar(s,n),a=_t(a),r=r(a),s.flags|=1,ut(t,s,r,n),s.child;case 14:return r=s.type,a=Yt(r,s.pendingProps),a=Yt(r.type,a),Eu(t,s,r,a,n);case 15:return Nh(t,s,s.type,s.pendingProps,n);case 17:return r=s.type,a=s.pendingProps,a=s.elementType===r?a:Yt(r,a),gl(t,s),s.tag=1,jt(r)?(t=!0,Pl(s)):t=!1,ar(s,n),bh(s,r,a),td(s,r,a,n),rd(null,s,r,!0,t,n);case 19:return Ah(t,s,n);case 22:return wh(t,s,n)}throw Error(ne(156,s.tag))};function Hh(t,s){return fx(t,s)}function v0(t,s,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $t(t,s,n,r){return new v0(t,s,n,r)}function fc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function j0(t){if(typeof t=="function")return fc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Rd)return 11;if(t===$d)return 14}return 2}function rn(t,s){var n=t.alternate;return n===null?(n=$t(t.tag,s,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=s,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,s=t.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function vl(t,s,n,r,a,l){var o=2;if(r=t,typeof t=="function")fc(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Un:return Cn(n.children,a,l,s);case Id:o=8,a|=8;break;case ki:return t=$t(12,n,s,a|2),t.elementType=ki,t.lanes=l,t;case Ci:return t=$t(13,n,s,a),t.elementType=Ci,t.lanes=l,t;case Ai:return t=$t(19,n,s,a),t.elementType=Ai,t.lanes=l,t;case Zm:return yo(n,a,l,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Xm:o=10;break e;case Km:o=9;break e;case Rd:o=11;break e;case $d:o=14;break e;case Bs:o=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return s=$t(o,n,s,a),s.elementType=t,s.type=r,s.lanes=l,s}function Cn(t,s,n,r){return t=$t(7,t,r,s),t.lanes=n,t}function yo(t,s,n,r){return t=$t(22,t,r,s),t.elementType=Zm,t.lanes=n,t.stateNode={isHidden:!1},t}function ci(t,s,n){return t=$t(6,t,null,s),t.lanes=n,t}function ui(t,s,n){return s=$t(4,t.children!==null?t.children:[],t.key,s),s.lanes=n,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function N0(t,s,n,r,a){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vo(0),this.expirationTimes=Vo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vo(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function gc(t,s,n,r,a,l,o,i,c){return t=new N0(t,s,n,i,c),s===1?(s=1,l===!0&&(s|=8)):s=0,l=$t(3,null,null,s),t.current=l,l.stateNode=t,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ec(l),t}function w0(t,s,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zn,key:r==null?null:""+r,children:t,containerInfo:s,implementation:n}}function Wh(t){if(!t)return dn;t=t._reactInternals;e:{if(In(t)!==t||t.tag!==1)throw Error(ne(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(jt(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(jt(n))return Wx(t,n,s)}return s}function Vh(t,s,n,r,a,l,o,i,c){return t=gc(n,r,!0,t,a,l,o,i,c),t.context=Wh(null),n=t.current,r=mt(),a=nn(n),l=Ns(r,a),l.callback=s??null,tn(n,l,a),t.current.lanes=a,Aa(t,a,r),Nt(t,r),t}function bo(t,s,n,r){var a=s.current,l=mt(),o=nn(a);return n=Wh(n),s.context===null?s.context=n:s.pendingContext=n,s=Ns(l,o),s.payload={element:t},r=r===void 0?null:r,r!==null&&(s.callback=r),t=tn(a,s,o),t!==null&&(Kt(t,a,o,l),hl(t,a,o)),o}function Gl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Bu(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<s?n:s}}function yc(t,s){Bu(t,s),(t=t.alternate)&&Bu(t,s)}function S0(){return null}var Gh=typeof reportError=="function"?reportError:function(t){console.error(t)};function bc(t){this._internalRoot=t}vo.prototype.render=bc.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(ne(409));bo(t,s,null,null)};vo.prototype.unmount=bc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;Ln(function(){bo(null,t,null,null)}),s[Ss]=null}};function vo(t){this._internalRoot=t}vo.prototype.unstable_scheduleHydration=function(t){if(t){var s=wx();t={blockedOn:null,target:t,priority:s};for(var n=0;n<Vs.length&&s!==0&&s<Vs[n].priority;n++);Vs.splice(n,0,t),n===0&&kx(t)}};function vc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function jo(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hu(){}function k0(t,s,n,r,a){if(a){if(typeof r=="function"){var l=r;r=function(){var u=Gl(o);l.call(u)}}var o=Vh(s,r,t,0,null,!1,!1,"",Hu);return t._reactRootContainer=o,t[Ss]=o.current,ua(t.nodeType===8?t.parentNode:t),Ln(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var i=r;r=function(){var u=Gl(c);i.call(u)}}var c=gc(t,0,!1,null,null,!1,!1,"",Hu);return t._reactRootContainer=c,t[Ss]=c.current,ua(t.nodeType===8?t.parentNode:t),Ln(function(){bo(s,c,n,r)}),c}function No(t,s,n,r,a){var l=n._reactRootContainer;if(l){var o=l;if(typeof a=="function"){var i=a;a=function(){var c=Gl(o);i.call(c)}}bo(s,o,t,a)}else o=k0(n,s,t,a,r);return Gl(o)}jx=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var n=Ur(s.pendingLanes);n!==0&&(_d(s,n|1),Nt(s,Ue()),!(je&6)&&(hr=Ue()+500,pn()))}break;case 13:Ln(function(){var r=ks(t,1);if(r!==null){var a=mt();Kt(r,t,1,a)}}),yc(t,1)}};zd=function(t){if(t.tag===13){var s=ks(t,134217728);if(s!==null){var n=mt();Kt(s,t,134217728,n)}yc(t,134217728)}};Nx=function(t){if(t.tag===13){var s=nn(t),n=ks(t,s);if(n!==null){var r=mt();Kt(n,t,s,r)}yc(t,s)}};wx=function(){return Se};Sx=function(t,s){var n=Se;try{return Se=t,s()}finally{Se=n}};Fi=function(t,s,n){switch(s){case"input":if(Ei(t,n),s=n.name,n.type==="radio"&&s!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<n.length;s++){var r=n[s];if(r!==t&&r.form===t.form){var a=mo(r);if(!a)throw Error(ne(90));tx(r),Ei(r,a)}}}break;case"textarea":nx(t,n);break;case"select":s=n.value,s!=null&&tr(t,!!n.multiple,s,!1)}};cx=xc;ux=Ln;var C0={usingClientEntryPoint:!1,Events:[Ta,Vn,mo,ix,dx,xc]},Ir={findFiberByHostInstance:jn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},A0={bundleType:Ir.bundleType,version:Ir.version,rendererPackageName:Ir.rendererPackageName,rendererConfig:Ir.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:As.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=hx(t),t===null?null:t.stateNode},findFiberByHostInstance:Ir.findFiberByHostInstance||S0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Za=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Za.isDisabled&&Za.supportsFiber)try{oo=Za.inject(A0),ms=Za}catch{}}Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C0;Dt.createPortal=function(t,s){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vc(s))throw Error(ne(200));return w0(t,s,null,n)};Dt.createRoot=function(t,s){if(!vc(t))throw Error(ne(299));var n=!1,r="",a=Gh;return s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(r=s.identifierPrefix),s.onRecoverableError!==void 0&&(a=s.onRecoverableError)),s=gc(t,1,!1,null,null,n,!1,r,a),t[Ss]=s.current,ua(t.nodeType===8?t.parentNode:t),new bc(s)};Dt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=hx(s),t=t===null?null:t.stateNode,t};Dt.flushSync=function(t){return Ln(t)};Dt.hydrate=function(t,s,n){if(!jo(s))throw Error(ne(200));return No(null,t,s,!0,n)};Dt.hydrateRoot=function(t,s,n){if(!vc(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,a=!1,l="",o=Gh;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),s=Vh(s,null,t,1,n??null,a,!1,l,o),t[Ss]=s.current,ua(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[n,a]:s.mutableSourceEagerHydrationData.push(n,a);return new vo(s)};Dt.render=function(t,s,n){if(!jo(s))throw Error(ne(200));return No(null,t,s,!1,n)};Dt.unmountComponentAtNode=function(t){if(!jo(t))throw Error(ne(40));return t._reactRootContainer?(Ln(function(){No(null,null,t,!1,function(){t._reactRootContainer=null,t[Ss]=null})}),!0):!1};Dt.unstable_batchedUpdates=xc;Dt.unstable_renderSubtreeIntoContainer=function(t,s,n,r){if(!jo(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return No(t,s,n,!1,r)};Dt.version="18.3.1-next-f1338f8080-20240426";function Yh(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yh)}catch(t){console.error(t)}}Yh(),Ym.exports=Dt;var Kn=Ym.exports,qh,Wu=Kn;qh=Wu.createRoot,Wu.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function va(){return va=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},va.apply(this,arguments)}var Qs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Qs||(Qs={}));const Vu="popstate";function D0(t){t===void 0&&(t={});function s(r,a){let{pathname:l,search:o,hash:i}=r.location;return fd("",{pathname:l,search:o,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Yl(a)}return E0(s,n,null,t)}function Fe(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function jc(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function T0(){return Math.random().toString(36).substr(2,8)}function Gu(t,s){return{usr:t.state,key:t.key,idx:s}}function fd(t,s,n,r){return n===void 0&&(n=null),va({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?vr(s):s,{state:n,key:s&&s.key||r||T0()})}function Yl(t){let{pathname:s="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(s+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(s+=r.charAt(0)==="#"?r:"#"+r),s}function vr(t){let s={};if(t){let n=t.indexOf("#");n>=0&&(s.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(s.search=t.substr(r),t=t.substr(0,r)),t&&(s.pathname=t)}return s}function E0(t,s,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:l=!1}=r,o=a.history,i=Qs.Pop,c=null,u=x();u==null&&(u=0,o.replaceState(va({},o.state,{idx:u}),""));function x(){return(o.state||{idx:null}).idx}function m(){i=Qs.Pop;let k=x(),v=k==null?null:k-u;u=k,c&&c({action:i,location:N.location,delta:v})}function p(k,v){i=Qs.Push;let g=fd(N.location,k,v);u=x()+1;let b=Gu(g,u),y=N.createHref(g);try{o.pushState(b,"",y)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;a.location.assign(y)}l&&c&&c({action:i,location:N.location,delta:1})}function h(k,v){i=Qs.Replace;let g=fd(N.location,k,v);u=x();let b=Gu(g,u),y=N.createHref(g);o.replaceState(b,"",y),l&&c&&c({action:i,location:N.location,delta:0})}function w(k){let v=a.location.origin!=="null"?a.location.origin:a.location.href,g=typeof k=="string"?k:Yl(k);return g=g.replace(/ $/,"%20"),Fe(v,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,v)}let N={get action(){return i},get location(){return t(a,o)},listen(k){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(Vu,m),c=k,()=>{a.removeEventListener(Vu,m),c=null}},createHref(k){return s(a,k)},createURL:w,encodeLocation(k){let v=w(k);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:h,go(k){return o.go(k)}};return N}var Yu;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Yu||(Yu={}));function M0(t,s,n){return n===void 0&&(n="/"),L0(t,s,n)}function L0(t,s,n,r){let a=typeof s=="string"?vr(s):s,l=pr(a.pathname||"/",n);if(l==null)return null;let o=Jh(t);P0(o);let i=null;for(let c=0;i==null&&c<o.length;++c){let u=W0(l);i=B0(o[c],u)}return i}function Jh(t,s,n,r){s===void 0&&(s=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(l,o,i)=>{let c={relativePath:i===void 0?l.path||"":i,caseSensitive:l.caseSensitive===!0,childrenIndex:o,route:l};c.relativePath.startsWith("/")&&(Fe(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=an([r,c.relativePath]),x=n.concat(c);l.children&&l.children.length>0&&(Fe(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Jh(l.children,s,x,u)),!(l.path==null&&!l.index)&&s.push({path:u,score:z0(u,l.index),routesMeta:x})};return t.forEach((l,o)=>{var i;if(l.path===""||!((i=l.path)!=null&&i.includes("?")))a(l,o);else for(let c of Qh(l.path))a(l,o,c)}),s}function Qh(t){let s=t.split("/");if(s.length===0)return[];let[n,...r]=s,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(r.length===0)return a?[l,""]:[l];let o=Qh(r.join("/")),i=[];return i.push(...o.map(c=>c===""?l:[l,c].join("/"))),a&&i.push(...o),i.map(c=>t.startsWith("/")&&c===""?"/":c)}function P0(t){t.sort((s,n)=>s.score!==n.score?n.score-s.score:U0(s.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const I0=/^:[\w-]+$/,R0=3,$0=2,F0=1,O0=10,_0=-2,qu=t=>t==="*";function z0(t,s){let n=t.split("/"),r=n.length;return n.some(qu)&&(r+=_0),s&&(r+=$0),n.filter(a=>!qu(a)).reduce((a,l)=>a+(I0.test(l)?R0:l===""?F0:O0),r)}function U0(t,s){return t.length===s.length&&t.slice(0,-1).every((r,a)=>r===s[a])?t[t.length-1]-s[s.length-1]:0}function B0(t,s,n){let{routesMeta:r}=t,a={},l="/",o=[];for(let i=0;i<r.length;++i){let c=r[i],u=i===r.length-1,x=l==="/"?s:s.slice(l.length)||"/",m=gd({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},x),p=c.route;if(!m)return null;Object.assign(a,m.params),o.push({params:a,pathname:an([l,m.pathname]),pathnameBase:J0(an([l,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(l=an([l,m.pathnameBase]))}return o}function gd(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=H0(t.path,t.caseSensitive,t.end),a=s.match(n);if(!a)return null;let l=a[0],o=l.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:r.reduce((u,x,m)=>{let{paramName:p,isOptional:h}=x;if(p==="*"){let N=i[m]||"";o=l.slice(0,l.length-N.length).replace(/(.)\/+$/,"$1")}const w=i[m];return h&&!w?u[p]=void 0:u[p]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:l,pathnameBase:o,pattern:t}}function H0(t,s,n){s===void 0&&(s=!1),n===void 0&&(n=!0),jc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,i,c)=>(r.push({paramName:i,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,s?void 0:"i"),r]}function W0(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return jc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function pr(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let n=s.endsWith("/")?s.length-1:s.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const V0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,G0=t=>V0.test(t);function Y0(t,s){s===void 0&&(s="/");let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?vr(t):t,l;if(n)if(G0(n))l=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),jc(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?l=Ju(n.substring(1),"/"):l=Ju(n,s)}else l=s;return{pathname:l,search:Q0(r),hash:X0(a)}}function Ju(t,s){let n=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function mi(t,s,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function q0(t){return t.filter((s,n)=>n===0||s.route.path&&s.route.path.length>0)}function Nc(t,s){let n=q0(t);return s?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function wc(t,s,n,r){r===void 0&&(r=!1);let a;typeof t=="string"?a=vr(t):(a=va({},t),Fe(!a.pathname||!a.pathname.includes("?"),mi("?","pathname","search",a)),Fe(!a.pathname||!a.pathname.includes("#"),mi("#","pathname","hash",a)),Fe(!a.search||!a.search.includes("#"),mi("#","search","hash",a)));let l=t===""||a.pathname==="",o=l?"/":a.pathname,i;if(o==null)i=n;else{let m=s.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;a.pathname=p.join("/")}i=m>=0?s[m]:"/"}let c=Y0(a,i),u=o&&o!=="/"&&o.endsWith("/"),x=(l||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||x)&&(c.pathname+="/"),c}const an=t=>t.join("/").replace(/\/\/+/g,"/"),J0=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Q0=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,X0=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function K0(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Xh=["post","put","patch","delete"];new Set(Xh);const Z0=["get",...Xh];new Set(Z0);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ja(){return ja=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ja.apply(this,arguments)}const wo=d.createContext(null),Kh=d.createContext(null),Ds=d.createContext(null),So=d.createContext(null),Ts=d.createContext({outlet:null,matches:[],isDataRoute:!1}),Zh=d.createContext(null);function ey(t,s){let{relative:n}=s===void 0?{}:s;jr()||Fe(!1);let{basename:r,navigator:a}=d.useContext(Ds),{hash:l,pathname:o,search:i}=ko(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:an([r,o])),a.createHref({pathname:c,search:i,hash:l})}function jr(){return d.useContext(So)!=null}function fn(){return jr()||Fe(!1),d.useContext(So).location}function ep(t){d.useContext(Ds).static||d.useLayoutEffect(t)}function Rn(){let{isDataRoute:t}=d.useContext(Ts);return t?py():ty()}function ty(){jr()||Fe(!1);let t=d.useContext(wo),{basename:s,future:n,navigator:r}=d.useContext(Ds),{matches:a}=d.useContext(Ts),{pathname:l}=fn(),o=JSON.stringify(Nc(a,n.v7_relativeSplatPath)),i=d.useRef(!1);return ep(()=>{i.current=!0}),d.useCallback(function(u,x){if(x===void 0&&(x={}),!i.current)return;if(typeof u=="number"){r.go(u);return}let m=wc(u,JSON.parse(o),l,x.relative==="path");t==null&&s!=="/"&&(m.pathname=m.pathname==="/"?s:an([s,m.pathname])),(x.replace?r.replace:r.push)(m,x.state,x)},[s,r,o,l,t])}const sy=d.createContext(null);function ny(t){let s=d.useContext(Ts).outlet;return s&&d.createElement(sy.Provider,{value:t},s)}function ko(t,s){let{relative:n}=s===void 0?{}:s,{future:r}=d.useContext(Ds),{matches:a}=d.useContext(Ts),{pathname:l}=fn(),o=JSON.stringify(Nc(a,r.v7_relativeSplatPath));return d.useMemo(()=>wc(t,JSON.parse(o),l,n==="path"),[t,o,l,n])}function ry(t,s){return ay(t,s)}function ay(t,s,n,r){jr()||Fe(!1);let{navigator:a}=d.useContext(Ds),{matches:l}=d.useContext(Ts),o=l[l.length-1],i=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=fn(),x;if(s){var m;let k=typeof s=="string"?vr(s):s;c==="/"||(m=k.pathname)!=null&&m.startsWith(c)||Fe(!1),x=k}else x=u;let p=x.pathname||"/",h=p;if(c!=="/"){let k=c.replace(/^\//,"").split("/");h="/"+p.replace(/^\//,"").split("/").slice(k.length).join("/")}let w=M0(t,{pathname:h}),N=cy(w&&w.map(k=>Object.assign({},k,{params:Object.assign({},i,k.params),pathname:an([c,a.encodeLocation?a.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?c:an([c,a.encodeLocation?a.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),l,n,r);return s&&N?d.createElement(So.Provider,{value:{location:ja({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:Qs.Pop}},N):N}function ly(){let t=hy(),s=K0(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return d.createElement(d.Fragment,null,d.createElement("h2",null,"Unexpected Application Error!"),d.createElement("h3",{style:{fontStyle:"italic"}},s),n?d.createElement("pre",{style:a},n):null,null)}const oy=d.createElement(ly,null);class iy extends d.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,n){return n.location!==s.location||n.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:n.error,location:n.location,revalidation:s.revalidation||n.revalidation}}componentDidCatch(s,n){console.error("React Router caught the following error during render",s,n)}render(){return this.state.error!==void 0?d.createElement(Ts.Provider,{value:this.props.routeContext},d.createElement(Zh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dy(t){let{routeContext:s,match:n,children:r}=t,a=d.useContext(wo);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),d.createElement(Ts.Provider,{value:s},r)}function cy(t,s,n,r){var a;if(s===void 0&&(s=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var l;if(!n)return null;if(n.errors)t=n.matches;else if((l=r)!=null&&l.v7_partialHydration&&s.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,i=(a=n)==null?void 0:a.errors;if(i!=null){let x=o.findIndex(m=>m.route.id&&(i==null?void 0:i[m.route.id])!==void 0);x>=0||Fe(!1),o=o.slice(0,Math.min(o.length,x+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let x=0;x<o.length;x++){let m=o[x];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=x),m.route.id){let{loaderData:p,errors:h}=n,w=m.route.loader&&p[m.route.id]===void 0&&(!h||h[m.route.id]===void 0);if(m.route.lazy||w){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((x,m,p)=>{let h,w=!1,N=null,k=null;n&&(h=i&&m.route.id?i[m.route.id]:void 0,N=m.route.errorElement||oy,c&&(u<0&&p===0?(fy("route-fallback"),w=!0,k=null):u===p&&(w=!0,k=m.route.hydrateFallbackElement||null)));let v=s.concat(o.slice(0,p+1)),g=()=>{let b;return h?b=N:w?b=k:m.route.Component?b=d.createElement(m.route.Component,null):m.route.element?b=m.route.element:b=x,d.createElement(dy,{match:m,routeContext:{outlet:x,matches:v,isDataRoute:n!=null},children:b})};return n&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?d.createElement(iy,{location:n.location,revalidation:n.revalidation,component:N,error:h,children:g(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):g()},null)}var tp=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(tp||{}),sp=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(sp||{});function uy(t){let s=d.useContext(wo);return s||Fe(!1),s}function my(t){let s=d.useContext(Kh);return s||Fe(!1),s}function xy(t){let s=d.useContext(Ts);return s||Fe(!1),s}function np(t){let s=xy(),n=s.matches[s.matches.length-1];return n.route.id||Fe(!1),n.route.id}function hy(){var t;let s=d.useContext(Zh),n=my(),r=np();return s!==void 0?s:(t=n.errors)==null?void 0:t[r]}function py(){let{router:t}=uy(tp.UseNavigateStable),s=np(sp.UseNavigateStable),n=d.useRef(!1);return ep(()=>{n.current=!0}),d.useCallback(function(a,l){l===void 0&&(l={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,ja({fromRouteId:s},l)))},[t,s])}const Qu={};function fy(t,s,n){Qu[t]||(Qu[t]=!0)}function gy(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Na(t){let{to:s,replace:n,state:r,relative:a}=t;jr()||Fe(!1);let{future:l,static:o}=d.useContext(Ds),{matches:i}=d.useContext(Ts),{pathname:c}=fn(),u=Rn(),x=wc(s,Nc(i,l.v7_relativeSplatPath),c,a==="path"),m=JSON.stringify(x);return d.useEffect(()=>u(JSON.parse(m),{replace:n,state:r,relative:a}),[u,m,a,n,r]),null}function Sc(t){return ny(t.context)}function ce(t){Fe(!1)}function yy(t){let{basename:s="/",children:n=null,location:r,navigationType:a=Qs.Pop,navigator:l,static:o=!1,future:i}=t;jr()&&Fe(!1);let c=s.replace(/^\/*/,"/"),u=d.useMemo(()=>({basename:c,navigator:l,static:o,future:ja({v7_relativeSplatPath:!1},i)}),[c,i,l,o]);typeof r=="string"&&(r=vr(r));let{pathname:x="/",search:m="",hash:p="",state:h=null,key:w="default"}=r,N=d.useMemo(()=>{let k=pr(x,c);return k==null?null:{location:{pathname:k,search:m,hash:p,state:h,key:w},navigationType:a}},[c,x,m,p,h,w,a]);return N==null?null:d.createElement(Ds.Provider,{value:u},d.createElement(So.Provider,{children:n,value:N}))}function rp(t){let{children:s,location:n}=t;return ry(yd(s),n)}new Promise(()=>{});function yd(t,s){s===void 0&&(s=[]);let n=[];return d.Children.forEach(t,(r,a)=>{if(!d.isValidElement(r))return;let l=[...s,a];if(r.type===d.Fragment){n.push.apply(n,yd(r.props.children,l));return}r.type!==ce&&Fe(!1),!r.props.index||!r.props.children||Fe(!1);let o={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=yd(r.props.children,l)),n.push(o)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ql(){return ql=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ql.apply(this,arguments)}function ap(t,s){if(t==null)return{};var n={},r=Object.keys(t),a,l;for(l=0;l<r.length;l++)a=r[l],!(s.indexOf(a)>=0)&&(n[a]=t[a]);return n}function by(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function vy(t,s){return t.button===0&&(!s||s==="_self")&&!by(t)}const jy=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ny=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],wy="6";try{window.__reactRouterVersion=wy}catch{}const Sy=d.createContext({isTransitioning:!1}),ky="startTransition",Xu=gf[ky];function Cy(t){let{basename:s,children:n,future:r,window:a}=t,l=d.useRef();l.current==null&&(l.current=D0({window:a,v5Compat:!0}));let o=l.current,[i,c]=d.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},x=d.useCallback(m=>{u&&Xu?Xu(()=>c(m)):c(m)},[c,u]);return d.useLayoutEffect(()=>o.listen(x),[o,x]),d.useEffect(()=>gy(r),[r]),d.createElement(yy,{basename:s,children:n,location:i.location,navigationType:i.action,navigator:o,future:r})}const Ay=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Dy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ln=d.forwardRef(function(s,n){let{onClick:r,relative:a,reloadDocument:l,replace:o,state:i,target:c,to:u,preventScrollReset:x,viewTransition:m}=s,p=ap(s,jy),{basename:h}=d.useContext(Ds),w,N=!1;if(typeof u=="string"&&Dy.test(u)&&(w=u,Ay))try{let b=new URL(window.location.href),y=u.startsWith("//")?new URL(b.protocol+u):new URL(u),j=pr(y.pathname,h);y.origin===b.origin&&j!=null?u=j+y.search+y.hash:N=!0}catch{}let k=ey(u,{relative:a}),v=My(u,{replace:o,state:i,target:c,preventScrollReset:x,relative:a,viewTransition:m});function g(b){r&&r(b),b.defaultPrevented||v(b)}return d.createElement("a",ql({},p,{href:w||k,onClick:N||l?r:g,ref:n,target:c}))}),Ty=d.forwardRef(function(s,n){let{"aria-current":r="page",caseSensitive:a=!1,className:l="",end:o=!1,style:i,to:c,viewTransition:u,children:x}=s,m=ap(s,Ny),p=ko(c,{relative:m.relative}),h=fn(),w=d.useContext(Kh),{navigator:N,basename:k}=d.useContext(Ds),v=w!=null&&Ly(p)&&u===!0,g=N.encodeLocation?N.encodeLocation(p).pathname:p.pathname,b=h.pathname,y=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;a||(b=b.toLowerCase(),y=y?y.toLowerCase():null,g=g.toLowerCase()),y&&k&&(y=pr(y,k)||y);const j=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let S=b===g||!o&&b.startsWith(g)&&b.charAt(j)==="/",C=y!=null&&(y===g||!o&&y.startsWith(g)&&y.charAt(g.length)==="/"),A={isActive:S,isPending:C,isTransitioning:v},R=S?r:void 0,O;typeof l=="function"?O=l(A):O=[l,S?"active":null,C?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let U=typeof i=="function"?i(A):i;return d.createElement(ln,ql({},m,{"aria-current":R,className:O,ref:n,style:U,to:c,viewTransition:u}),typeof x=="function"?x(A):x)});var bd;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(bd||(bd={}));var Ku;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Ku||(Ku={}));function Ey(t){let s=d.useContext(wo);return s||Fe(!1),s}function My(t,s){let{target:n,replace:r,state:a,preventScrollReset:l,relative:o,viewTransition:i}=s===void 0?{}:s,c=Rn(),u=fn(),x=ko(t,{relative:o});return d.useCallback(m=>{if(vy(m,n)){m.preventDefault();let p=r!==void 0?r:Yl(u)===Yl(x);c(t,{replace:p,state:a,preventScrollReset:l,relative:o,viewTransition:i})}},[u,c,x,r,a,n,t,l,o,i])}function Ly(t,s){s===void 0&&(s={});let n=d.useContext(Sy);n==null&&Fe(!1);let{basename:r}=Ey(bd.useViewTransitionState),a=ko(t,{relative:s.relative});if(!n.isTransitioning)return!1;let l=pr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=pr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return gd(a.pathname,o)!=null||gd(a.pathname,l)!=null}const J=()=>(console.log("[API] Production build - using production API"),"http://31.97.228.226:5000");async function Q(t,s={}){const n=localStorage.getItem("auth_token"),r={...s.headers};n&&(r.Authorization=`Bearer ${n}`),console.log("[API] Fetching:",t);try{const a=await fetch(t,{...s,credentials:"include",headers:r});return console.log("[API] Response status:",a.status,"for",t),a}catch(a){throw console.error("[API] Fetch FAILED:",a.message,"for",t),a}}async function X(t,s){if(!t.ok){let r={};try{r=await t.json()}catch{}const a=(r==null?void 0:r.message)||(r==null?void 0:r.code)||`${s} (${t.status})`;throw new Error(a)}let n={};try{n=await t.json()}catch{}return n}function Zt(t){try{return new Intl.NumberFormat("bn-BD",{style:"currency",currency:"BDT",maximumFractionDigits:0}).format(t||0)}catch{return`${Number(t||0).toLocaleString("bn-BD")}`}}function Pe(t){try{return new Intl.NumberFormat("en-US",{style:"currency",currency:"BDT",maximumFractionDigits:0}).format(t||0)}catch{return`${Number(t||0).toLocaleString("en-US")}`}}function Zu(t){const s=t?new Date(t):new Date,n=String(s.getDate()).padStart(2,"0"),r=String(s.getMonth()+1).padStart(2,"0"),a=s.getFullYear();return`${n}.${r}.${a}`}const B={_normalizeDate(t){if(!t)return"";if(/^\d{4}-\d{2}-\d{2}/.test(t))return t.slice(0,10);const s=/^(\d{2})\/(\d{2})\/(\d{4})$/.exec(t);if(s)return`${s[3]}-${s[2]}-${s[1]}`;const n=new Date(t);if(!isNaN(n)){const r=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0");return`${n.getFullYear()}-${a}-${r}`}return t},async login(t,s){const n=await Q(`${J()}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:s})}),r=await X(n,"Login failed");if(!r||typeof r!="object")throw new Error("Invalid login response");return r},async me(){const t=await Q(`${J()}/api/auth/me`),s=await X(t,"Auth check failed");if(!s||typeof s!="object")throw new Error("Invalid /me response");return s},async logout(){const t=await Q(`${J()}/api/auth/logout`,{method:"POST"});return X(t,"Logout failed")},async updateMe(t){const s=await Q(`${J()}/api/auth/me`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await X(s,"Update failed");if(!n||typeof n!="object")throw new Error("Invalid update response");return n},async listUsers(){const t=await Q(`${J()}/api/users`);return X(t,"Load users failed")},async listUsersPublic(){const t=await Q(`${J()}/api/users/list`,{credentials:"include"});return X(t,"Load public users failed")},async listAdmissionUsers(){const t=await Q(`${J()}/api/users/admission`,{credentials:"include"});return X(t,"Load admission users failed")},async createUser(t){const s=await Q(`${J()}/api/users`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create user failed")},async updateUser(t,s){const n=await Q(`${J()}/api/users/${t}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update user failed")},async deleteUser(t){const s=await Q(`${J()}/api/users/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete user failed")},async reorderUsers(t){const s=await Q(`${J()}/api/users/reorder`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:t})});return X(s,"Reorder users failed")},async listAllTasks(t){const s=t?`?status=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/tasks${s}`,{credentials:"include"});return X(n,"Load tasks failed")},async listMyTasks(t){const s=t?`?status=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/tasks/my${s}`,{credentials:"include"});return X(n,"Load my tasks failed")},async assignTask(t){const s=await Q(`${J()}/api/tasks/assign`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Assign task failed")},async addSelfTask(t){const s=await Q(`${J()}/api/tasks/self`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Add self task failed")},async updateTaskStatus(t,s){const n=await Q(`${J()}/api/tasks/${t}/status`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:s})});return X(n,"Update task status failed")},async updateTask(t,s){const n=await Q(`${J()}/api/tasks/${t}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update task failed")},async deleteTask(t){const s=await Q(`${J()}/api/tasks/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete task failed")},async addTaskComment(t,s){const n=await Q(`${J()}/api/tasks/${t}/comments`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Add comment failed")},async addTaskAttachment(t,s){const n=await Q(`${J()}/api/tasks/${t}/attachments`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Add attachment failed")},async updateChecklistItem(t,s,n){const r=await Q(`${J()}/api/tasks/${t}/checklist/${s}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({completed:n})});return X(r,"Update checklist failed")},async updateBoardPosition(t,s){const n=await Q(`${J()}/api/tasks/${t}/board-position`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update board position failed")},async listCourses(){const t=await Q(`${J()}/api/courses`,{credentials:"include"});return X(t,"Load courses failed")},async createCourse(t){const s=await Q(`${J()}/api/courses`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create course failed")},async updateCourse(t,s){const n=await Q(`${J()}/api/courses/${t}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update course failed")},async deleteCourse(t){const s=await Q(`${J()}/api/courses/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete course failed")},async listLeads(t){const s=t?`?status=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/leads${s}`,{credentials:"include"});return X(n,"Load leads failed")},async getTodayAssignments(){const t=await Q(`${J()}/api/leads/today-assignments`,{credentials:"include"});return X(t,"Load today assignments failed")},async getLeadHistory(t){const s=await Q(`${J()}/api/leads/${t}/history`,{credentials:"include"});return X(s,"Load lead history failed")},async assignLead(t,s){const n=await Q(`${J()}/api/leads/${t}/assign`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({assignedTo:s})});return X(n,"Assign lead failed")},async bulkAssignLeads(t,s){const n=await Q(`${J()}/api/leads/bulk-assign`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({leadIds:t,assignedTo:s})});return X(n,"Bulk assign failed")},async createLead(t){const s=await Q(`${J()}/api/leads`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create lead failed")},async bulkUploadLeads(t){const s=await Q(`${J()}/api/leads/bulk`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({csv:t})});return X(s,"Bulk upload failed")},async updateLead(t,s){const n=await Q(`${J()}/api/leads/${t}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update lead failed")},async deleteLead(t){const s=await Q(`${J()}/api/leads/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete lead failed")},async listAdmissionLeads(t){const s=t?`?status=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/admission/leads${s}`,{credentials:"include"});return X(n,"Load admission leads failed")},async updateLeadStatus(t,s,n,r,a,l){const o={status:s};n!=null&&(o.notes=n),r!=null&&(o.courseId=r),a!=null&&(o.batchId=a),l!=null&&l!==""&&(o.nextFollowUpDate=l);const i=await Q(`${J()}/api/admission/leads/${t}/status`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return X(i,"Update lead status failed")},async addLeadFollowUp(t,{note:s,nextFollowUpDate:n,priority:r}){const a=await Q(`${J()}/api/admission/leads/${t}/follow-up`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({note:s,nextFollowUpDate:n,priority:r})});return X(a,"Add follow-up failed")},async listAdmissionFees(){const t=await Q(`${J()}/api/admission/fees`,{credentials:"include"});return X(t,"Load fees failed")},async checkAdmissionFeeStatus(t){const s=await Q(`${J()}/api/admission/fees/status/${t}`,{credentials:"include"});return X(s,"Check fee status failed")},async createAdmissionFee(t){const s=await Q(`${J()}/api/admission/fees`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create fee failed")},async getAdmissionFollowUpNotifications(){const t=await Q(`${J()}/api/admission/follow-up-notifications`,{credentials:"include"});return X(t,"Load follow-up notifications failed")},async getAdmissionReports(t,s,n){const r=new URLSearchParams;t&&r.append("userId",t),s&&r.append("from",s),n&&r.append("to",n);const a=r.toString()?`?${r.toString()}`:"",l=await Q(`${J()}/api/admission/reports${a}`,{credentials:"include"});return X(l,"Load admission reports failed")},async getAdmissionMetrics(t,s,n){const r=new URLSearchParams;t&&r.append("userId",t),s&&r.append("from",s),n&&r.append("to",n);const a=r.toString()?`?${r.toString()}`:"",l=await Q(`${J()}/api/reports/admission-metrics${a}`,{credentials:"include"});return X(l,"Load admission metrics failed")},async downloadAdmissionMetricsCSV(t,s,n){const r=new URLSearchParams;t&&r.append("userId",t),s&&r.append("from",s),n&&r.append("to",n),r.append("format","csv");const a=r.toString()?`?${r.toString()}`:"",l=await Q(`${J()}/api/reports/admission-metrics${a}`,{credentials:"include"});if(!l.ok){let i={};try{i=await l.json()}catch{}const c=(i==null?void 0:i.message)||`Download failed (${l.status})`;throw new Error(c)}return await l.blob()},async listFeesForApproval(t){const s=t?`?status=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/accounting/fees${s}`,{credentials:"include"});return X(n,"Load fees failed")},async approveFee(t){const s=await Q(`${J()}/api/accounting/fees/${t}/approve`,{method:"PATCH",credentials:"include"});return X(s,"Approve failed")},async rejectFee(t){const s=await Q(`${J()}/api/accounting/fees/${t}/reject`,{method:"PATCH",credentials:"include"});return X(s,"Reject failed")},async listIncome(){const t=await Q(`${J()}/api/accounting/income`,{credentials:"include"});return X(t,"Load income failed")},async addIncome(t){const s=await Q(`${J()}/api/accounting/income`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Add income failed")},async listExpenses(){const t=await Q(`${J()}/api/accounting/expense`,{credentials:"include"});return X(t,"Load expenses failed")},async addExpense(t){const s=await Q(`${J()}/api/accounting/expense`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Add expense failed")},async deleteExpense(t){const s=await Q(`${J()}/api/accounting/expense/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete expense failed")},async getDueCollections(t){const s=t?`?status=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/accounting/due-collections${s}`,{credentials:"include"});return X(n,"Load due collections failed")},async approveDueCollection(t,s){const n=await Q(`${J()}/api/accounting/due-collections/${t}/approve`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewNote:s||""})});return X(n,"Approve due collection failed")},async rejectDueCollection(t,s){const n=await Q(`${J()}/api/accounting/due-collections/${t}/reject`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewNote:s||""})});return X(n,"Reject due collection failed")},async accountingSummary(t,s){const n=new URLSearchParams;t&&n.set("from",t),s&&n.set("to",s);const r=n.toString()?`?${n.toString()}`:"",a=await Q(`${J()}/api/accounting/summary${r}`,{credentials:"include"});return X(a,"Load summary failed")},async getRecruitmentStats(){const t=await Q(`${J()}/api/recruitment/stats`,{credentials:"include"});return X(t,"Load recruitment stats failed")},async getRecruitmentSummary(){return this.getRecruitmentStats()},async listEmployers(){const t=await Q(`${J()}/api/recruitment/employers`,{credentials:"include"});return X(t,"Load employers failed")},async createEmployer(t){const s=await Q(`${J()}/api/recruitment/employers`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create employer failed")},async updateEmployer(t,s){const n=await Q(`${J()}/api/recruitment/employers/${t}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update employer failed")},async deleteEmployer(t){const s=await Q(`${J()}/api/recruitment/employers/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete employer failed")},async listJobs(){const t=await Q(`${J()}/api/recruitment/jobs`,{credentials:"include"});return X(t,"Load jobs failed")},async createJob(t){const s=await Q(`${J()}/api/recruitment/jobs`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create job failed")},async updateJob(t,s){const n=await Q(`${J()}/api/recruitment/jobs/${t}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update job failed")},async deleteJob(t){const s=await Q(`${J()}/api/recruitment/jobs/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete job failed")},async listCandidates(t){const s=t?`?status=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/recruitment/candidates${s}`,{credentials:"include"});return X(n,"Load candidates failed")},async createCandidate(t){const s=await Q(`${J()}/api/recruitment/candidates`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create candidate failed")},async updateCandidate(t,s){const n=await Q(`${J()}/api/recruitment/candidates/${t}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update candidate failed")},async deleteCandidate(t){const s=await Q(`${J()}/api/recruitment/candidates/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete candidate failed")},async recruitCandidate(t,s){const n=await Q(`${J()}/api/recruitment/candidates/${t}/recruit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Recruit candidate failed")},async listRecruited(){return this.listCandidates("recruited")},async listRecIncome(){const t=await Q(`${J()}/api/recruitment/income`,{credentials:"include"});return X(t,"Load recruitment income failed")},async addRecIncome(t){const s={...t,date:this._normalizeDate(t==null?void 0:t.date)},n=await Q(`${J()}/api/recruitment/income`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Add recruitment income failed")},async approveRecIncome(t){const s=await Q(`${J()}/api/recruitment/income/${t}/approve`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});return X(s,"Approve recruitment income failed")},async rejectRecIncome(t,s){const n=await Q(`${J()}/api/recruitment/income/${t}/reject`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:s})});return X(n,"Reject recruitment income failed")},async deleteRecIncome(t){const s=await Q(`${J()}/api/recruitment/income/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete recruitment income failed")},async updateRecIncome(){throw new Error("updateRecIncome is not supported by the backend (use add/delete).")},async listRecExpense(){const t=await Q(`${J()}/api/recruitment/expenses`,{credentials:"include"});return X(t,"Load recruitment expenses failed")},async addRecExpense(t){const s={...t,date:this._normalizeDate(t==null?void 0:t.date)},n=await Q(`${J()}/api/recruitment/expenses`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Add recruitment expense failed")},async deleteRecExpense(t){const s=await Q(`${J()}/api/recruitment/expenses/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete recruitment expense failed")},async updateRecExpense(){throw new Error("updateRecExpense is not supported by the backend (use add/delete).")},async listDMCosts(t,s){const n=new URLSearchParams;t&&n.set("date",this._normalizeDate(t)),s&&n.set("channel",s);const r=n.toString()?`?${n.toString()}`:"",a=await Q(`${J()}/api/dm/expense${r}`,{credentials:"include"});return X(a,"Load DM costs failed")},async addDMCost(t){const s={...t,date:this._normalizeDate(t==null?void 0:t.date)},n=await Q(`${J()}/api/dm/expense`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Add DM cost failed")},async deleteDMCost(t){const s=await Q(`${J()}/api/dm/expense/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete DM cost failed")},async listDMCampaigns(t,s,n){const r=new URLSearchParams;t&&r.append("platform",t),s&&r.append("from",s),n&&r.append("to",n);const a=r.toString()?`?${r.toString()}`:"",l=await Q(`${J()}/api/dm/campaigns${a}`,{credentials:"include"});return X(l,"Load DM campaigns failed")},async createDMCampaign(t){const s=await Q(`${J()}/api/dm/campaigns`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create DM campaign failed")},async updateDMCampaign(t,s){const n=await Q(`${J()}/api/dm/campaigns/${t}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update DM campaign failed")},async deleteDMCampaign(t){const s=await Q(`${J()}/api/dm/campaigns/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete DM campaign failed")},async getDMCampaignsSummary(t,s,n){const r=new URLSearchParams;t&&r.append("platform",t),s&&r.append("from",s),n&&r.append("to",n);const a=r.toString()?`?${r.toString()}`:"",l=await Q(`${J()}/api/dm/campaigns/summary/metrics${a}`,{credentials:"include"});return X(l,"Load DM campaigns summary failed")},async listSocial(t){const s=t?`?date=${encodeURIComponent(this._normalizeDate(t))}`:"";let n=await Q(`${J()}/api/dm/social${s}`,{credentials:"include"});return!n.ok&&n.status===404&&(n=await Q(`${J()}/api/dm/social-metrics${s}`,{credentials:"include"})),X(n,"Load social metrics failed")},async addSocial(t){const s={...t};s.date&&delete s.date;const n={metrics:s};let r=await Q(`${J()}/api/dm/social`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});return!r.ok&&r.status===404&&(r=await Q(`${J()}/api/dm/social-metrics`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})),X(r,"Add social metrics failed")},async deleteSocial(t){let s=await Q(`${J()}/api/dm/social/${t}`,{method:"DELETE",credentials:"include"});return!s.ok&&s.status===404&&(s=await Q(`${J()}/api/dm/social-metrics/${t}`,{method:"DELETE",credentials:"include"})),X(s,"Delete social metrics failed")},async listSEO(t){const s=t?`?date=${encodeURIComponent(this._normalizeDate(t))}`:"",n=await Q(`${J()}/api/dm/seo${s}`,{credentials:"include"});return X(n,"Load SEO reports failed")},async createSEO(t){const s={...t,date:this._normalizeDate(t==null?void 0:t.date)},n=await Q(`${J()}/api/dm/seo`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Create SEO report failed")},async deleteSEO(t){const s=await Q(`${J()}/api/dm/seo/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete SEO report failed")},async addEmployer(t){return this.createEmployer(t)},async editEmployer(t,s){return this.updateEmployer(t,s)},async removeEmployer(t){return this.deleteEmployer(t)},async addJob(t){return this.createJob(t)},async editJob(t,s){return this.updateJob(t,s)},async removeJob(t){return this.deleteJob(t)},async addCandidate(t){return this.createCandidate(t)},async editCandidate(t,s){return this.updateCandidate(t,s)},async removeCandidate(t){return this.deleteCandidate(t)},async removeRecIncome(t){return this.deleteRecIncome(t)},async removeRecExpense(t){return this.deleteRecExpense(t)},async createDMCost(t){return this.addDMCost(t)},async createSocial(t){return this.addSocial(t)},async updateSocial(t){return this.addSocial(t)},async mgStats(){const t=await Q(`${J()}/api/mg/stats`,{credentials:"include"});return X(t,"Load MG stats failed")},async listMGWorks(t={}){const s=new URLSearchParams;t.date&&s.set("date",t.date),t.status&&s.set("status",t.status);const n=s.toString()?`?${s.toString()}`:"",r=await Q(`${J()}/api/mg/works${n}`,{credentials:"include"});return X(r,"Load MG works failed")},async createMGWork(t){const s=await Q(`${J()}/api/mg/works`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create MG work failed")},async updateMGWork(t,s){const n=await Q(`${J()}/api/mg/works/${t}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update MG work failed")},async deleteMGWork(t){const s=await Q(`${J()}/api/mg/works/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete MG work failed")},async reportsOverview(t,s){const n=new URLSearchParams;t&&n.set("from",t),s&&n.set("to",s);const r=n.toString()?`?${n.toString()}`:"",a=await Q(`${J()}/api/reports/overview${r}`,{credentials:"include"});return X(a,"Load consolidated report failed")},async getConversations(){const t=await Q(`${J()}/api/messages/conversations`,{credentials:"include"});return X(t,"Load conversations failed")},async getMessages(t,s={}){const n=new URLSearchParams;s.limit&&n.set("limit",s.limit),s.before&&n.set("before",s.before);const r=n.toString()?`?${n.toString()}`:"",a=await Q(`${J()}/api/messages/${t}${r}`,{credentials:"include"});return X(a,"Load messages failed")},async sendMessage(t){const s=await Q(`${J()}/api/messages/send`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Send message failed")},async markMessagesAsRead(t){const s=await Q(`${J()}/api/messages/${t}/read`,{method:"PATCH",credentials:"include"});return X(s,"Mark messages as read failed")},async deleteMessage(t){const s=await Q(`${J()}/api/messages/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete message failed")},async getUnreadMessageCount(){const t=await Q(`${J()}/api/messages/unread/count`,{credentials:"include"});return X(t,"Get unread count failed")},async setAdmissionTarget(t){const s=await Q(`${J()}/api/admission-targets`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Set admission target failed")},async getAdmissionTargets(t){const s=await Q(`${J()}/api/admission-targets?month=${t}`,{credentials:"include"});return X(s,"Get admission targets failed")},async getAllAdmissionTargets(){const t=await Q(`${J()}/api/admission-targets/all`,{credentials:"include"});return X(t,"Get all admission targets failed")},async deleteAdmissionTarget(t){const s=await Q(`${J()}/api/admission-targets/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete admission target failed")},async setTarget(t){const s=await Q(`${J()}/api/targets`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Set target failed")},async getTargets(t,s,n){let r=`${J()}/api/targets?month=${t}`;s&&(r+=`&targetType=${s}`),n&&(r+=`&assignedTo=${n}`);const a=await Q(r,{credentials:"include"});return X(a,"Get targets failed")},async getAllTargets(){const t=await Q(`${J()}/api/targets/all`,{credentials:"include"});return X(t,"Get all targets failed")},async deleteTarget(t){const s=await Q(`${J()}/api/targets/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete target failed")},async getTeamMembers(t){let s=`${J()}/api/targets/team-members`;t&&(s+=`?role=${t}`);const n=await Q(s,{credentials:"include"});return X(n,"Get team members failed")},async listBatches(t,s){let n=`${J()}/api/batches`;const r=new URLSearchParams;t&&r.append("status",t),s&&r.append("category",s),r.toString()&&(n+=`?${r.toString()}`);const a=await Q(n,{credentials:"include"});return X(a,"Load batches failed")},async getBatch(t){const s=await Q(`${J()}/api/batches/${t}`,{credentials:"include"});return X(s,"Load batch failed")},async getBatchReport(t){const s=await Q(`${J()}/api/batches/${t}/report`,{credentials:"include"});return X(s,"Load batch report failed")},async createBatch(t){const s=await Q(`${J()}/api/batches`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Create batch failed")},async updateBatch(t,s){const n=await Q(`${J()}/api/batches/${t}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update batch failed")},async deleteBatch(t){const s=await Q(`${J()}/api/batches/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete batch failed")},async addStudentToBatch(t,s){const n=await Q(`${J()}/api/batches/${t}/add-student`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({leadId:s})});return X(n,"Add student to batch failed")},async getStudentsWithDues(){const t=await Q(`${J()}/api/coordinator/students-with-dues`,{credentials:"include"});return X(t,"Load students with dues failed")},async getPaymentNotifications(){const t=await Q(`${J()}/api/coordinator/payment-notifications`,{credentials:"include"});return X(t,"Load payment notifications failed")},async getStudentHistory(t){const s=await Q(`${J()}/api/coordinator/student-history/${t}`,{credentials:"include"});return X(s,"Load student history failed")},async addFollowUp(t){const s=await Q(`${J()}/api/coordinator/add-follow-up`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Add follow-up failed")},async updatePaymentDate(t,s){const n=await Q(`${J()}/api/coordinator/update-payment-date/${t}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({nextPaymentDate:s})});return X(n,"Update payment date failed")},async getCoordinatorDashboardStats(){const t=await Q(`${J()}/api/coordinator/dashboard-stats`,{credentials:"include"});return X(t,"Load dashboard stats failed")},async updateAdmissionFeePayment(t){const s=await Q(`${J()}/api/coordinator/collect-due`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Collect due payment failed")},async createLeaveApplication(t){const s=await Q(`${J()}/api/leave`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Submit leave application failed")},async getMyLeaveApplications(){const t=await Q(`${J()}/api/leave/my-applications`,{credentials:"include"});return X(t,"Load leave applications failed")},async getAllLeaveApplications(t){const s=t?`?status=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/leave${s}`,{credentials:"include"});return X(n,"Load leave applications failed")},async approveLeaveApplication(t,s){const n=await Q(`${J()}/api/leave/${t}/approve`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewNote:s})});return X(n,"Approve leave failed")},async rejectLeaveApplication(t,s){const n=await Q(`${J()}/api/leave/${t}/reject`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({reviewNote:s})});return X(n,"Reject leave failed")},async getHandoverRequests(){const t=await Q(`${J()}/api/leave/handover-requests`,{credentials:"include"});return X(t,"Load handover requests failed")},async acceptHandover(t,s){const n=await Q(`${J()}/api/leave/${t}/handover/accept`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({handoverNote:s})});return X(n,"Accept handover failed")},async denyHandover(t,s){const n=await Q(`${J()}/api/leave/${t}/handover/deny`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({handoverNote:s})});return X(n,"Deny handover failed")},async updateLeaveApplication(t,s){const n=await Q(`${J()}/api/leave/${t}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update leave application failed")},async deleteLeaveApplication(t){const s=await Q(`${J()}/api/leave/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete leave application failed")},async createTADAApplication(t){const s=await Q(`${J()}/api/tada`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return X(s,"Submit TA/DA application failed")},async getMyTADAApplications(){const t=await Q(`${J()}/api/tada/my-applications`,{credentials:"include"});return X(t,"Load TA/DA applications failed")},async getAdminTADAApplications(t){const s=t?`?adminStatus=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/tada/admin${s}`,{credentials:"include"});return X(n,"Load TA/DA applications failed")},async getAccountantTADAApplications(t){const s=t?`?paymentStatus=${encodeURIComponent(t)}`:"",n=await Q(`${J()}/api/tada/accountant${s}`,{credentials:"include"});return X(n,"Load TA/DA applications failed")},async approveTADAApplication(t,s){const n=await Q(`${J()}/api/tada/${t}/approve`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminReviewNote:s})});return X(n,"Approve TA/DA failed")},async rejectTADAApplication(t,s){const n=await Q(`${J()}/api/tada/${t}/reject`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminReviewNote:s})});return X(n,"Reject TA/DA failed")},async payTADAApplication(t,s){const n=await Q(`${J()}/api/tada/${t}/pay`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentNote:s})});return X(n,"Process payment failed")},async updateTADAApplication(t,s){const n=await Q(`${J()}/api/tada/${t}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return X(n,"Update TA/DA application failed")},async deleteTADAApplication(t){const s=await Q(`${J()}/api/tada/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete TA/DA application failed")},async getNotifications(t,s=50){const n=new URLSearchParams;t!==void 0&&n.append("isRead",t),n.append("limit",s);const r=await Q(`${J()}/api/notifications?${n}`,{credentials:"include"});return X(r,"Load notifications failed")},async getUnreadCount(){const t=await Q(`${J()}/api/notifications/unread-count`,{credentials:"include"});return X(t,"Load unread count failed")},async markNotificationRead(t){const s=await Q(`${J()}/api/notifications/${t}/read`,{method:"PATCH",credentials:"include"});return X(s,"Mark notification read failed")},async markAllNotificationsRead(){const t=await Q(`${J()}/api/notifications/mark-all-read`,{method:"PATCH",credentials:"include"});return X(t,"Mark all notifications read failed")},async deleteNotification(t){const s=await Q(`${J()}/api/notifications/${t}`,{method:"DELETE",credentials:"include"});return X(s,"Delete notification failed")}},lp=d.createContext(null),ge=()=>d.useContext(lp);function Py({children:t}){const[s,n]=d.useState(null),[r,a]=d.useState(!1);d.useEffect(()=>{let c=!0;return B.me().then(u=>{c&&(n((u==null?void 0:u.user)||null),a(!0))}).catch(()=>{c&&a(!0)}),()=>{c=!1}},[]);const l=async(c,u)=>{const x=await B.login(c,u);if(!(x!=null&&x.user))throw new Error("Invalid login response (no user)");return x.token&&localStorage.setItem("auth_token",x.token),n(x.user),x.user},o=async()=>{try{await B.logout()}catch{}localStorage.removeItem("auth_token"),n(null)},i=async c=>{const u=await B.updateMe(c);if(!(u!=null&&u.user))throw new Error("Invalid update response (no user)");return n(u.user),u.user};return e.jsx(lp.Provider,{value:{user:s,ready:r,login:l,logout:o,updateMe:i},children:t})}function Iy(){const{user:t,ready:s}=ge();return s?t?e.jsx(Sc,{}):e.jsx(Na,{to:"/login",replace:!0}):e.jsx("div",{className:"p-6 text-royal",children:"Loading..."})}function Lt({roles:t=[]}){const{user:s}=ge();return s?t.length&&!t.includes(s.role)?e.jsx(Na,{to:"/",replace:!0}):e.jsx(Sc,{}):e.jsx(Na,{to:"/login",replace:!0})}/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ry=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),op=(...t)=>t.filter((s,n,r)=>!!s&&r.indexOf(s)===n).join(" ");/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $y={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fy=d.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:o,...i},c)=>d.createElement("svg",{ref:c,...$y,width:s,height:s,stroke:t,strokeWidth:r?Number(n)*24/Number(s):n,className:op("lucide",a),...i},[...o.map(([u,x])=>d.createElement(u,x)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=(t,s)=>{const n=d.forwardRef(({className:r,...a},l)=>d.createElement(Fy,{ref:l,iconNode:s,className:op(`lucide-${Ry(t)}`,r),...a}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oy=de("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=de("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=de("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=de("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=de("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=de("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=de("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=de("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=de("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jl=de("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=de("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=de("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=de("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=de("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=de("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=de("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=de("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=de("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=de("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=de("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=de("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=de("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=de("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=de("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=de("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=de("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=de("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=de("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=de("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=de("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=de("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=de("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=de("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=de("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=de("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=de("Kanban",[["path",{d:"M6 5v11",key:"mdvv1e"}],["path",{d:"M12 5v6",key:"14ar3b"}],["path",{d:"M18 5v14",key:"7ji314"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=de("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=de("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=de("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=de("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=de("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=de("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=de("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=de("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=de("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=de("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=de("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=de("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=de("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=de("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=de("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=de("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=de("PlaneTakeoff",[["path",{d:"M2 22h20",key:"272qi7"}],["path",{d:"M6.36 17.4 4 17l-2-4 1.1-.55a2 2 0 0 1 1.8 0l.17.1a2 2 0 0 0 1.8 0L8 12 5 6l.9-.45a2 2 0 0 1 2.09.2l4.02 3a2 2 0 0 0 2.1.2l4.19-2.06a2.41 2.41 0 0 1 1.73-.17L21 7a1.4 1.4 0 0 1 .87 1.99l-.38.76c-.23.46-.6.84-1.07 1.08L7.58 17.2a2 2 0 0 1-1.22.18Z",key:"fkigj9"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=de("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=de("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=de("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=de("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=de("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=de("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=de("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=de("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=de("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=de("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=de("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pi=de("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const er=de("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=de("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=de("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=de("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=de("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=de("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=de("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=de("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tb=de("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),el=t=>{if(!t)return"-";try{return new Date(t).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return t}};function hp({lead:t,onClose:s,onUpdate:n}){var j;const{user:r}=ge(),[a,l]=d.useState(""),[o,i]=d.useState(""),[c,u]=d.useState((t==null?void 0:t.priority)||"Interested"),[x,m]=d.useState(!1),[p,h]=d.useState(null),[w,N]=d.useState(null),k=(r==null?void 0:r.role)==="Admission",v=k&&t.status!=="Admitted"&&t.status!=="Not Admitted",g=async()=>{if(!a.trim()&&!o){N("Please add a note or select next follow-up date");return}try{m(!0),N(null),await B.addLeadFollowUp(t._id,{note:a.trim(),nextFollowUpDate:o||void 0,priority:c}),h("Follow-up added successfully"),l(""),i(""),setTimeout(()=>{h(null),n&&n()},1500)}catch(S){N(S.message||"Failed to add follow-up")}finally{m(!1)}},b=async()=>{if(confirm("Mark this lead as Admitted?"))try{m(!0),await B.updateLeadStatus(t._id,"Admitted"),h("Lead marked as Admitted"),setTimeout(()=>{n&&n(),s()},1e3)}catch(S){N(S.message),m(!1)}},y=async()=>{const S=prompt("Reason for not admitting (optional):");if(S!==null)try{m(!0),await B.updateLeadStatus(t._id,"Not Admitted",S),h("Lead marked as Not Admitted"),setTimeout(()=>{n&&n(),s()},1e3)}catch(C){N(C.message),m(!1)}};return t?e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:s}),e.jsxs("div",{className:"bg-white rounded-xl p-6 z-10 w-full max-w-4xl shadow-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-navy",children:["Lead History  ",t.leadId]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),p&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 text-green-700 rounded-lg text-sm",children:p}),w&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-lg text-sm",children:w}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Name:"})," ",e.jsx("strong",{children:t.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"})," ",e.jsx("strong",{children:t.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email:"})," ",e.jsx("strong",{children:t.email||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Course:"})," ",e.jsx("strong",{children:t.interestedCourse||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"})," ",e.jsx("strong",{className:"text-indigo-600",children:t.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Assigned To:"})," ",e.jsx("strong",{children:((j=t.assignedTo)==null?void 0:j.name)||"-"})]})]})}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"border-l-4 border-blue-400 pl-4 py-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Assigned At"}),e.jsx("div",{className:"font-semibold",children:t.assignedAt?el(t.assignedAt):e.jsx("span",{className:"text-gray-400",children:"Not recorded"})})]}),e.jsxs("div",{className:"border-l-4 border-purple-400 pl-4 py-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Counseling At"}),e.jsx("div",{className:"font-semibold",children:t.counselingAt?el(t.counselingAt):e.jsx("span",{className:"text-gray-400",children:"Not yet"})})]}),e.jsxs("div",{className:"border-l-4 border-green-400 pl-4 py-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Admitted At"}),e.jsx("div",{className:"font-semibold",children:t.admittedAt?el(t.admittedAt):e.jsx("span",{className:"text-gray-400",children:"Not admitted yet"})}),t.admittedToCourse&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Course: ",e.jsx("strong",{children:t.admittedToCourse.name})]}),t.admittedToBatch&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Batch: ",e.jsx("strong",{children:t.admittedToBatch.name})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h4",{className:"font-bold text-navy mb-2",children:["Follow-ups (",(t.followUps||[]).length,")"]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:(t.followUps||[]).length===0?e.jsx("div",{className:"text-gray-500 text-sm bg-gray-50 p-3 rounded-lg",children:"No follow-ups recorded"}):(t.followUps||[]).map((S,C)=>{var A;return e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border-l-4 border-orange-400",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:el(S.at)}),((A=S.by)==null?void 0:A.name)&&e.jsxs("div",{className:"text-xs text-gray-500",children:["by ",S.by.name]}),e.jsx("div",{className:"text-sm text-gray-800 mt-1",children:S.note||e.jsx("span",{className:"text-gray-400",children:"No note"})}),S.nextFollowUpDate&&e.jsxs("div",{className:"text-xs text-indigo-600 mt-1",children:["Next follow-up: ",new Date(S.nextFollowUpDate).toLocaleDateString("en-GB")]})]})})},C)})})]}),v&&e.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsxs("h4",{className:"font-bold text-navy mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Add Follow-up Note"]}),e.jsx("textarea",{value:a,onChange:S=>l(S.target.value),className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 mb-3 focus:outline-none focus:ring-2 focus:ring-indigo-500",rows:3,placeholder:"Enter follow-up note..."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Next Follow-up Date (Optional)"}),e.jsx("input",{type:"date",value:o,onChange:S=>i(S.target.value),className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:c,onChange:S=>u(S.target.value),className:"w-full border-2 border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"Very Interested",children:"Very Interested"}),e.jsx("option",{value:"Interested",children:"Interested"}),e.jsx("option",{value:"Few Interested",children:"Few Interested"}),e.jsx("option",{value:"Not Interested",children:"Not Interested"})]})]})]}),e.jsx("button",{onClick:g,disabled:x,className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 font-medium",children:x?"Saving...":"Add Follow-up"})]}),t.notes&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-bold text-navy mb-2",children:"Additional Notes"}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm",children:t.notes})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[k&&t.status!=="Admitted"&&t.status!=="Not Admitted"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:b,disabled:x,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:" Mark Admitted"}),e.jsx("button",{onClick:y,disabled:x,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:" Not Admitted"})]}),e.jsx("button",{onClick:s,className:"px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50",children:"Close"})]})]})]}):null}function sb({onMenuClick:t}){const{user:s,logout:n}=ge(),r=Rn(),[a,l]=d.useState(!1),[o,i]=d.useState([]),[c,u]=d.useState([]),[x,m]=d.useState([]),[p,h]=d.useState([]),[w,N]=d.useState(0),[k,v]=d.useState([]),[g,b]=d.useState(0),[y,j]=d.useState(!1),[S,C]=d.useState(null),[A,R]=d.useState(!1);d.useEffect(()=>{const L=localStorage.getItem("readNotifications");if(L)try{h(JSON.parse(L))}catch(W){console.error("Failed to parse read notifications:",W)}},[]),d.useEffect(()=>{const L=async()=>{try{const W=await B.getUnreadMessageCount();N(W.count||0)}catch(W){console.error("Failed to load unread messages:",W)}};if(s){L();const W=setInterval(L,10*1e3);return()=>clearInterval(W)}},[s]),d.useEffect(()=>{const L=async()=>{try{const G=((["SuperAdmin","Admin"].includes(s==null?void 0:s.role)?await B.listAllTasks():await B.listMyTasks()).tasks||[]).filter(ee=>{if(ee.status==="Completed"||!ee.dueDate)return!1;const _=new Date,te=new Date(ee.dueDate);return Math.ceil((te-_)/(1e3*60*60*24))<=3}).sort((ee,_)=>new Date(ee.dueDate)-new Date(_.dueDate));i(G)}catch(W){console.error("Failed to load urgent tasks:",W)}};if(s){L();const W=setInterval(L,60*1e3);return()=>clearInterval(W)}},[s]),d.useEffect(()=>{const L=async()=>{try{if(["Coordinator","Admin","SuperAdmin"].includes(s==null?void 0:s.role)){const F=(await B.getPaymentNotifications()).notifications||[],z=new Date;z.setHours(0,0,0,0);const G=F.filter(ee=>{if(!ee.nextPaymentDate)return!1;const _=new Date(ee.nextPaymentDate);return _.setHours(0,0,0,0),_<=z}).sort((ee,_)=>new Date(ee.nextPaymentDate)-new Date(_.nextPaymentDate));u(G)}}catch(W){console.error("Failed to load payment notifications:",W)}};if(s){L();const W=setInterval(L,2*60*1e3);return()=>clearInterval(W)}},[s]),d.useEffect(()=>{const L=async()=>{try{if(["Admission","Admin","SuperAdmin"].includes(s==null?void 0:s.role)){const F=(await B.getAdmissionFollowUpNotifications()).notifications||[],z=new Date;z.setHours(0,0,0,0);const G=F.filter(ee=>{if(!ee.nextFollowUpDate)return!1;const _=new Date(ee.nextFollowUpDate);return _.setHours(0,0,0,0),_<=z}).sort((ee,_)=>new Date(ee.nextFollowUpDate)-new Date(_.nextFollowUpDate));m(G)}}catch(W){console.error("Failed to load follow-up notifications:",W)}};if(s){L();const W=setInterval(L,2*60*1e3);return()=>clearInterval(W)}},[s]),d.useEffect(()=>{const L=async()=>{var W;try{console.log(" [Topbar] Loading system notifications for user:",s==null?void 0:s.name,s==null?void 0:s.id);const F=await B.getNotifications(!1,20);console.log(" [Topbar] System notifications response:",F),console.log(" [Topbar] Notifications array length:",(W=F.notifications)==null?void 0:W.length),console.log(" [Topbar] Notifications:",JSON.stringify(F.notifications,null,2)),console.log(" [Topbar] Unread count:",F.unreadCount),v(F.notifications||[]),b(F.unreadCount||0)}catch(F){console.error(" [Topbar] Failed to load system notifications:",F),console.error(" [Topbar] Error details:",F.message)}};if(s){L();const W=setInterval(L,30*1e3);return()=>clearInterval(W)}},[s]),d.useEffect(()=>{(()=>{const W=Date.now()-6048e5,F=p.filter(z=>z.readAt>W);F.length!==p.length&&(h(F),localStorage.setItem("readNotifications",JSON.stringify(F)))})()},[p]);const O=(L,W)=>{if(!L||W==="Completed")return null;const F=new Date,G=new Date(L)-F,ee=Math.ceil(G/(1e3*60*60*24));return ee<0?{bg:"bg-red-100",text:"text-red-700",label:"Overdue"}:ee<=1?{bg:"bg-red-50",text:"text-red-600",label:ee===0?"Due Today":"Due Tomorrow"}:ee<=3?{bg:"bg-orange-50",text:"text-orange-600",label:`${ee} days left`}:{bg:"bg-gray-50",text:"text-gray-600",label:null}},U={Low:{bg:"bg-blue-100",text:"text-blue-600"},Medium:{bg:"bg-yellow-100",text:"text-yellow-600"},High:{bg:"bg-orange-100",text:"text-orange-600"},Critical:{bg:"bg-red-100",text:"text-red-600"}},I=L=>{const W=[...p.filter(F=>F.taskId!==L._id),{taskId:L._id,readAt:Date.now()}];h(W),localStorage.setItem("readNotifications",JSON.stringify(W)),l(!1),sessionStorage.setItem("openTaskId",L._id),sessionStorage.setItem("openTaskData",JSON.stringify(L)),r("/tasks-board")},M=L=>{const W=[...p.filter(F=>F.paymentId!==L._id),{paymentId:L._id,readAt:Date.now()}];h(W),localStorage.setItem("readNotifications",JSON.stringify(W)),l(!1),sessionStorage.setItem("openPaymentId",L._id),sessionStorage.setItem("openPaymentData",JSON.stringify(L)),r("/coordinator/due-fees")},V=async L=>{const W=[...p.filter(F=>F.leadId!==L._id),{leadId:L._id,readAt:Date.now()}];h(W),localStorage.setItem("readNotifications",JSON.stringify(W)),l(!1);try{R(!0);const F=await B.getLeadHistory(L._id),z=F.lead||F;C(z),j(!0)}catch(F){console.error("Failed to load lead history:",F),r("/admission/pipeline")}finally{R(!1)}},D=o.filter(L=>!p.some(W=>W.taskId===L._id)).length,E=c.filter(L=>!p.some(W=>W.paymentId===L._id)).length,P=x.filter(L=>!p.some(W=>W.leadId===L._id)).length,$=D+E+P+g;return e.jsxs("header",{className:"h-16 bg-navy text-white flex items-center justify-between px-4 shadow-soft",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:t,className:"md:hidden p-2 hover:bg-navy/80 rounded-lg transition",children:e.jsx(Jy,{size:20})}),e.jsx("div",{className:"px-2",children:e.jsx("img",{src:"https://primeacademy.org/logo-full.png",alt:"Prime Academy",className:"h-6 md:h-8 object-contain"})})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("div",{className:"relative",children:e.jsxs("button",{onClick:()=>r("/messages"),className:"relative p-2 hover:bg-navy/80 rounded-lg transition",title:"Messages",children:[e.jsx(gt,{size:20,className:"text-white"}),w>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-green-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold animate-pulse",children:w>99?"99+":w})]})}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>l(!a),className:"relative p-2 hover:bg-navy/80 rounded-lg transition",title:"Notifications",children:[e.jsx(Qt,{size:20,className:"text-white"}),$>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold animate-pulse",children:$})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>l(!1)}),e.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-xl border z-50 max-h-[32rem] overflow-y-auto",children:[e.jsxs("div",{className:"p-3 border-b bg-gray-50 flex items-center justify-between sticky top-0",children:[e.jsx("h3",{className:"font-semibold text-navy",children:"Notifications"}),$>0&&e.jsxs("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-1 rounded-full",children:[$," new"]})]}),["Coordinator","Admin","SuperAdmin"].includes(s==null?void 0:s.role)&&c.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-orange-50 border-b border-orange-200",children:e.jsxs("h4",{className:"text-xs font-bold text-orange-700 uppercase flex items-center gap-1",children:[e.jsx(Qt,{size:12}),"Payment Due (",c.length,")"]})}),e.jsx("div",{className:"divide-y max-h-48 overflow-y-auto",children:c.map(L=>{var z,G;const W=!p.some(ee=>ee.paymentId===L._id),F=L.isOverdue;return e.jsxs("div",{onClick:()=>M(L),className:`p-3 hover:bg-gray-50 cursor-pointer relative ${W?"bg-orange-50":""}`,children:[W&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-orange-500"}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:`text-sm ${W?"font-semibold text-navy":"font-medium text-gray-700"}`,children:[(z=L.lead)==null?void 0:z.leadId,"  ",(G=L.lead)==null?void 0:G.name]}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:L.courseName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:`text-xs px-2 py-1 rounded inline-flex items-center gap-1 ${F?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:[e.jsx(fe,{size:10}),new Date(L.nextPaymentDate).toLocaleDateString("en-GB")]}),e.jsx("span",{className:`text-xs font-bold ${F?"text-red-600":"text-orange-600"}`,children:F?"OVERDUE":"DUE TODAY"})]}),e.jsxs("p",{className:"text-xs text-orange-700 font-semibold mt-1",children:["Due:  ",L.dueAmount||0]})]})})]},L._id)})})]}),["Admission","Admin","SuperAdmin"].includes(s==null?void 0:s.role)&&x.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-purple-50 border-b border-purple-200",children:e.jsxs("h4",{className:"text-xs font-bold text-purple-700 uppercase flex items-center gap-1",children:[e.jsx(Qt,{size:12}),"Follow-up Due (",x.length,")"]})}),e.jsx("div",{className:"divide-y max-h-48 overflow-y-auto",children:x.map(L=>{const W=!p.some(G=>G.leadId===L._id),F=L.isOverdue,z=["Admin","SuperAdmin"].includes(s==null?void 0:s.role);return e.jsxs("div",{onClick:()=>V(L),className:`p-3 hover:bg-gray-50 cursor-pointer relative ${W?"bg-purple-50":""}`,children:[W&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-purple-500"}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("p",{className:`text-sm flex-1 ${W?"font-semibold text-navy":"font-medium text-gray-700"}`,children:[L.leadId,"  ",L.name]}),z&&L.assignedTo&&e.jsxs("span",{className:"text-xs bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded-full whitespace-nowrap",children:[" ",L.assignedTo.name]})]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[L.interestedCourse||"No course","  ",L.status]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:`text-xs px-2 py-1 rounded inline-flex items-center gap-1 ${F?"bg-red-100 text-red-700":"bg-purple-100 text-purple-700"}`,children:[e.jsx(fe,{size:10}),new Date(L.nextFollowUpDate).toLocaleDateString("en-GB")]}),e.jsx("span",{className:`text-xs font-bold ${F?"text-red-600":"text-purple-600"}`,children:F?"OVERDUE":"DUE TODAY"})]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[L.phone," ",L.email&&` ${L.email}`]})]})})]},L._id)})})]}),o.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-blue-50 border-b border-blue-200",children:e.jsxs("h4",{className:"text-xs font-bold text-blue-700 uppercase flex items-center gap-1",children:[e.jsx(fe,{size:12}),"Urgent Tasks (",o.length,")"]})}),e.jsx("div",{className:"divide-y max-h-48 overflow-y-auto",children:o.map(L=>{var z,G;const W=O(L.dueDate,L.status),F=!p.some(ee=>ee.taskId===L._id);return e.jsxs("div",{onClick:()=>I(L),className:`p-3 hover:bg-gray-50 cursor-pointer relative ${F?"bg-blue-50":""}`,children:[F&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-blue-500"}),e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm ${F?"font-semibold text-navy":"font-medium text-gray-700"}`,children:L.title}),e.jsxs("div",{className:`text-xs mt-1 px-2 py-1 rounded inline-flex items-center gap-1 ${W==null?void 0:W.bg} ${W==null?void 0:W.text}`,children:[e.jsx(fe,{size:10}),new Date(L.dueDate).toLocaleDateString("en-GB"),(W==null?void 0:W.label)&&` - ${W.label}`]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${(z=U[L.priority])==null?void 0:z.bg} ${(G=U[L.priority])==null?void 0:G.text}`,children:L.priority})]})]},L._id)})})]}),k.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"px-3 py-2 bg-indigo-50 border-b border-indigo-200",children:e.jsxs("h4",{className:"text-xs font-bold text-indigo-700 uppercase flex items-center gap-1",children:[e.jsx(Qt,{size:12}),"System Notifications (",k.length,")"]})}),e.jsx("div",{className:"divide-y max-h-96 overflow-y-auto",children:k.map(L=>{const W=L.type==="LEAVE_HANDOVER_REQUEST";return e.jsxs("div",{onClick:async()=>{try{W?(console.log(" Handover notification clicked:",L),sessionStorage.setItem("openHandoverRequestId",L.relatedId),sessionStorage.setItem("handoverNotificationId",L._id),l(!1),r("/my-applications")):(await B.markNotificationRead(L._id),l(!1),L.link&&r(L.link));const F=await B.getNotifications(!1,20);v(F.notifications||[]),b(F.unreadCount||0)}catch(F){console.error("Failed to handle notification click:",F)}},className:`p-3 hover:bg-gray-50 cursor-pointer relative ${L.isRead?"":"bg-indigo-50"}`,children:[!L.isRead&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-indigo-500"}),e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:`text-sm ${L.isRead?"font-medium text-gray-700":"font-semibold text-navy"}`,children:[L.title,W&&e.jsx("span",{className:"ml-2 text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full",children:"Action Required"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:L.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(L.createdAt).toLocaleString("en-GB",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]})})]},L._id)})})]}),o.length===0&&c.length===0&&x.length===0&&k.length===0&&e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx(Qt,{size:32,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No notifications"})]}),(o.length>0||c.length>0||x.length>0||k.length>0)&&e.jsx("div",{className:"p-3 border-t bg-gray-50 sticky bottom-0",children:e.jsxs("button",{onClick:()=>{l(!1),r("/notifications")},className:"w-full py-2.5 px-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-lg font-medium hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(Qt,{size:16}),"See All Notifications"]})})]})]})]}),e.jsx("img",{src:s==null?void 0:s.avatar,alt:"avatar",className:"w-8 h-8 md:w-9 md:h-9 rounded-full border-2 border-gold object-cover"}),e.jsxs("div",{className:"hidden sm:block text-sm leading-tight",children:[e.jsx("div",{className:"font-semibold",children:s==null?void 0:s.name}),e.jsx("div",{className:"opacity-80 text-xs",children:s==null?void 0:s.designation})]}),e.jsxs("a",{href:"/profile",className:"hidden md:inline-flex items-center gap-1 bg-gold text-navy px-3 py-2 rounded-2xl hover:bg-lightgold transition text-sm",children:[e.jsx(fr,{size:16})," Profile"]}),e.jsx("a",{href:"/profile",className:"md:hidden p-2 bg-gold text-navy rounded-full hover:bg-lightgold transition",children:e.jsx(fr,{size:16})}),e.jsxs("button",{onClick:n,className:"hidden md:inline-flex items-center gap-1 bg-white text-navy px-3 py-2 rounded-2xl hover:bg-lightgold transition text-sm",children:[e.jsx(tm,{size:16})," Logout"]}),e.jsx("button",{onClick:n,className:"md:hidden p-2 bg-white text-navy rounded-full hover:bg-lightgold transition",children:e.jsx(tm,{size:16})})]}),y&&S&&e.jsx(hp,{lead:S,onClose:()=>{j(!1),C(null)},onUpdate:async()=>{try{const L=await B.getLeadHistory(S._id);C(L.lead||L)}catch(L){console.error("Failed to reload lead:",L)}}})]})}const nm=({to:t,icon:s,label:n,onClick:r})=>e.jsxs(Ty,{to:t,onClick:r,className:({isActive:a})=>`flex items-center gap-2 px-4 py-2 rounded-xl mx-3 my-1 ${a?"bg-[#e6eeff] text-navy":"text-royal hover:bg-[#f3f6ff]"}`,children:[s,e.jsx("span",{children:n})]});function nb({isOpen:t,setIsOpen:s}){const{user:n}=ge(),r={SuperAdmin:[{to:"/",label:"Dashboard",icon:e.jsx(is,{size:18})},{to:"/messages",label:"Messages",icon:e.jsx(gt,{size:18})},{to:"/tasks-board",label:"Task Board",icon:e.jsx(Fs,{size:18})},{to:"/admin-task-report",label:"Task Report",icon:e.jsx(St,{size:18})},{to:"/admin/approvals",label:"Application Approvals",icon:e.jsx(wd,{size:18})},{to:"/employees",label:"Employee ",icon:e.jsx(Me,{size:18})},{to:"/courses",label:"Courses ",icon:e.jsx(Sn,{size:18})},{to:"/batches",label:"Batches",icon:e.jsx(xi,{size:18})},{to:"/leads-center-view",label:"Leads Center ",icon:e.jsx(et,{size:18})},{to:"/admission/dashboard",label:"Admission Reports",icon:e.jsx(et,{size:18})},{to:"/recruitment",label:"Recruitment Reports",icon:e.jsx(is,{size:18})},{to:"/accounting/dashboard",label:"Accounts Reports",icon:e.jsx(gs,{size:18})},{to:"/dm/dashboard",label:"Digital Marketing Reports",icon:e.jsx(us,{size:18})},{to:"/mg/dashboard",label:"Motion Graphics Report",icon:e.jsx(Ql,{size:18})}],Admin:[{to:"/",label:"Dashboard",icon:e.jsx(is,{size:18})},{to:"/messages",label:"Messages",icon:e.jsx(gt,{size:18})},{to:"/my-applications",label:"My Applications",icon:e.jsx(Us,{size:18})},{to:"/tasks-board",label:"Task Board",icon:e.jsx(Fs,{size:18})},{to:"/admin-task-report",label:"Task Report",icon:e.jsx(St,{size:18})},{to:"/admin/approvals",label:"Application Approvals",icon:e.jsx(wd,{size:18})},{to:"/employees",label:"Employee",icon:e.jsx(Me,{size:18})},{to:"/leads-center-view",label:"Leads Center ",icon:e.jsx(et,{size:18})},{to:"/courses",label:"Courses ",icon:e.jsx(Sn,{size:18})},{to:"/admission-targets",label:"Targets",icon:e.jsx(Ht,{size:18})},{to:"/batches",label:"Batches",icon:e.jsx(xi,{size:18})},{to:"/admission/dashboard",label:"Admission Reports",icon:e.jsx(et,{size:18})},{to:"/recruitment",label:"Recruitment Reports",icon:e.jsx(is,{size:18})},{to:"/accounting/dashboard",label:"Accounts Dashboard",icon:e.jsx(gs,{size:18})},{to:"/dm/dashboard",label:"Digital Marketing Reports",icon:e.jsx(us,{size:18})},{to:"/mg/dashboard",label:"Motion Graphics Report",icon:e.jsx(Ql,{size:18})}],DigitalMarketing:[{to:"/",label:"Dashboard",icon:e.jsx(is,{size:18})},{to:"/messages",label:"Messages",icon:e.jsx(gt,{size:18})},{to:"/my-applications",label:"My Applications",icon:e.jsx(Us,{size:18})},{to:"/tasks-board",label:"Task Board",icon:e.jsx(Fs,{size:18})},{to:"/task-report",label:"Task Report",icon:e.jsx(St,{size:18})},{to:"/courses",label:"Courses",icon:e.jsx(Sn,{size:18})},{to:"/lead-entry",label:"Lead Entry / CSV",icon:e.jsx(et,{size:18})},{to:"/leads-center",label:"Leads Center",icon:e.jsx(et,{size:18})},{to:"/dm-metrics",label:"Cost / Social / SEO",icon:e.jsx(us,{size:18})}],Admission:[{to:"/",label:"Dashboard",icon:e.jsx(is,{size:18})},{to:"/messages",label:"Messages",icon:e.jsx(gt,{size:18})},{to:"/my-applications",label:"My Applications",icon:e.jsx(Us,{size:18})},{to:"/tasks-board",label:"Task Board",icon:e.jsx(Fs,{size:18})},{to:"/task-report",label:"Task Report",icon:e.jsx(St,{size:18})},{to:"/courses",label:"Courses",icon:e.jsx(Sn,{size:18})},{to:"/batches",label:"Batches",icon:e.jsx(xi,{size:18})},{to:"/my-targets",label:"My Targets",icon:e.jsx(Ht,{size:18})},{to:"/admission/metrics",label:"My Metrics",icon:e.jsx(us,{size:18})},{to:"/admission/assigned",label:"Assigned Lead",icon:e.jsx(et,{size:18})},{to:"/admission/counseling",label:"Counseling",icon:e.jsx(et,{size:18})},{to:"/admission/follow-up",label:"In Follow-Up",icon:e.jsx(et,{size:18})},{to:"/admission/admitted",label:"Admitted",icon:e.jsx(et,{size:18})},{to:"/admission/not-admitted",label:"Not Admitted",icon:e.jsx(et,{size:18})},{to:"/admission/fees",label:"Admission Fees",icon:e.jsx(et,{size:18})}],Accountant:[{to:"/",label:"Dashboard",icon:e.jsx(is,{size:18})},{to:"/messages",label:"Messages",icon:e.jsx(gt,{size:18})},{to:"/my-applications",label:"My Applications",icon:e.jsx(Us,{size:18})},{to:"/tasks-board",label:"Task Board",icon:e.jsx(Fs,{size:18})},{to:"/task-report",label:"Task Report",icon:e.jsx(St,{size:18})},{to:"/accounting/fees",label:"Admission Fees Approval",icon:e.jsx(et,{size:18})},{to:"/accounting/due-collections",label:"Due Collection Approval",icon:e.jsx(et,{size:18})},{to:"/recruitment/income",label:"Recruitment Income Approval",icon:e.jsx(gs,{size:18})},{to:"/accounting/expense",label:"Expense",icon:e.jsx(et,{size:18})},{to:"/accounting/tada-payments",label:"TA/DA Payments",icon:e.jsx(He,{size:18})}],AccountantExtra:[{to:"/employee-accounts/bank",label:"Employee Bank Account",icon:e.jsx(vd,{size:18})},{to:"/employee-accounts/salary",label:"Employee Salary",icon:e.jsx(gs,{size:18})}],Recruitment:[{to:"/",label:"Dashboard",icon:e.jsx(is,{size:18})},{to:"/messages",label:"Messages",icon:e.jsx(gt,{size:18})},{to:"/my-applications",label:"My Applications",icon:e.jsx(Us,{size:18})},{to:"/tasks-board",label:"Task Board",icon:e.jsx(Fs,{size:18})},{to:"/task-report",label:"Task Report",icon:e.jsx(St,{size:18})},{to:"/recruitment",label:"Recruitment",icon:e.jsx(Me,{size:18})},{to:"/recruitment/candidates",label:"Candidates",icon:e.jsx(Me,{size:18})},{to:"/recruitment/jobs",label:"Job Positions",icon:e.jsx(et,{size:18})},{to:"/recruitment/employers",label:"Employers",icon:e.jsx(et,{size:18})},{to:"/recruitment/income",label:"Recruitment Income",icon:e.jsx(gs,{size:18})},{to:"/recruitment/expenses",label:"Recruitment Expense",icon:e.jsx(gs,{size:18})}],MotionGraphics:[{to:"/",label:"Dashboard",icon:e.jsx(is,{size:18})},{to:"/messages",label:"Messages",icon:e.jsx(gt,{size:18})},{to:"/my-applications",label:"My Applications",icon:e.jsx(Us,{size:18})},{to:"/tasks-board",label:"Task Board",icon:e.jsx(Fs,{size:18})},{to:"/task-report",label:"Task Report",icon:e.jsx(St,{size:18})},{to:"/mg/production",label:"MG Production",icon:e.jsx(Oy,{size:18})}],Coordinator:[{to:"/",label:"Dashboard",icon:e.jsx(is,{size:18})},{to:"/messages",label:"Messages",icon:e.jsx(gt,{size:18})},{to:"/my-applications",label:"My Applications",icon:e.jsx(Us,{size:18})},{to:"/tasks-board",label:"Task Board",icon:e.jsx(Fs,{size:18})},{to:"/task-report",label:"Task Report",icon:e.jsx(St,{size:18})},{to:"/admission/fees",label:"Admission Fees Collection",icon:e.jsx(gs,{size:18})},{to:"/coordinator/due-fees",label:"Due Fees Collection",icon:e.jsx(vd,{size:18})},{to:"/coordinator/notifications",label:"Payment Reminders",icon:e.jsx(gt,{size:18})}]};let a=r[n==null?void 0:n.role]||[];(n==null?void 0:n.role)==="Accountant"&&Array.isArray(r.AccountantExtra)&&(a=[...a,...r.AccountantExtra]);const l=()=>s&&s(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"w-72 hidden md:flex bg-white border-r min-h-screen sticky top-0 flex-col",children:[e.jsx("div",{className:"px-4 py-4",children:e.jsx("img",{src:"https://primeacademy.org/logo-full.png",alt:"Prime Academy",className:"w-40 object-contain"})}),e.jsx("nav",{className:"flex-1",children:a.map(o=>e.jsx(nm,{...o},o.to))})]}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:l}),e.jsxs("aside",{className:"fixed left-0 top-0 h-full w-80 bg-white shadow-xl flex flex-col transform transition-transform",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("img",{src:"https://primeacademy.org/logo-full.png",alt:"Prime Academy",className:"w-32 object-contain"}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Do,{size:20,className:"text-gray-600"})})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto",children:a.map(o=>e.jsx(nm,{...o,onClick:l},o.to))})]})]})]})}function pp(){const{user:t}=ge();if(!["Accountant","Admin","SuperAdmin"].includes(t==null?void 0:t.role))return e.jsx("div",{className:"text-royal",children:"Only Accountant, Admin or SuperAdmin can access this dashboard."});const[s,n]=d.useState({period:"monthly",from:new Date(new Date().getFullYear(),0,1).toISOString().slice(0,10),to:new Date().toISOString().slice(0,10)}),[r,a]=d.useState({totalIncome:0,totalExpense:0,profit:0}),[l,o]=d.useState(null),[i,c]=d.useState([]),[u,x]=d.useState([]),[m,p]=d.useState(!1),[h,w]=d.useState({incomes:[],expenses:[]}),N=async()=>{try{let b,y;if(s.period==="custom")b=s.from,y=s.to;else if(s.period==="lifetime")b=void 0,y=void 0;else{const A=new Date,R=new Date;s.period==="daily"?R.setDate(A.getDate()-1):s.period==="weekly"?R.setDate(A.getDate()-7):s.period==="monthly"?R.setMonth(A.getMonth()-1):s.period==="yearly"&&R.setFullYear(A.getFullYear()-1),b=R.toISOString().slice(0,10),y=A.toISOString().slice(0,10)}const[j,S,C]=await Promise.all([B.accountingSummary(b,y),B.listIncome().catch(()=>({income:[]})),B.listExpenses().catch(()=>({expenses:[]}))]);a(j||{totalIncome:0,totalExpense:0,profit:0}),c(Array.isArray(S)?S:(S==null?void 0:S.income)||[]),x(Array.isArray(C)?C:(C==null?void 0:C.expenses)||[])}catch(b){o(b.message)}};d.useEffect(()=>{N()},[]);const k=fn();d.useEffect(()=>{try{const b=localStorage.getItem("accountHeads");w(b?JSON.parse(b):{incomes:[],expenses:[]})}catch{w({incomes:[],expenses:[]})}try{const b=new URLSearchParams(k.search||"");(b.get("openHeads")||b.get("openHeadsModal"))&&p(!0)}catch{}},[k.search]);const v=(r.totalIncome||0)-(r.totalExpense||0);rb(i,u,s);const g=ab(u);return e.jsxs("div",{className:"space-y-6 p-6 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Accounting Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Financial overview and metrics"})]})}),l&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium",children:l})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:s.period,onChange:b=>n(y=>({...y,period:b.target.value})),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"lifetime",children:"Lifetime"}),e.jsx("option",{value:"custom",children:"Custom"})]}),s.period==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:s.from,onChange:b=>n(y=>({...y,from:b.target.value})),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"to"}),e.jsx("input",{type:"date",value:s.to,onChange:b=>n(y=>({...y,to:b.target.value})),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"})]}),e.jsx("button",{onClick:N,className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all font-medium shadow-lg",children:"Apply"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"group relative bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Ot,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Income"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:Pe(r.totalIncome||0)})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-red-500 to-rose-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(xp,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Expense"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:Pe(r.totalExpense||0)})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(He,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Profit"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:Pe(r.profit||0)})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(gs,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Net Balance"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:Pe(v)})]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Income by Source"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Revenue distribution breakdown"})]}),e.jsx(Jl,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(am,{data:[{label:"Admission Fees",value:r.admissionFeesIncome||0,color:"#10b981"},{label:"Recruitment",value:r.recruitmentIncome||0,color:"#3b82f6"},{label:"Due Collections",value:r.dueCollectionIncome||0,color:"#f59e0b"},{label:"Other",value:r.otherIncome||0,color:"#8b5cf6"}].filter(b=>b.value>0)})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Expense by Head"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Distribution breakdown"})]}),e.jsx(Jl,{className:"w-5 h-5 text-gray-400"})]}),e.jsx(am,{data:g})]})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>p(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-3xl w-full shadow-2xl transform transition-all",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Account Heads Management"}),e.jsx("button",{onClick:()=>p(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:""})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsx(rm,{kind:"incomes",heads:h.incomes,onChange:b=>w(y=>({...y,incomes:b}))}),e.jsx(rm,{kind:"expenses",heads:h.expenses,onChange:b=>w(y=>({...y,expenses:b}))})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>p(!1),className:"px-6 py-2 rounded-xl border-2 border-gray-200 hover:bg-gray-50 transition-colors font-medium text-gray-700",children:"Close"}),e.jsx("button",{onClick:()=>{localStorage.setItem("accountHeads",JSON.stringify(h)),p(!1)},className:"px-6 py-2 rounded-xl bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700 transition-all font-medium shadow-lg hover:shadow-xl",children:"Save Changes"})]})]})})]})}function rm({kind:t,heads:s=[],onChange:n}){const[r,a]=d.useState(s||[]),[l,o]=d.useState("");d.useEffect(()=>{a(s||[])},[s]);const i=()=>{if(!l.trim())return;const p=[l.trim(),...r];a(p),o(""),n&&n(p)},c=p=>{const h=r.filter((w,N)=>N!==p);a(h),n&&n(h)},u=t==="incomes",x=u?"from-green-50 to-emerald-50":"from-red-50 to-rose-50",m=u?"from-green-600 to-emerald-600":"from-red-600 to-rose-600";return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:`text-lg font-bold bg-gradient-to-r ${m} bg-clip-text text-transparent`,children:t==="incomes"?"Income Heads":"Expense Heads"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:l,onChange:p=>o(p.target.value),placeholder:u?"New income head":"New expense head",className:"border-2 border-gray-200 rounded-xl px-4 py-2 flex-1 focus:border-blue-500 focus:outline-none transition-colors",onKeyPress:p=>p.key==="Enter"&&i()}),e.jsx("button",{onClick:i,className:`px-4 py-2 bg-gradient-to-r ${m} text-white rounded-xl hover:opacity-90 transition-opacity font-medium shadow-lg`,children:"Add"})]}),e.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:[r.map((p,h)=>e.jsxs("div",{className:`flex items-center justify-between bg-gradient-to-r ${x} rounded-xl px-4 py-3 hover:shadow-md transition-all`,children:[e.jsx("span",{className:"text-gray-800 font-medium",children:p}),e.jsx("button",{onClick:()=>c(h),className:"px-3 py-1 bg-red-100 text-red-600 text-sm rounded-lg hover:bg-red-200 transition-colors font-medium",children:"Remove"})]},p+h)),r.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(gs,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsxs("p",{children:["No ",t==="incomes"?"income":"expense"," heads defined"]})]})]})]})}function rb(t=[],s=[],n){let r,a;if(n.period==="custom")r=new Date(n.from),a=new Date(n.to);else{if(n.period==="lifetime")return[];{const i=new Date;r=new Date,n.period==="daily"?r.setDate(i.getDate()-1):n.period==="weekly"?r.setDate(i.getDate()-7):n.period==="monthly"?r.setMonth(i.getMonth()-1):n.period==="yearly"&&r.setFullYear(i.getFullYear()-1),a=i}}if(!r||!a)return[];const l=[],o=new Date(r);for(;o<=a;){const i=o.toISOString().slice(0,10),c=t.filter(x=>new Date(x.date).toISOString().slice(0,10)===i).reduce((x,m)=>x+(Number(m.amount)||0),0),u=s.filter(x=>new Date(x.date).toISOString().slice(0,10)===i).reduce((x,m)=>x+(Number(m.amount)||0),0);l.push({date:i,income:c,expense:u}),o.setDate(o.getDate()+1)}return l}function ab(t=[]){const s={};return(t||[]).forEach(n=>{const r=n.purpose||n.category||"Other";s[r]=(s[r]||0)+Number(n.amount||0)}),Object.entries(s).map(([n,r])=>({label:n,value:r}))}function am({data:t}){if(!t||t.length===0)return e.jsx("div",{className:"flex items-center justify-center h-52 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jl,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No data available"})]})});const s=t.reduce((u,x)=>u+x.value,0);if(s===0)return e.jsx("div",{className:"flex items-center justify-center h-52 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jl,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No expense recorded"})]})});const n=[{base:"#3b82f6",gradient:"url(#gradient0)"},{base:"#8b5cf6",gradient:"url(#gradient1)"},{base:"#ec4899",gradient:"url(#gradient2)"},{base:"#f59e0b",gradient:"url(#gradient3)"},{base:"#10b981",gradient:"url(#gradient4)"},{base:"#ef4444",gradient:"url(#gradient5)"},{base:"#06b6d4",gradient:"url(#gradient6)"},{base:"#a855f7",gradient:"url(#gradient7)"}];let r=-90;const a=120,l=120,o=90,i=60,c=t.map((u,x)=>{const m=u.value/s*360,p=r*Math.PI/180,h=(r+m)*Math.PI/180,w=a+o*Math.cos(p),N=l+o*Math.sin(p),k=a+o*Math.cos(h),v=l+o*Math.sin(h),g=a+i*Math.cos(h),b=l+i*Math.sin(h),y=a+i*Math.cos(p),j=l+i*Math.sin(p),S=m>180?1:0,C=`M${w},${N} A${o},${o} 0 ${S},1 ${k},${v} L${g},${b} A${i},${i} 0 ${S},0 ${y},${j} Z`,A=(u.value/s*100).toFixed(1);return r+=m,{path:C,color:n[x%n.length],label:u.label,percentage:A,value:u.value}});return e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("svg",{width:"240",height:"240",className:"mx-auto",children:[e.jsx("defs",{children:n.map((u,x)=>e.jsxs("linearGradient",{id:`gradient${x}`,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:u.base,stopOpacity:"0.9"}),e.jsx("stop",{offset:"100%",stopColor:u.base,stopOpacity:"0.6"})]},x))}),c.map((u,x)=>e.jsx("path",{d:u.path,fill:u.color.gradient,stroke:"white",strokeWidth:"2",className:"hover:opacity-80 transition-opacity cursor-pointer"},x)),e.jsx("text",{x:a,y:l-5,textAnchor:"middle",fontSize:"12",fill:"#6b7280",fontWeight:"500",children:"Total"}),e.jsx("text",{x:a,y:l+10,textAnchor:"middle",fontSize:"18",fill:"#1f2937",fontWeight:"bold",children:Pe(s)})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 w-full",children:c.map((u,x)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:n[x%n.length].base}}),e.jsx("span",{className:"text-gray-700 font-medium truncate",children:u.label}),e.jsxs("span",{className:"text-gray-500 ml-auto",children:[u.percentage,"%"]})]},x))})]})}function tl(){return new Date().toISOString().slice(0,10)}function lm(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1).toISOString().slice(0,10)}function fp(){const[t,s]=d.useState([]),[n,r]=d.useState([]),[a,l]=d.useState([]),[o,i]=d.useState(!1),[c,u]=d.useState(""),[x,m]=d.useState([]),[p,h]=d.useState(!1),[w,N]=d.useState(""),[k,v]=d.useState("monthly"),[g,b]=d.useState(""),[y,j]=d.useState("");d.useEffect(()=>{S();const D=new Date,E=D.getFullYear(),P=String(D.getMonth()+1).padStart(2,"0"),$=`${E}-${P}`;N($),C($)},[]);async function S(){i(!0);try{const[D,E,P]=await Promise.all([B.listCandidates().catch(()=>({candidates:[]})),B.listJobs().catch(()=>({jobs:[]})),B.listEmployers().catch(()=>({employers:[]}))]);s((D==null?void 0:D.candidates)||D||[]),r((E==null?void 0:E.jobs)||E||[]),l((P==null?void 0:P.employers)||P||[]),u("")}catch(D){u(D.message||"Failed to load")}finally{i(!1)}}async function C(D){h(!0);try{const E=await B.getTargets(D,null,null),P=(E==null?void 0:E.targets)||[];console.log("All targets for month:",D,P);const $=P.filter(L=>L.targetType==="RecruitmentCandidate"||L.targetType==="RecruitmentRevenue");console.log("Filtered recruitment targets:",$),m($)}catch(E){console.error("Failed to load targets:",E)}finally{h(!1)}}const A=()=>{const D=[],E=new Date;for(let P=-12;P<=3;P++){const $=new Date(E.getFullYear(),E.getMonth()+P,1),L=$.getFullYear(),W=$.getMonth()+1,F=`${L}-${String(W).padStart(2,"0")}`,z=$.toLocaleDateString("en-US",{month:"long",year:"numeric"});D.push({value:F,label:z})}return D},R=D=>{N(D),C(D)},O=()=>{if(k==="lifetime")return{from:null,to:null};if(k==="custom"){if(g&&y){const P=new Date(g);P.setHours(0,0,0,0);const $=new Date(y);return $.setHours(23,59,59,999),{from:P,to:$}}return{from:null,to:null}}const D=new Date;let E=new Date;return k==="daily"?E.setDate(D.getDate()-1):k==="weekly"?E.setDate(D.getDate()-7):k==="monthly"?E.setMonth(D.getMonth()-1):k==="yearly"&&E.setFullYear(D.getFullYear()-1),{from:E,to:D}},U=(D,E,P)=>{if(!D)return!1;const $=new Date(D).getTime();return!(E&&$<E.getTime()||P&&$>P.getTime())},{from:I,to:M}=O(),V=ve.useMemo(()=>{const D=I?new Date(I):null,E=M?new Date(M):null,P=t.filter(ee=>U(ee.createdAt,D,E)||!D&&!E),$=n.filter(ee=>U(ee.createdAt,D,E)||!D&&!E),L=P.length,W=P.filter(ee=>ee.status==="pending").length,F=$.filter(ee=>ee.status==="active").length,z=a.length,G=[];if(E)for(let ee=5;ee>=0;ee--){const _=new Date(E);_.setMonth(_.getMonth()-ee);const te=new Date(_.getFullYear(),_.getMonth(),1),K=new Date(_.getFullYear(),_.getMonth()+1,0,23,59,59,999),Y=te.toLocaleString("en-US",{month:"short",year:"numeric"}),oe=t.filter(Z=>U(Z.createdAt,te,K)).length,le=t.filter(Z=>Z.status==="recruited"&&U(Z.recruitedAt||Z.updatedAt,te,K)).length;G.push({month:Y,candidates:oe,recruited:le})}return{totalRecruitment:L,pendingCandidate:W,activeJobPosition:F,totalEmployer:z,series:G}},[t,n,a,I,M]);return e.jsxs("div",{className:"space-y-6 p-6 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Recruitment Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track candidates and job positions"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:k,onChange:D=>v(D.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"lifetime",children:"Lifetime"}),e.jsx("option",{value:"custom",children:"Custom"})]}),k==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:g,onChange:D=>b(D.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"to"}),e.jsx("input",{type:"date",value:y,onChange:D=>j(D.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"})]})]})]}),c&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium",children:c})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Me,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Total Recruitment"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:V.totalRecruitment})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Bt,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Pending Candidate"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:V.pendingCandidate})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(ip,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Active Job Position"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:V.activeJobPosition})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Uy,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Total Employer"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:V.totalEmployer})]})]})]}),e.jsx(lb,{}),!p&&e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-xl border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-lg",children:e.jsx(Ht,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Team Targets"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Recruitment performance tracking"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-gray-400"}),e.jsx("select",{value:w,onChange:D=>R(D.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-indigo-400 focus:border-indigo-500 focus:outline-none transition-colors font-medium text-gray-700",children:A().map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))})]})]}),x.length===0?e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-12 border-2 border-dashed border-gray-300 text-center",children:[e.jsx(Ht,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-700 mb-2",children:"No Targets Set"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Contact your admin to set recruitment targets for this month"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x.map(D=>{var F;const E=D.targetType==="RecruitmentCandidate",P=D.achieved||0,$=D.targetValue||0,L=$>0?Math.round(P/$*100):0,W=((F=D.assignedTo)==null?void 0:F.name)||"Team";return e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-xl p-6 border-2 border-gray-200 hover:border-indigo-300 hover:shadow-lg transition-all duration-300",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-3 rounded-lg shadow-md ${E?"bg-gradient-to-br from-blue-500 to-indigo-600":"bg-gradient-to-br from-green-500 to-emerald-600"}`,children:E?e.jsx(Me,{className:"w-6 h-6 text-white"}):e.jsx(He,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:E?"Candidates":"Revenue"}),e.jsx("p",{className:"text-gray-500 text-sm",children:W})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"Achievement"}),e.jsx("p",{className:"text-3xl font-bold text-gray-800",children:E?P:Zt(P)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"Target"}),e.jsx("p",{className:"text-xl font-semibold text-gray-600",children:E?$:Zt($)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600 font-medium",children:"Progress"}),e.jsxs("span",{className:`font-bold ${L>=100?"text-green-600":L>=75?"text-blue-600":L>=50?"text-orange-600":"text-red-600"}`,children:[L,"%"]})]}),e.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${L>=100?"bg-gradient-to-r from-green-500 to-emerald-600":L>=75?"bg-gradient-to-r from-blue-500 to-indigo-600":L>=50?"bg-gradient-to-r from-orange-500 to-amber-600":"bg-gradient-to-r from-red-500 to-rose-600"}`,style:{width:`${Math.min(L,100)}%`}})})]}),D.note&&e.jsxs("p",{className:"text-gray-600 text-sm mt-3 italic bg-gray-50 p-2 rounded border-l-4 border-indigo-400",children:['"',D.note,'"']})]})]},D._id)})})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Candidate vs Recruited"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Last 6 months performance"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Candidates"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Recruited"})]})]})]}),e.jsx(ob,{data:V.series})]})]})}function lb(){const[t,s]=d.useState("monthly"),[n,r]=d.useState(lm()),[a,l]=d.useState(tl()),[o,i]=d.useState(!1),[c,u]=d.useState(""),[x,m]=d.useState(""),p=async()=>{i(!0),u(""),m("");try{let h,w;t==="daily"?(h=tl(),w=tl()):t==="monthly"?(h=lm(),w=tl()):t==="custom"&&(h=n,w=a);const[N,k,v,g,b]=await Promise.all([B.listCandidates().catch(()=>({candidates:[]})),B.listJobs().catch(()=>({jobs:[]})),B.listEmployers().catch(()=>({employers:[]})),B.listRecIncome().catch(()=>({items:[]})),B.listRecExpense().catch(()=>({items:[]}))]),y=(N==null?void 0:N.candidates)||[],j=(k==null?void 0:k.jobs)||[],S=(v==null?void 0:v.employers)||[],C=Array.isArray(g)?g:(g==null?void 0:g.items)||(g==null?void 0:g.income)||[],A=Array.isArray(b)?b:(b==null?void 0:b.items)||(b==null?void 0:b.expenses)||[],R=new Date(h),O=new Date(w);O.setHours(23,59,59,999);const U=y.filter(K=>{const Y=new Date(K.createdAt||K.date);return Y>=R&&Y<=O}),I=j.filter(K=>{const Y=new Date(K.createdAt||K.date);return Y>=R&&Y<=O}),M=C.filter(K=>{const Y=new Date(K.date);return Y>=R&&Y<=O}),V=A.filter(K=>{const Y=new Date(K.date);return Y>=R&&Y<=O}),D=U.length,E={};U.forEach(K=>{const Y=K.status||"Unknown";E[Y]=(E[Y]||0)+1});const P=I.length,$={};I.forEach(K=>{const Y=K.status||"Unknown";$[Y]=($[Y]||0)+1});const L=M.reduce((K,Y)=>K+(Number(Y.amount)||0),0),W={};M.forEach(K=>{const Y=K.source||"Others";W[Y]=(W[Y]||0)+(Number(K.amount)||0)});const F=V.reduce((K,Y)=>K+(Number(Y.amount)||0),0),z={};V.forEach(K=>{const Y=K.purpose||"Others";z[Y]=(z[Y]||0)+(Number(K.amount)||0)});let G=`Recruitment Report
`;G+=`Period: ${h} to ${w}
`,G+=`Generated: ${new Date().toLocaleString()}

`,G+=`=== CANDIDATES ===
`,G+=`Total Candidates,${D}

`,G+=`Candidates by Status
`,G+=`Status,Count
`,Object.entries(E).sort((K,Y)=>Y[1]-K[1]).forEach(([K,Y])=>{G+=`${K},${Y}
`}),G+=`
`,U.length>0&&(G+=`Candidate Details
`,G+=`Name,Phone,Email,Status,Job Position,Company,Created Date
`,U.forEach(K=>{var se,me;const Y=(K.name||"N/A").replace(/,/g,";"),oe=K.phone||"N/A",le=(K.email||"N/A").replace(/,/g,";"),Z=K.status||"N/A",T=(((se=K.jobId)==null?void 0:se.title)||"N/A").replace(/,/g,";"),H=(((me=K.employerId)==null?void 0:me.companyName)||"N/A").replace(/,/g,";"),re=K.createdAt?new Date(K.createdAt).toLocaleDateString():"N/A";G+=`"${Y}",${oe},"${le}",${Z},"${T}","${H}",${re}
`}),G+=`
`),G+=`=== JOB POSITIONS ===
`,G+=`Total Jobs,${P}

`,G+=`Jobs by Status
`,G+=`Status,Count
`,Object.entries($).sort((K,Y)=>Y[1]-K[1]).forEach(([K,Y])=>{G+=`${K},${Y}
`}),G+=`
`,I.length>0&&(G+=`Job Position Details
`,G+=`Job Title,Company,Location,Status,Salary,Requirements,Created Date
`,I.forEach(K=>{var se;const Y=(K.title||"N/A").replace(/,/g,";"),oe=(((se=K.employerId)==null?void 0:se.companyName)||"N/A").replace(/,/g,";"),le=(K.location||"N/A").replace(/,/g,";"),Z=K.status||"N/A",T=(K.salary||"N/A").replace(/,/g,";"),H=(K.requirements||"N/A").replace(/,/g,";").replace(/\n/g," "),re=K.createdAt?new Date(K.createdAt).toLocaleDateString():"N/A";G+=`"${Y}","${oe}","${le}",${Z},"${T}","${H}",${re}
`}),G+=`
`),G+=`=== EMPLOYERS ===
`,G+=`Total Employers,${S.length}

`,S.length>0&&(G+=`Employer Details
`,G+=`Company Name,Contact Person,Phone,Email,Address,Industry
`,S.forEach(K=>{const Y=(K.companyName||"N/A").replace(/,/g,";"),oe=(K.contactPerson||"N/A").replace(/,/g,";"),le=K.phone||"N/A",Z=(K.email||"N/A").replace(/,/g,";"),T=(K.address||"N/A").replace(/,/g,";").replace(/\n/g," "),H=(K.industry||"N/A").replace(/,/g,";");G+=`"${Y}","${oe}",${le},"${Z}","${T}","${H}"
`}),G+=`
`),G+=`=== RECRUITMENT INCOME ===
`,G+=`Total Income,${L} BDT

`,G+=`Income by Source
`,G+=`Source Name,Amount (BDT)
`,Object.entries(W).sort((K,Y)=>Y[1]-K[1]).forEach(([K,Y])=>{G+=`${K},${Y}
`}),G+=`
`,M.length>0&&(G+=`Detailed Income
`,G+=`Date,Source Name,Amount (BDT),Status,Notes
`,M.forEach(K=>{const Y=new Date(K.date).toLocaleDateString(),oe=(K.source||"N/A").replace(/,/g,";"),le=K.status||"N/A",Z=(K.notes||K.description||"N/A").replace(/,/g,";").replace(/\n/g," ");G+=`${Y},"${oe}",${K.amount||0},${le},"${Z}"
`}),G+=`
`),G+=`=== RECRUITMENT EXPENSES ===
`,G+=`Total Expenses,${F} BDT

`,G+=`Expenses by Purpose Name
`,G+=`Purpose Name,Amount (BDT)
`,Object.entries(z).sort((K,Y)=>Y[1]-K[1]).forEach(([K,Y])=>{G+=`${K},${Y}
`}),G+=`
`,V.length>0&&(G+=`Detailed Expenses
`,G+=`Date,Purpose Name,Amount (BDT),Notes
`,V.forEach(K=>{const Y=new Date(K.date).toLocaleDateString(),oe=(K.purpose||"N/A").replace(/,/g,";"),le=(K.notes||K.description||"N/A").replace(/,/g,";").replace(/\n/g," ");G+=`${Y},"${oe}",${K.amount||0},"${le}"
`}),G+=`
`),G+=`=== FINANCIAL SUMMARY ===
`,G+=`Total Income,${L} BDT
`,G+=`Total Expenses,${F} BDT
`,G+=`Net Profit,${L-F} BDT
`;const ee=new Blob([G],{type:"text/csv;charset=utf-8;"}),_=URL.createObjectURL(ee),te=document.createElement("a");te.href=_,te.download=`Recruitment_Report_${h}_to_${w}.csv`,te.click(),URL.revokeObjectURL(_),u(" Report downloaded successfully!")}catch(h){m("Failed to download report: "+h.message)}finally{i(!1)}};return e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border-2 border-gray-200 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-md",children:e.jsx(ts,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Download Comprehensive Reports"})]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Export detailed reports including candidates, jobs, employers, income, and expenses"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs("select",{value:t,onChange:h=>s(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"daily",children:"Today"}),e.jsx("option",{value:"monthly",children:"This Month"}),e.jsx("option",{value:"custom",children:"Custom Range"})]}),t==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:n,onChange:h=>r(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"}),e.jsx("span",{className:"text-gray-500 font-medium self-center",children:"to"}),e.jsx("input",{type:"date",value:a,onChange:h=>l(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"})]}),e.jsx("button",{onClick:p,disabled:o,className:"px-6 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl font-bold hover:from-blue-600 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"w-4 h-4"}),"Download Report"]})})]})]}),c&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border-2 border-green-200 rounded-lg",children:e.jsx("p",{className:"text-green-700 font-medium text-sm",children:c})}),x&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border-2 border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium text-sm",children:x})})]})}function ob({data:t}){if(!t||t.length===0)return e.jsx("div",{className:"flex items-center justify-center h-52 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx(us,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No data available"})]})});const s=Math.max(...t.map(u=>Math.max(u.candidates||0,u.recruited||0)),1),n=40,r=10,a=n*2+r,l={left:50,right:30,top:30,bottom:60},o=l.left+l.right+(a+30)*t.length,i=300,c=i-l.top-l.bottom;return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("svg",{width:o,height:i,className:"min-w-full",children:[[0,.25,.5,.75,1].map((u,x)=>e.jsxs("g",{children:[e.jsx("line",{x1:l.left,y1:l.top+c*(1-u),x2:o-l.right,y2:l.top+c*(1-u),stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"4,4"}),e.jsx("text",{x:l.left-10,y:l.top+c*(1-u)+4,textAnchor:"end",fontSize:"12",fill:"#6b7280",children:Math.round(s*u)})]},x)),t.map((u,x)=>{const m=l.left+x*(a+30),p=u.candidates/s*c,h=u.recruited/s*c;return e.jsxs("g",{children:[e.jsx("rect",{x:m,y:l.top+c-p,width:n,height:p,fill:"url(#candidatesGradient)",rx:"4"}),e.jsx("text",{x:m+n/2,y:l.top+c-p-5,textAnchor:"middle",fontSize:"12",fontWeight:"600",fill:"#3b82f6",children:u.candidates}),e.jsx("rect",{x:m+n+r,y:l.top+c-h,width:n,height:h,fill:"url(#recruitedGradient)",rx:"4"}),e.jsx("text",{x:m+n+r+n/2,y:l.top+c-h-5,textAnchor:"middle",fontSize:"12",fontWeight:"600",fill:"#10b981",children:u.recruited}),e.jsx("text",{x:m+a/2,y:i-l.bottom+20,textAnchor:"middle",fontSize:"12",fill:"#374151",fontWeight:"500",children:u.month})]},x)}),e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"candidatesGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.9"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:"0.6"})]}),e.jsxs("linearGradient",{id:"recruitedGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.9"}),e.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.6"})]})]})]})})}function sl(){return new Date().toISOString().slice(0,10)}function om(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1).toISOString().slice(0,10)}function gp(){const[t,s]=d.useState([]),[n,r]=d.useState(""),[a,l]=d.useState(!1),[o,i]=d.useState("monthly"),[c,u]=d.useState(""),[x,m]=d.useState("");d.useEffect(()=>{p();const A=setInterval(p,3e4);return()=>clearInterval(A)},[]);async function p(){l(!0);try{const A=await B.listMGWorks().catch(()=>({works:[]})),R=(A==null?void 0:A.works)||A||[];s(Array.isArray(R)?R:[]),r("")}catch(A){r(A.message||"Failed to load")}finally{l(!1)}}const h=()=>{if(o==="lifetime")return{from:null,to:null};if(o==="custom"){if(c&&x){const O=new Date(c);O.setHours(0,0,0,0);const U=new Date(x);return U.setHours(23,59,59,999),{from:O,to:U}}return{from:null,to:null}}const A=new Date;let R=new Date;return o==="daily"?R.setDate(A.getDate()-1):o==="weekly"?R.setDate(A.getDate()-7):o==="monthly"?R.setMonth(A.getMonth()-1):o==="yearly"&&R.setFullYear(A.getFullYear()-1),{from:R,to:A}},w=(A,R,O)=>{if(!A)return!1;const U=new Date(A).getTime();return!(R&&U<R.getTime()||O&&U>O.getTime())},{from:N,to:k}=h(),v=d.useMemo(()=>{const A=N?new Date(N):null,R=k?new Date(k):null,O=t.filter(U=>w(U.createdAt,A,R)||!A&&!R);return{totalProduction:O.length,adDesign:O.filter(U=>U.type==="Ad").length,bannerDesign:O.filter(U=>U.type==="Banner").length,videoProduction:O.filter(U=>U.type==="Reel"||U.type==="Short"||U.type==="Explainer").length,other:O.filter(U=>U.type==="Other").length,queued:O.filter(U=>U.status==="Queued").length,inProgress:O.filter(U=>U.status==="InProgress"||U.status==="Review").length,done:O.filter(U=>U.status==="Done").length,hold:O.filter(U=>U.status==="Hold").length}},[t,N,k]),g=[{label:"Ad",value:v.adDesign,color:"#3b82f6"},{label:"Banner",value:v.bannerDesign,color:"#10b981"},{label:"Video (Reel/Short/Explainer)",value:v.videoProduction,color:"#f59e0b"},{label:"Other",value:v.other,color:"#6366f1"}].filter(A=>A.value>0),b=g.reduce((A,R)=>A+R.value,0),j=(()=>{if(b===0)return[];let A=-90;return g.map((R,O)=>{const U=R.value/b,I=U*360,M=A*Math.PI/180,V=(A+I)*Math.PI/180,D=50+40*Math.cos(M),E=50+40*Math.sin(M),P=50+40*Math.cos(V),$=50+40*Math.sin(V),L=I>180?1:0,W=["M 50 50",`L ${D} ${E}`,`A 40 40 0 ${L} 1 ${P} ${$}`,"Z"].join(" ");return A+=I,{...R,path:W,percentage:Math.round(U*100)}})})(),S=Math.max(v.queued,v.inProgress,v.done,1),C=[{label:"Queued",value:v.queued,color:"#ef4444",height:v.queued/S*100},{label:"In Progress",value:v.inProgress,color:"#3b82f6",height:v.inProgress/S*100},{label:"Done",value:v.done,color:"#10b981",height:v.done/S*100}];return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Motion Graphics Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Production analytics and performance metrics"})]}),a&&e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm",children:"Updating..."})]})]}),n&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg",children:n}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-navy font-semibold mb-3",children:[e.jsx(fe,{size:20}),e.jsx("span",{children:"Time Period"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("select",{value:o,onChange:A=>i(A.target.value),className:"border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"lifetime",children:"Lifetime"}),e.jsx("option",{value:"custom",children:"Custom Range"})]}),o==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:c,onChange:A=>u(A.target.value),className:"border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-gray-500",children:"to"}),e.jsx("input",{type:"date",value:x,onChange:A=>m(A.target.value),className:"border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm mb-1",children:"Total Production"}),e.jsx("p",{className:"text-4xl font-bold",children:v.totalProduction})]}),e.jsx(Ql,{size:48,className:"text-purple-200 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-xl shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm mb-1",children:"Ad"}),e.jsx("p",{className:"text-4xl font-bold",children:v.adDesign})]}),e.jsx(Gy,{size:48,className:"text-blue-200 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-xl shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm mb-1",children:"Banner"}),e.jsx("p",{className:"text-4xl font-bold",children:v.bannerDesign})]}),e.jsx(Wy,{size:48,className:"text-green-200 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white p-6 rounded-xl shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm mb-1",children:"Video (Reel/Short/Explainer)"}),e.jsx("p",{className:"text-4xl font-bold",children:v.videoProduction})]}),e.jsx(eb,{size:48,className:"text-orange-200 opacity-80"})]})})]}),e.jsx(ib,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-navy mb-4",children:"Production Type Distribution"}),b===0?e.jsx("div",{className:"flex items-center justify-center h-64 text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ql,{size:48,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No production data available"})]})}):e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("svg",{viewBox:"0 0 100 100",className:"w-64 h-64",children:[j.map((A,R)=>e.jsx("g",{children:e.jsx("path",{d:A.path,fill:A.color,stroke:"white",strokeWidth:"0.5",className:"hover:opacity-80 transition-opacity cursor-pointer"})},R)),e.jsx("circle",{cx:"50",cy:"50",r:"20",fill:"white"}),e.jsx("text",{x:"50",y:"47",textAnchor:"middle",fontSize:"4",fontWeight:"600",fill:"#1e3a8a",children:"Total"}),e.jsx("text",{x:"50",y:"55",textAnchor:"middle",fontSize:"8",fontWeight:"700",fill:"#1e3a8a",children:b})]})}),e.jsx("div",{className:"flex-1 space-y-3",children:j.map((A,R)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:A.color}}),e.jsx("span",{className:"text-sm text-gray-700",children:A.label})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"font-bold text-navy",children:A.value}),e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",A.percentage,"%)"]})]})]},R))})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-navy mb-4 flex items-center gap-2",children:[e.jsx(Ot,{size:20}),"Status Distribution"]}),v.totalProduction===0?e.jsx("div",{className:"flex items-center justify-center h-64 text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ot,{size:48,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No status data available"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-end justify-around gap-4 h-64 px-4",children:C.map((A,R)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"text-sm font-bold text-navy",children:A.value}),e.jsx("div",{className:"w-full rounded-t-lg transition-all duration-500 hover:opacity-80",style:{backgroundColor:A.color,height:`${A.height}%`,minHeight:A.value>0?"20px":"0"}}),e.jsx("div",{className:"text-xs text-gray-600 text-center font-medium",children:A.label})]},R))}),e.jsx("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t",children:C.map((A,R)=>e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:A.color}}),e.jsx("span",{className:"text-sm text-gray-600",children:A.label})]}),e.jsx("p",{className:"text-xl font-bold text-navy",children:A.value}),e.jsx("p",{className:"text-xs text-gray-500",children:v.totalProduction>0?`${Math.round(A.value/v.totalProduction*100)}%`:"0%"})]},R))})]})]})]})]})}function ib(){const[t,s]=d.useState("monthly"),[n,r]=d.useState(om()),[a,l]=d.useState(sl()),[o,i]=d.useState(!1),[c,u]=d.useState(""),[x,m]=d.useState(""),p=async()=>{i(!0),u(""),m("");try{let h,w;t==="daily"?(h=sl(),w=sl()):t==="monthly"?(h=om(),w=sl()):t==="custom"&&(h=n,w=a);const[N,k]=await Promise.all([B.listMGWorks().catch(()=>({works:[]})),B.listAllTasks().catch(()=>({tasks:[]}))]),v=(N==null?void 0:N.works)||N||[],g=(k==null?void 0:k.tasks)||[],b=new Date(h),y=new Date(w);y.setHours(23,59,59,999);const j=v.filter(F=>{const z=new Date(F.createdAt||F.date);return z>=b&&z<=y}),S=g.filter(F=>{var ee;const z=new Date(F.createdAt||F.deadline),G=(ee=F.assignedTo)==null?void 0:ee.some(_=>_.role==="MotionGraphics");return z>=b&&z<=y&&G}),C=j.length,A={todo:S.filter(F=>F.status==="To-Do").length,inProgress:S.filter(F=>F.status==="In Progress").length,completed:S.filter(F=>F.status==="Completed").length,total:S.length},R={};j.forEach(F=>{const z=F.type||"Unknown";R[z]=(R[z]||0)+1});const O={};j.forEach(F=>{const z=F.status||"Unknown";O[z]=(O[z]||0)+1});const U={};j.forEach(F=>{const z=F.priority||"Unknown";U[z]=(U[z]||0)+1});const I={};j.forEach(F=>{const z=F.platform||"Unknown";I[z]=(I[z]||0)+1});let M=`Motion Graphics Report
`;M+=`Period: ${h} to ${w}
`,M+=`Generated: ${new Date().toLocaleString()}

`,M+=`=== PRODUCTION SUMMARY ===
`,M+=`Total Production,${C}

`,M+=`=== TASKS ===
`,M+=`Status,Count
`,M+=`To-Do,${A.todo}
`,M+=`In Progress,${A.inProgress}
`,M+=`Completed,${A.completed}
`,M+=`Total,${A.total}

`,S.length>0&&(M+=`Task Details
`,M+=`Task Name,Status,Priority,Deadline,Assigned To
`,S.forEach(F=>{var K;const z=(F.title||"Untitled").replace(/,/g,";"),G=F.status||"N/A",ee=F.priority||"N/A",_=F.deadline?new Date(F.deadline).toLocaleDateString():"N/A",te=((K=F.assignedTo)==null?void 0:K.map(Y=>Y.name||"Unknown").join("; "))||"Unassigned";M+=`"${z}",${G},${ee},${_},"${te}"
`}),M+=`
`),M+=`Production by Type
`,M+=`Type Name,Count
`,Object.entries(R).sort((F,z)=>z[1]-F[1]).forEach(([F,z])=>{M+=`${F},${z}
`}),M+=`
`,M+=`Production by Status
`,M+=`Status,Count
`,Object.entries(O).sort((F,z)=>z[1]-F[1]).forEach(([F,z])=>{M+=`${F},${z}
`}),M+=`
`,M+=`Production by Priority
`,M+=`Priority,Count
`,Object.entries(U).sort((F,z)=>z[1]-F[1]).forEach(([F,z])=>{M+=`${F},${z}
`}),M+=`
`,M+=`Production by Platform
`,M+=`Platform,Count
`,Object.entries(I).sort((F,z)=>z[1]-F[1]).forEach(([F,z])=>{M+=`${F},${z}
`}),M+=`
`,j.length>0&&(M+=`=== DETAILED PRODUCTION LIST ===
`,M+=`Title,Type,Status,Priority,Platform,Assignee,Deadline,Created Date,Notes
`,j.forEach(F=>{var Z;const z=(F.title||"Untitled").replace(/,/g,";"),G=F.type||"N/A",ee=F.status||"N/A",_=F.priority||"N/A",te=F.platform||"N/A",K=((Z=F.assignedTo)==null?void 0:Z.name)||"Unassigned",Y=F.deadline?new Date(F.deadline).toLocaleDateString():"N/A",oe=F.createdAt?new Date(F.createdAt).toLocaleDateString():"N/A",le=(F.notes||F.description||"N/A").replace(/,/g,";").replace(/\n/g," ");M+=`"${z}",${G},${ee},${_},${te},"${K}",${Y},${oe},"${le}"
`}),M+=`
`);const V=j.filter(F=>F.status==="Done"),D=j.filter(F=>F.status==="InProgress"||F.status==="Review"),E=j.filter(F=>F.status==="Queued"),P=j.filter(F=>F.status==="Hold");M+=`=== PERFORMANCE METRICS ===
`,M+=`Metric,Value
`,M+=`Total Production,${C}
`,M+=`Completed Works,${V.length}
`,M+=`In Progress Works,${D.length}
`,M+=`Queued Works,${E.length}
`,M+=`On Hold Works,${P.length}
`,M+=`Production Completion Rate,${C>0?Math.round(V.length/C*100):0}%
`,M+=`Total Tasks,${A.total}
`,M+=`Completed Tasks,${A.completed}
`,M+=`In Progress Tasks,${A.inProgress}
`,M+=`Pending Tasks,${A.todo}
`,M+=`Task Completion Rate,${A.total>0?Math.round(A.completed/A.total*100):0}%
`;const $=new Blob([M],{type:"text/csv;charset=utf-8;"}),L=URL.createObjectURL($),W=document.createElement("a");W.href=L,W.download=`MG_Report_${h}_to_${w}.csv`,W.click(),URL.revokeObjectURL(L),u(" Report downloaded successfully!")}catch(h){m("Failed to download report: "+h.message)}finally{i(!1)}};return e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border-2 border-gray-200 hover:border-purple-300 transition-colors",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-lg shadow-md",children:e.jsx(ts,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent",children:"Download Comprehensive Reports"})]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Export detailed reports including tasks, production works, status, types, and performance metrics"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs("select",{value:t,onChange:h=>s(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-purple-400 focus:border-purple-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"daily",children:"Today"}),e.jsx("option",{value:"monthly",children:"This Month"}),e.jsx("option",{value:"custom",children:"Custom Range"})]}),t==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:n,onChange:h=>r(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-purple-400 focus:border-purple-500 focus:outline-none transition-colors"}),e.jsx("span",{className:"text-gray-500 font-medium self-center",children:"to"}),e.jsx("input",{type:"date",value:a,onChange:h=>l(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-purple-400 focus:border-purple-500 focus:outline-none transition-colors"})]}),e.jsx("button",{onClick:p,disabled:o,className:"px-6 py-2 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl font-bold hover:from-purple-600 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"w-4 h-4"}),"Download Report"]})})]})]}),c&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border-2 border-green-200 rounded-lg",children:e.jsx("p",{className:"text-green-700 font-medium text-sm",children:c})}),x&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border-2 border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium text-sm",children:x})})]})}function yp(){const{user:t}=ge();if((t==null?void 0:t.role)!=="Coordinator"&&(t==null?void 0:t.role)!=="Admin"&&(t==null?void 0:t.role)!=="SuperAdmin")return e.jsx("div",{className:"text-royal",children:"Access denied"});const[s,n]=d.useState(null),[r,a]=d.useState([]),[l,o]=d.useState(!0);if(d.useEffect(()=>{(async()=>{try{const[u,x]=await Promise.all([B.getCoordinatorDashboardStats(),B.getPaymentNotifications()]);n(u),a(x.notifications||[])}catch(u){console.error("Load failed:",u)}finally{o(!1)}})()},[]),l)return e.jsx("div",{className:"p-6",children:"Loading..."});const i=({icon:c,label:u,value:x,color:m,link:p})=>e.jsx(ln,{to:p,className:`bg-white rounded-2xl shadow-soft p-6 hover:shadow-lg transition-shadow border-l-4 ${m}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:u}),e.jsx("p",{className:"text-3xl font-bold text-navy",children:x})]}),e.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center ${m.replace("border-","bg-").replace("-500","-100")}`,children:c})]})});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-navy",children:"Coordinator Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage due fees and payment collections"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx(i,{icon:e.jsx(Me,{size:28,className:"text-blue-600"}),label:"Total Students with Dues",value:(s==null?void 0:s.totalWithDues)||0,color:"border-blue-500",link:"/coordinator/due-fees"}),e.jsx(i,{icon:e.jsx(Ut,{size:28,className:"text-red-600"}),label:"Overdue Payments",value:(s==null?void 0:s.overdue)||0,color:"border-red-500",link:"/coordinator/notifications"}),e.jsx(i,{icon:e.jsx(fe,{size:28,className:"text-orange-600"}),label:"Due This Week",value:(s==null?void 0:s.dueThisWeek)||0,color:"border-orange-500",link:"/coordinator/notifications"}),e.jsx(i,{icon:e.jsx(He,{size:28,className:"text-green-600"}),label:"Total Due Amount",value:` ${((s==null?void 0:s.totalDueAmount)||0).toLocaleString()}`,color:"border-green-500",link:"/coordinator/due-fees"})]}),(t==null?void 0:t.role)==="Coordinator"&&e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-600 rounded-2xl shadow-lg p-6 mb-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ot,{size:40}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold",children:"Your Follow-ups Today"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:(s==null?void 0:s.myFollowUpsToday)||0})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-soft p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-navy flex items-center gap-2",children:[e.jsx(fe,{className:"text-orange-500",size:24}),"Upcoming & Overdue Payments"]}),e.jsx(ln,{to:"/coordinator/notifications",className:"text-blue-600 hover:underline text-sm font-medium",children:"View All"})]}),r.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No upcoming or overdue payments"}):e.jsx("div",{className:"space-y-3",children:r.slice(0,5).map(c=>{var u,x,m,p;return e.jsxs(ln,{to:"/coordinator/due-fees",className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-semibold text-navy",children:[(u=c.lead)==null?void 0:u.leadId,"  ",(x=c.lead)==null?void 0:x.name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[(m=c.lead)==null?void 0:m.phone," ",((p=c.lead)==null?void 0:p.email)&&` ${c.lead.email}`]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Course: ",c.courseName," | Due:  ",c.dueAmount||0]})]}),e.jsxs("div",{className:"text-right ml-4",children:[c.isOverdue?e.jsx("span",{className:"inline-block px-3 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:"Overdue"}):e.jsxs("span",{className:"inline-block px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-xs font-medium",children:[c.daysUntil," days left"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:new Date(c.nextPaymentDate).toLocaleDateString("en-GB")})]})]},c._id)})})]})]})}function db(){return new Date().toISOString().slice(0,10)}function cb(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1).toISOString().slice(0,10)}function ub(){var _,te,K;const[t,s]=d.useState("monthly"),[n,r]=d.useState(cb()),[a,l]=d.useState(db()),[o,i]=d.useState(null),[c,u]=d.useState([]),[x,m]=d.useState([]),[p,h]=d.useState([]),[w,N]=d.useState([]),[k,v]=d.useState([]),[g,b]=d.useState([]),[y,j]=d.useState([]),[S,C]=d.useState([]),[A,R]=d.useState("");function O(){if(t==="custom"&&n&&a)return{from:new Date(n),to:new Date(a)};if(t==="lifetime")return{from:null,to:null};const Y=new Date;let oe=new Date;return t==="daily"?oe.setDate(Y.getDate()-1):t==="weekly"?oe.setDate(Y.getDate()-7):t==="monthly"?oe.setMonth(Y.getMonth()-1):t==="yearly"&&oe.setFullYear(Y.getFullYear()-1),{from:oe,to:Y}}const U=async()=>{try{let Y,oe;if(t==="custom")Y=n,oe=a;else if(t==="lifetime")Y=void 0,oe=void 0;else{const pe=new Date,De=new Date;t==="daily"?De.setDate(pe.getDate()-1):t==="weekly"?De.setDate(pe.getDate()-7):t==="monthly"?De.setMonth(pe.getMonth()-1):t==="yearly"&&De.setFullYear(pe.getFullYear()-1),Y=De.toISOString().slice(0,10),oe=pe.toISOString().slice(0,10)}const le=new Date().toISOString().slice(0,7),[Z,T,H,re,se,me,he,ie,xe]=await Promise.all([B.reportsOverview(Y,oe),B.listCourses().catch(()=>({courses:[]})),B.listLeads().catch(()=>({leads:[]})),B.listAdmissionLeads().catch(()=>({leads:[]})),B.listRecruited().catch(()=>[]),B.listAllTasks().catch(()=>({tasks:[]})),B.listIncome().catch(()=>[]),B.listExpenses().catch(()=>[]),B.getAdmissionTargets(le).catch(()=>({targets:[]}))]);i(Z),u((T==null?void 0:T.courses)||[]),m((H==null?void 0:H.leads)||[]),h((re==null?void 0:re.leads)||[]),N(Array.isArray(se)?se:(se==null?void 0:se.candidates)||[]),v((me==null?void 0:me.tasks)||[]),b(Array.isArray(he)?he:(he==null?void 0:he.income)||[]),j(Array.isArray(ie)?ie:(ie==null?void 0:ie.expenses)||[]),C((xe==null?void 0:xe.targets)||[]),R("")}catch(Y){R(Y.message||"Failed to load")}};d.useEffect(()=>{U()},[]);const{from:I,to:M}=O(),V=d.useMemo(()=>!I&&!M?x:x.filter(Y=>{const oe=new Date(Y.createdAt||Y.date||Y._id&&null);return oe&&(!I||oe>=I)&&(!M||oe<=M)}),[x,I,M]),D=d.useMemo(()=>!I&&!M?p:p.filter(Y=>{const oe=new Date(Y.createdAt||Y.date||Y._id&&null);return oe&&(!I||oe>=I)&&(!M||oe<=M)}),[p,I,M]);d.useMemo(()=>!I&&!M?k:k.filter(Y=>{const oe=new Date(Y.createdAt||Y.deadline||null);return oe&&(!I||oe>=I)&&(!M||oe<=M)}),[k,I,M]);const E=((_=o==null?void 0:o.combined)==null?void 0:_.income)??0,P=((te=o==null?void 0:o.combined)==null?void 0:te.expense)??0,$=((K=o==null?void 0:o.combined)==null?void 0:K.net)??E-P,L=(c||[]).filter(Y=>Y.status==="Active").length,W=V.length,F=D.filter(Y=>(Y.status||"").toLowerCase()==="admitted").length,z=(w||[]).length,G=d.useMemo(()=>{if(!I||!M)return[];const Y=[],oe=new Date(I);for(;oe<=M;){const le=oe.toISOString().slice(0,10),Z=(g||[]).filter(H=>new Date(H.date).toISOString().slice(0,10)===le).reduce((H,re)=>H+(Number(re.amount)||0),0),T=(y||[]).filter(H=>new Date(H.date).toISOString().slice(0,10)===le).reduce((H,re)=>H+(Number(re.amount)||0),0);Y.push({date:le,income:Z,expense:T}),oe.setDate(oe.getDate()+1)}return Y},[g,y,I,M]);d.useMemo(()=>{const Y={};return(y||[]).forEach(oe=>{const le=oe.category||oe.purpose||"Other";Y[le]=(Y[le]||0)+Number(oe.amount||0)}),Y},[y]);const ee=Y=>{var oe;(oe=Y==null?void 0:Y.preventDefault)==null||oe.call(Y),U()};return e.jsxs("div",{className:"space-y-6 p-6 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Admin Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome back! Here's your business overview"})]}),e.jsxs("form",{onSubmit:ee,className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:t,onChange:Y=>s(Y.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"lifetime",children:"Lifetime"}),e.jsx("option",{value:"custom",children:"Custom"})]}),t==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",value:n,onChange:Y=>r(Y.target.value)}),e.jsx("span",{className:"text-gray-500 font-medium",children:"to"}),e.jsx("input",{type:"date",className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",value:a,onChange:Y=>l(Y.target.value)})]}),e.jsx("button",{className:"px-6 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-medium hover:shadow-lg transform hover:-translate-y-0.5 transition-all",children:"Apply"})]})]}),A&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium",children:A})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"group relative bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Ot,{className:"w-5 h-5 text-white"})}),e.jsx(zy,{className:"w-4 h-4 text-white/70"})]}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Total Income"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:Pe(E)})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-red-500 to-pink-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(xp,{className:"w-5 h-5 text-white"})}),e.jsx(_y,{className:"w-4 h-4 text-white/70"})]}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Total Expense"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:Pe(P)})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(He,{className:"w-5 h-5 text-white"})}),e.jsx(us,{className:"w-4 h-4 text-white/70"})]}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Net Balance"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:Pe($)})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Sn,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded-full text-xs text-white font-medium",children:"Active"})]}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Active Courses"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:L})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Me,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded-full text-xs text-white font-medium",children:"Leads"})]}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Total Leads"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:W})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-cyan-500 to-teal-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(jd,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded-full text-xs text-white font-medium",children:"Students"})]}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Admitted Students"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:F})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-pink-500 to-rose-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(er,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"px-2 py-0.5 bg-white/20 rounded-full text-xs text-white font-medium",children:"Team"})]}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Recruited People"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:z})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"col-span-2 bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Income vs Expense"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Financial trend over time"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Income"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Expense"})]})]})]}),e.jsx(mb,{data:G})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg",children:e.jsx(Ht,{className:"text-white",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Admission Targets"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Current month performance (view only)"})]})]}),S.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-xl",children:[e.jsx(Ht,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"No targets set for this month"}),e.jsx("p",{className:"text-sm mt-1",children:"Admins can set targets from the Admission Targets page"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gradient-to-r from-purple-50 to-blue-50",children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-semibold text-gray-700",children:"Course Name"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Target"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Achieved"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Progress"})]})}),e.jsx("tbody",{children:S.map((Y,oe)=>{var H;const le=Y.percentage||0,Z=le>=100?"bg-green-500":le>=75?"bg-blue-500":le>=50?"bg-yellow-500":"bg-red-500",T=le>=100?"text-green-600":le>=75?"text-blue-600":le>=50?"text-yellow-600":"text-red-600";return e.jsxs("tr",{className:`border-b hover:bg-gray-50 transition-colors ${oe%2===0?"bg-white":"bg-gray-50"}`,children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(jd,{size:16,className:"text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-800",children:((H=Y.course)==null?void 0:H.name)||"Unknown Course"})]})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-semibold",children:Y.target})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:`inline-flex items-center justify-center px-3 py-1 ${Z} bg-opacity-10 ${T} rounded-full text-sm font-semibold`,children:Y.achieved})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"flex-1 max-w-xs bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-3 rounded-full ${Z} transition-all duration-500 ease-out`,style:{width:`${Math.min(le,100)}%`}})}),e.jsxs("span",{className:`text-sm font-bold ${T} min-w-[45px] text-right`,children:[le,"%"]})]})})]},Y._id)})})]})})]})]})]})}function mb({data:t}){if(!t||t.length===0)return e.jsx("div",{className:"flex items-center justify-center h-52 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx(us,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No data available"})]})});const a=Math.max(...t.map(x=>Math.max(x.income||0,x.expense||0)),1),l=(600-40*2)/Math.max(1,t.length-1),o=t.map((x,m)=>`${40+m*l},${180-(a?x.income/a*(220-40*2):0)}`).join(" "),i=t.map((x,m)=>`${40+m*l},${180-(a?x.expense/a*(220-40*2):0)}`).join(" "),c=`${o} ${40+(t.length-1)*l},180 40,180`,u=`${i} ${40+(t.length-1)*l},180 40,180`;return e.jsx("div",{className:"relative",children:e.jsxs("svg",{viewBox:"0 0 600 220",className:"w-full h-56",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"incomeGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.05"})]}),e.jsxs("linearGradient",{id:"expenseGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#ef4444",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"#ef4444",stopOpacity:"0.05"})]})]}),[0,.25,.5,.75,1].map((x,m)=>e.jsx("line",{x1:40,y1:180-(220-40*2)*x,x2:560,y2:180-(220-40*2)*x,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"4,4"},m)),e.jsx("polygon",{fill:"url(#incomeGradient)",points:c}),e.jsx("polygon",{fill:"url(#expenseGradient)",points:u}),e.jsx("polyline",{fill:"none",stroke:"#10b981",strokeWidth:"3",points:o,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("polyline",{fill:"none",stroke:"#ef4444",strokeWidth:"3",points:i,strokeLinecap:"round",strokeLinejoin:"round"}),t.map((x,m)=>{const p=40+m*l,h=180-(a?x.income/a*(220-40*2):0),w=180-(a?x.expense/a*(220-40*2):0);return e.jsxs("g",{children:[e.jsx("circle",{cx:p,cy:h,r:"4",fill:"#10b981",stroke:"white",strokeWidth:"2"}),e.jsx("circle",{cx:p,cy:w,r:"4",fill:"#ef4444",stroke:"white",strokeWidth:"2"})]},m)})]})})}function xb({data:t}){if(!t||t.length===0)return e.jsx("div",{className:"flex items-center justify-center h-52 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx(us,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No data available"})]})});const a=Math.max(...t.map(x=>Math.max(x.leads||0,x.admitted||0)),1),l=(700-40*2)/Math.max(1,t.length-1),o=t.map((x,m)=>`${40+m*l},${180-(a?x.leads/a*(220-40*2):0)}`).join(" "),i=t.map((x,m)=>`${40+m*l},${180-(a?x.admitted/a*(220-40*2):0)}`).join(" "),c=`${o} ${40+(t.length-1)*l},180 40,180`,u=`${i} ${40+(t.length-1)*l},180 40,180`;return e.jsx("div",{className:"relative",children:e.jsxs("svg",{viewBox:"0 0 700 220",className:"w-full h-56",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"leadsGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:"0.05"})]}),e.jsxs("linearGradient",{id:"admittedGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:"0.05"})]})]}),[0,.25,.5,.75,1].map((x,m)=>e.jsx("line",{x1:40,y1:180-(220-40*2)*x,x2:660,y2:180-(220-40*2)*x,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"4,4"},m)),e.jsx("polygon",{fill:"url(#leadsGradient)",points:c}),e.jsx("polygon",{fill:"url(#admittedGradient)",points:u}),e.jsx("polyline",{fill:"none",stroke:"#3b82f6",strokeWidth:"3",points:o,strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("polyline",{fill:"none",stroke:"#10b981",strokeWidth:"3",points:i,strokeLinecap:"round",strokeLinejoin:"round"}),t.map((x,m)=>{const p=40+m*l,h=180-(a?x.leads/a*(220-40*2):0),w=180-(a?x.admitted/a*(220-40*2):0);return e.jsxs("g",{children:[e.jsx("circle",{cx:p,cy:h,r:"4",fill:"#3b82f6",stroke:"white",strokeWidth:"2"}),e.jsx("circle",{cx:p,cy:w,r:"4",fill:"#10b981",stroke:"white",strokeWidth:"2"})]},m)})]})})}const im=[{key:"Assigned",label:"Assigned"},{key:"Counseling",label:"Counseling"},{key:"In Follow Up",label:"In Follow-Up"},{key:"Admitted",label:"Admitted"},{key:"Not Admitted",label:"Not Admitted"}];function bp(){var W,F,z,G,ee,_,te,K,Y,oe,le,Z;const{user:t}=ge(),[s,n]=d.useState(""),[r,a]=d.useState("monthly"),[l,o]=d.useState(""),[i,c]=d.useState(""),[u,x]=d.useState([]),[m,p]=d.useState([]),[h,w]=d.useState("All"),[N,k]=d.useState(!1),[v,g]=d.useState([]),[b,y]=d.useState("all"),[j,S]=d.useState(null),[C,A]=d.useState(!1),R=(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin";d.useEffect(()=>{O()},[]);async function O(){k(!0);try{const T=[B.listAdmissionLeads().catch(()=>({leads:[]})),B.listBatches().catch(()=>({batches:[]}))];R&&T.push(B.listAdmissionUsers().catch(()=>({users:[]})));const H=await Promise.all(T),[re,se,me]=H,he=(re==null?void 0:re.leads)||re||[];if(x(Array.isArray(he)?he:[]),p((se==null?void 0:se.batches)||[]),R&&me){const ie=(me==null?void 0:me.users)||[];g(Array.isArray(ie)?ie:[]),U()}n("")}catch(T){n(T.message||"Failed to load")}finally{k(!1)}}async function U(){if(R)try{const{from:T,to:H}=I(),re=T?T.toISOString().slice(0,10):void 0,se=H?H.toISOString().slice(0,10):void 0,me=b==="all"?void 0:b,he=await B.getAdmissionReports(me,re,se);S(he)}catch(T){console.error("Failed to load reports:",T)}}d.useEffect(()=>{R&&v.length>0&&U()},[b,r,l,i]);const I=()=>{if(r==="lifetime")return{from:null,to:null};if(r==="custom"){if(l&&i){const re=new Date(l);re.setHours(0,0,0,0);const se=new Date(i);return se.setHours(23,59,59,999),{from:re,to:se}}return{from:null,to:null}}const T=new Date;let H=new Date;return r==="daily"?H.setDate(T.getDate()-1):r==="weekly"?H.setDate(T.getDate()-7):r==="monthly"?H.setMonth(T.getMonth()-1):r==="yearly"&&H.setFullYear(T.getFullYear()-1),{from:H,to:T}},M=(T,H,re)=>{if(!T)return!1;const se=new Date(T).getTime();return!(H&&se<H.getTime()||re&&se>re.getTime())},{from:V,to:D}=I(),E=ve.useMemo(()=>{const T=V?new Date(V):null,H=D?new Date(D):null,re=u.filter(xe=>M(xe.createdAt,T,H)||!T&&!H),se={};se.Assigned=re.length,im.forEach(xe=>{xe.key!=="Assigned"&&(se[xe.key]=re.filter(pe=>pe.status===xe.key).length)});const me=[];if(T&&H){const xe=new Date(T);for(;xe<=H;){const pe=xe.toISOString().slice(0,10),De=u.filter(Ie=>{const ke=new Date(Ie.createdAt);return ke&&ke.toISOString().slice(0,10)===pe}).length,ft=u.filter(Ie=>{const ke=Ie.admittedAt?new Date(Ie.admittedAt):null;return ke&&ke.toISOString().slice(0,10)===pe}).length;me.push({date:pe,leads:De,admitted:ft}),xe.setDate(xe.getDate()+1)}}const he={totalLeads:re.length,assigned:re.filter(xe=>xe.status==="Assigned").length,counseling:re.filter(xe=>xe.status==="Counseling").length,inFollowUp:re.filter(xe=>xe.status==="In Follow Up").length,admitted:re.filter(xe=>xe.status==="Admitted").length,notAdmitted:re.filter(xe=>xe.status==="Not Admitted").length},ie=he.totalLeads>0?(he.admitted/he.totalLeads*100).toFixed(2):"0.00";return{counts:se,series:me,reportMetrics:he,conversionRate:ie}},[u,V,D]),P=T=>({Assigned:e.jsx(Us,{className:"w-5 h-5 text-white"}),Counseling:e.jsx(Xy,{className:"w-5 h-5 text-white"}),"In Follow Up":e.jsx(Me,{className:"w-5 h-5 text-white"}),Admitted:e.jsx(jd,{className:"w-5 h-5 text-white"}),"Not Admitted":e.jsx(Hr,{className:"w-5 h-5 text-white"})})[T]||e.jsx(Me,{className:"w-5 h-5 text-white"}),$=T=>({Assigned:"from-blue-500 to-indigo-600",Counseling:"from-purple-500 to-violet-600","In Follow Up":"from-orange-500 to-amber-600",Admitted:"from-green-500 to-emerald-600","Not Admitted":"from-red-500 to-pink-600"})[T]||"from-gray-500 to-slate-600",L=()=>{var T,H,re,se,me,he;if(j){A(!0);try{let ie="";b==="all"?(ie=`ADMISSION TEAM REPORT
`,ie+=`Period: ${r==="custom"&&l&&i?`${l} to ${i}`:r}
`,ie+=`Generated: ${new Date().toLocaleString()}

`,ie+=`OVERALL TEAM SUMMARY
`,ie+=`Metric,Value
`,ie+=`Total Leads,${((T=E.reportMetrics)==null?void 0:T.totalLeads)||0}
`,ie+=`Assigned,${((H=E.reportMetrics)==null?void 0:H.assigned)||0}
`,ie+=`Counseling,${((re=E.reportMetrics)==null?void 0:re.counseling)||0}
`,ie+=`In Follow Up,${((se=E.reportMetrics)==null?void 0:se.inFollowUp)||0}
`,ie+=`Admitted,${((me=E.reportMetrics)==null?void 0:me.admitted)||0}
`,ie+=`Not Admitted,${((he=E.reportMetrics)==null?void 0:he.notAdmitted)||0}
`,ie+=`Conversion Rate,${E.conversionRate||"0.00"}%

`,j&&j.reports&&j.reports.length>0&&(ie+=`INDIVIDUAL REPORTS BY TEAM MEMBER

`,[...j.reports].sort((ke,ls)=>ke.user.name.localeCompare(ls.user.name)).forEach((ke,ls)=>{ie+=`${ls+1}. ${ke.user.name.toUpperCase()}
`,ie+=`Email: ${ke.user.email}
`,ie+=`Total Leads,${ke.stats.totalLeads}
`,ie+=`Assigned,${ke.stats.assigned}
`,ie+=`Counseling,${ke.stats.counseling}
`,ie+=`In Follow Up,${ke.stats.inFollowUp}
`,ie+=`Admitted,${ke.stats.admitted}
`,ie+=`Not Admitted,${ke.stats.notAdmitted}
`,ie+=`Conversion Rate,${ke.conversionRate}%

`}))):(ie=`Admission Report - ${j.user.name}
`,ie+=`Email: ${j.user.email}
`,ie+=`Period: ${r==="custom"&&l&&i?`${l} to ${i}`:r}
`,ie+=`Generated: ${new Date().toLocaleString()}

`,ie+=`SUMMARY
`,ie+=`Total Leads,${j.stats.totalLeads}
`,ie+=`Assigned,${j.stats.assigned}
`,ie+=`Counseling,${j.stats.counseling}
`,ie+=`In Follow Up,${j.stats.inFollowUp}
`,ie+=`Admitted,${j.stats.admitted}
`,ie+=`Not Admitted,${j.stats.notAdmitted}
`,ie+=`Conversion Rate,${j.conversionRate}%

`,ie+=`LEAD DETAILS
`,ie+=`Lead ID,Name,Phone,Email,Status,Course,Created At,Admitted At
`,j.leads&&j.leads.length>0&&j.leads.forEach(Ie=>{const ke=[Ie.leadId||"",Ie.name||"",Ie.phone||"",Ie.email||"",Ie.status||"",Ie.interestedCourse||"",Ie.createdAt?new Date(Ie.createdAt).toLocaleDateString():"",Ie.admittedAt?new Date(Ie.admittedAt).toLocaleDateString():""];ie+=ke.map(ls=>`"${ls}"`).join(",")+`
`}));const xe=new Blob([ie],{type:"text/csv;charset=utf-8;"}),pe=document.createElement("a"),De=URL.createObjectURL(xe);pe.setAttribute("href",De);const ft=b==="all"?`admission-report-all-${new Date().toISOString().slice(0,10)}.csv`:`admission-report-${j.user.name.replace(/\s+/g,"-")}-${new Date().toISOString().slice(0,10)}.csv`;pe.setAttribute("download",ft),pe.style.visibility="hidden",document.body.appendChild(pe),pe.click(),document.body.removeChild(pe)}catch(ie){console.error("Download failed:",ie),alert("Failed to download report. Please try again.")}finally{A(!1)}}};return e.jsxs("div",{className:"space-y-6 p-6 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Admission Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track student admissions and pipeline"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:r,onChange:T=>a(T.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"lifetime",children:"Lifetime"}),e.jsx("option",{value:"custom",children:"Custom"})]}),r==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",value:l,onChange:T=>o(T.target.value)}),e.jsx("span",{className:"text-gray-500 font-medium",children:"to"}),e.jsx("input",{type:"date",className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",value:i,onChange:T=>c(T.target.value)})]})]})]}),"      ",s&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium",children:s})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:im.map(T=>e.jsxs("div",{className:`group relative bg-gradient-to-br ${$(T.key)} rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:P(T.key)})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:T.label}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:E.counts[T.key]??0})]})]},T.key))}),m.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Active Batches Overview"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Track progress across all batches"})]}),e.jsxs("select",{value:h,onChange:T=>w(T.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors text-sm",children:[e.jsx("option",{value:"All",children:" All Categories"}),[...new Set(m.filter(T=>T.status==="Active").map(T=>T.category))].map(T=>e.jsxs("option",{value:T,children:[" ",T]},T))]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:m.filter(T=>T.status==="Active"&&(h==="All"||T.category===h)).map(T=>{var me;const H=((me=T.admittedStudents)==null?void 0:me.length)||0,re=T.targetedStudent||0,se=re>0?Math.round(H/re*100):0;return e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg p-3 border border-blue-100 hover:border-blue-300 hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("h4",{className:"font-bold text-gray-800 text-sm mb-1 line-clamp-1",title:T.batchName,children:T.batchName}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"inline-block px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs font-medium",children:T.category}),e.jsx("span",{className:"text-xs font-mono text-gray-500",children:T.batchId.split("-").pop()})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"bg-white rounded p-2 flex-1 text-center",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Target"}),e.jsx("div",{className:"text-lg font-bold text-gray-800",children:re})]}),e.jsxs("div",{className:"bg-white rounded p-2 flex-1 text-center",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Admitted"}),e.jsx("div",{className:"text-lg font-bold text-blue-600",children:H})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:`text-xs font-bold ${se>=100?"text-green-600":se>=75?"text-blue-600":se>=50?"text-yellow-600":"text-orange-600"}`,children:[se,"%"]}),se>=100&&e.jsx("span",{className:"text-xs",children:""})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${se>=100?"bg-gradient-to-r from-green-500 to-emerald-500":se>=75?"bg-gradient-to-r from-blue-500 to-indigo-500":se>=50?"bg-gradient-to-r from-yellow-500 to-amber-500":"bg-gradient-to-r from-orange-500 to-red-500"}`,style:{width:`${Math.min(se,100)}%`}})}),H<re&&e.jsxs("div",{className:"text-center text-xs text-gray-500",children:[re-H," left"]})]})]},T._id)})}),m.filter(T=>T.status==="Active"&&(h==="All"||T.category===h)).length===0&&e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(Me,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:h==="All"?"No active batches available":`No active batches in "${h}" category`})]})]}),R&&e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-xl border border-gray-100",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Admission Team Reports"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Overall performance and individual metrics"})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(Ao,{className:"w-5 h-5 text-gray-500"}),e.jsxs("select",{value:b,onChange:T=>y(T.target.value),className:"flex-1 px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"all",children:" Overall Team Report"}),v.map(T=>e.jsxs("option",{value:T._id,children:[" ",T.name," - Individual Report"]},T._id))]})]}),e.jsxs("button",{onClick:L,disabled:(b==="all"?!E.reportMetrics:!j)||C,className:"flex items-center gap-2 px-6 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-xl font-medium hover:shadow-lg transform hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:[e.jsx(ts,{size:18}),C?"Downloading...":b==="all"?"Download All Team Reports":"Download Individual Report"]})]}),b==="all"&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Me,{size:18,className:"text-purple-600"}),"Overall Team Performance"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 text-center border border-blue-200",children:[e.jsx("div",{className:"text-xs text-blue-600 mb-1 font-medium",children:"Total Leads"}),e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:((W=E.reportMetrics)==null?void 0:W.totalLeads)||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 text-center border border-green-200",children:[e.jsx("div",{className:"text-xs text-green-600 mb-1 font-medium",children:"Admitted"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:((F=E.reportMetrics)==null?void 0:F.admitted)||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 text-center border border-orange-200",children:[e.jsx("div",{className:"text-xs text-orange-600 mb-1 font-medium",children:"In Progress"}),e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:(((z=E.reportMetrics)==null?void 0:z.counseling)||0)+(((G=E.reportMetrics)==null?void 0:G.inFollowUp)||0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 rounded-lg p-4 text-center border border-red-200",children:[e.jsx("div",{className:"text-xs text-red-600 mb-1 font-medium",children:"Not Admitted"}),e.jsx("div",{className:"text-2xl font-bold text-red-700",children:((ee=E.reportMetrics)==null?void 0:ee.notAdmitted)||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 text-center border border-purple-200",children:[e.jsx("div",{className:"text-xs text-purple-600 mb-1 font-medium",children:"Conversion Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-700",children:[E.conversionRate||"0.00","%"]})]})]})]}),j&&b!=="all"&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(er,{size:18,className:"text-blue-600"}),"Individual Report - ",(_=j.user)==null?void 0:_.name,e.jsxs("span",{className:"text-xs font-normal text-gray-500 ml-2",children:["(",(te=j.user)==null?void 0:te.email,")"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Total Leads"}),e.jsx("div",{className:"text-xl font-bold text-blue-600",children:((K=j.stats)==null?void 0:K.totalLeads)||0})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Admitted"}),e.jsx("div",{className:"text-xl font-bold text-green-600",children:((Y=j.stats)==null?void 0:Y.admitted)||0})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"In Progress"}),e.jsx("div",{className:"text-xl font-bold text-orange-600",children:(((oe=j.stats)==null?void 0:oe.counseling)||0)+(((le=j.stats)==null?void 0:le.inFollowUp)||0)})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Not Admitted"}),e.jsx("div",{className:"text-xl font-bold text-red-600",children:((Z=j.stats)==null?void 0:Z.notAdmitted)||0})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Conversion Rate"}),e.jsxs("div",{className:"text-xl font-bold text-purple-600",children:[j.conversionRate||0,"%"]})]})]}),j.leads&&j.leads.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h5",{className:"font-semibold text-gray-700 mb-2 text-sm",children:["Lead Details (",j.leads.length," total)"]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto bg-white rounded-lg border border-gray-200",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left px-3 py-2 text-xs font-semibold text-gray-600",children:"Lead ID"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-semibold text-gray-600",children:"Name"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-semibold text-gray-600",children:"Status"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-semibold text-gray-600",children:"Course"}),e.jsx("th",{className:"text-left px-3 py-2 text-xs font-semibold text-gray-600",children:"Created"})]})}),e.jsx("tbody",{children:j.leads.slice(0,10).map((T,H)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-xs font-mono",children:T.leadId}),e.jsx("td",{className:"px-3 py-2 text-xs",children:T.name}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${T.status==="Admitted"?"bg-green-100 text-green-700":T.status==="Not Admitted"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:T.status})}),e.jsx("td",{className:"px-3 py-2 text-xs",children:T.interestedCourse||"-"}),e.jsx("td",{className:"px-3 py-2 text-xs",children:T.createdAt?new Date(T.createdAt).toLocaleDateString():"-"})]},T._id||H))})]}),j.leads.length>10&&e.jsxs("div",{className:"text-center py-2 text-xs text-gray-500 bg-gray-50",children:["Showing 10 of ",j.leads.length," leads. Download report for complete list."]})]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Leads vs Admitted"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Conversion tracking over time"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Leads"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Admitted"})]})]})]}),e.jsx(xb,{data:E.series})]})]})}function nl(){return new Date().toISOString().slice(0,10)}function dm(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1).toISOString().slice(0,10)}function vp(){const[t,s]=d.useState(""),[n,r]=d.useState("monthly"),[a,l]=d.useState(""),[o,i]=d.useState(""),[c,u]=d.useState([]),[x,m]=d.useState([]),[p,h]=d.useState([]),[w,N]=d.useState(!1);d.useEffect(()=>{v()},[]);const k=()=>{if(n==="lifetime")return{from:null,to:null};if(n==="custom"&&a&&o)return{from:new Date(a),to:new Date(o)};const S=new Date;let C=new Date;return n==="daily"?C.setDate(S.getDate()-1):n==="weekly"?C.setDate(S.getDate()-7):n==="monthly"?C.setMonth(S.getMonth()-1):n==="yearly"&&C.setFullYear(S.getFullYear()-1),{from:C,to:S}};async function v(){N(!0);try{const[S,C,A]=await Promise.all([B.listLeads().catch(()=>({leads:[]})),B.listMyTasks().catch(()=>({tasks:[]})),B.listDMCosts().catch(()=>({items:[]}))]);u((S==null?void 0:S.leads)||[]),m((C==null?void 0:C.tasks)||[]);const R=Array.isArray(A)?A:(A==null?void 0:A.items)||(A==null?void 0:A.costs)||[];h(R||[]),s("")}catch(S){s(S.message||"Failed to load dashboard data")}finally{N(!1)}}const g=(S,C,A)=>{if(!S)return!1;const R=new Date(S).getTime();return!(C&&R<C.getTime()||A&&R>A.getTime())},{from:b,to:y}=k(),j=d.useMemo(()=>{const S=b?new Date(b):null,C=y?new Date(y):null,A=c.filter(P=>g(P.createdAt||P.date||P._id&&null,S,C)||!S&&!C),R=A.length,O={meta:0,linkedin:0,manual:0,others:0};A.forEach(P=>{const $=(P.source||"").toLowerCase();$.includes("meta")?O.meta++:$.includes("linkedin")||$.includes("linked in")?O.linkedin++:$.includes("manual")?O.manual++:O.others++});const U=x.filter(P=>g(P.createdAt||P.createdAt,S,C)||!S&&!C),I=U.filter(P=>(P.status||"").toLowerCase()==="completed").length,V=p.filter(P=>g(P.date||P.createdAt,S,C)||!S&&!C).reduce((P,$)=>P+(Number($.amount)||0),0),D=[];if(S&&C){const P=new Date(S);for(;P<=C;){const $=P.toISOString().slice(0,10),L=c.filter(W=>{const F=new Date(W.createdAt||W.date||W._id&&null);return F&&F.toISOString().slice(0,10)===$}).length;D.push({date:$,value:L}),P.setDate(P.getDate()+1)}}const E=U.filter(P=>{const $=(P.category||"").toLowerCase();return($.includes("content")||$.includes("published"))&&(P.status||"").toLowerCase()==="completed"}).length;return{totalLeads:R,sourceCounts:O,totalTasksCompleted:I,totalExpense:V,series:D,contentPublished:E}},[c,x,p,b,y]);return e.jsxs("div",{className:"space-y-6 p-6 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Digital Marketing Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track your marketing performance"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("select",{value:n,onChange:S=>r(S.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"lifetime",children:"Lifetime"}),e.jsx("option",{value:"custom",children:"Custom"})]}),n==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:a,onChange:S=>l(S.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"}),e.jsx("span",{className:"text-gray-500 font-medium",children:"to"}),e.jsx("input",{type:"date",value:o,onChange:S=>i(S.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"})]})]})]}),t&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium",children:t})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"group relative bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Me,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Total Leads"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:j.totalLeads})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-purple-500 to-violet-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Cc,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Meta Leads"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:j.sourceCounts.meta})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-cyan-500 to-teal-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Ac,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"LinkedIn Leads"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:j.sourceCounts.linkedin})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-orange-500 to-amber-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(St,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Manual Leads"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:j.sourceCounts.manual})]})]}),e.jsxs("div",{className:"group relative bg-gradient-to-br from-red-500 to-pink-600 rounded-xl p-4 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(He,{className:"w-5 h-5 text-white"})})}),e.jsx("p",{className:"text-white/80 text-xs font-medium mb-1",children:"Total Expense"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:Zt(j.totalExpense)})]})]})]}),e.jsx(hb,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"col-span-2 bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Leads Over Time"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Daily lead generation trend"})]})}),e.jsx(pb,{data:j.series})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border border-gray-100",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Lead Sources"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Distribution by channel"})]}),e.jsx(fb,{parts:j.sourceCounts})]})]}),e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl p-6 shadow-xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(Ht,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:"Total Content Published"}),e.jsx("h3",{className:"text-4xl font-bold text-white mt-1",children:j.contentPublished}),e.jsx("p",{className:"text-white/60 text-xs mt-2",children:"Completed content tasks"})]})]})})]})}function hb(){const[t,s]=d.useState("monthly"),[n,r]=d.useState(dm()),[a,l]=d.useState(nl()),[o,i]=d.useState(!1),[c,u]=d.useState(""),[x,m]=d.useState(""),p=async()=>{i(!0),u(""),m("");try{let h,w;t==="daily"?(h=nl(),w=nl()):t==="monthly"?(h=dm(),w=nl()):t==="custom"&&(h=n,w=a);const[N,k,v,g,b]=await Promise.all([B.listLeads().catch(()=>({leads:[]})),B.listAllTasks().catch(()=>({tasks:[]})),B.listDMCosts().catch(()=>({items:[]})),B.listSocial().catch(()=>({metrics:{}})),B.listSEO().catch(()=>({items:[]}))]),y=(N==null?void 0:N.leads)||[],j=(k==null?void 0:k.tasks)||[],S=Array.isArray(v)?v:(v==null?void 0:v.items)||(v==null?void 0:v.costs)||[],C=(g==null?void 0:g.metrics)||{},A=Array.isArray(b)?b:(b==null?void 0:b.items)||(b==null?void 0:b.seo)||[],R=new Date(h),O=new Date(w);O.setHours(23,59,59,999);const U=y.filter(_=>{const te=new Date(_.createdAt||_.date);return te>=R&&te<=O}),I=j.filter(_=>{var K;const te=new Date(_.createdAt||_.deadline);return te>=R&&te<=O&&((K=_.assignedTo)==null?void 0:K.some(Y=>Y.role==="DigitalMarketing"))}),M=S.filter(_=>{const te=new Date(_.date);return te>=R&&te<=O}),V=A.filter(_=>{const te=new Date(_.date);return te>=R&&te<=O}),D=U.length,E={};U.forEach(_=>{const te=_.source||"Unknown";E[te]=(E[te]||0)+1});const P={todo:I.filter(_=>_.status==="To-Do").length,inProgress:I.filter(_=>_.status==="In Progress").length,completed:I.filter(_=>_.status==="Completed").length,total:I.length},$=M.reduce((_,te)=>_+(Number(te.amount)||0),0),L={};M.forEach(_=>{const te=_.purpose||"Others";L[te]=(L[te]||0)+(Number(_.amount)||0)});const W={};V.forEach(_=>{const te=_.typeOfWork||"Others";W[te]=(W[te]||0)+1});let F=`Digital Marketing Report
`;F+=`Period: ${h} to ${w}
`,F+=`Generated: ${new Date().toLocaleString()}

`,F+=`=== LEADS ===
`,F+=`Total Leads,${D}

`,F+=`Leads by Source
`,F+=`Source Name,Number of Leads
`,Object.entries(E).sort((_,te)=>te[1]-_[1]).forEach(([_,te])=>{F+=`${_},${te}
`}),F+=`
`,F+=`=== TASKS ===
`,F+=`Status,Count
`,F+=`To-Do,${P.todo}
`,F+=`In Progress,${P.inProgress}
`,F+=`Completed,${P.completed}
`,F+=`Total,${P.total}

`,I.length>0&&(F+=`Task Details
`,F+=`Task Name,Status,Priority,Deadline,Assigned To
`,I.forEach(_=>{var Z;const te=(_.title||"Untitled").replace(/,/g,";"),K=_.status||"N/A",Y=_.priority||"N/A",oe=_.deadline?new Date(_.deadline).toLocaleDateString():"N/A",le=((Z=_.assignedTo)==null?void 0:Z.map(T=>T.name||"Unknown").join("; "))||"Unassigned";F+=`"${te}",${K},${Y},${oe},"${le}"
`}),F+=`
`),F+=`=== MARKETING EXPENSES ===
`,F+=`Total Cost,${$} BDT

`,F+=`Cost by Purpose Name
`,F+=`Purpose Name,Amount (BDT)
`,Object.entries(L).sort((_,te)=>te[1]-_[1]).forEach(([_,te])=>{F+=`${_},${te}
`}),F+=`
`,F+=`=== SOCIAL MEDIA METRICS ===
`,F+=`Platform,Value
`,F+=`Facebook Followers,${C.facebookFollowers||0}
`,F+=`Instagram Followers,${C.instagramFollowers||0}
`,F+=`Facebook Group Members,${C.facebookGroupMembers||0}
`,F+=`YouTube Subscribers,${C.youtubeSubscribers||0}
`,F+=`LinkedIn Followers,${C.linkedInFollowers||0}
`,F+=`X (Twitter) Followers,${C.xFollowers||0}
`,F+=`Pinterest Views,${C.pinterestView||0}
`,F+=`Blogger Impressions,${C.bloggerImpression||0}
`,F+=`Total Reach,${C.totalReach||0}

`,F+=`=== SEO ACTIVITIES ===
`,F+=`Total Activities,${V.length}

`,F+=`Activities by Type
`,F+=`Type,Count
`,Object.entries(W).forEach(([_,te])=>{F+=`${_},${te}
`}),F+=`
`,V.length>0&&(F+=`SEO Activity Details
`,F+=`Date,Type,Challenge,Details
`,V.forEach(_=>{const te=new Date(_.date).toLocaleDateString(),K=(_.typeOfWork||"").replace(/,/g,";"),Y=(_.challenge||"").replace(/,/g,";").replace(/\n/g," "),oe=(_.details||"").replace(/,/g,";").replace(/\n/g," ");F+=`${te},"${K}","${Y}","${oe}"
`}),F+=`
`),M.length>0&&(F+=`=== DETAILED EXPENSES ===
`,F+=`Date,Purpose Name,Amount (BDT),Notes
`,M.forEach(_=>{const te=new Date(_.date).toLocaleDateString(),K=(_.purpose||"N/A").replace(/,/g,";"),Y=(_.notes||_.description||"N/A").replace(/,/g,";").replace(/\n/g," ");F+=`${te},"${K}",${_.amount||0},"${Y}"
`}));const z=new Blob([F],{type:"text/csv;charset=utf-8;"}),G=URL.createObjectURL(z),ee=document.createElement("a");ee.href=G,ee.download=`DM_Report_${h}_to_${w}.csv`,ee.click(),URL.revokeObjectURL(G),u(" Report downloaded successfully!")}catch(h){m("Failed to download report: "+h.message)}finally{i(!1)}};return e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-xl border-2 border-gray-200 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-md",children:e.jsx(ts,{className:"w-6 h-6 text-white"})}),e.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Download Comprehensive Reports"})]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Export detailed reports including leads, tasks, costs, social metrics, and SEO activities"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs("select",{value:t,onChange:h=>s(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors",children:[e.jsx("option",{value:"daily",children:"Today"}),e.jsx("option",{value:"monthly",children:"This Month"}),e.jsx("option",{value:"custom",children:"Custom Range"})]}),t==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:n,onChange:h=>r(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"}),e.jsx("span",{className:"text-gray-500 font-medium self-center",children:"to"}),e.jsx("input",{type:"date",value:a,onChange:h=>l(h.target.value),className:"px-4 py-2 border-2 border-gray-200 rounded-xl bg-white hover:border-blue-400 focus:border-blue-500 focus:outline-none transition-colors"})]}),e.jsx("button",{onClick:p,disabled:o,className:"px-6 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl font-bold hover:from-blue-600 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"w-4 h-4"}),"Download Report"]})})]})]}),c&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border-2 border-green-200 rounded-lg",children:e.jsx("p",{className:"text-green-700 font-medium text-sm",children:c})}),x&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border-2 border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium text-sm",children:x})})]})}function pb({data:t}){if(!t||t.length===0)return e.jsx("div",{className:"flex items-center justify-center h-52 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx(us,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No data available"})]})});const a=Math.max(...t.map(c=>c.value),1),l=(600-40*2)/Math.max(1,t.length-1),o=t.map((c,u)=>{const x=40+u*l,m=180-(a?c.value/a*(220-40*2):0);return`${x},${m}`}).join(" "),i=`${o} ${40+(t.length-1)*l},180 40,180`;return e.jsx("div",{className:"relative",children:e.jsxs("svg",{viewBox:"0 0 600 220",className:"w-full h-56",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:"0.05"})]})}),[0,.25,.5,.75,1].map((c,u)=>e.jsx("line",{x1:40,y1:180-(220-40*2)*c,x2:560,y2:180-(220-40*2)*c,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"4,4"},u)),e.jsx("polygon",{fill:"url(#lineGradient)",points:i}),e.jsx("polyline",{fill:"none",stroke:"#3b82f6",strokeWidth:"3",points:o,strokeLinecap:"round",strokeLinejoin:"round"}),t.map((c,u)=>{const x=40+u*l,m=180-(a?c.value/a*(220-40*2):0);return e.jsx("circle",{cx:x,cy:m,r:"4",fill:"#3b82f6",stroke:"white",strokeWidth:"2"},u)})]})})}function fb({parts:t}){const s=Object.values(t||{}).reduce((x,m)=>x+(m||0),0),n=Object.entries(t||{});if(s===0)return e.jsx("div",{className:"flex items-center justify-center h-48 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx(us,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No data"})]})});let r=0;const a=160,l=a/2,o=a/2,i=a/2-4,c=i*.6,u=["#3b82f6","#8b5cf6","#06b6d4","#f59e0b"];return e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsxs("svg",{width:a,height:a,viewBox:`0 0 ${a} ${a}`,className:"drop-shadow-md",children:[n.map(([x,m],p)=>{const h=r/s*Math.PI*2;r+=m||0;const w=r/s*Math.PI*2,N=l+i*Math.cos(h-Math.PI/2),k=o+i*Math.sin(h-Math.PI/2),v=l+i*Math.cos(w-Math.PI/2),g=o+i*Math.sin(w-Math.PI/2),b=l+c*Math.cos(h-Math.PI/2),y=o+c*Math.sin(h-Math.PI/2),j=l+c*Math.cos(w-Math.PI/2),S=o+c*Math.sin(w-Math.PI/2),C=w-h>Math.PI?1:0,A=`
              M ${N} ${k}
              A ${i} ${i} 0 ${C} 1 ${v} ${g}
              L ${j} ${S}
              A ${c} ${c} 0 ${C} 0 ${b} ${y}
              Z
            `;return e.jsx("path",{d:A,fill:u[p%u.length],stroke:"#fff",strokeWidth:"2",className:"hover:opacity-80 transition-opacity cursor-pointer"},x)}),e.jsx("circle",{cx:l,cy:o,r:c,fill:"white"}),e.jsx("text",{x:l,y:o-5,textAnchor:"middle",fontSize:"12",fontWeight:"600",fill:"#6b7280",children:"Total"}),e.jsx("text",{x:l,y:o+10,textAnchor:"middle",fontSize:"16",fontWeight:"700",fill:"#1f2937",children:s})]})}),e.jsx("div",{className:"flex flex-col gap-2 w-full",children:n.map(([x,m],p)=>{const h=(m/s*100).toFixed(1);return e.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{background:u[p%u.length]},className:"w-3 h-3 rounded-full shadow-sm"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:x})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[h,"%"]}),e.jsx("span",{className:"text-sm font-bold text-gray-800",children:m})]})]},x)})})]})}function gb(){const[t,s]=d.useState(0);return d.useEffect(()=>{(async()=>{const n=await B.listMyTasks().catch(()=>[]);s((n||[]).filter(r=>(r.status||"").toLowerCase()!=="done").length)})()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-xl font-bold text-navy",children:"My Dashboard"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"text-royal text-sm",children:"My Open Tasks"}),e.jsx("div",{className:"text-3xl font-extrabold",children:t})]})})]})}function yb(){const{user:t}=ge(),s=t==null?void 0:t.role;return s==="SuperAdmin"||s==="Admin"?e.jsx(ub,{}):s==="Accountant"?e.jsx(pp,{}):s==="Recruitment"?e.jsx(fp,{}):s==="MotionGraphics"?e.jsx(gp,{}):s==="Admission"?e.jsx(bp,{}):s==="DigitalMarketing"?e.jsx(vp,{}):s==="Coordinator"?e.jsx(yp,{}):e.jsx(gb,{})}function bb(){const{user:t,updateMe:s}=ge(),[n,r]=d.useState((t==null?void 0:t.name)||""),[a,l]=d.useState((t==null?void 0:t.avatar)||""),[o,i]=d.useState(""),[c,u]=d.useState(""),[x,m]=d.useState(null),[p,h]=d.useState(null),w=async N=>{N.preventDefault(),m(null),h(null);try{const k={name:n,avatar:a};c&&(k.currentPassword=o,k.newPassword=c),await s(k),m("Profile updated"),i(""),u("")}catch(k){h((k==null?void 0:k.message)||"Update failed")}};return e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy mb-4",children:"Edit Profile"}),x&&e.jsx("div",{className:"mb-3 text-green-700",children:x}),p&&e.jsx("div",{className:"mb-3 text-red-600",children:p}),e.jsxs("form",{onSubmit:w,className:"bg-white shadow-soft rounded-2xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:a,alt:"avatar",className:"w-20 h-20 rounded-full object-cover border-2 border-gold"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Avatar URL"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:a,onChange:N=>l(N.target.value)})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Full Name"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:n,onChange:N=>r(N.target.value)})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Current Password"}),e.jsx("input",{type:"password",className:"w-full border rounded-xl px-3 py-2",value:o,onChange:N=>i(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"New Password"}),e.jsx("input",{type:"password",className:"w-full border rounded-xl px-3 py-2",value:c,onChange:N=>u(N.target.value)})]})]}),e.jsx("button",{className:"mt-6 bg-gold text-navy rounded-xl px-5 py-2 font-semibold hover:bg-lightgold",children:"Save Changes"})]})]})}const jp=t=>new Date(t).toISOString().slice(0,16),rl=(t=3)=>{const s=new Date;return s.setDate(s.getDate()+t),jp(s)};function vb(){const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState([]),[l,o]=d.useState("InProgress"),[i,c]=d.useState(!1),[u,x]=d.useState({title:"",description:"",category:"",assignedTo:"",deadline:rl(3)}),[m,p]=d.useState(null),[h,w]=d.useState(null),[N,k]=d.useState(null),v=(t==null?void 0:t.role)==="SuperAdmin"||(t==null?void 0:t.role)==="Admin",g=async()=>{try{const{users:R}=await B.listUsers();n(R)}catch{}},b=async()=>{try{const{tasks:R}=await B.listAllTasks(l);a(R)}catch{}};d.useEffect(()=>{v&&g()},[v]),d.useEffect(()=>{v&&b()},[l,v]);const y=d.useMemo(()=>s.filter(R=>R.role!=="SuperAdmin"),[s]),j=async R=>{R.preventDefault(),w(null),k(null);try{m?(await B.updateTask(m._id,{...u}),k("Task updated")):(await B.assignTask({...u}),k("Task assigned")),c(!1),p(null),x({title:"",description:"",category:"",assignedTo:"",deadline:rl(3)}),b()}catch(O){w((O==null?void 0:O.message)||"Failed to save task")}},S=R=>{var O,U;p(R),x({title:R.title,description:R.description||"",category:R.category||"",assignedTo:Array.isArray(R.assignedTo)?(O=R.assignedTo[0])==null?void 0:O._id:((U=R.assignedTo)==null?void 0:U._id)||"",deadline:R.dueDate?jp(R.dueDate):rl(3)}),c(!0)},C=async R=>{if(confirm("Are you sure you want to delete this task?")){w(null),k(null);try{await B.deleteTask(R),k("Task deleted"),b()}catch(O){w((O==null?void 0:O.message)||"Failed to delete task")}}},A=()=>{c(!1),p(null),x({title:"",description:"",category:"",assignedTo:"",deadline:rl(3)})};return v?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Assign Task"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:l,onChange:R=>o(R.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"InProgress",children:"In Progress"}),e.jsx("option",{value:"Completed",children:"Completed"})]}),e.jsx("button",{onClick:()=>c(!0),className:"bg-gold text-navy rounded-xl px-4 py-2 font-semibold hover:bg-lightgold",children:"+ Assign Task"})]})]}),N&&e.jsx("div",{className:"mb-2 text-green-700",children:N}),h&&e.jsx("div",{className:"mb-2 text-red-600",children:h}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Task"}),e.jsx("th",{className:"text-left p-3",children:"Assignee"}),e.jsx("th",{className:"text-left p-3",children:"Assigned By"}),e.jsx("th",{className:"text-left p-3",children:"Status"}),e.jsx("th",{className:"text-left p-3",children:"Deadline"}),e.jsx("th",{className:"text-center p-3",children:"Actions"})]})}),e.jsxs("tbody",{children:[r.map(R=>{var U,I,M,V,D,E;const O=((U=R.assignedBy)==null?void 0:U._id)===(t==null?void 0:t.id);return e.jsxs("tr",{className:"border-t",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-semibold text-navy",children:R.title}),R.description&&e.jsx("div",{className:"text-royal/80",children:R.description}),R.category&&e.jsxs("div",{className:"text-xs text-royal/70 mt-1",children:["Category: ",R.category]})]}),e.jsxs("td",{className:"p-3",children:[Array.isArray(R.assignedTo)?R.assignedTo.map(P=>P.name).join(", "):(I=R.assignedTo)==null?void 0:I.name," ",e.jsxs("span",{className:"text-xs text-royal/70",children:["(",Array.isArray(R.assignedTo)?(M=R.assignedTo[0])==null?void 0:M.role:(V=R.assignedTo)==null?void 0:V.role,")"]})]}),e.jsxs("td",{className:"p-3",children:[(D=R.assignedBy)==null?void 0:D.name," ",e.jsxs("span",{className:"text-xs text-royal/70",children:["(",(E=R.assignedBy)==null?void 0:E.role,")"]})]}),e.jsx("td",{className:"p-3",children:R.status==="InProgress"||R.status==="In Progress"?"In Progress":R.status==="Completed"?"Completed":R.status}),e.jsx("td",{className:"p-3",children:R.dueDate?new Date(R.dueDate).toLocaleString():R.deadline?new Date(R.deadline).toLocaleString():"-"}),e.jsx("td",{className:"p-3 text-center",children:O?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>S(R),className:"text-blue-600 hover:text-blue-800 px-2 py-1 hover:bg-blue-50 rounded transition-colors text-xs font-medium",title:"Edit Task",children:"Edit"}),e.jsx("button",{onClick:()=>C(R._id),className:"text-red-600 hover:text-red-800 px-2 py-1 hover:bg-red-50 rounded transition-colors text-xs font-medium",title:"Delete Task",children:"Delete"})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})})]},R._id)}),r.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:"6",children:"No tasks"})})]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4 z-50",children:e.jsxs("form",{onSubmit:j,className:"bg-white rounded-2xl shadow-soft p-4 w-full max-w-xl",children:[e.jsx("h2",{className:"text-xl font-bold text-navy mb-3",children:m?"Edit Task":"Assign Task"}),e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Title *"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2 mb-3",value:u.title,onChange:R=>x(O=>({...O,title:R.target.value})),required:!0}),e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border rounded-xl px-3 py-2 mb-3",rows:"3",value:u.description,onChange:R=>x(O=>({...O,description:R.target.value}))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Category"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:u.category,onChange:R=>x(O=>({...O,category:R.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Assign To *"}),e.jsxs("select",{className:"w-full border rounded-xl px-3 py-2",value:u.assignedTo,onChange:R=>x(O=>({...O,assignedTo:R.target.value})),required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Select user"}),y.map(R=>e.jsxs("option",{value:R._id,children:[R.name,"  ",R.role]},R._id))]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Deadline *"}),e.jsx("input",{type:"datetime-local",className:"w-full border rounded-xl px-3 py-2",value:u.deadline,onChange:R=>x(O=>({...O,deadline:R.target.value})),required:!0})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 rounded-xl border hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded-xl bg-gold text-navy font-semibold hover:bg-lightgold",children:m?"Update":"Assign"})]})]})})]}):e.jsx("div",{className:"text-royal",children:"You do not have permission to view this page."})}const jb=3,cm=t=>new Date(t).toLocaleString(),Nb=t=>new Date(t).toISOString().slice(0,16),um=(t=3)=>{const s=new Date;return s.setDate(s.getDate()+t),Nb(s)},wb=(t,s,n)=>{if(s==="Completed")return n&&new Date(n)<=new Date(t)?"bg-green-50":"bg-red-50";const r=new Date,a=new Date(t),l=Math.floor((a-r)/(1e3*60*60*24));return l<=0?"bg-red-50":l<=jb?"bg-yellow-50":""};function Sb(){const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState("InProgress"),[l,o]=d.useState(!1),[i,c]=d.useState(null),[u,x]=d.useState(null),[m,p]=d.useState({title:"",description:"",category:"",deadline:um(3)}),h=t&&t.role!=="SuperAdmin",w=async()=>{try{const{tasks:v}=await B.listMyTasks(r);n(v)}catch{}};d.useEffect(()=>{h&&w()},[r,h]);const N=async v=>{try{const g=v.status==="InProgress"?"Completed":"InProgress";await B.updateTaskStatus(v._id,g),x("Status updated"),w()}catch(g){c((g==null?void 0:g.message)||"Failed to update")}},k=async v=>{v.preventDefault(),c(null),x(null);try{await B.addSelfTask({...m}),o(!1),p({title:"",description:"",category:"",deadline:um(3)}),x("Task added"),w()}catch(g){c((g==null?void 0:g.message)||"Failed to add")}};return h?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"My Task"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:r,onChange:v=>a(v.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"InProgress",children:"In Progress"}),e.jsx("option",{value:"Completed",children:"Completed"})]}),e.jsx("button",{onClick:()=>o(!0),className:"bg-gold text-navy rounded-xl px-4 py-2 font-semibold hover:bg-lightgold",children:"+ Add My Task"})]})]}),u&&e.jsx("div",{className:"mb-2 text-green-700",children:u}),i&&e.jsx("div",{className:"mb-2 text-red-600",children:i}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Task"}),e.jsx("th",{className:"text-left p-3",children:"Assigned By"})," ",e.jsx("th",{className:"text-left p-3",children:"Status"}),e.jsx("th",{className:"text-left p-3",children:"Deadline"}),e.jsx("th",{className:"text-left p-3",children:"Completed"}),e.jsx("th",{className:"text-left p-3",children:"Action"})]})}),e.jsxs("tbody",{children:[s.map(v=>{var g,b;return e.jsxs("tr",{className:`border-t ${wb(v.deadline,v.status,v.completedAt)}`,children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-semibold text-navy",children:v.title}),v.description&&e.jsx("div",{className:"text-royal/80",children:v.description}),v.category&&e.jsxs("div",{className:"text-xs text-royal/70 mt-1",children:["Category: ",v.category]})]}),e.jsxs("td",{className:"p-3",children:[(g=v.assignedBy)==null?void 0:g.name,e.jsxs("span",{className:"text-xs text-royal/70",children:[" (",(b=v.assignedBy)==null?void 0:b.role,")"]})]}),e.jsx("td",{className:"p-3",children:v.status==="InProgress"?"In Progress":"Completed"}),e.jsx("td",{className:"p-3",children:cm(v.deadline)}),e.jsx("td",{className:"p-3",children:v.completedAt?cm(v.completedAt):"-"}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>N(v),className:"px-3 py-1 rounded-lg border hover:bg-[#f3f6ff]",children:v.status==="InProgress"?"Mark Completed":"Mark In-Progress"})})]},v._id)}),s.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:"6",children:"No tasks"})})]})]})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:e.jsxs("form",{onSubmit:k,className:"bg-white rounded-2xl shadow-soft p-4 w-full max-w-xl",children:[e.jsx("h2",{className:"text-xl font-bold text-navy mb-3",children:"Add My Task"}),e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Title *"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2 mb-3",value:m.title,onChange:v=>p(g=>({...g,title:v.target.value})),required:!0}),e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Description"}),e.jsx("textarea",{className:"w-full border rounded-xl px-3 py-2 mb-3",rows:"3",value:m.description,onChange:v=>p(g=>({...g,description:v.target.value}))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Category"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:m.category,onChange:v=>p(g=>({...g,category:v.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Deadline *"}),e.jsx("input",{type:"datetime-local",className:"w-full border rounded-xl px-3 py-2",value:m.deadline,onChange:v=>p(g=>({...g,deadline:v.target.value})),required:!0})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 rounded-xl border",children:"Cancel"}),e.jsx("button",{className:"px-4 py-2 rounded-xl bg-gold text-navy font-semibold hover:bg-lightgold",children:"Add"})]})]})})]}):e.jsx("div",{className:"text-royal",children:"Super Admin has no My Task."})}function kb(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return d.useMemo(()=>r=>{s.forEach(a=>a(r))},s)}const To=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Nr(t){const s=Object.prototype.toString.call(t);return s==="[object Window]"||s==="[object global]"}function Tc(t){return"nodeType"in t}function pt(t){var s,n;return t?Nr(t)?t:Tc(t)&&(s=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?s:window:window}function Ec(t){const{Document:s}=pt(t);return t instanceof s}function Ma(t){return Nr(t)?!1:t instanceof pt(t).HTMLElement}function Np(t){return t instanceof pt(t).SVGElement}function wr(t){return t?Nr(t)?t.document:Tc(t)?Ec(t)?t:Ma(t)||Np(t)?t.ownerDocument:document:document:document}const ns=To?d.useLayoutEffect:d.useEffect;function Eo(t){const s=d.useRef(t);return ns(()=>{s.current=t}),d.useCallback(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return s.current==null?void 0:s.current(...r)},[])}function Cb(){const t=d.useRef(null),s=d.useCallback((r,a)=>{t.current=setInterval(r,a)},[]),n=d.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[s,n]}function wa(t,s){s===void 0&&(s=[t]);const n=d.useRef(t);return ns(()=>{n.current!==t&&(n.current=t)},s),n}function La(t,s){const n=d.useRef();return d.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...s])}function Zl(t){const s=Eo(t),n=d.useRef(null),r=d.useCallback(a=>{a!==n.current&&(s==null||s(a,n.current)),n.current=a},[]);return[n,r]}function eo(t){const s=d.useRef();return d.useEffect(()=>{s.current=t},[t]),s.current}let gi={};function Pa(t,s){return d.useMemo(()=>{if(s)return s;const n=gi[t]==null?0:gi[t]+1;return gi[t]=n,t+"-"+n},[t,s])}function wp(t){return function(s){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.reduce((l,o)=>{const i=Object.entries(o);for(const[c,u]of i){const x=l[c];x!=null&&(l[c]=x+t*u)}return l},{...s})}}const or=wp(1),to=wp(-1);function Ab(t){return"clientX"in t&&"clientY"in t}function Mo(t){if(!t)return!1;const{KeyboardEvent:s}=pt(t.target);return s&&t instanceof s}function Db(t){if(!t)return!1;const{TouchEvent:s}=pt(t.target);return s&&t instanceof s}function so(t){if(Db(t)){if(t.touches&&t.touches.length){const{clientX:s,clientY:n}=t.touches[0];return{x:s,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:s,clientY:n}=t.changedTouches[0];return{x:s,y:n}}}return Ab(t)?{x:t.clientX,y:t.clientY}:null}const un=Object.freeze({Translate:{toString(t){if(!t)return;const{x:s,y:n}=t;return"translate3d("+(s?Math.round(s):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:s,scaleY:n}=t;return"scaleX("+s+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[un.Translate.toString(t),un.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:s,duration:n,easing:r}=t;return s+" "+n+"ms "+r}}}),mm="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Tb(t){return t.matches(mm)?t:t.querySelector(mm)}const Eb={display:"none"};function Mb(t){let{id:s,value:n}=t;return ve.createElement("div",{id:s,style:Eb},n)}function Lb(t){let{id:s,announcement:n,ariaLiveType:r="assertive"}=t;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ve.createElement("div",{id:s,style:a,role:"status","aria-live":r,"aria-atomic":!0},n)}function Pb(){const[t,s]=d.useState("");return{announce:d.useCallback(r=>{r!=null&&s(r)},[]),announcement:t}}const Sp=d.createContext(null);function Ib(t){const s=d.useContext(Sp);d.useEffect(()=>{if(!s)throw new Error("useDndMonitor must be used within a children of <DndContext>");return s(t)},[t,s])}function Rb(){const[t]=d.useState(()=>new Set),s=d.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[d.useCallback(r=>{let{type:a,event:l}=r;t.forEach(o=>{var i;return(i=o[a])==null?void 0:i.call(o,l)})},[t]),s]}const $b={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Fb={onDragStart(t){let{active:s}=t;return"Picked up draggable item "+s.id+"."},onDragOver(t){let{active:s,over:n}=t;return n?"Draggable item "+s.id+" was moved over droppable area "+n.id+".":"Draggable item "+s.id+" is no longer over a droppable area."},onDragEnd(t){let{active:s,over:n}=t;return n?"Draggable item "+s.id+" was dropped over droppable area "+n.id:"Draggable item "+s.id+" was dropped."},onDragCancel(t){let{active:s}=t;return"Dragging was cancelled. Draggable item "+s.id+" was dropped."}};function Ob(t){let{announcements:s=Fb,container:n,hiddenTextDescribedById:r,screenReaderInstructions:a=$b}=t;const{announce:l,announcement:o}=Pb(),i=Pa("DndLiveRegion"),[c,u]=d.useState(!1);if(d.useEffect(()=>{u(!0)},[]),Ib(d.useMemo(()=>({onDragStart(m){let{active:p}=m;l(s.onDragStart({active:p}))},onDragMove(m){let{active:p,over:h}=m;s.onDragMove&&l(s.onDragMove({active:p,over:h}))},onDragOver(m){let{active:p,over:h}=m;l(s.onDragOver({active:p,over:h}))},onDragEnd(m){let{active:p,over:h}=m;l(s.onDragEnd({active:p,over:h}))},onDragCancel(m){let{active:p,over:h}=m;l(s.onDragCancel({active:p,over:h}))}}),[l,s])),!c)return null;const x=ve.createElement(ve.Fragment,null,ve.createElement(Mb,{id:r,value:a.draggable}),ve.createElement(Lb,{id:i,announcement:o}));return n?Kn.createPortal(x,n):x}var Ve;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ve||(Ve={}));function no(){}function _b(t,s){return d.useMemo(()=>({sensor:t,options:s??{}}),[t,s])}function zb(){for(var t=arguments.length,s=new Array(t),n=0;n<t;n++)s[n]=arguments[n];return d.useMemo(()=>[...s].filter(r=>r!=null),[...s])}const rs=Object.freeze({x:0,y:0});function Ub(t,s){return Math.sqrt(Math.pow(t.x-s.x,2)+Math.pow(t.y-s.y,2))}function Bb(t,s){const n=so(t);if(!n)return"0 0";const r={x:(n.x-s.left)/s.width*100,y:(n.y-s.top)/s.height*100};return r.x+"% "+r.y+"%"}function Hb(t,s){let{data:{value:n}}=t,{data:{value:r}}=s;return n-r}function Wb(t,s){let{data:{value:n}}=t,{data:{value:r}}=s;return r-n}function xm(t){let{left:s,top:n,height:r,width:a}=t;return[{x:s,y:n},{x:s+a,y:n},{x:s,y:n+r},{x:s+a,y:n+r}]}function Vb(t,s){if(!t||t.length===0)return null;const[n]=t;return n[s]}const Gb=t=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=t;const a=xm(s),l=[];for(const o of r){const{id:i}=o,c=n.get(i);if(c){const u=xm(c),x=a.reduce((p,h,w)=>p+Ub(u[w],h),0),m=Number((x/4).toFixed(4));l.push({id:i,data:{droppableContainer:o,value:m}})}}return l.sort(Hb)};function Yb(t,s){const n=Math.max(s.top,t.top),r=Math.max(s.left,t.left),a=Math.min(s.left+s.width,t.left+t.width),l=Math.min(s.top+s.height,t.top+t.height),o=a-r,i=l-n;if(r<a&&n<l){const c=s.width*s.height,u=t.width*t.height,x=o*i,m=x/(c+u-x);return Number(m.toFixed(4))}return 0}const qb=t=>{let{collisionRect:s,droppableRects:n,droppableContainers:r}=t;const a=[];for(const l of r){const{id:o}=l,i=n.get(o);if(i){const c=Yb(i,s);c>0&&a.push({id:o,data:{droppableContainer:l,value:c}})}}return a.sort(Wb)};function Jb(t,s,n){return{...t,scaleX:s&&n?s.width/n.width:1,scaleY:s&&n?s.height/n.height:1}}function kp(t,s){return t&&s?{x:t.left-s.left,y:t.top-s.top}:rs}function Qb(t){return function(n){for(var r=arguments.length,a=new Array(r>1?r-1:0),l=1;l<r;l++)a[l-1]=arguments[l];return a.reduce((o,i)=>({...o,top:o.top+t*i.y,bottom:o.bottom+t*i.y,left:o.left+t*i.x,right:o.right+t*i.x}),{...n})}}const Xb=Qb(1);function Cp(t){if(t.startsWith("matrix3d(")){const s=t.slice(9,-1).split(/, /);return{x:+s[12],y:+s[13],scaleX:+s[0],scaleY:+s[5]}}else if(t.startsWith("matrix(")){const s=t.slice(7,-1).split(/, /);return{x:+s[4],y:+s[5],scaleX:+s[0],scaleY:+s[3]}}return null}function Kb(t,s,n){const r=Cp(s);if(!r)return t;const{scaleX:a,scaleY:l,x:o,y:i}=r,c=t.left-o-(1-a)*parseFloat(n),u=t.top-i-(1-l)*parseFloat(n.slice(n.indexOf(" ")+1)),x=a?t.width/a:t.width,m=l?t.height/l:t.height;return{width:x,height:m,top:u,right:c+x,bottom:u+m,left:c}}const Zb={ignoreTransform:!1};function Sr(t,s){s===void 0&&(s=Zb);let n=t.getBoundingClientRect();if(s.ignoreTransform){const{transform:u,transformOrigin:x}=pt(t).getComputedStyle(t);u&&(n=Kb(n,u,x))}const{top:r,left:a,width:l,height:o,bottom:i,right:c}=n;return{top:r,left:a,width:l,height:o,bottom:i,right:c}}function hm(t){return Sr(t,{ignoreTransform:!0})}function ev(t){const s=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:s,bottom:n,width:s,height:n}}function tv(t,s){return s===void 0&&(s=pt(t).getComputedStyle(t)),s.position==="fixed"}function sv(t,s){s===void 0&&(s=pt(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const l=s[a];return typeof l=="string"?n.test(l):!1})}function Mc(t,s){const n=[];function r(a){if(s!=null&&n.length>=s||!a)return n;if(Ec(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!Ma(a)||Np(a)||n.includes(a))return n;const l=pt(t).getComputedStyle(a);return a!==t&&sv(a,l)&&n.push(a),tv(a,l)?n:r(a.parentNode)}return t?r(t):n}function Ap(t){const[s]=Mc(t,1);return s??null}function yi(t){return!To||!t?null:Nr(t)?t:Tc(t)?Ec(t)||t===wr(t).scrollingElement?window:Ma(t)?t:null:null}function Dp(t){return Nr(t)?t.scrollX:t.scrollLeft}function Tp(t){return Nr(t)?t.scrollY:t.scrollTop}function Sd(t){return{x:Dp(t),y:Tp(t)}}var Qe;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Qe||(Qe={}));function Ep(t){return!To||!t?!1:t===document.scrollingElement}function Mp(t){const s={x:0,y:0},n=Ep(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},a=t.scrollTop<=s.y,l=t.scrollLeft<=s.x,o=t.scrollTop>=r.y,i=t.scrollLeft>=r.x;return{isTop:a,isLeft:l,isBottom:o,isRight:i,maxScroll:r,minScroll:s}}const nv={x:.2,y:.2};function rv(t,s,n,r,a){let{top:l,left:o,right:i,bottom:c}=n;r===void 0&&(r=10),a===void 0&&(a=nv);const{isTop:u,isBottom:x,isLeft:m,isRight:p}=Mp(t),h={x:0,y:0},w={x:0,y:0},N={height:s.height*a.y,width:s.width*a.x};return!u&&l<=s.top+N.height?(h.y=Qe.Backward,w.y=r*Math.abs((s.top+N.height-l)/N.height)):!x&&c>=s.bottom-N.height&&(h.y=Qe.Forward,w.y=r*Math.abs((s.bottom-N.height-c)/N.height)),!p&&i>=s.right-N.width?(h.x=Qe.Forward,w.x=r*Math.abs((s.right-N.width-i)/N.width)):!m&&o<=s.left+N.width&&(h.x=Qe.Backward,w.x=r*Math.abs((s.left+N.width-o)/N.width)),{direction:h,speed:w}}function av(t){if(t===document.scrollingElement){const{innerWidth:l,innerHeight:o}=window;return{top:0,left:0,right:l,bottom:o,width:l,height:o}}const{top:s,left:n,right:r,bottom:a}=t.getBoundingClientRect();return{top:s,left:n,right:r,bottom:a,width:t.clientWidth,height:t.clientHeight}}function Lp(t){return t.reduce((s,n)=>or(s,Sd(n)),rs)}function lv(t){return t.reduce((s,n)=>s+Dp(n),0)}function ov(t){return t.reduce((s,n)=>s+Tp(n),0)}function Pp(t,s){if(s===void 0&&(s=Sr),!t)return;const{top:n,left:r,bottom:a,right:l}=s(t);Ap(t)&&(a<=0||l<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const iv=[["x",["left","right"],lv],["y",["top","bottom"],ov]];class Lc{constructor(s,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Mc(n),a=Lp(r);this.rect={...s},this.width=s.width,this.height=s.height;for(const[l,o,i]of iv)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=i(r),x=a[l]-u;return this.rect[c]+x},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ea{constructor(s){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=s}add(s,n,r){var a;(a=this.target)==null||a.addEventListener(s,n,r),this.listeners.push([s,n,r])}}function dv(t){const{EventTarget:s}=pt(t);return t instanceof s?t:wr(t)}function bi(t,s){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof s=="number"?Math.sqrt(n**2+r**2)>s:"x"in s&&"y"in s?n>s.x&&r>s.y:"x"in s?n>s.x:"y"in s?r>s.y:!1}var Pt;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Pt||(Pt={}));function pm(t){t.preventDefault()}function cv(t){t.stopPropagation()}var Ne;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Ne||(Ne={}));const Ip={start:[Ne.Space,Ne.Enter],cancel:[Ne.Esc],end:[Ne.Space,Ne.Enter,Ne.Tab]},uv=(t,s)=>{let{currentCoordinates:n}=s;switch(t.code){case Ne.Right:return{...n,x:n.x+25};case Ne.Left:return{...n,x:n.x-25};case Ne.Down:return{...n,y:n.y+25};case Ne.Up:return{...n,y:n.y-25}}};class Rp{constructor(s){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=s;const{event:{target:n}}=s;this.props=s,this.listeners=new ea(wr(n)),this.windowListeners=new ea(pt(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Pt.Resize,this.handleCancel),this.windowListeners.add(Pt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Pt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:s,onStart:n}=this.props,r=s.node.current;r&&Pp(r),n(rs)}handleKeyDown(s){if(Mo(s)){const{active:n,context:r,options:a}=this.props,{keyboardCodes:l=Ip,coordinateGetter:o=uv,scrollBehavior:i="smooth"}=a,{code:c}=s;if(l.end.includes(c)){this.handleEnd(s);return}if(l.cancel.includes(c)){this.handleCancel(s);return}const{collisionRect:u}=r.current,x=u?{x:u.left,y:u.top}:rs;this.referenceCoordinates||(this.referenceCoordinates=x);const m=o(s,{active:n,context:r.current,currentCoordinates:x});if(m){const p=to(m,x),h={x:0,y:0},{scrollableAncestors:w}=r.current;for(const N of w){const k=s.code,{isTop:v,isRight:g,isLeft:b,isBottom:y,maxScroll:j,minScroll:S}=Mp(N),C=av(N),A={x:Math.min(k===Ne.Right?C.right-C.width/2:C.right,Math.max(k===Ne.Right?C.left:C.left+C.width/2,m.x)),y:Math.min(k===Ne.Down?C.bottom-C.height/2:C.bottom,Math.max(k===Ne.Down?C.top:C.top+C.height/2,m.y))},R=k===Ne.Right&&!g||k===Ne.Left&&!b,O=k===Ne.Down&&!y||k===Ne.Up&&!v;if(R&&A.x!==m.x){const U=N.scrollLeft+p.x,I=k===Ne.Right&&U<=j.x||k===Ne.Left&&U>=S.x;if(I&&!p.y){N.scrollTo({left:U,behavior:i});return}I?h.x=N.scrollLeft-U:h.x=k===Ne.Right?N.scrollLeft-j.x:N.scrollLeft-S.x,h.x&&N.scrollBy({left:-h.x,behavior:i});break}else if(O&&A.y!==m.y){const U=N.scrollTop+p.y,I=k===Ne.Down&&U<=j.y||k===Ne.Up&&U>=S.y;if(I&&!p.x){N.scrollTo({top:U,behavior:i});return}I?h.y=N.scrollTop-U:h.y=k===Ne.Down?N.scrollTop-j.y:N.scrollTop-S.y,h.y&&N.scrollBy({top:-h.y,behavior:i});break}}this.handleMove(s,or(to(m,this.referenceCoordinates),h))}}}handleMove(s,n){const{onMove:r}=this.props;s.preventDefault(),r(n)}handleEnd(s){const{onEnd:n}=this.props;s.preventDefault(),this.detach(),n()}handleCancel(s){const{onCancel:n}=this.props;s.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Rp.activators=[{eventName:"onKeyDown",handler:(t,s,n)=>{let{keyboardCodes:r=Ip,onActivation:a}=s,{active:l}=n;const{code:o}=t.nativeEvent;if(r.start.includes(o)){const i=l.activatorNode.current;return i&&t.target!==i?!1:(t.preventDefault(),a==null||a({event:t.nativeEvent}),!0)}return!1}}];function fm(t){return!!(t&&"distance"in t)}function gm(t){return!!(t&&"delay"in t)}class Pc{constructor(s,n,r){var a;r===void 0&&(r=dv(s.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=s,this.events=n;const{event:l}=s,{target:o}=l;this.props=s,this.events=n,this.document=wr(o),this.documentListeners=new ea(this.document),this.listeners=new ea(r),this.windowListeners=new ea(pt(o)),this.initialCoordinates=(a=so(l))!=null?a:rs,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:s,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(s.move.name,this.handleMove,{passive:!1}),this.listeners.add(s.end.name,this.handleEnd),s.cancel&&this.listeners.add(s.cancel.name,this.handleCancel),this.windowListeners.add(Pt.Resize,this.handleCancel),this.windowListeners.add(Pt.DragStart,pm),this.windowListeners.add(Pt.VisibilityChange,this.handleCancel),this.windowListeners.add(Pt.ContextMenu,pm),this.documentListeners.add(Pt.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(gm(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(fm(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(s,n){const{active:r,onPending:a}=this.props;a(r,s,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:s}=this,{onStart:n}=this.props;s&&(this.activated=!0,this.documentListeners.add(Pt.Click,cv,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Pt.SelectionChange,this.removeTextSelection),n(s))}handleMove(s){var n;const{activated:r,initialCoordinates:a,props:l}=this,{onMove:o,options:{activationConstraint:i}}=l;if(!a)return;const c=(n=so(s))!=null?n:rs,u=to(a,c);if(!r&&i){if(fm(i)){if(i.tolerance!=null&&bi(u,i.tolerance))return this.handleCancel();if(bi(u,i.distance))return this.handleStart()}if(gm(i)&&bi(u,i.tolerance))return this.handleCancel();this.handlePending(i,u);return}s.cancelable&&s.preventDefault(),o(c)}handleEnd(){const{onAbort:s,onEnd:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleCancel(){const{onAbort:s,onCancel:n}=this.props;this.detach(),this.activated||s(this.props.active),n()}handleKeydown(s){s.code===Ne.Esc&&this.handleCancel()}removeTextSelection(){var s;(s=this.document.getSelection())==null||s.removeAllRanges()}}const mv={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ic extends Pc{constructor(s){const{event:n}=s,r=wr(n.target);super(s,mv,r)}}Ic.activators=[{eventName:"onPointerDown",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:r}=s;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const xv={move:{name:"mousemove"},end:{name:"mouseup"}};var kd;(function(t){t[t.RightClick=2]="RightClick"})(kd||(kd={}));class hv extends Pc{constructor(s){super(s,xv,wr(s.event.target))}}hv.activators=[{eventName:"onMouseDown",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:r}=s;return n.button===kd.RightClick?!1:(r==null||r({event:n}),!0)}}];const vi={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class pv extends Pc{constructor(s){super(s,vi)}static setup(){return window.addEventListener(vi.move.name,s,{capture:!1,passive:!1}),function(){window.removeEventListener(vi.move.name,s)};function s(){}}}pv.activators=[{eventName:"onTouchStart",handler:(t,s)=>{let{nativeEvent:n}=t,{onActivation:r}=s;const{touches:a}=n;return a.length>1?!1:(r==null||r({event:n}),!0)}}];var ta;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(ta||(ta={}));var ro;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(ro||(ro={}));function fv(t){let{acceleration:s,activator:n=ta.Pointer,canScroll:r,draggingRect:a,enabled:l,interval:o=5,order:i=ro.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:x,delta:m,threshold:p}=t;const h=yv({delta:m,disabled:!l}),[w,N]=Cb(),k=d.useRef({x:0,y:0}),v=d.useRef({x:0,y:0}),g=d.useMemo(()=>{switch(n){case ta.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case ta.DraggableRect:return a}},[n,a,c]),b=d.useRef(null),y=d.useCallback(()=>{const S=b.current;if(!S)return;const C=k.current.x*v.current.x,A=k.current.y*v.current.y;S.scrollBy(C,A)},[]),j=d.useMemo(()=>i===ro.TreeOrder?[...u].reverse():u,[i,u]);d.useEffect(()=>{if(!l||!u.length||!g){N();return}for(const S of j){if((r==null?void 0:r(S))===!1)continue;const C=u.indexOf(S),A=x[C];if(!A)continue;const{direction:R,speed:O}=rv(S,A,g,s,p);for(const U of["x","y"])h[U][R[U]]||(O[U]=0,R[U]=0);if(O.x>0||O.y>0){N(),b.current=S,w(y,o),k.current=O,v.current=R;return}}k.current={x:0,y:0},v.current={x:0,y:0},N()},[s,y,r,N,l,o,JSON.stringify(g),JSON.stringify(h),w,u,j,x,JSON.stringify(p)])}const gv={x:{[Qe.Backward]:!1,[Qe.Forward]:!1},y:{[Qe.Backward]:!1,[Qe.Forward]:!1}};function yv(t){let{delta:s,disabled:n}=t;const r=eo(s);return La(a=>{if(n||!r||!a)return gv;const l={x:Math.sign(s.x-r.x),y:Math.sign(s.y-r.y)};return{x:{[Qe.Backward]:a.x[Qe.Backward]||l.x===-1,[Qe.Forward]:a.x[Qe.Forward]||l.x===1},y:{[Qe.Backward]:a.y[Qe.Backward]||l.y===-1,[Qe.Forward]:a.y[Qe.Forward]||l.y===1}}},[n,s,r])}function bv(t,s){const n=s!=null?t.get(s):void 0,r=n?n.node.current:null;return La(a=>{var l;return s==null?null:(l=r??a)!=null?l:null},[r,s])}function vv(t,s){return d.useMemo(()=>t.reduce((n,r)=>{const{sensor:a}=r,l=a.activators.map(o=>({eventName:o.eventName,handler:s(o.handler,r)}));return[...n,...l]},[]),[t,s])}var Sa;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Sa||(Sa={}));var Cd;(function(t){t.Optimized="optimized"})(Cd||(Cd={}));const ym=new Map;function jv(t,s){let{dragging:n,dependencies:r,config:a}=s;const[l,o]=d.useState(null),{frequency:i,measure:c,strategy:u}=a,x=d.useRef(t),m=k(),p=wa(m),h=d.useCallback(function(v){v===void 0&&(v=[]),!p.current&&o(g=>g===null?v:g.concat(v.filter(b=>!g.includes(b))))},[p]),w=d.useRef(null),N=La(v=>{if(m&&!n)return ym;if(!v||v===ym||x.current!==t||l!=null){const g=new Map;for(let b of t){if(!b)continue;if(l&&l.length>0&&!l.includes(b.id)&&b.rect.current){g.set(b.id,b.rect.current);continue}const y=b.node.current,j=y?new Lc(c(y),y):null;b.rect.current=j,j&&g.set(b.id,j)}return g}return v},[t,l,n,m,c]);return d.useEffect(()=>{x.current=t},[t]),d.useEffect(()=>{m||h()},[n,m]),d.useEffect(()=>{l&&l.length>0&&o(null)},[JSON.stringify(l)]),d.useEffect(()=>{m||typeof i!="number"||w.current!==null||(w.current=setTimeout(()=>{h(),w.current=null},i))},[i,m,h,...r]),{droppableRects:N,measureDroppableContainers:h,measuringScheduled:l!=null};function k(){switch(u){case Sa.Always:return!1;case Sa.BeforeDragging:return n;default:return!n}}}function Rc(t,s){return La(n=>t?n||(typeof s=="function"?s(t):t):null,[s,t])}function Nv(t,s){return Rc(t,s)}function wv(t){let{callback:s,disabled:n}=t;const r=Eo(s),a=d.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:l}=window;return new l(r)},[r,n]);return d.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Lo(t){let{callback:s,disabled:n}=t;const r=Eo(s),a=d.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:l}=window;return new l(r)},[n]);return d.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Sv(t){return new Lc(Sr(t),t)}function bm(t,s,n){s===void 0&&(s=Sv);const[r,a]=d.useState(null);function l(){a(c=>{if(!t)return null;if(t.isConnected===!1){var u;return(u=c??n)!=null?u:null}const x=s(t);return JSON.stringify(c)===JSON.stringify(x)?c:x})}const o=wv({callback(c){if(t)for(const u of c){const{type:x,target:m}=u;if(x==="childList"&&m instanceof HTMLElement&&m.contains(t)){l();break}}}}),i=Lo({callback:l});return ns(()=>{l(),t?(i==null||i.observe(t),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(i==null||i.disconnect(),o==null||o.disconnect())},[t]),r}function kv(t){const s=Rc(t);return kp(t,s)}const vm=[];function Cv(t){const s=d.useRef(t),n=La(r=>t?r&&r!==vm&&t&&s.current&&t.parentNode===s.current.parentNode?r:Mc(t):vm,[t]);return d.useEffect(()=>{s.current=t},[t]),n}function Av(t){const[s,n]=d.useState(null),r=d.useRef(t),a=d.useCallback(l=>{const o=yi(l.target);o&&n(i=>i?(i.set(o,Sd(o)),new Map(i)):null)},[]);return d.useEffect(()=>{const l=r.current;if(t!==l){o(l);const i=t.map(c=>{const u=yi(c);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,Sd(u)]):null}).filter(c=>c!=null);n(i.length?new Map(i):null),r.current=t}return()=>{o(t),o(l)};function o(i){i.forEach(c=>{const u=yi(c);u==null||u.removeEventListener("scroll",a)})}},[a,t]),d.useMemo(()=>t.length?s?Array.from(s.values()).reduce((l,o)=>or(l,o),rs):Lp(t):rs,[t,s])}function jm(t,s){s===void 0&&(s=[]);const n=d.useRef(null);return d.useEffect(()=>{n.current=null},s),d.useEffect(()=>{const r=t!==rs;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?to(t,n.current):rs}function Dv(t){d.useEffect(()=>{if(!To)return;const s=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of s)n==null||n()}},t.map(s=>{let{sensor:n}=s;return n}))}function Tv(t,s){return d.useMemo(()=>t.reduce((n,r)=>{let{eventName:a,handler:l}=r;return n[a]=o=>{l(o,s)},n},{}),[t,s])}function $p(t){return d.useMemo(()=>t?ev(t):null,[t])}const Nm=[];function Ev(t,s){s===void 0&&(s=Sr);const[n]=t,r=$p(n?pt(n):null),[a,l]=d.useState(Nm);function o(){l(()=>t.length?t.map(c=>Ep(c)?r:new Lc(s(c),c)):Nm)}const i=Lo({callback:o});return ns(()=>{i==null||i.disconnect(),o(),t.forEach(c=>i==null?void 0:i.observe(c))},[t]),a}function Fp(t){if(!t)return null;if(t.children.length>1)return t;const s=t.children[0];return Ma(s)?s:t}function Mv(t){let{measure:s}=t;const[n,r]=d.useState(null),a=d.useCallback(u=>{for(const{target:x}of u)if(Ma(x)){r(m=>{const p=s(x);return m?{...m,width:p.width,height:p.height}:p});break}},[s]),l=Lo({callback:a}),o=d.useCallback(u=>{const x=Fp(u);l==null||l.disconnect(),x&&(l==null||l.observe(x)),r(x?s(x):null)},[s,l]),[i,c]=Zl(o);return d.useMemo(()=>({nodeRef:i,rect:n,setRef:c}),[n,i,c])}const Lv=[{sensor:Ic,options:{}},{sensor:Rp,options:{}}],Pv={current:{}},Nl={draggable:{measure:hm},droppable:{measure:hm,strategy:Sa.WhileDragging,frequency:Cd.Optimized},dragOverlay:{measure:Sr}};class sa extends Map{get(s){var n;return s!=null&&(n=super.get(s))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(s=>{let{disabled:n}=s;return!n})}getNodeFor(s){var n,r;return(n=(r=this.get(s))==null?void 0:r.node.current)!=null?n:void 0}}const Iv={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new sa,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:no},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Nl,measureDroppableContainers:no,windowRect:null,measuringScheduled:!1},Op={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:no,draggableNodes:new Map,over:null,measureDroppableContainers:no},Ia=d.createContext(Op),_p=d.createContext(Iv);function Rv(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new sa}}}function $v(t,s){switch(s.type){case Ve.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:s.initialCoordinates,active:s.active}};case Ve.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:s.coordinates.x-t.draggable.initialCoordinates.x,y:s.coordinates.y-t.draggable.initialCoordinates.y}}};case Ve.DragEnd:case Ve.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ve.RegisterDroppable:{const{element:n}=s,{id:r}=n,a=new sa(t.droppable.containers);return a.set(r,n),{...t,droppable:{...t.droppable,containers:a}}}case Ve.SetDroppableDisabled:{const{id:n,key:r,disabled:a}=s,l=t.droppable.containers.get(n);if(!l||r!==l.key)return t;const o=new sa(t.droppable.containers);return o.set(n,{...l,disabled:a}),{...t,droppable:{...t.droppable,containers:o}}}case Ve.UnregisterDroppable:{const{id:n,key:r}=s,a=t.droppable.containers.get(n);if(!a||r!==a.key)return t;const l=new sa(t.droppable.containers);return l.delete(n),{...t,droppable:{...t.droppable,containers:l}}}default:return t}}function Fv(t){let{disabled:s}=t;const{active:n,activatorEvent:r,draggableNodes:a}=d.useContext(Ia),l=eo(r),o=eo(n==null?void 0:n.id);return d.useEffect(()=>{if(!s&&!r&&l&&o!=null){if(!Mo(l)||document.activeElement===l.target)return;const i=a.get(o);if(!i)return;const{activatorNode:c,node:u}=i;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const x of[c.current,u.current]){if(!x)continue;const m=Tb(x);if(m){m.focus();break}}})}},[r,s,a,o,l]),null}function zp(t,s){let{transform:n,...r}=s;return t!=null&&t.length?t.reduce((a,l)=>l({transform:a,...r}),n):n}function Ov(t){return d.useMemo(()=>({draggable:{...Nl.draggable,...t==null?void 0:t.draggable},droppable:{...Nl.droppable,...t==null?void 0:t.droppable},dragOverlay:{...Nl.dragOverlay,...t==null?void 0:t.dragOverlay}}),[t==null?void 0:t.draggable,t==null?void 0:t.droppable,t==null?void 0:t.dragOverlay])}function _v(t){let{activeNode:s,measure:n,initialRect:r,config:a=!0}=t;const l=d.useRef(!1),{x:o,y:i}=typeof a=="boolean"?{x:a,y:a}:a;ns(()=>{if(!o&&!i||!s){l.current=!1;return}if(l.current||!r)return;const u=s==null?void 0:s.node.current;if(!u||u.isConnected===!1)return;const x=n(u),m=kp(x,r);if(o||(m.x=0),i||(m.y=0),l.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const p=Ap(u);p&&p.scrollBy({top:m.y,left:m.x})}},[s,o,i,r,n])}const Po=d.createContext({...rs,scaleX:1,scaleY:1});var Ws;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Ws||(Ws={}));const zv=d.memo(function(s){var n,r,a,l;let{id:o,accessibility:i,autoScroll:c=!0,children:u,sensors:x=Lv,collisionDetection:m=qb,measuring:p,modifiers:h,...w}=s;const N=d.useReducer($v,void 0,Rv),[k,v]=N,[g,b]=Rb(),[y,j]=d.useState(Ws.Uninitialized),S=y===Ws.Initialized,{draggable:{active:C,nodes:A,translate:R},droppable:{containers:O}}=k,U=C!=null?A.get(C):null,I=d.useRef({initial:null,translated:null}),M=d.useMemo(()=>{var Ye;return C!=null?{id:C,data:(Ye=U==null?void 0:U.data)!=null?Ye:Pv,rect:I}:null},[C,U]),V=d.useRef(null),[D,E]=d.useState(null),[P,$]=d.useState(null),L=wa(w,Object.values(w)),W=Pa("DndDescribedBy",o),F=d.useMemo(()=>O.getEnabled(),[O]),z=Ov(p),{droppableRects:G,measureDroppableContainers:ee,measuringScheduled:_}=jv(F,{dragging:S,dependencies:[R.x,R.y],config:z.droppable}),te=bv(A,C),K=d.useMemo(()=>P?so(P):null,[P]),Y=Oo(),oe=Nv(te,z.draggable.measure);_v({activeNode:C!=null?A.get(C):null,config:Y.layoutShiftCompensation,initialRect:oe,measure:z.draggable.measure});const le=bm(te,z.draggable.measure,oe),Z=bm(te?te.parentElement:null),T=d.useRef({activatorEvent:null,active:null,activeNode:te,collisionRect:null,collisions:null,droppableRects:G,draggableNodes:A,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),H=O.getNodeFor((n=T.current.over)==null?void 0:n.id),re=Mv({measure:z.dragOverlay.measure}),se=(r=re.nodeRef.current)!=null?r:te,me=S?(a=re.rect)!=null?a:le:null,he=!!(re.nodeRef.current&&re.rect),ie=kv(he?null:le),xe=$p(se?pt(se):null),pe=Cv(S?H??te:null),De=Ev(pe),ft=zp(h,{transform:{x:R.x-ie.x,y:R.y-ie.y,scaleX:1,scaleY:1},activatorEvent:P,active:M,activeNodeRect:le,containerNodeRect:Z,draggingNodeRect:me,over:T.current.over,overlayNodeRect:re.rect,scrollableAncestors:pe,scrollableAncestorRects:De,windowRect:xe}),Ie=K?or(K,R):null,ke=Av(pe),ls=jm(ke),gn=jm(ke,[le]),hs=or(ft,ls),rt=me?Xb(me,ft):null,Es=M&&rt?m({active:M,collisionRect:rt,droppableRects:G,droppableContainers:F,pointerCoordinates:Ie}):null,Ms=Vb(Es,"id"),[Et,Ls]=d.useState(null),Ra=he?ft:or(ft,gn),Ro=Jb(Ra,(l=Et==null?void 0:Et.rect)!=null?l:null,le),kr=d.useRef(null),$n=d.useCallback((Ye,Ke)=>{let{sensor:ct,options:Wt}=Ke;if(V.current==null)return;const q=A.get(V.current);if(!q)return;const ae=Ye.nativeEvent,ye=new ct({active:V.current,activeNode:q,event:ae,options:Wt,context:T,onAbort(Ce){if(!A.get(Ce))return;const{onDragAbort:qe}=L.current,Mt={id:Ce};qe==null||qe(Mt),g({type:"onDragAbort",event:Mt})},onPending(Ce,Ze,qe,Mt){if(!A.get(Ce))return;const{onDragPending:Is}=L.current,Rs={id:Ce,constraint:Ze,initialCoordinates:qe,offset:Mt};Is==null||Is(Rs),g({type:"onDragPending",event:Rs})},onStart(Ce){const Ze=V.current;if(Ze==null)return;const qe=A.get(Ze);if(!qe)return;const{onDragStart:Mt}=L.current,Ps={activatorEvent:ae,active:{id:Ze,data:qe.data,rect:I}};Kn.unstable_batchedUpdates(()=>{Mt==null||Mt(Ps),j(Ws.Initializing),v({type:Ve.DragStart,initialCoordinates:Ce,active:Ze}),g({type:"onDragStart",event:Ps}),E(kr.current),$(ae)})},onMove(Ce){v({type:Ve.DragMove,coordinates:Ce})},onEnd:_e(Ve.DragEnd),onCancel:_e(Ve.DragCancel)});kr.current=ye;function _e(Ce){return async function(){const{active:qe,collisions:Mt,over:Ps,scrollAdjustedTranslate:Is}=T.current;let Rs=null;if(qe&&Is){const{cancelDrop:Cr}=L.current;Rs={activatorEvent:ae,active:qe,collisions:Mt,delta:Is,over:Ps},Ce===Ve.DragEnd&&typeof Cr=="function"&&await Promise.resolve(Cr(Rs))&&(Ce=Ve.DragCancel)}V.current=null,Kn.unstable_batchedUpdates(()=>{v({type:Ce}),j(Ws.Uninitialized),Ls(null),E(null),$(null),kr.current=null;const Cr=Ce===Ve.DragEnd?"onDragEnd":"onDragCancel";if(Rs){const _o=L.current[Cr];_o==null||_o(Rs),g({type:Cr,event:Rs})}})}}},[A]),$o=d.useCallback((Ye,Ke)=>(ct,Wt)=>{const q=ct.nativeEvent,ae=A.get(Wt);if(V.current!==null||!ae||q.dndKit||q.defaultPrevented)return;const ye={active:ae};Ye(ct,Ke.options,ye)===!0&&(q.dndKit={capturedBy:Ke.sensor},V.current=Wt,$n(ct,Ke))},[A,$n]),Fn=vv(x,$o);Dv(x),ns(()=>{le&&y===Ws.Initializing&&j(Ws.Initialized)},[le,y]),d.useEffect(()=>{const{onDragMove:Ye}=L.current,{active:Ke,activatorEvent:ct,collisions:Wt,over:q}=T.current;if(!Ke||!ct)return;const ae={active:Ke,activatorEvent:ct,collisions:Wt,delta:{x:hs.x,y:hs.y},over:q};Kn.unstable_batchedUpdates(()=>{Ye==null||Ye(ae),g({type:"onDragMove",event:ae})})},[hs.x,hs.y]),d.useEffect(()=>{const{active:Ye,activatorEvent:Ke,collisions:ct,droppableContainers:Wt,scrollAdjustedTranslate:q}=T.current;if(!Ye||V.current==null||!Ke||!q)return;const{onDragOver:ae}=L.current,ye=Wt.get(Ms),_e=ye&&ye.rect.current?{id:ye.id,rect:ye.rect.current,data:ye.data,disabled:ye.disabled}:null,Ce={active:Ye,activatorEvent:Ke,collisions:ct,delta:{x:q.x,y:q.y},over:_e};Kn.unstable_batchedUpdates(()=>{Ls(_e),ae==null||ae(Ce),g({type:"onDragOver",event:Ce})})},[Ms]),ns(()=>{T.current={activatorEvent:P,active:M,activeNode:te,collisionRect:rt,collisions:Es,droppableRects:G,draggableNodes:A,draggingNode:se,draggingNodeRect:me,droppableContainers:O,over:Et,scrollableAncestors:pe,scrollAdjustedTranslate:hs},I.current={initial:me,translated:rt}},[M,te,Es,rt,A,se,me,G,O,Et,pe,hs]),fv({...Y,delta:R,draggingRect:rt,pointerCoordinates:Ie,scrollableAncestors:pe,scrollableAncestorRects:De});const $a=d.useMemo(()=>({active:M,activeNode:te,activeNodeRect:le,activatorEvent:P,collisions:Es,containerNodeRect:Z,dragOverlay:re,draggableNodes:A,droppableContainers:O,droppableRects:G,over:Et,measureDroppableContainers:ee,scrollableAncestors:pe,scrollableAncestorRects:De,measuringConfiguration:z,measuringScheduled:_,windowRect:xe}),[M,te,le,P,Es,Z,re,A,O,G,Et,ee,pe,De,z,_,xe]),Fo=d.useMemo(()=>({activatorEvent:P,activators:Fn,active:M,activeNodeRect:le,ariaDescribedById:{draggable:W},dispatch:v,draggableNodes:A,over:Et,measureDroppableContainers:ee}),[P,Fn,M,le,v,W,A,Et,ee]);return ve.createElement(Sp.Provider,{value:b},ve.createElement(Ia.Provider,{value:Fo},ve.createElement(_p.Provider,{value:$a},ve.createElement(Po.Provider,{value:Ro},u)),ve.createElement(Fv,{disabled:(i==null?void 0:i.restoreFocus)===!1})),ve.createElement(Ob,{...i,hiddenTextDescribedById:W}));function Oo(){const Ye=(D==null?void 0:D.autoScrollEnabled)===!1,Ke=typeof c=="object"?c.enabled===!1:c===!1,ct=S&&!Ye&&!Ke;return typeof c=="object"?{...c,enabled:ct}:{enabled:ct}}}),Uv=d.createContext(null),wm="button",Bv="Draggable";function Hv(t){let{id:s,data:n,disabled:r=!1,attributes:a}=t;const l=Pa(Bv),{activators:o,activatorEvent:i,active:c,activeNodeRect:u,ariaDescribedById:x,draggableNodes:m,over:p}=d.useContext(Ia),{role:h=wm,roleDescription:w="draggable",tabIndex:N=0}=a??{},k=(c==null?void 0:c.id)===s,v=d.useContext(k?Po:Uv),[g,b]=Zl(),[y,j]=Zl(),S=Tv(o,s),C=wa(n);ns(()=>(m.set(s,{id:s,key:l,node:g,activatorNode:y,data:C}),()=>{const R=m.get(s);R&&R.key===l&&m.delete(s)}),[m,s]);const A=d.useMemo(()=>({role:h,tabIndex:N,"aria-disabled":r,"aria-pressed":k&&h===wm?!0:void 0,"aria-roledescription":w,"aria-describedby":x.draggable}),[r,h,N,k,w,x.draggable]);return{active:c,activatorEvent:i,activeNodeRect:u,attributes:A,isDragging:k,listeners:r?void 0:S,node:g,over:p,setNodeRef:b,setActivatorNodeRef:j,transform:v}}function Up(){return d.useContext(_p)}const Wv="Droppable",Vv={timeout:25};function Gv(t){let{data:s,disabled:n=!1,id:r,resizeObserverConfig:a}=t;const l=Pa(Wv),{active:o,dispatch:i,over:c,measureDroppableContainers:u}=d.useContext(Ia),x=d.useRef({disabled:n}),m=d.useRef(!1),p=d.useRef(null),h=d.useRef(null),{disabled:w,updateMeasurementsFor:N,timeout:k}={...Vv,...a},v=wa(N??r),g=d.useCallback(()=>{if(!m.current){m.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{u(Array.isArray(v.current)?v.current:[v.current]),h.current=null},k)},[k]),b=Lo({callback:g,disabled:w||!o}),y=d.useCallback((A,R)=>{b&&(R&&(b.unobserve(R),m.current=!1),A&&b.observe(A))},[b]),[j,S]=Zl(y),C=wa(s);return d.useEffect(()=>{!b||!j.current||(b.disconnect(),m.current=!1,b.observe(j.current))},[j,b]),d.useEffect(()=>(i({type:Ve.RegisterDroppable,element:{id:r,key:l,disabled:n,node:j,rect:p,data:C}}),()=>i({type:Ve.UnregisterDroppable,key:l,id:r})),[r]),d.useEffect(()=>{n!==x.current.disabled&&(i({type:Ve.SetDroppableDisabled,id:r,key:l,disabled:n}),x.current.disabled=n)},[r,l,n,i]),{active:o,rect:p,isOver:(c==null?void 0:c.id)===r,node:j,over:c,setNodeRef:S}}function Yv(t){let{animation:s,children:n}=t;const[r,a]=d.useState(null),[l,o]=d.useState(null),i=eo(n);return!n&&!r&&i&&a(i),ns(()=>{if(!l)return;const c=r==null?void 0:r.key,u=r==null?void 0:r.props.id;if(c==null||u==null){a(null);return}Promise.resolve(s(u,l)).then(()=>{a(null)})},[s,r,l]),ve.createElement(ve.Fragment,null,n,r?d.cloneElement(r,{ref:o}):null)}const qv={x:0,y:0,scaleX:1,scaleY:1};function Jv(t){let{children:s}=t;return ve.createElement(Ia.Provider,{value:Op},ve.createElement(Po.Provider,{value:qv},s))}const Qv={position:"fixed",touchAction:"none"},Xv=t=>Mo(t)?"transform 250ms ease":void 0,Kv=d.forwardRef((t,s)=>{let{as:n,activatorEvent:r,adjustScale:a,children:l,className:o,rect:i,style:c,transform:u,transition:x=Xv}=t;if(!i)return null;const m=a?u:{...u,scaleX:1,scaleY:1},p={...Qv,width:i.width,height:i.height,top:i.top,left:i.left,transform:un.Transform.toString(m),transformOrigin:a&&r?Bb(r,i):void 0,transition:typeof x=="function"?x(r):x,...c};return ve.createElement(n,{className:o,style:p,ref:s},l)}),Zv=t=>s=>{let{active:n,dragOverlay:r}=s;const a={},{styles:l,className:o}=t;if(l!=null&&l.active)for(const[i,c]of Object.entries(l.active))c!==void 0&&(a[i]=n.node.style.getPropertyValue(i),n.node.style.setProperty(i,c));if(l!=null&&l.dragOverlay)for(const[i,c]of Object.entries(l.dragOverlay))c!==void 0&&r.node.style.setProperty(i,c);return o!=null&&o.active&&n.node.classList.add(o.active),o!=null&&o.dragOverlay&&r.node.classList.add(o.dragOverlay),function(){for(const[c,u]of Object.entries(a))n.node.style.setProperty(c,u);o!=null&&o.active&&n.node.classList.remove(o.active)}},ej=t=>{let{transform:{initial:s,final:n}}=t;return[{transform:un.Transform.toString(s)},{transform:un.Transform.toString(n)}]},tj={duration:250,easing:"ease",keyframes:ej,sideEffects:Zv({styles:{active:{opacity:"0"}}})};function sj(t){let{config:s,draggableNodes:n,droppableContainers:r,measuringConfiguration:a}=t;return Eo((l,o)=>{if(s===null)return;const i=n.get(l);if(!i)return;const c=i.node.current;if(!c)return;const u=Fp(o);if(!u)return;const{transform:x}=pt(o).getComputedStyle(o),m=Cp(x);if(!m)return;const p=typeof s=="function"?s:nj(s);return Pp(c,a.draggable.measure),p({active:{id:l,data:i.data,node:c,rect:a.draggable.measure(c)},draggableNodes:n,dragOverlay:{node:o,rect:a.dragOverlay.measure(u)},droppableContainers:r,measuringConfiguration:a,transform:m})})}function nj(t){const{duration:s,easing:n,sideEffects:r,keyframes:a}={...tj,...t};return l=>{let{active:o,dragOverlay:i,transform:c,...u}=l;if(!s)return;const x={x:i.rect.left-o.rect.left,y:i.rect.top-o.rect.top},m={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/i.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/i.rect.height:1},p={x:c.x-x.x,y:c.y-x.y,...m},h=a({...u,active:o,dragOverlay:i,transform:{initial:c,final:p}}),[w]=h,N=h[h.length-1];if(JSON.stringify(w)===JSON.stringify(N))return;const k=r==null?void 0:r({active:o,dragOverlay:i,...u}),v=i.node.animate(h,{duration:s,easing:n,fill:"forwards"});return new Promise(g=>{v.onfinish=()=>{k==null||k(),g()}})}}let Sm=0;function rj(t){return d.useMemo(()=>{if(t!=null)return Sm++,Sm},[t])}const aj=ve.memo(t=>{let{adjustScale:s=!1,children:n,dropAnimation:r,style:a,transition:l,modifiers:o,wrapperElement:i="div",className:c,zIndex:u=999}=t;const{activatorEvent:x,active:m,activeNodeRect:p,containerNodeRect:h,draggableNodes:w,droppableContainers:N,dragOverlay:k,over:v,measuringConfiguration:g,scrollableAncestors:b,scrollableAncestorRects:y,windowRect:j}=Up(),S=d.useContext(Po),C=rj(m==null?void 0:m.id),A=zp(o,{activatorEvent:x,active:m,activeNodeRect:p,containerNodeRect:h,draggingNodeRect:k.rect,over:v,overlayNodeRect:k.rect,scrollableAncestors:b,scrollableAncestorRects:y,transform:S,windowRect:j}),R=Rc(p),O=sj({config:r,draggableNodes:w,droppableContainers:N,measuringConfiguration:g}),U=R?k.setRef:void 0;return ve.createElement(Jv,null,ve.createElement(Yv,{animation:O},m&&C?ve.createElement(Kv,{key:C,id:m.id,ref:U,as:i,activatorEvent:x,adjustScale:s,className:c,transition:l,rect:R,style:{zIndex:u,...a},transform:A},n):null))});function Bp(t,s,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(s,1)[0]),r}function lj(t,s){return t.reduce((n,r,a)=>{const l=s.get(r);return l&&(n[a]=l),n},Array(t.length))}function al(t){return t!==null&&t>=0}function oj(t,s){if(t===s)return!0;if(t.length!==s.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==s[n])return!1;return!0}function ij(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const Hp=t=>{let{rects:s,activeIndex:n,overIndex:r,index:a}=t;const l=Bp(s,r,n),o=s[a],i=l[a];return!i||!o?null:{x:i.left-o.left,y:i.top-o.top,scaleX:i.width/o.width,scaleY:i.height/o.height}},ll={scaleX:1,scaleY:1},dj=t=>{var s;let{activeIndex:n,activeNodeRect:r,index:a,rects:l,overIndex:o}=t;const i=(s=l[n])!=null?s:r;if(!i)return null;if(a===n){const u=l[o];return u?{x:0,y:n<o?u.top+u.height-(i.top+i.height):u.top-i.top,...ll}:null}const c=cj(l,a,n);return a>n&&a<=o?{x:0,y:-i.height-c,...ll}:a<n&&a>=o?{x:0,y:i.height+c,...ll}:{x:0,y:0,...ll}};function cj(t,s,n){const r=t[s],a=t[s-1],l=t[s+1];return r?n<s?a?r.top-(a.top+a.height):l?l.top-(r.top+r.height):0:l?l.top-(r.top+r.height):a?r.top-(a.top+a.height):0:0}const Wp="Sortable",Vp=ve.createContext({activeIndex:-1,containerId:Wp,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Hp,disabled:{draggable:!1,droppable:!1}});function uj(t){let{children:s,id:n,items:r,strategy:a=Hp,disabled:l=!1}=t;const{active:o,dragOverlay:i,droppableRects:c,over:u,measureDroppableContainers:x}=Up(),m=Pa(Wp,n),p=i.rect!==null,h=d.useMemo(()=>r.map(S=>typeof S=="object"&&"id"in S?S.id:S),[r]),w=o!=null,N=o?h.indexOf(o.id):-1,k=u?h.indexOf(u.id):-1,v=d.useRef(h),g=!oj(h,v.current),b=k!==-1&&N===-1||g,y=ij(l);ns(()=>{g&&w&&x(h)},[g,h,w,x]),d.useEffect(()=>{v.current=h},[h]);const j=d.useMemo(()=>({activeIndex:N,containerId:m,disabled:y,disableTransforms:b,items:h,overIndex:k,useDragOverlay:p,sortedRects:lj(h,c),strategy:a}),[N,m,y.draggable,y.droppable,b,h,k,c,p,a]);return ve.createElement(Vp.Provider,{value:j},s)}const mj=t=>{let{id:s,items:n,activeIndex:r,overIndex:a}=t;return Bp(n,r,a).indexOf(s)},xj=t=>{let{containerId:s,isSorting:n,wasDragging:r,index:a,items:l,newIndex:o,previousItems:i,previousContainerId:c,transition:u}=t;return!u||!r||i!==l&&a===o?!1:n?!0:o!==a&&s===c},hj={duration:200,easing:"ease"},Gp="transform",pj=un.Transition.toString({property:Gp,duration:0,easing:"linear"}),fj={roleDescription:"sortable"};function gj(t){let{disabled:s,index:n,node:r,rect:a}=t;const[l,o]=d.useState(null),i=d.useRef(n);return ns(()=>{if(!s&&n!==i.current&&r.current){const c=a.current;if(c){const u=Sr(r.current,{ignoreTransform:!0}),x={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(x.x||x.y)&&o(x)}}n!==i.current&&(i.current=n)},[s,n,r,a]),d.useEffect(()=>{l&&o(null)},[l]),l}function Yp(t){let{animateLayoutChanges:s=xj,attributes:n,disabled:r,data:a,getNewIndex:l=mj,id:o,strategy:i,resizeObserverConfig:c,transition:u=hj}=t;const{items:x,containerId:m,activeIndex:p,disabled:h,disableTransforms:w,sortedRects:N,overIndex:k,useDragOverlay:v,strategy:g}=d.useContext(Vp),b=yj(r,h),y=x.indexOf(o),j=d.useMemo(()=>({sortable:{containerId:m,index:y,items:x},...a}),[m,a,y,x]),S=d.useMemo(()=>x.slice(x.indexOf(o)),[x,o]),{rect:C,node:A,isOver:R,setNodeRef:O}=Gv({id:o,data:j,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...c}}),{active:U,activatorEvent:I,activeNodeRect:M,attributes:V,setNodeRef:D,listeners:E,isDragging:P,over:$,setActivatorNodeRef:L,transform:W}=Hv({id:o,data:j,attributes:{...fj,...n},disabled:b.draggable}),F=kb(O,D),z=!!U,G=z&&!w&&al(p)&&al(k),ee=!v&&P,_=ee&&G?W:null,K=G?_??(i??g)({rects:N,activeNodeRect:M,activeIndex:p,overIndex:k,index:y}):null,Y=al(p)&&al(k)?l({id:o,items:x,activeIndex:p,overIndex:k}):y,oe=U==null?void 0:U.id,le=d.useRef({activeId:oe,items:x,newIndex:Y,containerId:m}),Z=x!==le.current.items,T=s({active:U,containerId:m,isDragging:P,isSorting:z,id:o,index:y,items:x,newIndex:le.current.newIndex,previousItems:le.current.items,previousContainerId:le.current.containerId,transition:u,wasDragging:le.current.activeId!=null}),H=gj({disabled:!T,index:y,node:A,rect:C});return d.useEffect(()=>{z&&le.current.newIndex!==Y&&(le.current.newIndex=Y),m!==le.current.containerId&&(le.current.containerId=m),x!==le.current.items&&(le.current.items=x)},[z,Y,m,x]),d.useEffect(()=>{if(oe===le.current.activeId)return;if(oe!=null&&le.current.activeId==null){le.current.activeId=oe;return}const se=setTimeout(()=>{le.current.activeId=oe},50);return()=>clearTimeout(se)},[oe]),{active:U,activeIndex:p,attributes:V,data:j,rect:C,index:y,newIndex:Y,items:x,isOver:R,isSorting:z,isDragging:P,listeners:E,node:A,overIndex:k,over:$,setNodeRef:F,setActivatorNodeRef:L,setDroppableNodeRef:O,setDraggableNodeRef:D,transform:H??K,transition:re()};function re(){if(H||Z&&le.current.newIndex===y)return pj;if(!(ee&&!Mo(I)||!u)&&(z||T))return un.Transition.toString({...u,property:Gp})}}function yj(t,s){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t==null?void 0:t.draggable)!=null?n:s.draggable,droppable:(r=t==null?void 0:t.droppable)!=null?r:s.droppable}}Ne.Down,Ne.Right,Ne.Up,Ne.Left;const qp=6048e5,bj=864e5,km=Symbol.for("constructDateFrom");function mn(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&km in t?t[km](s):t instanceof Date?new t.constructor(s):new Date(s)}function as(t,s){return mn(s||t,t)}let vj={};function Io(){return vj}function ka(t,s){var i,c,u,x;const n=Io(),r=(s==null?void 0:s.weekStartsOn)??((c=(i=s==null?void 0:s.locale)==null?void 0:i.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((x=(u=n.locale)==null?void 0:u.options)==null?void 0:x.weekStartsOn)??0,a=as(t,s==null?void 0:s.in),l=a.getDay(),o=(l<r?7:0)+l-r;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function ao(t,s){return ka(t,{...s,weekStartsOn:1})}function Jp(t,s){const n=as(t,s==null?void 0:s.in),r=n.getFullYear(),a=mn(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const l=ao(a),o=mn(n,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const i=ao(o);return n.getTime()>=l.getTime()?r+1:n.getTime()>=i.getTime()?r:r-1}function Cm(t){const s=as(t),n=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return n.setUTCFullYear(s.getFullYear()),+t-+n}function jj(t,...s){const n=mn.bind(null,s.find(r=>typeof r=="object"));return s.map(n)}function Am(t,s){const n=as(t,s==null?void 0:s.in);return n.setHours(0,0,0,0),n}function Nj(t,s,n){const[r,a]=jj(n==null?void 0:n.in,t,s),l=Am(r),o=Am(a),i=+l-Cm(l),c=+o-Cm(o);return Math.round((i-c)/bj)}function wj(t,s){const n=Jp(t,s),r=mn(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),ao(r)}function Sj(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function kj(t){return!(!Sj(t)&&typeof t!="number"||isNaN(+as(t)))}function Cj(t,s){const n=as(t,s==null?void 0:s.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const Aj={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Dj=(t,s,n)=>{let r;const a=Aj[t];return typeof a=="string"?r=a:s===1?r=a.one:r=a.other.replace("{{count}}",s.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function ji(t){return(s={})=>{const n=s.width?String(s.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const Tj={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ej={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Mj={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Lj={date:ji({formats:Tj,defaultWidth:"full"}),time:ji({formats:Ej,defaultWidth:"full"}),dateTime:ji({formats:Mj,defaultWidth:"full"})},Pj={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Ij=(t,s,n,r)=>Pj[t];function Rr(t){return(s,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,i=n!=null&&n.width?String(n.width):o;a=t.formattingValues[i]||t.formattingValues[o]}else{const o=t.defaultWidth,i=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[i]||t.values[o]}const l=t.argumentCallback?t.argumentCallback(s):s;return a[l]}}const Rj={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},$j={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Fj={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Oj={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_j={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},zj={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Uj=(t,s)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Bj={ordinalNumber:Uj,era:Rr({values:Rj,defaultWidth:"wide"}),quarter:Rr({values:$j,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Rr({values:Fj,defaultWidth:"wide"}),day:Rr({values:Oj,defaultWidth:"wide"}),dayPeriod:Rr({values:_j,defaultWidth:"wide",formattingValues:zj,defaultFormattingWidth:"wide"})};function $r(t){return(s,n={})=>{const r=n.width,a=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],l=s.match(a);if(!l)return null;const o=l[0],i=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(i)?Wj(i,m=>m.test(o)):Hj(i,m=>m.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;const x=s.slice(o.length);return{value:u,rest:x}}}function Hj(t,s){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&s(t[n]))return n}function Wj(t,s){for(let n=0;n<t.length;n++)if(s(t[n]))return n}function Vj(t){return(s,n={})=>{const r=s.match(t.matchPattern);if(!r)return null;const a=r[0],l=s.match(t.parsePattern);if(!l)return null;let o=t.valueCallback?t.valueCallback(l[0]):l[0];o=n.valueCallback?n.valueCallback(o):o;const i=s.slice(a.length);return{value:o,rest:i}}}const Gj=/^(\d+)(th|st|nd|rd)?/i,Yj=/\d+/i,qj={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Jj={any:[/^b/i,/^(a|c)/i]},Qj={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Xj={any:[/1/i,/2/i,/3/i,/4/i]},Kj={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Zj={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},eN={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},tN={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},sN={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},nN={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},rN={ordinalNumber:Vj({matchPattern:Gj,parsePattern:Yj,valueCallback:t=>parseInt(t,10)}),era:$r({matchPatterns:qj,defaultMatchWidth:"wide",parsePatterns:Jj,defaultParseWidth:"any"}),quarter:$r({matchPatterns:Qj,defaultMatchWidth:"wide",parsePatterns:Xj,defaultParseWidth:"any",valueCallback:t=>t+1}),month:$r({matchPatterns:Kj,defaultMatchWidth:"wide",parsePatterns:Zj,defaultParseWidth:"any"}),day:$r({matchPatterns:eN,defaultMatchWidth:"wide",parsePatterns:tN,defaultParseWidth:"any"}),dayPeriod:$r({matchPatterns:sN,defaultMatchWidth:"any",parsePatterns:nN,defaultParseWidth:"any"})},aN={code:"en-US",formatDistance:Dj,formatLong:Lj,formatRelative:Ij,localize:Bj,match:rN,options:{weekStartsOn:0,firstWeekContainsDate:1}};function lN(t,s){const n=as(t,s==null?void 0:s.in);return Nj(n,Cj(n))+1}function oN(t,s){const n=as(t,s==null?void 0:s.in),r=+ao(n)-+wj(n);return Math.round(r/qp)+1}function Qp(t,s){var x,m,p,h;const n=as(t,s==null?void 0:s.in),r=n.getFullYear(),a=Io(),l=(s==null?void 0:s.firstWeekContainsDate)??((m=(x=s==null?void 0:s.locale)==null?void 0:x.options)==null?void 0:m.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(p=a.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,o=mn((s==null?void 0:s.in)||t,0);o.setFullYear(r+1,0,l),o.setHours(0,0,0,0);const i=ka(o,s),c=mn((s==null?void 0:s.in)||t,0);c.setFullYear(r,0,l),c.setHours(0,0,0,0);const u=ka(c,s);return+n>=+i?r+1:+n>=+u?r:r-1}function iN(t,s){var i,c,u,x;const n=Io(),r=(s==null?void 0:s.firstWeekContainsDate)??((c=(i=s==null?void 0:s.locale)==null?void 0:i.options)==null?void 0:c.firstWeekContainsDate)??n.firstWeekContainsDate??((x=(u=n.locale)==null?void 0:u.options)==null?void 0:x.firstWeekContainsDate)??1,a=Qp(t,s),l=mn((s==null?void 0:s.in)||t,0);return l.setFullYear(a,0,r),l.setHours(0,0,0,0),ka(l,s)}function dN(t,s){const n=as(t,s==null?void 0:s.in),r=+ka(n,s)-+iN(n,s);return Math.round(r/qp)+1}function we(t,s){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(s,"0");return n+r}const Os={y(t,s){const n=t.getFullYear(),r=n>0?n:1-n;return we(s==="yy"?r%100:r,s.length)},M(t,s){const n=t.getMonth();return s==="M"?String(n+1):we(n+1,2)},d(t,s){return we(t.getDate(),s.length)},a(t,s){const n=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,s){return we(t.getHours()%12||12,s.length)},H(t,s){return we(t.getHours(),s.length)},m(t,s){return we(t.getMinutes(),s.length)},s(t,s){return we(t.getSeconds(),s.length)},S(t,s){const n=s.length,r=t.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return we(a,s.length)}},_n={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Dm={G:function(t,s,n){const r=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,s,n){if(s==="yo"){const r=t.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return Os.y(t,s)},Y:function(t,s,n,r){const a=Qp(t,r),l=a>0?a:1-a;if(s==="YY"){const o=l%100;return we(o,2)}return s==="Yo"?n.ordinalNumber(l,{unit:"year"}):we(l,s.length)},R:function(t,s){const n=Jp(t);return we(n,s.length)},u:function(t,s){const n=t.getFullYear();return we(n,s.length)},Q:function(t,s,n){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return we(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,s,n){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return we(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,s,n){const r=t.getMonth();switch(s){case"M":case"MM":return Os.M(t,s);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,s,n){const r=t.getMonth();switch(s){case"L":return String(r+1);case"LL":return we(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,s,n,r){const a=dN(t,r);return s==="wo"?n.ordinalNumber(a,{unit:"week"}):we(a,s.length)},I:function(t,s,n){const r=oN(t);return s==="Io"?n.ordinalNumber(r,{unit:"week"}):we(r,s.length)},d:function(t,s,n){return s==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Os.d(t,s)},D:function(t,s,n){const r=lN(t);return s==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):we(r,s.length)},E:function(t,s,n){const r=t.getDay();switch(s){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,s,n,r){const a=t.getDay(),l=(a-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(l);case"ee":return we(l,2);case"eo":return n.ordinalNumber(l,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,s,n,r){const a=t.getDay(),l=(a-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(l);case"cc":return we(l,s.length);case"co":return n.ordinalNumber(l,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,s,n){const r=t.getDay(),a=r===0?7:r;switch(s){case"i":return String(a);case"ii":return we(a,s.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,s,n){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,s,n){const r=t.getHours();let a;switch(r===12?a=_n.noon:r===0?a=_n.midnight:a=r/12>=1?"pm":"am",s){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,s,n){const r=t.getHours();let a;switch(r>=17?a=_n.evening:r>=12?a=_n.afternoon:r>=4?a=_n.morning:a=_n.night,s){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,s,n){if(s==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Os.h(t,s)},H:function(t,s,n){return s==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Os.H(t,s)},K:function(t,s,n){const r=t.getHours()%12;return s==="Ko"?n.ordinalNumber(r,{unit:"hour"}):we(r,s.length)},k:function(t,s,n){let r=t.getHours();return r===0&&(r=24),s==="ko"?n.ordinalNumber(r,{unit:"hour"}):we(r,s.length)},m:function(t,s,n){return s==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Os.m(t,s)},s:function(t,s,n){return s==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Os.s(t,s)},S:function(t,s){return Os.S(t,s)},X:function(t,s,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(s){case"X":return Em(r);case"XXXX":case"XX":return vn(r);case"XXXXX":case"XXX":default:return vn(r,":")}},x:function(t,s,n){const r=t.getTimezoneOffset();switch(s){case"x":return Em(r);case"xxxx":case"xx":return vn(r);case"xxxxx":case"xxx":default:return vn(r,":")}},O:function(t,s,n){const r=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Tm(r,":");case"OOOO":default:return"GMT"+vn(r,":")}},z:function(t,s,n){const r=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Tm(r,":");case"zzzz":default:return"GMT"+vn(r,":")}},t:function(t,s,n){const r=Math.trunc(+t/1e3);return we(r,s.length)},T:function(t,s,n){return we(+t,s.length)}};function Tm(t,s=""){const n=t>0?"-":"+",r=Math.abs(t),a=Math.trunc(r/60),l=r%60;return l===0?n+String(a):n+String(a)+s+we(l,2)}function Em(t,s){return t%60===0?(t>0?"-":"+")+we(Math.abs(t)/60,2):vn(t,s)}function vn(t,s=""){const n=t>0?"-":"+",r=Math.abs(t),a=we(Math.trunc(r/60),2),l=we(r%60,2);return n+a+s+l}const Mm=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Xp=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},cN=(t,s)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return Mm(t,s);let l;switch(r){case"P":l=s.dateTime({width:"short"});break;case"PP":l=s.dateTime({width:"medium"});break;case"PPP":l=s.dateTime({width:"long"});break;case"PPPP":default:l=s.dateTime({width:"full"});break}return l.replace("{{date}}",Mm(r,s)).replace("{{time}}",Xp(a,s))},uN={p:Xp,P:cN},mN=/^D+$/,xN=/^Y+$/,hN=["D","DD","YY","YYYY"];function pN(t){return mN.test(t)}function fN(t){return xN.test(t)}function gN(t,s,n){const r=yN(t,s,n);if(console.warn(r),hN.includes(t))throw new RangeError(r)}function yN(t,s,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const bN=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,vN=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,jN=/^'([^]*?)'?$/,NN=/''/g,wN=/[a-zA-Z]/;function Fr(t,s,n){var x,m,p,h;const r=Io(),a=r.locale??aN,l=r.firstWeekContainsDate??((m=(x=r.locale)==null?void 0:x.options)==null?void 0:m.firstWeekContainsDate)??1,o=r.weekStartsOn??((h=(p=r.locale)==null?void 0:p.options)==null?void 0:h.weekStartsOn)??0,i=as(t,n==null?void 0:n.in);if(!kj(i))throw new RangeError("Invalid time value");let c=s.match(vN).map(w=>{const N=w[0];if(N==="p"||N==="P"){const k=uN[N];return k(w,a.formatLong)}return w}).join("").match(bN).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const N=w[0];if(N==="'")return{isToken:!1,value:SN(w)};if(Dm[N])return{isToken:!0,value:w};if(N.match(wN))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:w}});a.localize.preprocessor&&(c=a.localize.preprocessor(i,c));const u={firstWeekContainsDate:l,weekStartsOn:o,locale:a};return c.map(w=>{if(!w.isToken)return w.value;const N=w.value;(fN(N)||pN(N))&&gN(N,s,String(t));const k=Dm[N[0]];return k(i,N,a.localize,u)}).join("")}function SN(t){const s=t.match(jN);return s?s[1].replace(NN,"'"):t}const kN={Low:"#60A5FA",Medium:"#FBBF24",High:"#F97316",Critical:"#EF4444"},CN={"To Do":"#9CA3AF","In Progress":"#3B82F6","In Review":"#8B5CF6",Completed:"#22C55E",Backlog:"#6B7280"},AN=["Admission","Accounting","Recruitment","Digital Marketing","Motion Graphics","SEO","Social Media","Content Creation","Administration","Management"],DN=["Low","Medium","High","Critical"],TN=["To Do","In Progress","In Review","Completed"];function EN({task:t,taskId:s,isOpen:n,onClose:r,onUpdate:a}){var V,D,E,P,$,L,W,F,z,G,ee;const{user:l}=ge(),[o,i]=d.useState(t||null),[c,u]=d.useState(!t),[x,m]=d.useState(!1),[p,h]=d.useState({}),[w,N]=d.useState(""),[k,v]=d.useState(""),[g,b]=d.useState([]);d.useEffect(()=>{var _;t&&(i(t),h({title:t.title,description:t.description,status:t.status,priority:t.priority,dueDate:t.dueDate?t.dueDate.split("T")[0]:"",tags:t.tags||[],assignedTo:((_=t.assignedTo)==null?void 0:_.map(te=>te._id||te))||[]}),u(!1))},[t]),d.useEffect(()=>{n&&(s||t)&&(t||y(),j())},[n,s,t]);const y=async()=>{var _;if(s)try{u(!0);const Y=((["SuperAdmin","Admin"].includes(l==null?void 0:l.role)?await B.listAllTasks():await B.listMyTasks()).tasks||[]).find(oe=>oe._id===s);Y&&(i(Y),h({title:Y.title,description:Y.description,status:Y.status,priority:Y.priority,dueDate:Y.dueDate?Y.dueDate.split("T")[0]:"",tags:Y.tags||[],assignedTo:((_=Y.assignedTo)==null?void 0:_.map(oe=>oe._id||oe))||[]}))}catch(te){console.error("Error loading task:",te)}finally{u(!1)}},j=async()=>{try{const _=await B.listUsers(),te=_.users||_.data||[];b(te)}catch(_){console.error("Error loading users:",_)}},S=async()=>{try{await B.updateTask(s,p),await y(),m(!1),a&&a()}catch(_){console.error("Error updating task:",_),alert("Failed to update task")}},C=async()=>{if(w.trim())try{await B.addTaskComment(s,{text:w}),N(""),await y()}catch(_){console.error("Error adding comment:",_),alert("Failed to add comment")}},A=async(_,te)=>{try{await B.updateChecklistItem(s,_,te),await y()}catch(K){console.error("Error updating checklist:",K)}},R=async()=>{if(k.trim())try{const _=[...o.checklist||[],{text:k,completed:!1}];await B.updateTask(s,{checklist:_}),v(""),await y()}catch(_){console.error("Error adding checklist item:",_)}},O=async()=>{if(confirm("Are you sure you want to delete this task?"))try{await B.deleteTask(s),a&&a(),r()}catch(_){console.error("Error deleting task:",_),alert("Failed to delete task")}},U=(l==null?void 0:l.role)==="SuperAdmin"||(l==null?void 0:l.role)==="Admin",I=(V=o==null?void 0:o.assignedTo)==null?void 0:V.some(_=>_._id===(l==null?void 0:l._id)),M=U||((D=o==null?void 0:o.assignedBy)==null?void 0:D._id)===(l==null?void 0:l._id)||I;return n?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Task Details"}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Do,{size:20})})]}),c?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):o?e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),x?e.jsx("input",{type:"text",value:p.title,onChange:_=>h({...p,title:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:o.title})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(em,{size:16})," Status"]}),x?e.jsx("select",{value:p.status,onChange:_=>h({...p,status:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:TN.map(_=>e.jsx("option",{value:_,children:_},_))}):e.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-white text-sm font-medium",style:{backgroundColor:CN[o.status]},children:o.status})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(em,{size:16})," Priority"]}),x?e.jsx("select",{value:p.priority,onChange:_=>h({...p,priority:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:DN.map(_=>e.jsx("option",{value:_,children:_},_))}):e.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-white text-sm font-medium",style:{backgroundColor:kN[o.priority]},children:o.priority})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(fe,{size:16})," Due Date"]}),x?e.jsx("input",{type:"date",value:p.dueDate,onChange:_=>h({...p,dueDate:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):o.dueDate?e.jsx("p",{className:"text-gray-900",children:Fr(new Date(o.dueDate),"MMM dd, yyyy")}):e.jsx("p",{className:"text-gray-400",children:"No due date"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),x?e.jsx("textarea",{value:p.description,onChange:_=>h({...p,description:_.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}):e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:o.description})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Me,{size:16})," Assigned To"]}),x?e.jsx("select",{multiple:!0,value:p.assignedTo,onChange:_=>h({...p,assignedTo:Array.from(_.target.selectedOptions,te=>te.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",size:5,children:g.map(_=>e.jsx("option",{value:_._id,children:_.name||_.fullName},_._id))}):e.jsx("div",{className:"flex flex-wrap gap-2",children:(E=o.assignedTo)==null?void 0:E.map(_=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[e.jsx(fr,{size:14}),_.name||_.fullName]},_._id))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Dc,{size:16})," Tags"]}),x?e.jsx("div",{className:"flex flex-wrap gap-2",children:AN.map(_=>e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"checkbox",checked:p.tags.includes(_),onChange:te=>{te.target.checked?h({...p,tags:[...p.tags,_]}):h({...p,tags:p.tags.filter(K=>K!==_)})},className:"mr-2"}),e.jsx("span",{className:"text-sm",children:_})]},_))}):e.jsx("div",{className:"flex flex-wrap gap-2",children:(P=o.tags)==null?void 0:P.map(_=>e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm",children:_},_))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(wd,{size:16})," Checklist",(($=o.checklist)==null?void 0:$.length)>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",o.checklist.filter(_=>_.completed).length,"/",o.checklist.length," completed)"]})]}),e.jsxs("div",{className:"space-y-2",children:[(L=o.checklist)==null?void 0:L.map(_=>e.jsxs("div",{className:"flex items-start gap-2 p-2 hover:bg-gray-50 rounded",children:[e.jsx("input",{type:"checkbox",checked:_.completed,onChange:te=>A(_._id,te.target.checked),disabled:!M,className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm ${_.completed?"line-through text-gray-500":"text-gray-900"}`,children:_.text}),_.completed&&_.completedBy&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Completed by ",_.completedBy.name||_.completedBy.fullName," on ",Fr(new Date(_.completedAt),"MMM dd, yyyy")]})]})]},_._id)),M&&e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("input",{type:"text",value:k,onChange:_=>v(_.target.value),onKeyPress:_=>_.key==="Enter"&&R(),placeholder:"Add checklist item...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:R,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:e.jsx(ss,{size:16})})]})]})]}),((W=o.attachments)==null?void 0:W.length)>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(Nd,{size:16})," Attachments"]}),e.jsx("div",{className:"space-y-2",children:o.attachments.map(_=>{var te,K;return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-md",children:[e.jsx(Nd,{size:16,className:"text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:_.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Uploaded by ",((te=_.uploadedBy)==null?void 0:te.name)||((K=_.uploadedBy)==null?void 0:K.fullName)," on ",Fr(new Date(_.uploadedAt),"MMM dd, yyyy")]})]}),e.jsx("a",{href:_.url,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-gray-200 rounded transition-colors",children:e.jsx(ts,{size:16})})]},_._id)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(mp,{size:16})," Comments (",((F=o.comments)==null?void 0:F.length)||0,")"]}),e.jsx("div",{className:"space-y-4 mb-4",children:(z=o.comments)==null?void 0:z.map(_=>{var te,K,Y;return e.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(fr,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"font-medium text-sm text-gray-900",children:((te=_.author)==null?void 0:te.name)||((K=_.author)==null?void 0:K.fullName)}),e.jsx("span",{className:"text-xs text-gray-500",children:Fr(new Date(_.createdAt),"MMM dd, yyyy HH:mm")})]}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_.text}),((Y=_.mentions)==null?void 0:Y.length)>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:_.mentions.map(oe=>e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:["@",oe.name||oe.fullName]},oe._id))})]},_._id)})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("textarea",{value:w,onChange:_=>N(_.target.value),placeholder:"Add a comment...",rows:2,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:C,disabled:!w.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Kl,{size:16})})]})]}),e.jsx("div",{className:"border-t pt-4 mt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Assigned By:"})," ",((G=o.assignedBy)==null?void 0:G.name)||((ee=o.assignedBy)==null?void 0:ee.fullName)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Created:"})," ",Fr(new Date(o.createdAt),"MMM dd, yyyy")]})]})})]}):e.jsx("div",{className:"p-8 text-center",children:"Task not found"}),!c&&o&&e.jsxs("div",{className:"border-t p-4 flex items-center justify-between bg-gray-50",children:[e.jsx("div",{className:"flex gap-2",children:U&&e.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[e.jsx(cn,{size:16}),"Delete Task"]})}),e.jsx("div",{className:"flex gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{var _;m(!1),h({title:o.title,description:o.description,status:o.status,priority:o.priority,dueDate:o.dueDate?o.dueDate.split("T")[0]:"",tags:o.tags||[],assignedTo:((_=o.assignedTo)==null?void 0:_.map(te=>te._id))||[]})},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Save Changes"})]}):e.jsxs(e.Fragment,{children:[M&&e.jsx("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Edit Task"}),e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors",children:"Close"})]})})]})]})}):null}const MN=["Admission","Accounting","Recruitment","Digital Marketing","Motion Graphics","SEO","Social Media","Content Creation","Administration","Management"],LN=["Low","Medium","High","Critical"];function PN({isOpen:t,onClose:s,onCreated:n}){const{user:r}=ge(),[a,l]=d.useState([]),[o,i]=d.useState(!1),[c,u]=d.useState(!1),[x,m]=d.useState({title:"",description:"",assignedTo:[],dueDate:"",priority:"Medium",tags:[],checklist:[]}),[p,h]=d.useState(""),w=(r==null?void 0:r.role)==="SuperAdmin"||(r==null?void 0:r.role)==="Admin";d.useEffect(()=>{t&&(N(),m({title:"",description:"",assignedTo:[],dueDate:"",priority:"Medium",tags:[],checklist:[]}),h(""))},[t]);const N=async()=>{try{const y=await B.listUsers();console.log("Loaded users:",y);const j=y.data||y.users||[];console.log("Users list:",j);const S=j.filter(C=>C.role!=="SuperAdmin");console.log("Filtered users (excluding SuperAdmin):",S),l(S)}catch(y){console.error("Error loading users:",y)}},k=()=>{p.trim()&&(m({...x,checklist:[...x.checklist,{text:p,completed:!1}]}),h(""))},v=y=>{m({...x,checklist:x.checklist.filter((j,S)=>S!==y)})},g=y=>{x.tags.includes(y)?m({...x,tags:x.tags.filter(j=>j!==y)}):m({...x,tags:[...x.tags,y]})},b=async y=>{if(y.preventDefault(),!x.title.trim()){alert("Please enter a task title");return}if(x.assignedTo.length===0){alert("Please assign the task to at least one user");return}i(!0);try{await B.assignTask({title:x.title,description:x.description,assignedTo:x.assignedTo,dueDate:x.dueDate||void 0,priority:x.priority,tags:x.tags,checklist:x.checklist.filter(j=>j.text.trim())}),n&&n(),s()}catch(j){console.error("Error creating task:",j),alert("Failed to create task. Please try again.")}finally{i(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:w?"Assign New Task":"Create New Task"}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",disabled:o,children:e.jsx(Do,{size:20})})]}),e.jsxs("form",{onSubmit:b,className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Task Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:x.title,onChange:y=>m({...x,title:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter task title...",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:x.description,onChange:y=>m({...x,description:y.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter task description..."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[w?"Assign To Employee(s)":"Assign To"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),!w&&e.jsx("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:y=>{const j=y.target.checked;u(j),j&&(r!=null&&r._id)?m({...x,assignedTo:[r._id]}):m({...x,assignedTo:[]})},className:"mr-2 w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Assign this task to myself"})]})}),(w||!c)&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{multiple:!0,value:x.assignedTo,onChange:y=>m({...x,assignedTo:Array.from(y.target.selectedOptions,j=>j.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",size:6,required:!c,disabled:!w&&c,children:[e.jsxs("option",{value:"",disabled:!0,className:"text-gray-400",children:["-- Select ",w?"Employee(s)":"User(s)"," --"]}),a.length===0?e.jsx("option",{disabled:!0,children:"Loading users..."}):a.map(y=>e.jsxs("option",{value:y._id,children:[y.name||y.fullName||"Unknown"," (",y.role,")"]},y._id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Hold Ctrl (Windows) or Cmd (Mac) to select multiple users"}),w&&e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Note: SuperAdmins are excluded from the list"})]}),!w&&c&&r&&e.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:e.jsxs("p",{className:"text-sm text-green-900",children:[" Task will be assigned to: ",e.jsx("strong",{children:r.name||r.fullName})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsx("select",{value:x.priority,onChange:y=>m({...x,priority:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:LN.map(y=>e.jsx("option",{value:y,children:y},y))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),e.jsx("input",{type:"date",value:x.dueDate,onChange:y=>m({...x,dueDate:y.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:MN.map(y=>e.jsx("button",{type:"button",onClick:()=>g(y),className:`px-3 py-1 rounded-full text-sm transition-colors ${x.tags.includes(y)?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:y},y))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Checklist"}),e.jsx("div",{className:"space-y-2 mb-2",children:x.checklist.map((y,j)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"flex-1 text-sm text-gray-900",children:y.text}),e.jsx("button",{type:"button",onClick:()=>v(j),className:"p-1 hover:bg-gray-200 rounded transition-colors",children:e.jsx(Qy,{size:16,className:"text-red-600"})})]},j))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:p,onChange:y=>h(y.target.value),onKeyPress:y=>y.key==="Enter"&&(y.preventDefault(),k()),placeholder:"Add checklist item...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:e.jsx(ss,{size:16})})]})]})]}),e.jsxs("div",{className:"border-t p-4 flex items-center justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",onClick:s,disabled:o,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",onClick:b,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:o?"Creating...":"Create Task"})]})]})}):null}const Ys={Backlog:{bg:"bg-gray-100",text:"text-gray-600",border:"border-gray-300",dot:"bg-gray-400"},"To Do":{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-300",dot:"bg-gray-500"},"In Progress":{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-300",dot:"bg-blue-500"},"In Review":{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-300",dot:"bg-purple-500"},Completed:{bg:"bg-green-100",text:"text-green-700",border:"border-green-300",dot:"bg-green-500"},Overdue:{bg:"bg-red-100",text:"text-red-700",border:"border-red-300",dot:"bg-red-600"}},Lm={Low:{bg:"bg-blue-100",text:"text-blue-600",dot:"bg-blue-400"},Medium:{bg:"bg-yellow-100",text:"text-yellow-600",dot:"bg-yellow-500"},High:{bg:"bg-orange-100",text:"text-orange-600",dot:"bg-orange-500"},Critical:{bg:"bg-red-100",text:"text-red-600",dot:"bg-red-500"}},IN=["Admission","Accounting","Recruitment","Digital Marketing","Motion Graphics","SEO","Social Media","Content Creation","Administration","Management"],RN=["Backlog","To Do","In Progress","In Review","Completed"];function $N(t,s){if(!t||s==="Completed")return null;const n=new Date,a=new Date(t)-n,l=Math.ceil(a/(1e3*60*60*24));return l<0?{bg:"bg-red-100",text:"text-red-700",icon:"text-red-600",label:"Overdue"}:l<=1?{bg:"bg-red-50",text:"text-red-600",icon:"text-red-500",label:l===0?"Due Today":"Due Tomorrow"}:l<=3?{bg:"bg-orange-50",text:"text-orange-600",icon:"text-orange-500",label:`${l} days left`}:l<=7?{bg:"bg-yellow-50",text:"text-yellow-600",icon:"text-yellow-500",label:`${l} days left`}:{bg:"bg-gray-50",text:"text-gray-600",icon:"text-gray-500",label:null}}function Kp({task:t,onClick:s,isDragging:n,onStatusChange:r,onDeadlineRequest:a}){var S,C,A,R,O,U,I;if(!t)return null;const[l,o]=d.useState(!1),[i,c]=d.useState(!1),{attributes:u,listeners:x,setNodeRef:m,transform:p,transition:h}=Yp({id:t._id}),w={transform:un.Transform.toString(p),transition:h,opacity:n?.5:1},N=t.dueDate&&t.status!=="Completed"&&new Date(t.dueDate)<new Date,k=N?Ys.Overdue:Ys[t.status]||Ys["To Do"],v=Lm[t.priority]||Lm.Medium,g=$N(t.dueDate,t.status),b=((S=t.checklist)==null?void 0:S.length)>0?`${t.checklist.filter(M=>M.completed).length}/${t.checklist.length}`:null,j={Backlog:["To Do"],"To Do":["In Progress","Completed"],"In Progress":["In Review","Completed"],"In Review":["Completed","To Do"],Completed:["To Do","In Progress"]}[t.status]||[];return e.jsxs("div",{ref:m,style:w,className:`bg-white rounded-lg shadow-md border-l-4 ${((C=v==null?void 0:v.dot)==null?void 0:C.replace("bg-","border-"))||"border-gray-400"} p-4 mb-2.5 hover:shadow-lg transition-all cursor-pointer group`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:`text-xs px-2.5 py-1 rounded-full ${(v==null?void 0:v.bg)||"bg-gray-100"} ${(v==null?void 0:v.text)||"text-gray-700"} font-bold uppercase tracking-wide`,children:t.priority||"Medium"}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:M=>{M.stopPropagation(),c(!i)},className:"p-1.5 opacity-0 group-hover:opacity-100 hover:bg-gray-100 rounded-lg transition",children:e.jsx(Hy,{size:16,className:"text-gray-600"})}),i&&e.jsx("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:e.jsx("button",{onClick:M=>{M.stopPropagation(),a==null||a(),c(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:" Request Deadline Change"})})]}),N&&e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-red-100 text-red-600 font-semibold flex items-center gap-1 animate-pulse",children:[e.jsx(Ut,{size:12})," Overdue"]})]}),e.jsx("h3",{className:"font-bold text-navy mb-3 text-sm leading-tight cursor-pointer hover:text-blue-600",onClick:s,children:t.title}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-2.5 mb-3 space-y-1.5",children:[t.assignedBy&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-blue-700 font-medium",children:[e.jsx(fr,{size:13,className:"text-blue-600"}),e.jsx("span",{className:"text-gray-600",children:"From:"})]}),e.jsx("span",{className:"font-semibold text-blue-900",children:t.assignedBy.name||t.assignedBy.fullName})]}),((A=t.assignedTo)==null?void 0:A.length)>0&&e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-purple-700 font-medium",children:[e.jsx(Me,{size:13,className:"text-purple-600"}),e.jsx("span",{className:"text-gray-600",children:"To:"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.assignedTo.map((M,V)=>e.jsx("span",{className:"font-semibold text-purple-900 bg-white px-2 py-0.5 rounded",children:M.name||M.fullName||"Unknown"},M._id||V))})]})]}),t.description&&e.jsx("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2 italic",children:t.description}),((R=t.tags)==null?void 0:R.length)>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:t.tags.map(M=>e.jsxs("span",{className:"text-xs px-2.5 py-1 rounded-full bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 font-medium border border-gray-300",children:[e.jsx(Dc,{size:10,className:"inline mr-1"}),M]},M))}),e.jsxs("div",{className:"space-y-2 text-xs pt-3 border-t border-gray-200",children:[t.dueDate&&e.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 rounded-lg ${(g==null?void 0:g.bg)||"bg-gray-50"} border ${((O=g==null?void 0:g.bg)==null?void 0:O.replace("bg-","border-").replace("-100","-200"))||"border-gray-200"}`,children:[e.jsx(fe,{size:14,className:`${(g==null?void 0:g.icon)||"text-gray-500"} flex-shrink-0`}),e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{className:`font-semibold ${(g==null?void 0:g.text)||"text-gray-600"}`,children:new Date(t.dueDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(g==null?void 0:g.label)&&e.jsx("span",{className:`px-2 py-0.5 rounded-full font-bold ${g.bg} ${g.text}`,children:g.label})]})]}),e.jsx("div",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[b&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-white rounded border border-green-200",children:[e.jsx(kc,{size:13,className:"text-green-600"}),e.jsx("span",{className:"font-semibold text-green-700",children:b})]}),e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-white rounded border border-blue-200 cursor-pointer hover:bg-blue-50 transition",onClick:s,title:"Click to view comments",children:[e.jsx(mp,{size:13,className:"text-blue-600"}),e.jsx("span",{className:"font-semibold text-blue-700",children:((U=t.comments)==null?void 0:U.length)||0})]}),((I=t.attachments)==null?void 0:I.length)>0&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-white rounded border border-purple-200",children:[e.jsx(Nd,{size:13,className:"text-purple-600"}),e.jsx("span",{className:"font-semibold text-purple-700",children:t.attachments.length})]})]})}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:M=>{M.stopPropagation(),o(!l)},className:`w-full py-2.5 px-3 rounded-lg font-semibold text-sm border-2 transition-all flex items-center justify-between ${k==null?void 0:k.bg} ${k==null?void 0:k.text} ${k==null?void 0:k.border}`,children:[e.jsxs("span",{children:["Status: ",t.status]}),e.jsx("span",{className:"text-lg",children:""})]}),l&&e.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-2 bg-white border-2 border-gray-300 rounded-lg shadow-lg z-50",children:j.map(M=>{var V,D;return e.jsxs("button",{onClick:E=>{E.stopPropagation(),r==null||r(t._id,M),o(!1)},className:`w-full text-left px-4 py-2.5 text-sm font-semibold border-b border-gray-200 hover:${(V=Ys[M])==null?void 0:V.bg} transition ${(D=Ys[M])==null?void 0:D.text}`,children:[" Move to ",M]},M)})})]})]})]})}function FN({column:t,tasks:s,onCardClick:n,onAddTask:r,activeId:a,isAdmin:l,onStatusChange:o,onDeadlineRequest:i}){var h,w,N;const c=s.filter(k=>k.boardColumn===t),u=c.length,x=c.map(k=>k._id),{setNodeRef:m,isOver:p}=Yp({id:t,data:{type:"column",accepts:["task"]}});return e.jsxs("div",{ref:m,className:`flex-1 min-w-[260px] max-w-[280px] bg-gradient-to-b from-gray-50 to-gray-100 rounded-xl p-3 transition-all ${p?"bg-gradient-to-b from-blue-50 to-blue-100 border-2 border-blue-400 shadow-lg":"border-2 border-gray-200"}`,children:[e.jsx("div",{className:"mb-4 pb-3 border-b-2 border-gray-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${((h=Ys[t])==null?void 0:h.dot)||"bg-gray-400"} shadow-md`}),e.jsx("h2",{className:"font-bold text-navy text-base",children:t}),e.jsx("span",{className:`text-xs font-bold px-2.5 py-1 rounded-full ${((w=Ys[t])==null?void 0:w.bg)||"bg-gray-200"} ${((N=Ys[t])==null?void 0:N.text)||"text-gray-700"}`,children:u})]}),e.jsx("button",{onClick:()=>r(t),className:"p-2 hover:bg-white rounded-lg transition shadow-sm border border-gray-300 hover:border-blue-400 hover:shadow-md",title:l?"Assign task":"Create task",children:e.jsx(ss,{size:18,className:"text-gray-600"})})]})}),e.jsx(uj,{items:x,strategy:dj,children:e.jsxs("div",{className:"space-y-3 max-h-[calc(100vh-250px)] overflow-y-auto",children:[c.map(k=>e.jsx(Kp,{task:k,onClick:v=>n(k,v),isDragging:a===k._id,onStatusChange:o,onDeadlineRequest:i},k._id)),u===0&&e.jsx("div",{className:"text-center text-gray-400 text-sm py-8",children:"No tasks"})]})})]})}function ON(){var D,E;const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState(!0),[l,o]=d.useState(""),[i,c]=d.useState(""),[u,x]=d.useState([]),[m,p]=d.useState(""),[h,w]=d.useState(""),[N,k]=d.useState(null),[v,g]=d.useState(!1),[b,y]=d.useState(null),j=zb(_b(Ic,{activationConstraint:{distance:8}})),S=async()=>{try{a(!0);const $=["SuperAdmin","Admin"].includes(t==null?void 0:t.role)?await B.listAllTasks():await B.listMyTasks();n($.tasks||[])}catch(P){console.error("Failed to load tasks:",P)}finally{a(!1)}};d.useEffect(()=>{S()},[]),d.useEffect(()=>{const P=sessionStorage.getItem("openTaskId"),$=sessionStorage.getItem("openTaskData");if(P){if(s.length>0){const L=s.find(W=>W._id===P);if(L){k(L),sessionStorage.removeItem("openTaskId"),sessionStorage.removeItem("openTaskData");return}}if($)try{const L=JSON.parse($);k(L),sessionStorage.removeItem("openTaskId"),sessionStorage.removeItem("openTaskData")}catch(L){console.error("Failed to parse task data:",L),sessionStorage.removeItem("openTaskId"),sessionStorage.removeItem("openTaskData")}}},[s]);const C=ve.useMemo(()=>{const P=new Map;return s.forEach($=>{var L;$.assignedBy&&P.set($.assignedBy._id,$.assignedBy),(L=$.assignedTo)==null||L.forEach(W=>{W&&P.set(W._id,W)})}),Array.from(P.values()).sort(($,L)=>($.name||$.fullName||"").localeCompare(L.name||L.fullName||""))},[s]),A=s.filter(P=>{var $,L;return!(l&&!P.title.toLowerCase().includes(l.toLowerCase())||i&&P.priority!==i||u.length>0&&!u.some(W=>{var F;return(F=P.tags)==null?void 0:F.includes(W)})||m&&(($=P.assignedBy)==null?void 0:$._id)!==m||h&&!((L=P.assignedTo)!=null&&L.some(W=>W._id===h)))}),R=(P,$)=>{$!=null&&$.defaultPrevented||k(P)},O=async(P,$)=>{try{await B.updateTaskStatus(P,$),await S()}catch(L){console.error("Error updating task status:",L),alert("Failed to update task status")}},U=()=>{const P=s.find($=>$._id===(N==null?void 0:N._id));P&&k(P)},I=P=>{g(!0)},M=P=>{y(P.active.id)},V=async P=>{const{active:$,over:L}=P;if(y(null),!L)return;const W=$.id,F=L.id,z=s.find(G=>G._id===W);if(!(!z||z.boardColumn===F))try{await B.updateBoardPosition(W,{boardColumn:F,boardPosition:0}),await S()}catch(G){console.error("Error moving task:",G),alert("Failed to move task")}};return r?e.jsx("div",{className:"p-6 text-center text-royal",children:"Loading tasks..."}):e.jsxs(e.Fragment,{children:[e.jsxs(zv,{sensors:j,collisionDetection:Gb,onDragStart:M,onDragEnd:V,children:[e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Task Board"}),e.jsx("p",{className:"text-gray-600 mt-1 text-sm",children:["SuperAdmin","Admin"].includes(t==null?void 0:t.role)?`Manage and track all team tasks  ${A.length} tasks`:`Your assigned tasks  ${A.length} tasks`})]}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg hover:shadow-xl font-semibold",children:[e.jsx(ss,{size:20}),["SuperAdmin","Admin"].includes(t==null?void 0:t.role)?"Assign Task":"New Task"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(An,{size:18,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search tasks by title...",value:l,onChange:P=>o(P.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3",children:[e.jsxs("select",{value:i,onChange:P=>c(P.target.value),className:"px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-sm",children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"Low",children:" Low"}),e.jsx("option",{value:"Medium",children:" Medium"}),e.jsx("option",{value:"High",children:" High"}),e.jsx("option",{value:"Critical",children:" Critical"})]}),e.jsxs("select",{value:u[0]||"",onChange:P=>x(P.target.value?[P.target.value]:[]),className:"px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-sm",children:[e.jsx("option",{value:"",children:"All Tags"}),IN.map(P=>e.jsx("option",{value:P,children:P},P))]}),["SuperAdmin","Admin"].includes(t==null?void 0:t.role)&&e.jsxs("select",{value:m,onChange:P=>p(P.target.value),className:"px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-sm",children:[e.jsx("option",{value:"",children:" Assigned By: All"}),C.filter(P=>s.some($=>{var L;return((L=$.assignedBy)==null?void 0:L._id)===P._id})).map(P=>e.jsx("option",{value:P._id,children:P.name||P.fullName},P._id))]}),["SuperAdmin","Admin"].includes(t==null?void 0:t.role)&&e.jsxs("select",{value:h,onChange:P=>w(P.target.value),className:"px-3 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-sm",children:[e.jsx("option",{value:"",children:" Assigned To: All"}),C.filter(P=>s.some($=>{var L;return(L=$.assignedTo)==null?void 0:L.some(W=>W._id===P._id)})).map(P=>e.jsx("option",{value:P._id,children:P.name||P.fullName},P._id))]}),(l||i||u.length>0||m||h)&&e.jsx("button",{onClick:()=>{o(""),c(""),x([]),p(""),w("")},className:"px-4 py-2.5 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium text-sm",children:"Clear Filters"})]}),(i||u.length>0||m||h)&&e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-gray-200",children:[e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Active Filters:"}),i&&e.jsxs("span",{className:"text-xs px-2.5 py-1 bg-blue-100 text-blue-700 rounded-full font-medium",children:["Priority: ",i]}),u.map(P=>e.jsxs("span",{className:"text-xs px-2.5 py-1 bg-purple-100 text-purple-700 rounded-full font-medium",children:["Tag: ",P]},P)),m&&e.jsxs("span",{className:"text-xs px-2.5 py-1 bg-green-100 text-green-700 rounded-full font-medium",children:["From: ",((D=C.find(P=>P._id===m))==null?void 0:D.name)||"Unknown"]}),h&&e.jsxs("span",{className:"text-xs px-2.5 py-1 bg-orange-100 text-orange-700 rounded-full font-medium",children:["To: ",((E=C.find(P=>P._id===h))==null?void 0:E.name)||"Unknown"]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsx("div",{className:"flex gap-4 min-w-max pb-4",children:RN.map(P=>e.jsx(FN,{column:P,tasks:A,onCardClick:R,onAddTask:I,activeId:b,isAdmin:["SuperAdmin","Admin"].includes(t==null?void 0:t.role),onStatusChange:O,onDeadlineRequest:U},P))})})]}),e.jsx(aj,{children:b?e.jsx(Kp,{task:s.find(P=>P._id===b),onClick:()=>{},isDragging:!0,onStatusChange:O,onDeadlineRequest:()=>U()}):null})]}),N&&e.jsx(EN,{task:N,taskId:N._id,isOpen:!!N,onClose:()=>k(null),onUpdate:S}),e.jsx(PN,{isOpen:v,onClose:()=>g(!1),onCreated:S})]})}function _N(){const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState(!1),[l,o]=d.useState(null),[i,c]=d.useState({name:"",email:"",role:"Admission",department:"",designation:"",phone:"",avatar:"",displayOrder:0}),[u,x]=d.useState(null),[m,p]=d.useState(null),h=(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin";console.log("DEBUG Employee Page - User:",t),console.log("DEBUG Employee Page - canEdit:",h);const w=async()=>{try{const{users:y}=await B.listUsers();n(y)}catch(y){x((y==null?void 0:y.message)||"Failed to load")}};d.useEffect(()=>{w()},[]);const N=d.useMemo(()=>[...s].sort((y,j)=>{const S=y.displayOrder||0,C=j.displayOrder||0;return S===C?(y.name||"").localeCompare(j.name||""):S-C}),[s]),k=()=>{o(null),c({name:"",email:"",role:"Admission",department:"",designation:"",phone:"",avatar:"",displayOrder:0}),a(!0)},v=y=>{o(y._id),c({name:y.name||"",email:y.email||"",role:y.role||"Admission",department:y.department||"",designation:y.designation||"",phone:y.phone||"",avatar:y.avatar||"",displayOrder:y.displayOrder||0}),a(!0)},g=async y=>{y.preventDefault(),x(null),p(null);try{l?(await B.updateUser(l,i),p("Employee updated")):(await B.createUser({...i,password:"password123"}),p("Employee created (default password: password123)")),a(!1),w()}catch(j){x((j==null?void 0:j.message)||"Failed")}},b=async y=>{if(confirm("Delete this employee?"))try{await B.deleteUser(y),p("Employee deleted"),w()}catch(j){x((j==null?void 0:j.message)||"Delete failed")}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Employee List"}),h&&e.jsx("button",{onClick:k,className:"bg-gold text-navy rounded-xl px-4 py-2 font-semibold hover:bg-lightgold",children:"+ Add Employee"})]}),m&&e.jsx("div",{className:"mb-2 text-green-700",children:m}),u&&e.jsx("div",{className:"mb-2 text-red-600",children:u}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Order"}),e.jsx("th",{className:"text-left p-3",children:"Name"}),e.jsx("th",{className:"text-left p-3",children:"Role"}),e.jsx("th",{className:"text-left p-3",children:"Department"}),e.jsx("th",{className:"text-left p-3",children:"Designation"}),e.jsx("th",{className:"text-left p-3",children:"Email"}),e.jsx("th",{className:"text-left p-3",children:"Phone"}),h&&e.jsx("th",{className:"text-left p-3",children:"Action"})]})}),e.jsxs("tbody",{children:[N.map((y,j)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3 text-navy font-semibold",children:y.displayOrder||0}),e.jsxs("td",{className:"p-3 flex items-center gap-2",children:[e.jsx("img",{src:y.avatar,className:"w-8 h-8 rounded-full border",alt:y.name}),e.jsx("div",{children:e.jsx("div",{className:"font-semibold text-navy",children:y.name})})]}),e.jsx("td",{className:"p-3",children:y.role}),e.jsx("td",{className:"p-3",children:y.department||"-"}),e.jsx("td",{className:"p-3",children:y.designation||"-"}),e.jsx("td",{className:"p-3",children:y.email}),e.jsx("td",{className:"p-3",children:y.phone||"-"}),h&&e.jsxs("td",{className:"p-3",children:[e.jsx("button",{onClick:()=>v(y),className:"px-3 py-1 rounded-lg border mr-2",children:"Edit"}),((t==null?void 0:t.role)==="SuperAdmin"||y.role!=="SuperAdmin")&&e.jsx("button",{onClick:()=>b(y._id),className:"px-3 py-1 rounded-lg border hover:bg-red-50",children:"Delete"})]})]},y._id)),N.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:h?8:7,children:"No employees"})})]})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:e.jsxs("form",{onSubmit:g,className:"bg-white rounded-2xl shadow-soft p-4 w-full max-w-xl",children:[e.jsx("h2",{className:"text-xl font-bold text-navy mb-3",children:l?"Edit Employee":"Add Employee"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Display Order *"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",type:"number",min:"0",required:!0,value:i.displayOrder,onChange:y=>c(j=>({...j,displayOrder:parseInt(y.target.value)||0})),placeholder:"e.g., 1, 2, 3..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first (1, 2, 3...)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Name *"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",required:!0,value:i.name,onChange:y=>c(j=>({...j,name:y.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Email *"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",required:!0,type:"email",value:i.email,onChange:y=>c(j=>({...j,email:y.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Role *"}),e.jsxs("select",{className:"w-full border rounded-xl px-3 py-2",value:i.role,onChange:y=>c(j=>({...j,role:y.target.value})),children:[(t==null?void 0:t.role)==="SuperAdmin"&&e.jsx("option",{children:"SuperAdmin"}),e.jsx("option",{children:"Admin"}),e.jsx("option",{children:"Accountant"}),e.jsx("option",{children:"Admission"}),e.jsx("option",{children:"Recruitment"}),e.jsx("option",{children:"DigitalMarketing"}),e.jsx("option",{children:"MotionGraphics"}),e.jsx("option",{children:"Coordinator"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Department"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:i.department,onChange:y=>c(j=>({...j,department:y.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Designation"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:i.designation,onChange:y=>c(j=>({...j,designation:y.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Phone"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:i.phone,onChange:y=>c(j=>({...j,phone:y.target.value}))})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Avatar URL"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:i.avatar,onChange:y=>c(j=>({...j,avatar:y.target.value}))})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"px-4 py-2 rounded-xl border",children:"Cancel"}),h&&e.jsx("button",{className:"px-4 py-2 rounded-xl bg-gold text-navy font-semibold hover:bg-lightgold",children:l?"Save":"Create"})]})]})})]})}function zN(){const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState("All"),[l,o]=d.useState(!1),[i,c]=d.useState(!1),[u,x]=d.useState(null),[m,p]=d.useState(null),[h,w]=d.useState({name:"",category:"",duration:"",regularFee:0,discountFee:0,teacher:"",details:"",status:"Active"}),[N,k]=d.useState(null),[v,g]=d.useState(null),b=(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin",y=["All",...new Set(s.map(I=>I.category).filter(Boolean))],j=r==="All"?s:s.filter(I=>I.category===r),S=async()=>{try{const{courses:I}=await B.listCourses();n(I)}catch(I){k((I==null?void 0:I.message)||"Failed to load")}};d.useEffect(()=>{S()},[]);const C=()=>{p(null),w({name:"",category:"",duration:"",regularFee:0,discountFee:0,teacher:"",details:"",status:"Active"}),o(!0)},A=I=>{x(I),c(!0)},R=I=>{p(I._id),w({name:I.name,category:I.category,duration:I.duration,regularFee:I.regularFee,discountFee:I.discountFee,teacher:I.teacher,details:I.details,status:I.status}),o(!0)},O=async I=>{I.preventDefault(),k(null),g(null);try{m?(await B.updateCourse(m,{...h}),g("Course updated")):(await B.createCourse({...h}),g("Course created")),o(!1),S()}catch(M){k((M==null?void 0:M.message)||"Failed")}},U=async I=>{if(confirm("Delete this course?"))try{await B.deleteCourse(I),g("Course deleted"),S()}catch(M){k((M==null?void 0:M.message)||"Delete failed")}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Courses"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("select",{value:r,onChange:I=>a(I.target.value),className:"border rounded-xl px-4 py-2 text-sm",children:y.map(I=>e.jsx("option",{value:I,children:I==="All"?" All Categories":` ${I}`},I))}),b&&e.jsx("button",{onClick:C,className:"bg-gold text-navy rounded-xl px-4 py-2 font-semibold hover:bg-lightgold",children:"+ Add Course"})]})]}),v&&e.jsx("div",{className:"mb-2 p-3 bg-green-100 text-green-700 rounded-xl",children:v}),N&&e.jsx("div",{className:"mb-2 p-3 bg-red-100 text-red-600 rounded-xl",children:N}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Course ID"}),e.jsx("th",{className:"text-left p-3",children:"Name"}),e.jsx("th",{className:"text-left p-3",children:"Category"}),e.jsx("th",{className:"text-left p-3",children:"Duration"}),e.jsx("th",{className:"text-left p-3",children:"Regular Fee"}),e.jsx("th",{className:"text-left p-3",children:"Discount Fee"}),e.jsx("th",{className:"text-left p-3",children:"Teacher"}),e.jsx("th",{className:"text-left p-3",children:"Status"}),e.jsx("th",{className:"text-left p-3",children:"Action"})]})}),e.jsxs("tbody",{children:[j.map(I=>e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsx("td",{className:"p-3",children:I.courseId}),e.jsx("td",{className:"p-3 font-semibold text-navy",children:I.name}),e.jsx("td",{className:"p-3",children:I.category?e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-medium",children:I.category}):"-"}),e.jsx("td",{className:"p-3",children:I.duration||"-"}),e.jsxs("td",{className:"p-3",children:[" ",I.regularFee]}),e.jsxs("td",{className:"p-3",children:[" ",I.discountFee]}),e.jsx("td",{className:"p-3",children:I.teacher||"-"}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${I.status==="Active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:I.status})}),e.jsxs("td",{className:"p-3",children:[e.jsx("button",{onClick:()=>A(I),className:"px-3 py-1 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100 mr-2",children:"View"}),b&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>R(I),className:"px-3 py-1 rounded-lg border mr-2",children:"Edit"}),e.jsx("button",{onClick:()=>U(I._id),className:"px-3 py-1 rounded-lg border hover:bg-red-50",children:"Delete"})]})]})]},I._id)),j.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70 text-center",colSpan:"9",children:s.length===0?"No courses":"No courses in this category"})})]})]})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:e.jsxs("form",{onSubmit:O,className:"bg-white rounded-2xl shadow-soft p-4 w-full max-w-2xl",children:[e.jsx("h2",{className:"text-xl font-bold text-navy mb-3",children:m?"Edit Course":"Add Course"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Course Name *"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",required:!0,value:h.name,onChange:I=>w(M=>({...M,name:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Category"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:h.category,onChange:I=>w(M=>({...M,category:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Duration"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:h.duration,onChange:I=>w(M=>({...M,duration:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Regular Fee"}),e.jsx("input",{type:"number",className:"w-full border rounded-xl px-3 py-2",value:h.regularFee,onChange:I=>w(M=>({...M,regularFee:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Discount Fee"}),e.jsx("input",{type:"number",className:"w-full border rounded-xl px-3 py-2",value:h.discountFee,onChange:I=>w(M=>({...M,discountFee:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Teacher"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2",value:h.teacher,onChange:I=>w(M=>({...M,teacher:I.target.value}))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Details"}),e.jsx("textarea",{rows:"3",className:"w-full border rounded-xl px-3 py-2",value:h.details,onChange:I=>w(M=>({...M,details:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Status"}),e.jsxs("select",{className:"w-full border rounded-xl px-3 py-2",value:h.status,onChange:I=>w(M=>({...M,status:I.target.value})),children:[e.jsx("option",{children:"Active"}),e.jsx("option",{children:"Inactive"})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 rounded-xl border",children:"Cancel"}),b&&e.jsx("button",{className:"px-4 py-2 rounded-xl bg-gold text-navy font-semibold hover:bg-lightgold",children:m?"Save":"Create"})]})]})}),i&&u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-soft p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-navy",children:"Course Details"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:""})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Course ID"}),e.jsx("div",{className:"text-lg font-semibold text-navy",children:u.courseId})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Status"}),e.jsx("div",{className:`text-lg font-semibold ${u.status==="Active"?"text-green-600":"text-gray-600"}`,children:u.status})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-blue-600 mb-1",children:"Course Name"}),e.jsx("div",{className:"text-xl font-bold text-navy",children:u.name})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Category"}),e.jsx("div",{className:"text-lg font-semibold text-navy",children:u.category||"Not specified"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Duration"}),e.jsx("div",{className:"text-lg font-semibold text-navy",children:u.duration||"Not specified"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl border-2 border-yellow-200",children:[e.jsx("div",{className:"text-sm text-yellow-700 mb-1",children:"Regular Fee"}),e.jsxs("div",{className:"text-2xl font-bold text-yellow-800",children:[" ",u.regularFee.toLocaleString()]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-xl border-2 border-green-200",children:[e.jsx("div",{className:"text-sm text-green-700 mb-1",children:"Discount Fee"}),e.jsxs("div",{className:"text-2xl font-bold text-green-800",children:[" ",u.discountFee.toLocaleString()]}),u.regularFee>u.discountFee&&e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Save ",(u.regularFee-u.discountFee).toLocaleString()]})]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-purple-600 mb-1",children:"Teacher/Instructor"}),e.jsx("div",{className:"text-lg font-semibold text-purple-800",children:u.teacher||"Not assigned"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Course Details"}),e.jsx("div",{className:"text-gray-800 whitespace-pre-wrap",children:u.details||"No details provided"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs text-gray-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Created:"})," ",new Date(u.createdAt).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Updated:"})," ",new Date(u.updatedAt).toLocaleString()]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>c(!1),className:"px-6 py-2 rounded-xl bg-navy text-white font-semibold hover:bg-navy/90",children:"Close"})})]})})]})}function UN(){return new Date().toISOString().slice(0,10)}function BN(){const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1).toISOString().slice(0,10)}function HN(t){const s=Object.keys(t[0]||{});return[s.join(","),...t.map(r=>s.map(a=>JSON.stringify(r[a]??"")).join(","))].join(`
`)}function WN(){const[t,s]=d.useState(BN()),[n,r]=d.useState(UN()),[a,l]=d.useState(null),[o,i]=d.useState(!0),[c,u]=d.useState(""),x=async()=>{i(!0);try{const w=await B.reportsOverview(t,n);l(w),u("")}catch(w){u(w.message||"Failed to load")}finally{i(!1)}};d.useEffect(()=>{x()},[]);const m=w=>{w.preventDefault(),x()},p=d.useMemo(()=>a?[{title:"Accounting  Income",val:a.accounting.income},{title:"Accounting  Expense",val:a.accounting.expense},{title:"Accounting  Net",val:a.accounting.net},{title:"Admission  Collected",val:a.admission.collected},{title:"Recruitment  Income",val:a.recruitment.income},{title:"Recruitment  Expense",val:a.recruitment.expense},{title:"Recruitment  Net",val:a.recruitment.net},{title:"Digital Marketing  Cost",val:a.dm.cost},{title:"Combined  Income",val:a.combined.income},{title:"Combined  Expense",val:a.combined.expense},{title:"Combined  Net",val:a.combined.net}]:[],[a]),h=d.useMemo(()=>{if(!a)return"";const w=[{Section:"Accounting",Metric:"Income",Amount:a.accounting.income},{Section:"Accounting",Metric:"Expense",Amount:a.accounting.expense},{Section:"Accounting",Metric:"Net",Amount:a.accounting.net},{Section:"Admission",Metric:"Collected",Amount:a.admission.collected},{Section:"Recruitment",Metric:"Income",Amount:a.recruitment.income},{Section:"Recruitment",Metric:"Expense",Amount:a.recruitment.expense},{Section:"Recruitment",Metric:"Net",Amount:a.recruitment.net},{Section:"Digital Marketing",Metric:"Cost",Amount:a.dm.cost},{Section:"Combined",Metric:"Income",Amount:a.combined.income},{Section:"Combined",Metric:"Expense",Amount:a.combined.expense},{Section:"Combined",Metric:"Net",Amount:a.combined.net}],N=new Blob([HN(w)],{type:"text/csv;charset=utf-8;"});return URL.createObjectURL(N)},[a]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-navy",children:"Consolidated Reports"}),e.jsxs("form",{onSubmit:m,className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",className:"input",value:t,onChange:w=>s(w.target.value)}),e.jsx("span",{className:"text-royal",children:"to"}),e.jsx("input",{type:"date",className:"input",value:n,onChange:w=>r(w.target.value)}),e.jsx("button",{className:"btn btn-primary",children:"Apply"}),h&&e.jsx("a",{className:"btn",href:h,download:`reports_${t}_to_${n}.csv`,children:"Export CSV"})]})]}),c&&e.jsx("div",{className:"text-red-600",children:c}),o&&e.jsx("div",{children:"Loading"}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:p.map((w,N)=>e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"text-royal text-sm",children:w.title}),e.jsx("div",{className:`text-2xl font-extrabold ${w.title.includes("Net")?w.val>=0?"text-green-600":"text-red-600":"text-navy"}`,children:Zt(w.val)})]},N))}),e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsx("div",{className:"font-semibold text-navy mb-2",children:"Summary"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-royal",children:[e.jsx("th",{className:"py-2",children:"Section"}),e.jsx("th",{children:"Metric"}),e.jsx("th",{children:"Amount"})]})}),e.jsxs("tbody",{children:[e.jsx(Gt,{s:"Accounting",m:"Income",a:a.accounting.income}),e.jsx(Gt,{s:"Accounting",m:"Expense",a:a.accounting.expense}),e.jsx(Gt,{s:"Accounting",m:"Net",a:a.accounting.net}),e.jsx(Gt,{s:"Admission",m:"Collected",a:a.admission.collected}),e.jsx(Gt,{s:"Recruitment",m:"Income",a:a.recruitment.income}),e.jsx(Gt,{s:"Recruitment",m:"Expense",a:a.recruitment.expense}),e.jsx(Gt,{s:"Recruitment",m:"Net",a:a.recruitment.net}),e.jsx(Gt,{s:"Digital Marketing",m:"Cost",a:a.dm.cost}),e.jsx(Gt,{s:"Combined",m:"Income",a:a.combined.income}),e.jsx(Gt,{s:"Combined",m:"Expense",a:a.combined.expense}),e.jsx(Gt,{s:"Combined",m:"Net",a:a.combined.net})]})]})})]})]})]})}function Gt({s:t,m:s,a:n}){return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:t}),e.jsx("td",{children:s}),e.jsx("td",{className:"font-semibold",children:Zt(n)})]})}function ol(t){if(!t)return"-";try{return new Date(t).toLocaleString()}catch{return t}}function VN(){const{user:t}=ge(),[s,n]=d.useState("All Leads"),[r,a]=d.useState("All"),[l,o]=d.useState([]),[i,c]=d.useState([]),[u,x]=d.useState(null),[m,p]=d.useState(!1),[h,w]=d.useState(null),[N,k]=d.useState(!1),v=async()=>{try{let b=s==="All Leads"?void 0:s;s==="Unassigned"&&(b="Assigned");const[y,j]=await Promise.all([B.listLeads(b),B.listAdmissionUsers().catch(()=>({users:[]}))]);let S=(y==null?void 0:y.leads)||[];s==="Unassigned"&&(S=S.filter(C=>!C.assignedTo)),o(S),c((j==null?void 0:j.users)||[]),x(null)}catch(b){x(b.message)}};d.useEffect(()=>{v()},[s]);const g=ve.useMemo(()=>r==="All"?l:r==="Unassigned"?l.filter(b=>!b.assignedTo):l.filter(b=>{var y;return((y=b.assignedTo)==null?void 0:y._id)===r}),[l,r]);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Leads Center (View-only)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:r,onChange:b=>a(b.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"All",children:" All Members"}),e.jsx("option",{value:"Unassigned",children:" Unassigned"}),i.map(b=>e.jsxs("option",{value:b._id,children:[" ",b.name]},b._id))]}),e.jsxs("select",{value:s,onChange:b=>n(b.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{children:"All Leads"}),e.jsx("option",{children:"Unassigned"}),e.jsx("option",{children:"Assigned"}),e.jsx("option",{children:"Counseling"}),e.jsx("option",{children:"In Follow Up"}),e.jsx("option",{children:"Admitted"}),e.jsx("option",{children:"Not Admitted"})]})]})]}),u&&e.jsx("div",{className:"mb-2 text-red-600",children:u}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Lead ID"}),e.jsx("th",{className:"text-left p-3",children:"Name"}),e.jsx("th",{className:"text-left p-3",children:"Phone / Email"}),e.jsx("th",{className:"text-left p-3",children:"Interested Course"}),e.jsx("th",{className:"text-left p-3",children:"Source"}),e.jsx("th",{className:"text-left p-3",children:"Lead Status"}),e.jsx("th",{className:"text-left p-3",children:"Assigned To"}),((t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin"||(t==null?void 0:t.role)==="Admission")&&e.jsx("th",{className:"text-left p-3",children:"History"})]})}),e.jsxs("tbody",{children:[g.map(b=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",children:b.leadId}),e.jsx("td",{className:"p-3",children:b.name}),e.jsxs("td",{className:"p-3",children:[e.jsx("div",{children:b.phone}),e.jsx("div",{className:"text-xs text-royal/70",children:b.email||"-"})]}),e.jsx("td",{className:"p-3",children:b.interestedCourse||"-"}),e.jsx("td",{className:"p-3",children:b.source}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b.status==="Admitted"?"bg-green-100 text-green-700":b.status==="Not Admitted"?"bg-red-100 text-red-700":b.status==="Counseling"?"bg-blue-100 text-blue-700":b.status==="In Follow Up"?"bg-yellow-100 text-yellow-700":b.status==="Assigned"&&b.assignedTo?"bg-purple-100 text-purple-700":b.status==="Assigned"&&!b.assignedTo?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:b.status==="Assigned"&&!b.assignedTo?"Unassigned":b.status||"New"})}),e.jsx("td",{className:"p-3",children:b.assignedTo?`${b.assignedTo.name} (${b.assignedTo.role})`:"-"}),((t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin"||(t==null?void 0:t.role)==="Admission")&&e.jsx("td",{className:"p-3",children:e.jsx("button",{disabled:N,onClick:async()=>{try{x(null),k(!0);const y=await B.getLeadHistory(b._id);w(y.lead||y),p(!0)}catch(y){x(y.message)}finally{k(!1)}},className:"px-3 py-1 rounded-xl border hover:bg-[#f3f6ff]",children:N?"Loading":"History"})})]},b._id)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:7,children:"No leads for selected filters"})})]})]})}),m&&h&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>p(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-4 z-10 w-full max-w-2xl shadow-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Lead History  ",h.leadId]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{children:["Assigned At: ",e.jsx("strong",{children:ol(h.assignedAt||h.updatedAt)})]}),e.jsxs("div",{children:["Counseling At: ",e.jsx("strong",{children:ol(h.counselingAt||h.updatedAt)})]}),e.jsxs("div",{children:["Admitted At: ",e.jsx("strong",{children:ol(h.admittedAt||h.updatedAt)})]}),e.jsxs("div",{children:["Follow-ups (",(h.followUps||[]).length,"):"]}),e.jsx("div",{className:"pl-2",children:(h.followUps||[]).length===0?e.jsx("div",{className:"text-royal/70",children:"No follow-ups"}):(h.followUps||[]).map((b,y)=>{var j;return e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"text-sm font-medium",children:[ol(b.at)," ",(j=b.by)!=null&&j.name?`  ${b.by.name}`:""]}),e.jsx("div",{className:"text-royal/70",children:b.note||"-"})]},y)})})]}),e.jsx("div",{className:"mt-4 text-right",children:e.jsx("button",{onClick:()=>p(!1),className:"px-3 py-2 rounded-xl border",children:"Close"})})]})]})]})}function GN(){const{user:t}=ge(),[s,n]=d.useState({name:"",phone:"",email:"",interestedCourse:"",source:"Manually Generated Lead"}),[r,a]=d.useState(""),[l,o]=d.useState(null),[i,c]=d.useState(null),[u,x]=d.useState(null),[m,p]=d.useState(!1),[h,w]=d.useState([]),[N,k]=d.useState(null),v=(t==null?void 0:t.role)==="DigitalMarketing";d.useEffect(()=>{(async()=>{try{const C=await B.listCourses();w((C==null?void 0:C.courses)||[])}catch(C){console.error("Failed to load courses:",C)}})();const S=new URLSearchParams(window.location.search);if(S.has("edit")){const C=S.get("edit"),A=sessionStorage.getItem("editLead");if(A){const R=JSON.parse(A);n({name:R.name||"",phone:R.phone||"",email:R.email||"",interestedCourse:R.interestedCourse||"",source:R.source||"Manually Generated Lead"}),k(C)}}},[]);const g=async j=>{j.preventDefault(),o(null),c(null),p(!0);try{N?(await B.updateLead(N,s),o("Lead updated successfully! "),setTimeout(()=>{window.location.href="/leads-center"},1500)):(await B.createLead(s),o("Lead added successfully! "),n({name:"",phone:"",email:"",interestedCourse:"",source:"Manually Generated Lead"}))}catch(S){c(S.message)}finally{p(!1)}},b=async j=>{j.preventDefault(),o(null),c(null),p(!0);try{const{created:S,skipped:C,errors:A}=await B.bulkUploadLeads(r);let R=`Bulk upload completed!  Created: ${S} leads |  Skipped: ${C}`;A&&A.length>0&&(R+=`

Errors:
${A.join(`
`)}`),o(R),a("")}catch(S){c(S.message)}finally{p(!1)}},y=j=>j.includes("Meta")?Cc:j.includes("LinkedIn")?Ac:j.includes("Manual")?hi:Vy;return v?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:N?" Edit Lead":"Lead Entry"}),e.jsx("p",{className:"text-gray-600 mt-1",children:N?"Update lead details":"Add new leads individually or upload in bulk via CSV"})]}),l&&e.jsxs("div",{className:"p-4 bg-green-50 border-l-4 border-green-500 rounded-lg flex items-start gap-3",children:[e.jsx(it,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-green-800 font-medium",children:l})})]}),i&&e.jsxs("div",{className:"p-4 bg-red-50 border-l-4 border-red-500 rounded-lg flex items-start gap-3",children:[e.jsx(Ut,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-red-800 font-medium",children:i})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("form",{onSubmit:g,className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:`bg-gradient-to-r ${N?"from-green-500 to-teal-600":"from-blue-500 to-purple-600"} p-5`,children:e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:N?e.jsx(hi,{className:"w-6 h-6"}):e.jsx(fi,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:N?"Update Lead":"Add Single Lead"}),e.jsx("p",{className:"text-sm text-white/80",children:N?"Modify lead details":"Enter lead details manually"})]})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(fi,{className:"w-4 h-4 text-blue-600"}),"Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border-2 border-gray-200 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:outline-none transition-colors",placeholder:"Enter lead's full name",required:!0,value:s.name,onChange:j=>n(S=>({...S,name:j.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(jl,{className:"w-4 h-4 text-green-600"}),"Phone Number"]}),e.jsx("input",{type:"tel",className:"w-full border-2 border-gray-200 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:outline-none transition-colors",placeholder:"+880 1XXX-XXXXXX",value:s.phone,onChange:j=>n(S=>({...S,phone:j.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(up,{className:"w-4 h-4 text-purple-600"}),"Email Address"]}),e.jsx("input",{type:"email",className:"w-full border-2 border-gray-200 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:outline-none transition-colors",placeholder:"email@example.com",value:s.email,onChange:j=>n(S=>({...S,email:j.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Sn,{className:"w-4 h-4 text-orange-600"}),"Interested Course"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"w-full border-2 border-gray-200 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:outline-none transition-colors appearance-none bg-white pr-10",value:s.interestedCourse,onChange:j=>n(S=>({...S,interestedCourse:j.target.value})),children:[e.jsx("option",{value:"",children:"Select a course"}),h.map(j=>e.jsx("option",{value:j.name,children:j.name},j._id))]}),e.jsx(Sn,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"})]}),h.length===0&&e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:" No courses available. Contact admin."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Dc,{className:"w-4 h-4 text-pink-600"}),"Lead Source"]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"w-full border-2 border-gray-200 rounded-lg px-4 py-2.5 focus:border-blue-500 focus:outline-none transition-colors appearance-none bg-white pr-10",value:s.source,onChange:j=>n(S=>({...S,source:j.target.value})),children:[e.jsx("option",{children:"Meta Lead"}),e.jsx("option",{children:"LinkedIn Lead"}),e.jsx("option",{children:"Manually Generated Lead"}),e.jsx("option",{children:"Others"})]}),ve.createElement(y(s.source),{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"})]})]}),e.jsx("button",{type:"submit",disabled:m,className:`w-full bg-gradient-to-r ${N?"from-green-500 to-teal-600":"from-blue-500 to-purple-600"} text-white rounded-lg px-6 py-3 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),N?"Updating Lead...":"Adding Lead..."]}):e.jsx(e.Fragment,{children:N?e.jsxs(e.Fragment,{children:[e.jsx(hi,{className:"w-5 h-5"}),"Update Lead"]}):e.jsxs(e.Fragment,{children:[e.jsx(fi,{className:"w-5 h-5"}),"Add Lead"]})})})]})]}),!N&&e.jsxs("form",{onSubmit:b,className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-pink-600 p-5",children:e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(pi,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Bulk Upload (CSV)"}),e.jsx("p",{className:"text-sm text-white/80",children:"Import multiple leads at once"})]})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(St,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Required CSV Format"}),e.jsx("p",{className:"text-xs text-blue-700 mb-2",children:"Your CSV file must have these exact headers:"}),e.jsx("code",{className:"block bg-white px-3 py-2 rounded border border-blue-300 text-xs text-gray-800 font-mono",children:"Name,Phone,Email,InterestedCourse,Source"}),e.jsx("p",{className:"text-xs text-blue-600 mt-2",children:" First row should be headers, data starts from second row"})]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(pi,{className:"w-4 h-4 text-orange-600"}),"Upload CSV File"]}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"file",accept:".csv,text/csv",className:"w-full border-2 border-dashed border-gray-300 rounded-lg px-4 py-8 text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-gradient-to-r file:from-orange-500 file:to-pink-600 file:text-white file:font-semibold hover:file:shadow-lg file:cursor-pointer cursor-pointer hover:border-orange-400 transition-colors",onChange:async j=>{x(null),c(null),o(null);const S=j.target.files&&j.target.files[0];if(!S)return;const C=(S.name||"").toLowerCase();if(!(S.type==="text/csv"||C.endsWith(".csv"))){x("Please select a valid CSV file (.csv)");return}try{const R=await S.text();a(R),o(`File loaded: ${S.name} (${(S.size/1024).toFixed(1)} KB)`)}catch{x("Unable to read file. Please try again.")}}})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"OR"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx(St,{className:"w-4 h-4 text-pink-600"}),"Paste CSV Content"]}),e.jsx("textarea",{rows:"8",className:"w-full border-2 border-gray-200 rounded-lg px-4 py-3 focus:border-orange-500 focus:outline-none transition-colors font-mono text-sm resize-none",placeholder:`Name,Phone,Email,InterestedCourse,Source
John Doe,01712345678,john@example.com,Graphic Design,Meta Lead
Jane Smith,01798765432,jane@example.com,Web Development,LinkedIn Lead`,value:r,onChange:j=>a(j.target.value)}),r&&e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:[" ",r.split(`
`).filter(j=>j.trim()).length-1," leads detected"]})]}),u&&e.jsx("div",{className:"p-3 bg-red-50 border-l-4 border-red-500 rounded-lg",children:e.jsx("p",{className:"text-red-800 text-sm",children:u})}),e.jsx("button",{type:"submit",disabled:m||!r,className:"w-full bg-gradient-to-r from-orange-500 to-pink-600 text-white rounded-lg px-6 py-3 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pi,{className:"w-5 h-5"}),"Upload CSV"]})})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("p",{className:"text-xl text-gray-600",children:"Only Digital Marketing can add or upload leads."})]})})}function YN(){const{user:t}=ge(),[s,n]=d.useState("Assigned"),[r,a]=d.useState("All"),[l,o]=d.useState("All"),[i,c]=d.useState("date-desc"),[u,x]=d.useState([]),[m,p]=d.useState([]),[h,w]=d.useState([]),[N,k]=d.useState([]),[v,g]=d.useState(null),[b,y]=d.useState(null),[j,S]=d.useState(!1),[C,A]=d.useState(null),[R,O]=d.useState(!1),[U,I]=d.useState(!1),[M,V]=d.useState(""),[D,E]=d.useState(null),[P,$]=d.useState(0),[L,W]=d.useState([]),[F,z]=d.useState(!1),G=(t==null?void 0:t.role)==="DigitalMarketing",ee=async()=>{try{const H=s==="Unassigned"?"Assigned":s,re=[s==="All Leads"?B.listLeads():B.listLeads(H),B.listCourses()];G&&(re.push(B.listAdmissionUsers()),re.push(B.getTodayAssignments()));const se=await Promise.all(re),me=se[0],he=se[1],ie=G?se[2]:{users:[]},xe=G?se[3]:null;let pe=(me==null?void 0:me.leads)||[];s==="Unassigned"&&(pe=pe.filter(De=>!De.assignedTo)),p(pe),x((he==null?void 0:he.courses)||[]),w((ie==null?void 0:ie.users)||[]),k([]),xe&&(E(xe.grouped||{}),$(xe.total||0)),y(null)}catch(H){y(H.message)}};d.useEffect(()=>{ee()},[s]);const _=async(H,re)=>{g(null),y(null);try{await B.assignLead(H,re),g("Lead assigned"),ee()}catch(se){y(se.message)}},te=H=>{sessionStorage.setItem("editLead",JSON.stringify(H)),window.location.href="/lead-entry?edit="+H._id},K=async H=>{if(window.confirm("Are you sure you want to delete this lead? This action cannot be undone.")){g(null),y(null);try{await B.deleteLead(H),g("Lead deleted successfully"),ee()}catch(re){y(re.message)}}},Y=async()=>{if(N.length===0||L.length===0){alert("Please select leads and at least one member");return}g(null),y(null),I(!0);try{const H=Math.floor(N.length/L.length),re=N.length%L.length;let se=0,me=[];for(let he=0;he<L.length;he++){const ie=L[he],xe=H+(he<re?1:0),pe=N.slice(se,se+xe);pe.length>0&&me.push(B.bulkAssignLeads(pe,ie)),se+=xe}await Promise.all(me),g(` Successfully distributed ${N.length} leads among ${L.length} members equally${re>0?` (${re} remainder lead(s))`:""}`),W([]),k([]),z(!1),ee()}catch(H){y(H.message)}finally{I(!1)}},oe=async()=>{if(!(N.length===0||!M)){g(null),y(null),I(!0);try{const H=await B.bulkAssignLeads(N,M);g(H.message||`${N.length} lead(s) assigned`),V(""),ee()}catch(H){y(H.message)}finally{I(!1)}}},le=()=>{N.length===T.length?k([]):k(T.map(H=>H._id))},Z=H=>{k(re=>re.includes(H)?re.filter(se=>se!==H):[...re,H])},T=d.useMemo(()=>{let H=m;return r!=="All"&&(H=H.filter(se=>se.interestedCourse===r)),l!=="All"&&(l==="Unassigned"?H=H.filter(se=>!se.assignedTo):H=H.filter(se=>{var me;return((me=se.assignedTo)==null?void 0:me._id)===l})),[...H].sort((se,me)=>{var he,ie,xe,pe;if(i==="date-desc")return new Date(me.createdAt)-new Date(se.createdAt);if(i==="date-asc")return new Date(se.createdAt)-new Date(me.createdAt);if(i==="member-asc"){const De=((he=se.assignedTo)==null?void 0:he.name)||"Unassigned",ft=((ie=me.assignedTo)==null?void 0:ie.name)||"Unassigned";return De.localeCompare(ft)}else if(i==="member-desc"){const De=((xe=se.assignedTo)==null?void 0:xe.name)||"Unassigned";return(((pe=me.assignedTo)==null?void 0:pe.name)||"Unassigned").localeCompare(De)}return 0})},[m,r,l,i]);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Leads Center"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:i,onChange:H=>c(H.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"date-desc",children:" Newest First"}),e.jsx("option",{value:"date-asc",children:" Oldest First"}),e.jsx("option",{value:"member-asc",children:" Member (A-Z)"}),e.jsx("option",{value:"member-desc",children:" Member (Z-A)"})]}),e.jsxs("select",{value:l,onChange:H=>o(H.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"All",children:" All Members"}),e.jsx("option",{value:"Unassigned",children:" Unassigned"}),h.map(H=>e.jsxs("option",{value:H._id,children:[" ",H.name]},H._id))]}),e.jsxs("select",{value:r,onChange:H=>a(H.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"All",children:" All Courses"}),u.map(H=>e.jsx("option",{value:H.name,children:H.name},H._id))]}),e.jsxs("select",{value:s,onChange:H=>n(H.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{children:"All Leads"}),e.jsx("option",{children:"Unassigned"}),e.jsx("option",{children:"Assigned"}),e.jsx("option",{children:"Counseling"}),e.jsx("option",{children:"In Follow Up"}),e.jsx("option",{children:"Admitted"}),e.jsx("option",{children:"Not Admitted"})]})]})]}),v&&e.jsx("div",{className:"mb-2 p-3 bg-green-100 text-green-700 rounded-xl",children:v}),b&&e.jsx("div",{className:"mb-2 p-3 bg-red-100 text-red-600 rounded-xl",children:b}),G&&D&&Object.keys(D).length>0&&e.jsxs("div",{className:"mb-4 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 rounded-2xl p-5 shadow-lg border border-blue-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:" Today's Lead Assignments"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:new Date().toLocaleDateString("en-GB",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-xl shadow-md",children:[e.jsx("div",{className:"text-xs font-medium opacity-90",children:"Total Assigned"}),e.jsx("div",{className:"text-3xl font-bold",children:P})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.entries(D).map(([H,re])=>{const se=Object.values(re).reduce((me,he)=>me+he,0);return e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-md border border-gray-200 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white text-sm font-bold",children:H.charAt(0).toUpperCase()}),H]}),e.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-lg text-sm font-bold",children:se})]}),e.jsx("div",{className:"space-y-2",children:Object.entries(re).map(([me,he])=>e.jsxs("div",{className:"flex items-center justify-between text-sm bg-gray-50 rounded-lg px-3 py-2",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:me}),e.jsx("span",{className:"bg-purple-100 text-purple-800 px-2 py-0.5 rounded-md font-bold text-xs",children:he})]},me))})]},H)})})]}),G&&N.length>0&&e.jsx("div",{className:"mb-3 p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl border border-blue-200 space-y-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-medium text-blue-900",children:[N.length," lead(s) selected"]}),e.jsxs("select",{value:M,onChange:H=>V(H.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Admission Member"}),h.map(H=>e.jsx("option",{value:H._id,children:H.name},H._id))]}),e.jsx("button",{onClick:oe,disabled:U||!M,className:"px-4 py-2 bg-blue-600 text-white rounded-xl hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:U?"Assigning...":"Assign to One"}),e.jsx("button",{onClick:()=>z(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-xl hover:bg-purple-700 font-medium",title:"Distribute leads equally among selected members",children:" Distribute Equally"}),e.jsx("button",{onClick:()=>k([]),className:"px-3 py-2 text-royal hover:text-red-600",children:"Clear Selection"})]})}),F&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>z(!1)}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 z-10 w-full max-w-md shadow-lg",children:[e.jsxs("h3",{className:"text-xl font-bold text-navy mb-4",children:[" Distribute ",N.length," Leads Equally"]}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Select admission members to distribute leads equally among them"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto mb-4",children:h.map(H=>e.jsxs("label",{className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:L.includes(H._id),onChange:re=>{re.target.checked?W([...L,H._id]):W(L.filter(se=>se!==H._id))},className:"w-4 h-4 cursor-pointer"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-800",children:H.name}),e.jsx("div",{className:"text-xs text-gray-500",children:H.email})]})]},H._id))}),L.length>0&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:[e.jsx("div",{className:"text-sm text-blue-900 font-medium",children:"Distribution plan:"}),e.jsxs("div",{className:"text-xs text-blue-700 mt-1",children:[Math.floor(N.length/L.length)," leads per member",N.length%L.length>0&&` + ${N.length%L.length} remainder`]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:Y,disabled:L.length===0||U,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-xl hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:U?"Distributing...":"Confirm Distribution"})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[G&&e.jsx("th",{className:"p-3",children:e.jsx("input",{type:"checkbox",checked:T.length>0&&N.length===T.length,onChange:le,className:"w-4 h-4 cursor-pointer"})}),e.jsx("th",{className:"text-left p-3",children:"Lead ID"}),e.jsx("th",{className:"text-left p-3",children:"Added Date"}),e.jsx("th",{className:"text-left p-3",children:"Name"}),e.jsx("th",{className:"text-left p-3",children:"Phone / Email"}),e.jsx("th",{className:"text-left p-3",children:"Interested Course"}),e.jsx("th",{className:"text-left p-3",children:"Source"}),e.jsx("th",{className:"text-left p-3",children:"Lead Status"}),e.jsx("th",{className:"text-left p-3",children:"Assigned To"}),((t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin"||(t==null?void 0:t.role)==="Admission"||(t==null?void 0:t.role)==="DigitalMarketing")&&e.jsx("th",{className:"text-left p-3",children:"History"}),G&&e.jsx("th",{className:"text-left p-3",children:"Action"})]})}),e.jsxs("tbody",{children:[T.map(H=>{var re;return e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[G&&e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",checked:N.includes(H._id),onChange:()=>Z(H._id),className:"w-4 h-4 cursor-pointer"})}),e.jsx("td",{className:"p-3",children:H.leadId}),e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"text-sm",children:new Date(H.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),e.jsx("div",{className:"text-xs text-royal/70",children:new Date(H.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("td",{className:"p-3",children:H.name}),e.jsxs("td",{className:"p-3",children:[e.jsx("div",{children:H.phone}),e.jsx("div",{className:"text-xs text-royal/70",children:H.email||"-"})]}),e.jsx("td",{className:"p-3",children:H.interestedCourse||"-"}),e.jsx("td",{className:"p-3",children:H.source}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H.status==="Admitted"?"bg-green-100 text-green-700":H.status==="Not Admitted"?"bg-red-100 text-red-700":H.status==="Counseling"?"bg-blue-100 text-blue-700":H.status==="In Follow Up"?"bg-yellow-100 text-yellow-700":H.status==="Assigned"&&H.assignedTo?"bg-purple-100 text-purple-700":H.status==="Assigned"&&!H.assignedTo?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"}`,children:H.status==="Assigned"&&!H.assignedTo?"Unassigned":H.status||"New"})}),e.jsx("td",{className:"p-3",children:H.assignedTo?`${H.assignedTo.name} (${H.assignedTo.role})`:"-"}),((t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin"||(t==null?void 0:t.role)==="Admission"||(t==null?void 0:t.role)==="DigitalMarketing")&&e.jsx("td",{className:"p-3",children:e.jsx("button",{disabled:R,onClick:async()=>{try{y(null),O(!0);const se=await B.getLeadHistory(H._id);A(se.lead||se),S(!0)}catch(se){y(se.message)}finally{O(!1)}},className:"px-3 py-1 rounded-xl border hover:bg-[#f3f6ff]",children:R?"Loading":"History"})}),G&&e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>te(H),className:"px-2 py-1 text-sm rounded-lg border border-blue-300 bg-blue-50 text-blue-700 hover:bg-blue-100 transition",title:"Edit lead",children:" Edit"}),e.jsx("button",{onClick:()=>K(H._id),className:"px-2 py-1 text-sm rounded-lg border border-red-300 bg-red-50 text-red-700 hover:bg-red-100 transition",title:"Delete lead",children:" Delete"}),H.assignedTo?e.jsxs("span",{className:"text-sm px-2 py-1 rounded-lg bg-green-50 text-green-700 font-medium whitespace-nowrap",children:[" Assigned to ",(re=H.assignedTo)==null?void 0:re.name]}):e.jsx(qN,{current:"",options:h,onChange:se=>_(H._id,se)})]})})]},H._id)}),T.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70 text-center",colSpan:G?11:9,children:m.length===0?"No leads":"No leads match the selected filters"})})]})]})}),j&&C&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>S(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-4 z-10 w-full max-w-2xl shadow-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Lead History  ",C.leadId]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-royal/70 min-w-[140px]",children:"Created At:"}),e.jsx("strong",{children:C.createdAt?new Date(C.createdAt).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):"-"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-royal/70 min-w-[140px]",children:"Assigned At:"}),e.jsx("strong",{children:C.assignedAt?new Date(C.assignedAt).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):e.jsx("span",{className:"text-royal/50",children:"Not yet assigned"})})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-royal/70 min-w-[140px]",children:"Counseling At:"}),e.jsx("strong",{children:C.counselingAt?new Date(C.counselingAt).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):e.jsx("span",{className:"text-royal/50",children:"Not yet in counseling"})})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-royal/70 min-w-[140px]",children:"Admitted At:"}),e.jsx("strong",{children:C.admittedAt?new Date(C.admittedAt).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):e.jsx("span",{className:"text-royal/50",children:"Not yet admitted"})})]}),e.jsxs("div",{className:"border-t pt-3 mt-2",children:[e.jsxs("div",{className:"font-medium mb-2",children:["Follow-ups (",(C.followUps||[]).length,")"]}),e.jsx("div",{className:"pl-2",children:(C.followUps||[]).length===0?e.jsx("div",{className:"text-royal/70 italic",children:"No follow-ups yet"}):(C.followUps||[]).map((H,re)=>{var se;return e.jsxs("div",{className:"mb-3 p-2 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"text-sm font-medium text-royal",children:[new Date(H.at).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),((se=H.by)==null?void 0:se.name)&&e.jsxs("span",{className:"ml-2 text-blue-600",children:[" ",H.by.name]})]}),e.jsx("div",{className:"text-sm text-royal/70 mt-1",children:H.note||"No notes"})]},re)})})]})]}),e.jsx("div",{className:"mt-4 text-right",children:e.jsx("button",{onClick:()=>S(!1),className:"px-4 py-2 bg-royal text-white rounded-xl hover:bg-royal/90",children:"Close"})})]})]})]})}function qN({current:t,options:s,onChange:n}){const[r,a]=d.useState(t||"");return d.useEffect(()=>a(t||""),[t]),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{className:"border rounded-xl px-3 py-2",value:r,onChange:l=>a(l.target.value),children:[e.jsx("option",{value:"",children:"Select Admission Member"}),s.map(l=>e.jsx("option",{value:l._id,children:l.name},l._id))]}),e.jsx("button",{disabled:!r,onClick:()=>n(r),className:"px-3 py-1 rounded-lg border hover:bg-[#f3f6ff]",children:"Assign"})]})}function JN(){const{user:t}=ge();return(t==null?void 0:t.role)!=="DigitalMarketing"?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("p",{className:"text-xl text-gray-600",children:"Only Digital Marketing can access this page."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Digital Marketing Metrics"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track expenses, social media performance, SEO activities, and ad campaigns"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsx(QN,{}),e.jsx(XN,{}),e.jsx(KN,{})]}),e.jsx(ZN,{})]})}function QN(){const[t,s]=d.useState([]),[n,r]=d.useState({date:new Date().toISOString().slice(0,10),purpose:"Meta Ads",amount:0}),[a,l]=d.useState(null),[o,i]=d.useState(null),c=async()=>{try{const h=await B.listDMCosts();let w=[];Array.isArray(h)?w=h:Array.isArray(h==null?void 0:h.costs)?w=h.costs:Array.isArray(h==null?void 0:h.items)?w=h.items:w=[],s(Array.isArray(w)?w:[]),i(null)}catch(h){console.error("Failed to load DM costs:",h),i(h.message||"Failed to load costs"),s([])}};d.useEffect(()=>{c()},[]);const u=async h=>{h.preventDefault(),l(null),i(null);try{await B.createDMCost(n),l("Cost added successfully!"),r({date:new Date().toISOString().slice(0,10),purpose:"Meta Ads",amount:0}),await c()}catch(w){console.error("Failed to add cost:",w),i(w.message||"Failed to add cost")}},x=async h=>{if(confirm("Are you sure you want to delete this cost entry?"))try{await B.deleteDMCost(h),await c()}catch(w){console.error("Failed to delete cost:",w),i(w.message||"Failed to delete")}},m=d.useMemo(()=>{try{const h=(Array.isArray(t)?t:[]).reduce((N,k)=>{const v=Number(k==null?void 0:k.amount)||0;return N+(isNaN(v)?0:v)},0),w={};return(Array.isArray(t)?t:[]).forEach(N=>{if(N&&N.purpose){const k=Number(N.amount)||0;w[N.purpose]=(w[N.purpose]||0)+(isNaN(k)?0:k)}}),{total:h,byPurpose:w}}catch(h){return console.error("Error calculating stats:",h),{total:0,byPurpose:{}}}},[t]),p={"Meta Ads":"bg-blue-100 text-blue-800","LinkedIn Ads":"bg-cyan-100 text-cyan-800","Software Purchase":"bg-purple-100 text-purple-800",Subscription:"bg-orange-100 text-orange-800",Others:"bg-gray-100 text-gray-800"};return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-red-500 to-pink-600 p-5",children:e.jsxs("div",{className:"flex items-center justify-between text-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(He,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Marketing Expenses"}),e.jsx("p",{className:"text-sm text-white/80",children:"Track your advertising costs"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-white/80",children:"Total Spent"}),e.jsx("p",{className:"text-2xl font-bold",children:Pe(m.total)})]})]})}),e.jsxs("div",{className:"p-5",children:[a&&e.jsxs("div",{className:"mb-3 p-3 bg-green-50 border-l-4 border-green-500 text-green-700 rounded-lg",children:[" ",a]}),o&&e.jsxs("div",{className:"mb-3 p-3 bg-red-50 border-l-4 border-red-500 text-red-700 rounded-lg",children:[" ",o]}),Object.keys(m.byPurpose).length>0&&e.jsx("div",{className:"mb-4 grid grid-cols-2 gap-2",children:Object.entries(m.byPurpose).map(([h,w])=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-2 border border-gray-200",children:[e.jsx("div",{className:"text-xs text-gray-600",children:h}),e.jsx("div",{className:"text-sm font-bold text-gray-800",children:Pe(w)})]},h))}),e.jsxs("form",{onSubmit:u,className:"mb-4 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ss,{className:"w-4 h-4 text-gray-600"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Add New Expense"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-pink-500 focus:outline-none transition-colors",value:n.date,onChange:h=>r(w=>({...w,date:h.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Purpose"}),e.jsxs("select",{className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-pink-500 focus:outline-none transition-colors",value:n.purpose,onChange:h=>r(w=>({...w,purpose:h.target.value})),required:!0,children:[e.jsx("option",{children:"Meta Ads"}),e.jsx("option",{children:"LinkedIn Ads"}),e.jsx("option",{children:"Software Purchase"}),e.jsx("option",{children:"Subscription"}),e.jsx("option",{children:"Others"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Amount (BDT)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-pink-500 focus:outline-none transition-colors",value:n.amount,onChange:h=>r(w=>({...w,amount:h.target.value})),placeholder:"0.00",required:!0})]}),e.jsxs("button",{className:"w-full bg-gradient-to-r from-red-500 to-pink-600 text-white rounded-lg px-4 py-2.5 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),"Add Expense"]})]})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(He,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No expenses recorded yet"})]}):t.map(h=>e.jsx("div",{className:"group bg-gray-50 hover:bg-gray-100 rounded-lg p-3 border border-gray-200 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(fe,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-600",children:new Date(h.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${p[h.purpose]||p.Others}`,children:h.purpose}),e.jsx("span",{className:"text-sm font-bold text-gray-800",children:Pe(h.amount)})]})]}),e.jsx("button",{onClick:()=>x(h._id),className:"opacity-0 group-hover:opacity-100 p-2 text-red-600 hover:bg-red-50 rounded-lg transition-all",title:"Delete",children:e.jsx(cn,{className:"w-4 h-4"})})]})},h._id))})]})]})}function XN(){const[t,s]=d.useState([]),[n,r]=d.useState({date:new Date().toISOString().slice(0,10),facebookFollowers:0,instagramFollowers:0,facebookGroupMembers:0,youtubeSubscribers:0,linkedInFollowers:0,xFollowers:0,pinterestView:0,bloggerImpression:0,totalReach:0}),[a,l]=d.useState(null),[o,i]=d.useState(null),c=async()=>{try{const p=await B.listSocial(),h=(p==null?void 0:p.metrics)||(p==null?void 0:p.social)||{};if(h&&typeof h=="object"&&Object.keys(h).length>0){const w={facebookFollowers:Number(h.facebookFollowers)||0,instagramFollowers:Number(h.instagramFollowers)||0,facebookGroupMembers:Number(h.facebookGroupMembers)||0,youtubeSubscribers:Number(h.youtubeSubscribers)||0,linkedInFollowers:Number(h.linkedInFollowers)||0,xFollowers:Number(h.xFollowers)||0,pinterestView:Number(h.pinterestView)||0,bloggerImpression:Number(h.bloggerImpression)||0,totalReach:Number(h.totalReach)||0};r(N=>({...N,...w})),s([{_id:(p==null?void 0:p.updatedAt)||"latest",date:(p==null?void 0:p.updatedAt)||n.date,...w}]),i(null)}else s([]),i(null)}catch(p){console.error("Failed to load social metrics:",p),i(p.message||"Failed to load social metrics"),s([])}};d.useEffect(()=>{c()},[]);const u=async p=>{p.preventDefault(),l(null),i(null);try{await B.createSocial(n),l("Social metrics updated successfully!"),await c()}catch(h){console.error("Failed to save social metrics:",h),i(h.message||"Failed to save social metrics")}},x=[{key:"facebookFollowers",label:"Facebook",icon:Cc,color:"from-blue-500 to-blue-600"},{key:"instagramFollowers",label:"Instagram",icon:Yy,color:"from-pink-500 to-purple-600"},{key:"facebookGroupMembers",label:"FB Group",icon:Me,color:"from-blue-400 to-blue-500"},{key:"youtubeSubscribers",label:"YouTube",icon:tb,color:"from-red-500 to-red-600"},{key:"linkedInFollowers",label:"LinkedIn",icon:Ac,color:"from-cyan-500 to-cyan-600"},{key:"xFollowers",label:"X (Twitter)",icon:Zy,color:"from-gray-700 to-gray-800"},{key:"pinterestView",label:"Pinterest",icon:Co,color:"from-red-600 to-red-700"},{key:"bloggerImpression",label:"Blogger",icon:St,color:"from-orange-500 to-orange-600"},{key:"totalReach",label:"Total Reach",icon:Ht,color:"from-green-500 to-green-600"}],m=d.useMemo(()=>n.facebookFollowers+n.instagramFollowers+n.facebookGroupMembers+n.youtubeSubscribers+n.linkedInFollowers+n.xFollowers,[n]);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-pink-600 p-5",children:e.jsxs("div",{className:"flex items-center justify-between text-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Ot,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"Social Media Metrics"}),e.jsx("p",{className:"text-sm text-white/80",children:"Track your social presence"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-white/80",children:"Total Followers"}),e.jsx("p",{className:"text-2xl font-bold",children:m.toLocaleString()})]})]})}),e.jsxs("div",{className:"p-5",children:[a&&e.jsxs("div",{className:"mb-3 p-3 bg-green-50 border-l-4 border-green-500 text-green-700 rounded-lg",children:[" ",a]}),o&&e.jsxs("div",{className:"mb-3 p-3 bg-red-50 border-l-4 border-red-500 text-red-700 rounded-lg",children:[" ",o]}),t.length>0&&e.jsx("div",{className:"mb-4 grid grid-cols-2 gap-2",children:x.map(p=>{const h=p.icon,w=n[p.key];return e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-lg p-3 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`p-1.5 bg-gradient-to-r ${p.color} rounded-lg`,children:e.jsx(h,{className:"w-3 h-3 text-white"})}),e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:p.label})]}),e.jsx("div",{className:"text-lg font-bold text-gray-800",children:w.toLocaleString()})]},p.key)})}),e.jsxs("form",{onSubmit:u,className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Ot,{className:"w-4 h-4 text-purple-600"}),e.jsx("h3",{className:"text-sm font-semibold text-purple-900",children:"Update Metrics"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full border-2 border-purple-200 rounded-lg px-3 py-2 focus:border-purple-500 focus:outline-none transition-colors bg-white",value:n.date,onChange:p=>r(h=>({...h,date:p.target.value})),required:!0})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-3",children:x.map(p=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-gray-600 mb-1 flex items-center gap-1",children:[e.jsx(p.icon,{className:"w-3 h-3"}),p.label]}),e.jsx("input",{type:"number",min:"0",className:"w-full border-2 border-purple-200 rounded-lg px-3 py-2 focus:border-purple-500 focus:outline-none transition-colors bg-white text-sm",value:n[p.key],onChange:h=>r(w=>({...w,[p.key]:Number(h.target.value)}))})]},p.key))}),e.jsxs("button",{className:"w-full bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-lg px-4 py-2.5 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"}),"Update Metrics"]})]}),t.length>0&&e.jsxs("div",{className:"mt-3 text-xs text-gray-500 text-center",children:["Last updated: ",new Date(t[0].date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})]})]})]})}function KN(){const[t,s]=d.useState([]),[n,r]=d.useState(!1),[a,l]=d.useState({date:new Date().toISOString().slice(0,10),typeOfWork:"Blogpost",challenge:"",details:""}),[o,i]=d.useState(null),[c,u]=d.useState(null),x=async()=>{try{const w=await B.listSEO();let N=[];Array.isArray(w)?N=w:Array.isArray(w==null?void 0:w.seo)?N=w.seo:Array.isArray(w==null?void 0:w.items)&&(N=w.items),s(N)}catch(w){u(w.message)}};d.useEffect(()=>{x()},[]);const m=async w=>{w.preventDefault(),i(null),u(null);try{await B.createSEO(a),i("SEO report added successfully!"),l({date:new Date().toISOString().slice(0,10),typeOfWork:"Blogpost",challenge:"",details:""}),r(!1),x()}catch(N){u(N.message)}},p={Blogpost:"bg-green-100 text-green-800",Backlink:"bg-blue-100 text-blue-800","Social Bookmarking":"bg-purple-100 text-purple-800","Keyword Research":"bg-orange-100 text-orange-800",Others:"bg-gray-100 text-gray-800"},h=d.useMemo(()=>{const w={};return t.forEach(N=>{w[N.typeOfWork]=(w[N.typeOfWork]||0)+1}),{total:t.length,byType:w}},[t]);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-teal-600 p-5",children:e.jsxs("div",{className:"flex items-center justify-between text-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(An,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:"SEO Activities"}),e.jsx("p",{className:"text-sm text-white/80",children:"Track your SEO work"})]})]}),e.jsxs("button",{onClick:()=>r(!0),className:"bg-white text-green-600 rounded-lg px-4 py-2 font-semibold hover:bg-green-50 transition-colors flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),"Add Report"]})]})}),e.jsxs("div",{className:"p-5",children:[o&&e.jsxs("div",{className:"mb-3 p-3 bg-green-50 border-l-4 border-green-500 text-green-700 rounded-lg",children:[" ",o]}),c&&e.jsxs("div",{className:"mb-3 p-3 bg-red-50 border-l-4 border-red-500 text-red-700 rounded-lg",children:[" ",c]}),h.total>0&&e.jsxs("div",{className:"mb-4 bg-gradient-to-br from-green-50 to-teal-50 rounded-xl p-4 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-green-900",children:"Summary"}),e.jsxs("span",{className:"bg-green-600 text-white px-3 py-1 rounded-lg text-sm font-bold",children:[h.total," Reports"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(h.byType).map(([w,N])=>e.jsxs("div",{className:"bg-white rounded-lg p-2 border border-green-200",children:[e.jsx("div",{className:"text-xs text-gray-600",children:w}),e.jsx("div",{className:"text-lg font-bold text-gray-800",children:N})]},w))})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(An,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No SEO reports yet"}),e.jsx("button",{onClick:()=>r(!0),className:"mt-3 text-green-600 hover:text-green-700 font-medium text-sm",children:"Add your first report "})]}):t.map(w=>e.jsxs("div",{className:"bg-gray-50 hover:bg-gray-100 rounded-lg p-3 border border-gray-200 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-600",children:new Date(w.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${p[w.typeOfWork]||p.Others}`,children:w.typeOfWork})]}),w.challenge&&e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Challenge:"}),e.jsx("p",{className:"text-sm text-gray-700 mt-0.5",children:w.challenge})]}),w.details&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Details:"}),e.jsx("p",{className:"text-sm text-gray-700 mt-0.5",children:w.details})]})]},w._id))})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("form",{onSubmit:m,className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-green-500 to-teal-600 rounded-lg",children:e.jsx(An,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Add SEO Report"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-green-500 focus:outline-none transition-colors",value:a.date,onChange:w=>l(N=>({...N,date:w.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type of Work"}),e.jsxs("select",{className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-green-500 focus:outline-none transition-colors",value:a.typeOfWork,onChange:w=>l(N=>({...N,typeOfWork:w.target.value})),required:!0,children:[e.jsx("option",{children:"Blogpost"}),e.jsx("option",{children:"Backlink"}),e.jsx("option",{children:"Social Bookmarking"}),e.jsx("option",{children:"Keyword Research"}),e.jsx("option",{children:"Others"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Challenge"}),e.jsx("input",{className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-green-500 focus:outline-none transition-colors",value:a.challenge,onChange:w=>l(N=>({...N,challenge:w.target.value})),placeholder:"What challenges did you face?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Details"}),e.jsx("textarea",{rows:"4",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-green-500 focus:outline-none transition-colors resize-none",value:a.details,onChange:w=>l(N=>({...N,details:w.target.value})),placeholder:"Describe the work you did..."})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-5 py-2.5 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-5 py-2.5 rounded-lg bg-gradient-to-r from-green-500 to-teal-600 text-white font-semibold hover:shadow-lg transition-all flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),"Save Report"]})]})]})})]})}function ZN(){const[t,s]=d.useState("Meta Ads"),[n,r]=d.useState([]),[a,l]=d.useState(null),[o,i]=d.useState(!1),[c,u]=d.useState(!1),[x,m]=d.useState(null),[p,h]=d.useState(null),[w,N]=d.useState({campaignName:"",platform:"Meta Ads",boostType:"Leads",cost:"",leads:"",postEngagements:"",thruPlays:"",impressions:"",reach:"",notes:""});d.useEffect(()=>{k()},[t]);async function k(){i(!0),h(null);try{const[j,S]=await Promise.all([B.listDMCampaigns(t).catch(R=>(console.warn("Campaigns fetch failed",R),{campaigns:[]})),B.getDMCampaignsSummary(t).catch(R=>(console.warn("Summary fetch failed",R),{summary:null}))]),C=Array.isArray(j==null?void 0:j.campaigns)?j.campaigns:[];r(C);const A=S!=null&&S.summary&&typeof S.summary=="object"?S.summary:null;l(A)}catch(j){console.error("Failed to fetch campaigns:",j),h(j.message||"Failed to load campaigns"),r([]),l(null)}finally{i(!1)}}function v(j){const{name:S,value:C}=j.target;N(A=>({...A,[S]:C}))}async function g(j){j.preventDefault();try{const S={...w,cost:Number(w.cost),leads:Number(w.leads)||0,postEngagements:Number(w.postEngagements)||0,thruPlays:Number(w.thruPlays)||0,impressions:Number(w.impressions)||0,reach:Number(w.reach)||0};x?await B.updateDMCampaign(x,S):await B.createDMCampaign(S),N({campaignName:"",platform:"Meta Ads",boostType:"Leads",cost:"",leads:"",postEngagements:"",thruPlays:"",impressions:"",reach:"",notes:""}),u(!1),m(null),await k()}catch(S){alert("Error: "+(S.message||"Failed to save campaign"))}}async function b(j){if(window.confirm("Are you sure you want to delete this campaign?"))try{await B.deleteDMCampaign(j),await k()}catch(S){alert("Error: "+(S.message||"Failed to delete"))}}function y(j){N({campaignName:j.campaignName||"",platform:j.platform||"Meta Ads",boostType:j.boostType||"Leads",cost:(j.cost||0).toString(),leads:(j.leads||0).toString(),postEngagements:(j.postEngagements||0).toString(),thruPlays:(j.thruPlays||0).toString(),impressions:(j.impressions||0).toString(),reach:(j.reach||0).toString(),notes:j.notes||""}),m(j._id),u(!0)}return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(Ht,{className:"w-5 h-5 text-blue-600"}),"Ad Campaigns"]}),e.jsxs("button",{onClick:()=>{u(!c),m(null),N({campaignName:"",platform:"Meta Ads",boostType:"Leads",cost:"",leads:"",postEngagements:"",thruPlays:"",impressions:"",reach:"",notes:""})},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm",children:[e.jsx(ss,{className:"w-4 h-4"})," ",c?"Cancel":"Add Campaign"]})]}),p&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border-l-4 border-red-500 text-red-700 rounded-lg text-sm",children:[" ",p]}),e.jsxs("div",{className:"mb-6 flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Platform:"}),e.jsxs("select",{value:t,onChange:j=>s(j.target.value),className:"px-3 py-2 border rounded-lg bg-white text-sm",children:[e.jsx("option",{value:"Meta Ads",children:"Meta Ads"}),e.jsx("option",{value:"LinkedIn Ads",children:"LinkedIn Ads"})]})]}),a&&typeof a=="object"&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-3 border border-blue-200",children:[e.jsx("div",{className:"text-xs text-blue-600 font-semibold uppercase",children:"Total Cost"}),e.jsxs("div",{className:"text-xl font-bold text-blue-900 mt-1",children:["",(Number(a.totalCost)||0).toLocaleString("en-IN")]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-3 border border-green-200",children:[e.jsx("div",{className:"text-xs text-green-600 font-semibold uppercase",children:"Total Leads"}),e.jsx("div",{className:"text-xl font-bold text-green-900 mt-1",children:Number(a.totalLeads)||0})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-3 border border-purple-200",children:[e.jsx("div",{className:"text-xs text-purple-600 font-semibold uppercase",children:"Avg CPL"}),e.jsxs("div",{className:"text-xl font-bold text-purple-900 mt-1",children:["",(Number(a.avgCostPerLead)||0).toFixed(2)]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-3 border border-orange-200",children:[e.jsx("div",{className:"text-xs text-orange-600 font-semibold uppercase",children:"Impressions"}),e.jsxs("div",{className:"text-xl font-bold text-orange-900 mt-1",children:[((Number(a.totalImpressions)||0)/1e3).toFixed(1),"K"]})]})]}),c&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:x?"Edit Campaign":"Add New Campaign"}),e.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Campaign Name *"}),e.jsx("input",{type:"text",name:"campaignName",value:w.campaignName,onChange:v,required:!0,className:"w-full px-3 py-2 border rounded text-sm",placeholder:"e.g., AI For Personal Camp"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Platform *"}),e.jsxs("select",{name:"platform",value:w.platform,onChange:v,className:"w-full px-3 py-2 border rounded text-sm",children:[e.jsx("option",{value:"Meta Ads",children:"Meta Ads"}),e.jsx("option",{value:"LinkedIn Ads",children:"LinkedIn Ads"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Boost Type *"}),e.jsxs("select",{name:"boostType",value:w.boostType,onChange:v,className:"w-full px-3 py-2 border rounded text-sm",children:[e.jsx("option",{value:"Leads",children:"Leads"}),e.jsx("option",{value:"Engagements",children:"Engagements"}),e.jsx("option",{value:"ThruPlays",children:"ThruPlays"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Cost () *"}),e.jsx("input",{type:"number",name:"cost",value:w.cost,onChange:v,required:!0,step:"0.01",className:"w-full px-3 py-2 border rounded text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Leads"}),e.jsx("input",{type:"number",name:"leads",value:w.leads,onChange:v,className:"w-full px-3 py-2 border rounded text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Engagements"}),e.jsx("input",{type:"number",name:"postEngagements",value:w.postEngagements,onChange:v,className:"w-full px-3 py-2 border rounded text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"ThruPlays"}),e.jsx("input",{type:"number",name:"thruPlays",value:w.thruPlays,onChange:v,className:"w-full px-3 py-2 border rounded text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Impressions"}),e.jsx("input",{type:"number",name:"impressions",value:w.impressions,onChange:v,className:"w-full px-3 py-2 border rounded text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",children:"Reach"}),e.jsx("input",{type:"number",name:"reach",value:w.reach,onChange:v,className:"w-full px-3 py-2 border rounded text-sm"})]}),e.jsxs("div",{className:"lg:col-span-3 flex gap-2",children:[e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded text-sm hover:bg-green-700 font-medium",children:[x?"Update":"Add"," Campaign"]}),e.jsx("button",{type:"button",onClick:()=>{u(!1),m(null)},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded text-sm hover:bg-gray-400",children:"Cancel"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:o&&n.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500 text-sm",children:"Loading campaigns..."}):n.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500 text-sm",children:"No campaigns yet. Add one to get started!"}):e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100 border-b border-gray-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Campaign"}),e.jsx("th",{className:"px-3 py-2 text-left font-semibold",children:"Type"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Cost ()"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Leads"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Eng"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Impressions"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"Reach"}),e.jsx("th",{className:"px-3 py-2 text-right font-semibold",children:"CPL"}),e.jsx("th",{className:"px-3 py-2 text-center font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:n.map((j,S)=>e.jsxs("tr",{className:`border-b border-gray-200 ${S%2===0?"bg-white":"bg-gray-50"} hover:bg-blue-50`,children:[e.jsx("td",{className:"px-3 py-2",children:j.campaignName||""}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium",children:j.boostType||"N/A"})}),e.jsx("td",{className:"px-3 py-2 text-right font-semibold",children:(j.cost||0).toLocaleString("en-IN")}),e.jsx("td",{className:"px-3 py-2 text-right",children:j.leads||0}),e.jsx("td",{className:"px-3 py-2 text-right",children:j.postEngagements||0}),e.jsxs("td",{className:"px-3 py-2 text-right",children:[((j.impressions||0)/1e3).toFixed(1),"K"]}),e.jsxs("td",{className:"px-3 py-2 text-right",children:[((j.reach||0)/1e3).toFixed(1),"K"]}),e.jsx("td",{className:"px-3 py-2 text-right font-semibold text-green-700",children:j.costPerLead?`${Number(j.costPerLead).toFixed(2)}`:""}),e.jsxs("td",{className:"px-3 py-2 text-center",children:[e.jsx("button",{onClick:()=>y(j),className:"text-blue-600 hover:text-blue-800 inline-block mr-2",title:"Edit",children:e.jsx(Edit2,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(j._id),className:"text-red-600 hover:text-red-800 inline-block",title:"Delete",children:e.jsx(cn,{className:"w-4 h-4"})})]})]},j._id))})]})})]})}function _s(t){if(!t)return"-";try{return new Date(t).toLocaleString()}catch{return t}}const Pm=[{key:"Assigned",path:"/admission/assigned",label:"Assigned Lead"},{key:"Counseling",path:"/admission/counseling",label:"Counseling"},{key:"In Follow Up",path:"/admission/follow-up",label:"In Follow-Up"},{key:"Admitted",path:"/admission/admitted",label:"Admitted"},{key:"Not Admitted",path:"/admission/not-admitted",label:"Not Admitted"}];function Or(){const{user:t}=ge(),s=fn(),n=d.useMemo(()=>{const r=Pm.find(a=>a.path===s.pathname);return r?r.key:"Assigned"},[s.pathname]);return(t==null?void 0:t.role)!=="Admission"&&(t==null?void 0:t.role)!=="Admin"&&(t==null?void 0:t.role)!=="SuperAdmin"?e.jsx("div",{className:"text-royal",children:"Access denied"}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy mb-3",children:"Admission Pipeline"}),e.jsxs("div",{className:"flex gap-2 mb-4 flex-wrap",children:[Pm.map(r=>e.jsx(ln,{to:r.path,className:`px-3 py-1.5 rounded-xl border ${n===r.key?"bg-gold text-navy border-gold":"hover:bg-[#f3f6ff]"}`,children:r.label},r.key)),n==="Admitted"&&(t==null?void 0:t.role)==="Admission"&&e.jsx(ln,{to:"/admission/fees",className:"ml-auto px-3 py-1.5 rounded-xl bg-gold text-navy font-semibold",children:"Admission Fees"})]}),e.jsx(ew,{status:n,canAct:(t==null?void 0:t.role)==="Admission"})]})}function ew({status:t,canAct:s}){var Wt;const[n,r]=d.useState([]),[a,l]=d.useState(""),[o,i]=d.useState(null),[c,u]=d.useState(null),[x,m]=d.useState(!1),[p,h]=d.useState(""),[w,N]=d.useState(null),[k,v]=d.useState(""),[g,b]=d.useState("Interested"),[y,j]=d.useState(!1),[S,C]=d.useState(""),[A,R]=d.useState(null),[O,U]=d.useState(!1),[I,M]=d.useState(null),[V,D]=d.useState(!1),[E,P]=d.useState(!1),[$,L]=d.useState(null),[W,F]=d.useState(""),[z,G]=d.useState(""),[ee,_]=d.useState([]),[te,K]=d.useState([]),[Y,oe]=d.useState(!1),[le,Z]=d.useState(null),[T,H]=d.useState(!1),[re,se]=d.useState(!1),[me,he]=d.useState(null),[ie,xe]=d.useState({leadId:"",courseName:"",totalAmount:"",nowPaying:"",method:"Bkash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""}),[pe,De]=d.useState(null),[ft,Ie]=d.useState(null),[ke,ls]=d.useState(!1),[gn,hs]=d.useState(""),[rt,Es]=d.useState("all"),[Ms,Et]=d.useState(""),[Ls,Ra]=d.useState("all"),[Ro,kr]=d.useState([]),$n=async()=>{try{const{leads:q}=await B.listAdmissionLeads(t);r(q||[]);const ae=new Set((q==null?void 0:q.filter(ye=>ye.interestedCourse).map(ye=>ye.interestedCourse))||[]);kr(Array.from(ae).sort()),u(null)}catch(q){u(q.message)}},$o=async()=>{oe(!0);try{const[q,ae]=await Promise.all([B.listCourses(),B.listBatches("Active")]);_((q==null?void 0:q.courses)||[]),K((ae==null?void 0:ae.batches)||[])}catch(q){console.error("Failed to load courses/batches:",q),u("Failed to load courses/batches: "+q.message)}finally{oe(!1)}};d.useEffect(()=>{$n()},[t]);const Fn=async(q,ae,ye="",_e="",Ce="",Ze="")=>{i(null),u(null);try{await B.updateLeadStatus(q,ae,ye,_e,Ce,Ze),i(`Status updated to ${ae}`),m(!1),h(""),N(null),v(""),j(!1),C(""),R(null),P(!1),L(null),F(""),G(""),U(!1),M(null),D(!1),$n()}catch(qe){u(qe.message)}},$a=q=>{L(q),F(""),G(""),Z(null),P(!0),$o(),Fo(q)},Fo=async q=>{H(!0);try{const ae=await B.checkAdmissionFeeStatus(q);Z(ae)}catch(ae){console.error("Failed to check fee status:",ae),Z({hasApprovedFee:!1,message:ae.message})}finally{H(!1)}},Oo=q=>{he(q),xe({leadId:q._id,courseName:q.interestedCourse||"",totalAmount:"",nowPaying:"",method:"Bkash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""}),De(null),Ie(null),se(!0)},Ye=async q=>{q.preventDefault(),De(null),Ie(null),ls(!0);try{const ae=Number(ie.totalAmount)||0,ye=Number(ie.nowPaying)||0,_e={...ie,amount:ye,totalAmount:ae,dueAmount:ae-ye};await B.createAdmissionFee(_e),De("Fee submitted for review"),setTimeout(()=>{se(!1),he(null),xe({leadId:"",courseName:"",totalAmount:"",nowPaying:"",method:"Bkash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""}),De(null)},1500)}catch(ae){Ie(ae.message)}finally{ls(!1)}},Ke=d.useMemo(()=>{let q=n;if(a.trim()){const ae=a.toLowerCase();q=q.filter(ye=>{var _e,Ce,Ze,qe,Mt,Ps,Is;return((_e=ye.leadId)==null?void 0:_e.toLowerCase().includes(ae))||((Ce=ye.name)==null?void 0:Ce.toLowerCase().includes(ae))||((Ze=ye.phone)==null?void 0:Ze.includes(ae))||((qe=ye.email)==null?void 0:qe.toLowerCase().includes(ae))||((Mt=ye.interestedCourse)==null?void 0:Mt.toLowerCase().includes(ae))||((Is=(Ps=ye.assignedTo)==null?void 0:Ps.name)==null?void 0:Is.toLowerCase().includes(ae))})}if(gn&&(q=q.filter(ae=>ae.interestedCourse===gn)),Ls!=="all"&&(q=q.filter(ae=>ae.priority===Ls)),t==="In Follow Up"&&rt!=="all"){const ae=new Date;ae.setHours(0,0,0,0),q=q.filter(ye=>{if(!ye.nextFollowUpDate)return!1;const _e=new Date(ye.nextFollowUpDate);_e.setHours(0,0,0,0);const Ce=new Date(ae);Ce.setDate(Ce.getDate()-1);const Ze=new Date(ae);if(Ze.setDate(Ze.getDate()+1),rt==="today")return _e.getTime()===ae.getTime();if(rt==="yesterday")return _e.getTime()===Ce.getTime();if(rt==="nextday")return _e.getTime()===Ze.getTime();if(rt==="bydate"&&Ms){const qe=new Date(Ms);return qe.setHours(0,0,0,0),_e.getTime()===qe.getTime()}return!1})}return q},[n,a,gn,Ls,t,rt,Ms]),ct=q=>s?t==="Assigned"?e.jsx(ps,{onClick:()=>Fn(q._id,"Counseling"),children:"Start Counseling"}):t==="Counseling"?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ps,{onClick:()=>$a(q._id),children:"Admitted"}),e.jsx(ps,{onClick:()=>{N(q._id),h(""),v(""),b(q.priority||"Interested"),m(!0)},children:"Follow-Up"}),e.jsx(ps,{variant:"danger",onClick:()=>{R(q._id),C(""),j(!0)},children:"Not Admitted"}),e.jsx(ps,{onClick:async()=>{try{u(null),D(!0);const ae=await B.getLeadHistory(q._id);M(ae.lead||ae),U(!0)}catch(ae){u(ae.message)}finally{D(!1)}},children:V?"Loading":"History"})]}):t==="In Follow Up"?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ps,{onClick:()=>$a(q._id),children:"Admitted"}),e.jsx(ps,{onClick:()=>{N(q._id),h(""),v(""),b(q.priority||"Interested"),m(!0)},children:"Follow-Up Again"}),e.jsx(ps,{variant:"danger",onClick:()=>{R(q._id),C(""),j(!0)},children:"Not Admitted"}),e.jsx(ps,{onClick:async()=>{try{u(null),D(!0);const ae=await B.getLeadHistory(q._id);M(ae.lead||ae),U(!0)}catch(ae){u(ae.message)}finally{D(!1)}},children:V?"Loading":"History"})]}):e.jsx("span",{className:"text-royal/60",children:""}):null;return e.jsxs("div",{children:[o&&e.jsx("div",{className:"mb-2 text-green-700",children:o}),c&&e.jsx("div",{className:"mb-2 text-red-600",children:c}),e.jsxs("div",{className:"mb-4 bg-white rounded-xl shadow-soft p-4 flex flex-wrap gap-3 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Course:"}),e.jsxs("select",{value:gn,onChange:q=>hs(q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[e.jsx("option",{value:"",children:"All Courses"}),Ro.map(q=>e.jsx("option",{value:q,children:q},q))]})]}),t==="In Follow Up"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Priority:"}),e.jsxs("select",{value:Ls,onChange:q=>Ra(q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[e.jsx("option",{value:"all",children:"All Priorities"}),e.jsx("option",{value:"Very Interested",children:"Very Interested"}),e.jsx("option",{value:"Interested",children:"Interested"}),e.jsx("option",{value:"Few Interested",children:"Few Interested"}),e.jsx("option",{value:"Not Interested",children:"Not Interested"})]})]}),t==="In Follow Up"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Follow-up Date:"}),e.jsxs("select",{value:rt,onChange:q=>{Es(q.target.value),q.target.value!=="bydate"&&Et("")},className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",children:[e.jsx("option",{value:"all",children:"All Dates"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"yesterday",children:"Yesterday"}),e.jsx("option",{value:"nextday",children:"Next Day"}),e.jsx("option",{value:"bydate",children:"By Date"})]})]}),rt==="bydate"&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"date",value:Ms,onChange:q=>Et(q.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-400"})})]}),(gn||Ls!=="all"||rt!=="all"||Ms)&&e.jsx("button",{onClick:()=>{hs(""),Ra("all"),Es("all"),Et("")},className:"ml-auto px-3 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"Reset Filters"})]}),e.jsxs("div",{className:"mb-4 bg-white rounded-xl shadow-soft p-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:" Search by Lead ID, Name, Phone, Email, Course, or Assigned Member...",className:"w-full border border-blue-300 rounded-lg px-4 py-3 pl-10 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 bg-blue-50",value:a,onChange:q=>l(q.target.value)}),e.jsx("svg",{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),a&&e.jsx("button",{type:"button",onClick:()=>l(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 bg-white rounded-full p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a&&e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:[" Showing ",Ke.length," of ",n.length," lead(s)"]})]}),E&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>P(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-6 z-10 w-full max-w-md shadow-lg",children:[e.jsx("h3",{className:"text-xl font-bold text-navy mb-4",children:"Admit Student"}),T?e.jsx("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin",children:""}),e.jsx("p",{className:"text-sm text-blue-700 ml-2",children:"Checking admission fees..."})]})}):le!=null&&le.hasApprovedFee?e.jsx("div",{className:"mb-4 p-4 bg-green-50 rounded-lg border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-green-800",children:"Admission Fees Approved"}),e.jsx("p",{className:"text-sm text-green-700",children:"You can proceed with admission."})]})]})}):e.jsx("div",{className:"mb-4 p-4 bg-red-50 rounded-lg border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-red-800 mb-1",children:"Admission Fees Not Collected or Not Approved"}),e.jsx("p",{className:"text-sm text-red-700 mb-3",children:"Please collect and get approval for admission fees before marking student as admitted."}),e.jsx("button",{type:"button",onClick:()=>{P(!1);const q=n.find(ae=>ae._id===$);q&&Oo(q)},className:"inline-block px-3 py-1.5 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition",children:" Collect Admission Fees"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Course ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:W,onChange:q=>F(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-gold",disabled:Y||!(le!=null&&le.hasApprovedFee),required:!0,children:[e.jsx("option",{value:"",children:Y?"Loading...":"Select a course"}),ee.map(q=>e.jsxs("option",{value:q._id,children:[q.name," (",q.courseId,")"]},q._id))]}),ee.length===0&&!Y&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"No courses available"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Batch ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:z,onChange:q=>G(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-gold",disabled:Y||!(le!=null&&le.hasApprovedFee),required:!0,children:[e.jsx("option",{value:"",children:Y?"Loading...":"Select a batch"}),te.map(q=>{var ae;return e.jsxs("option",{value:q._id,children:[q.batchName," - ",q.category," (",((ae=q.admittedStudents)==null?void 0:ae.length)||0,"/",q.targetedStudent,")"]},q._id)})]}),te.length===0&&!Y&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"No active batches available. Contact admin to create a batch."})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{P(!1),L(null),F(""),G(""),Z(null)},className:"px-4 py-2 rounded-xl border border-gray-300 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>Fn($,"Admitted","",W,z),className:"px-4 py-2 rounded-xl bg-gold text-navy font-semibold hover:bg-yellow-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!W||!z||Y||!(le!=null&&le.hasApprovedFee),children:"Confirm Admission"})]})]})]}),re&&me&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fadeIn",children:e.jsxs("form",{onSubmit:Ye,className:"bg-white rounded-2xl shadow-2xl p-5 w-full max-w-lg transform transition-all max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#053867]",children:"Collect Admission Fees"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Student: ",e.jsx("span",{className:"font-semibold",children:me.name})," (",me.leadId,")"]})]}),e.jsx("button",{type:"button",onClick:()=>{se(!1),he(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),pe&&e.jsxs("div",{className:"mb-3 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm",children:[" ",pe]}),ft&&e.jsxs("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:[" ",ft]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Lead ID"}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-50",value:me.leadId,disabled:!0})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Student Name"}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm bg-gray-50",value:me.name,disabled:!0})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Course Name *"}),e.jsx("input",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0,placeholder:"e.g., Graphics Design Professional",value:ie.courseName,onChange:q=>xe(ae=>({...ae,courseName:q.target.value}))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Total Amount *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:""}),e.jsx("input",{type:"number",className:"w-full border border-green-300 rounded-lg pl-7 pr-3 py-2 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-green-400 bg-green-50",required:!0,placeholder:"0",min:"0",value:ie.totalAmount||"",onChange:q=>xe(ae=>({...ae,totalAmount:q.target.value}))})]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Now Paying *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:""}),e.jsx("input",{type:"number",className:"w-full border border-orange-300 rounded-lg pl-7 pr-3 py-2 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-orange-400 bg-orange-50",required:!0,placeholder:"0",min:"0",value:ie.nowPaying||"",onChange:q=>xe(ae=>({...ae,nowPaying:q.target.value}))})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Payment Method *"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white",value:ie.method,onChange:q=>xe(ae=>({...ae,method:q.target.value})),children:[e.jsx("option",{children:"Bkash"}),e.jsx("option",{children:"Nagad"}),e.jsx("option",{children:"Rocket"}),e.jsx("option",{children:"Bank Transfer"}),e.jsx("option",{children:"Cash on Hand"})]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Payment Date *"}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0,value:ie.paymentDate,onChange:q=>xe(ae=>({...ae,paymentDate:q.target.value}))})]})})]}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Next Payment Date (Optional)"}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",value:ie.nextPaymentDate||"",onChange:q=>xe(ae=>({...ae,nextPaymentDate:q.target.value}))})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Additional Note"}),e.jsx("textarea",{rows:"2",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 resize-none",placeholder:"Add any additional information...",value:ie.note||"",onChange:q=>xe(ae=>({...ae,note:q.target.value}))})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-4 mt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>{se(!1),he(null)},className:"px-4 py-2 rounded-lg bg-gray-100 text-gray-700 text-sm font-medium hover:bg-gray-200 transition-colors",disabled:ke,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:ke,className:"px-4 py-2 rounded-lg bg-gradient-to-r from-[#F7BA23] to-[#f5a623] text-[#053867] text-sm font-bold hover:shadow-lg transition-all flex items-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed",children:ke?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Submit Fee"]})})]})]})}),x&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>m(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-4 z-10 w-full max-w-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Add Follow-Up Note"}),e.jsx("textarea",{rows:4,className:"w-full border rounded-xl px-3 py-2 mb-3",value:p,onChange:q=>h(q.target.value),placeholder:"Enter follow-up note (optional)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Next Follow-Up Date"}),e.jsx("input",{type:"date",value:k,onChange:q=>v(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-gold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsxs("select",{value:g,onChange:q=>b(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-gold",children:[e.jsx("option",{value:"Very Interested",children:"Very Interested"}),e.jsx("option",{value:"Interested",children:"Interested"}),e.jsx("option",{value:"Few Interested",children:"Few Interested"}),e.jsx("option",{value:"Not Interested",children:"Not Interested"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{m(!1),h(""),N(null),v(""),b("Interested")},className:"px-3 py-2 rounded-xl border",children:"Cancel"}),e.jsx("button",{type:"button",onClick:async()=>{try{u(null),await B.addLeadFollowUp(w,{note:p,nextFollowUpDate:k,priority:g}),i("Follow-up added successfully"),m(!1),h(""),N(null),v(""),b("Interested"),$n()}catch(q){u(q.message)}},className:"px-3 py-2 rounded-xl bg-gold text-navy",children:"Save Follow-Up"})]})]})]}),O&&I&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>U(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-6 z-10 w-full max-w-3xl shadow-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 text-navy",children:["Lead History  ",I.leadId]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Name:"})," ",e.jsx("strong",{children:I.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"})," ",e.jsx("strong",{children:I.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email:"})," ",e.jsx("strong",{children:I.email||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Course:"})," ",e.jsx("strong",{children:I.interestedCourse||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"})," ",e.jsx("strong",{className:"text-indigo-600",children:I.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Assigned To:"})," ",e.jsx("strong",{children:((Wt=I.assignedTo)==null?void 0:Wt.name)||"-"})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"border-l-4 border-blue-400 pl-4 py-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Assigned At"}),e.jsx("div",{className:"font-semibold",children:I.assignedAt?_s(I.assignedAt):e.jsx("span",{className:"text-gray-400",children:"Not recorded"})})]}),e.jsxs("div",{className:"border-l-4 border-purple-400 pl-4 py-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Counseling At"}),e.jsx("div",{className:"font-semibold",children:I.counselingAt?_s(I.counselingAt):e.jsx("span",{className:"text-gray-400",children:"Not yet"})})]}),e.jsxs("div",{className:"border-l-4 border-green-400 pl-4 py-2",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Admitted At"}),e.jsx("div",{className:"font-semibold",children:I.admittedAt?_s(I.admittedAt):e.jsx("span",{className:"text-gray-400",children:"Not admitted yet"})}),I.admittedToCourse&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Course: ",e.jsx("strong",{children:I.admittedToCourse.name})]}),I.admittedToBatch&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Batch: ",e.jsx("strong",{children:I.admittedToBatch.name})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"font-bold text-navy mb-2",children:["Follow-ups (",(I.followUps||[]).length,")"]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:(I.followUps||[]).length===0?e.jsx("div",{className:"text-gray-500 text-sm bg-gray-50 p-3 rounded-lg",children:"No follow-ups recorded"}):(I.followUps||[]).map((q,ae)=>{var ye;return e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border-l-4 border-orange-400",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:_s(q.at)}),((ye=q.by)==null?void 0:ye.name)&&e.jsxs("div",{className:"text-xs text-gray-500",children:["by ",q.by.name]}),e.jsx("div",{className:"text-sm text-gray-800 mt-1",children:q.note||e.jsx("span",{className:"text-gray-400",children:"No note"})}),q.nextFollowUpDate&&e.jsxs("div",{className:"text-xs text-indigo-600 mt-1",children:["Next follow-up: ",new Date(q.nextFollowUpDate).toLocaleDateString("en-GB")]})]})})},ae)})})]}),I.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-bold text-navy mb-2",children:"Additional Notes"}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm",children:I.notes})]}),e.jsx("div",{className:"mt-6 flex justify-end gap-2",children:e.jsx("button",{onClick:()=>U(!1),className:"px-4 py-2 rounded-xl border border-gray-300 hover:bg-gray-50",children:"Close"})})]})]}),y&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>j(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-4 z-10 w-full max-w-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Reason for Not Admitted"}),e.jsx("textarea",{rows:6,className:"w-full border rounded-xl px-3 py-2 mb-3",value:S,onChange:q=>C(q.target.value),placeholder:"Enter reason (optional)"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{j(!1),C(""),R(null)},className:"px-3 py-2 rounded-xl border",children:"Cancel"}),e.jsx("button",{type:"button",onClick:()=>Fn(A,"Not Admitted",S),className:"px-3 py-2 rounded-xl bg-red-600 text-white",children:"Save"})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Lead ID"}),e.jsx("th",{className:"p-3 text-left",children:"Name"}),e.jsx("th",{className:"p-3 text-left",children:"Phone / Email"}),e.jsx("th",{className:"p-3 text-left",children:"Course"}),e.jsx("th",{className:"p-3 text-left",children:"Source"}),e.jsx("th",{className:"p-3 text-left",children:"Assigned To"}),t==="Assigned"&&e.jsx("th",{className:"p-3 text-left",children:"Assigned At"}),t==="Counseling"&&e.jsx("th",{className:"p-3 text-left",children:"Counseling At"}),t==="In Follow Up"&&e.jsx("th",{className:"p-3 text-left",children:"Follow-Ups"}),t==="In Follow Up"&&e.jsx("th",{className:"p-3 text-left",children:"Priority"}),t==="In Follow Up"&&e.jsx("th",{className:"p-3 text-left",children:"Next Follow-Up Date"}),t==="Admitted"&&e.jsx("th",{className:"p-3 text-left",children:"Admitted At"}),e.jsx("th",{className:"p-3 text-left",children:"Action"})]})}),e.jsxs("tbody",{children:[Ke.map(q=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{children:q.leadId}),(q.followUps||[]).length>0&&e.jsxs("div",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full",children:[(q.followUps||[]).length," FU"]})]})}),e.jsx("td",{className:"p-3",children:q.name}),e.jsxs("td",{className:"p-3",children:[e.jsx("div",{children:q.phone}),e.jsx("div",{className:"text-xs text-royal/70",children:q.email||"-"})]}),e.jsx("td",{className:"p-3",children:q.interestedCourse||"-"}),e.jsx("td",{className:"p-3",children:q.source}),e.jsx("td",{className:"p-3",children:q.assignedTo?q.assignedTo.name:"-"}),t==="Assigned"&&e.jsx("td",{className:"p-3",children:_s(q.assignedAt||q.updatedAt)}),t==="Counseling"&&e.jsx("td",{className:"p-3",children:_s(q.counselingAt||q.updatedAt)}),t==="In Follow Up"&&e.jsx("td",{className:"p-3",children:(q.followUps||[]).length===0?e.jsx("div",{className:"text-royal/70",children:"No follow-ups"}):e.jsx("div",{className:"flex flex-col gap-1",children:(q.followUps||[]).map((ae,ye)=>{var _e;return e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{className:"font-medium",children:_s(ae.at)}),e.jsxs("div",{className:"text-royal/70",children:[ae.note||"-"," ",(_e=ae.by)!=null&&_e.name?`  ${ae.by.name}`:""]})]},ye)})})}),t==="In Follow Up"&&e.jsx("td",{className:"p-3",children:e.jsx("div",{className:`text-xs font-semibold px-2 py-1 rounded-lg inline-block ${q.priority==="Very Interested"?"text-green-800 bg-green-100":q.priority==="Interested"?"text-blue-800 bg-blue-100":q.priority==="Few Interested"?"text-yellow-800 bg-yellow-100":q.priority==="Not Interested"?"text-red-800 bg-red-100":"text-gray-800 bg-gray-100"}`,children:q.priority||"Interested"})}),t==="In Follow Up"&&e.jsx("td",{className:"p-3",children:q.nextFollowUpDate?e.jsx("div",{className:`text-sm font-semibold px-2 py-1 rounded-lg ${(()=>{if(!q.nextFollowUpDate)return"text-gray-600 bg-gray-50";const ae=new Date(q.nextFollowUpDate),ye=new Date;return ye.setHours(0,0,0,0),ae.setHours(0,0,0,0),ae.getTime()<ye.getTime()?"text-red-700 bg-red-50":ae.getTime()===ye.getTime()?"text-orange-700 bg-orange-50":"text-green-700 bg-green-50"})()}`,children:new Date(q.nextFollowUpDate).toLocaleDateString()}):e.jsx("div",{className:"text-royal/70 text-xs",children:"-"})}),t==="Admitted"&&e.jsx("td",{className:"p-3",children:_s(q.admittedAt||q.updatedAt)}),e.jsx("td",{className:"p-3",children:ct(q)})]},q._id)),n.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:t==="In Follow Up"?"10":"8",children:"No leads"})}),n.length>0&&Ke.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70 text-center",colSpan:t==="In Follow Up"?"10":"8",children:"No leads found matching your filters"})})]})]})})]})}function ps({children:t,onClick:s,variant:n="default"}){const r=n==="danger"?"px-3 py-1 rounded-lg border text-red-700 hover:bg-red-50":"px-3 py-1 rounded-lg border hover:bg-[#f3f6ff]";return e.jsx("button",{onClick:s,className:r,children:t})}function tw(){var C,A,R,O;const{user:t}=ge();if((t==null?void 0:t.role)!=="Admission"&&(t==null?void 0:t.role)!=="Admin"&&(t==null?void 0:t.role)!=="SuperAdmin"&&(t==null?void 0:t.role)!=="Accountant"&&(t==null?void 0:t.role)!=="Coordinator")return e.jsx("div",{className:"text-royal",children:"Access denied"});const[s,n]=d.useState([]),[r,a]=d.useState([]),[l,o]=d.useState(""),[i,c]=d.useState(!1),[u,x]=d.useState(!1),[m,p]=d.useState(null),[h,w]=d.useState(null),[N,k]=d.useState(null),[v,g]=d.useState({leadId:"",courseName:"",totalAmount:"",nowPaying:"",method:"Bkash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""}),b=(t==null?void 0:t.role)==="Admission",y=async()=>{try{const[{fees:U},I]=await Promise.all([B.listAdmissionFees(),B.listAdmissionLeads()]);n(U||[]);const M=((I==null?void 0:I.leads)||[]).filter(V=>V.status!=="Admitted"&&V.status!=="Not Admitted");a(M)}catch(U){k(U.message)}};d.useEffect(()=>{y()},[]);const j=async U=>{U.preventDefault(),w(null),k(null);try{const I=Number(v.totalAmount)||0,M=Number(v.nowPaying)||0,V={...v,amount:M,totalAmount:I,dueAmount:I-M};await B.createAdmissionFee(V),w("Fee submitted for review"),c(!1),g({leadId:"",courseName:"",totalAmount:"",nowPaying:"",method:"Bkash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""}),o(""),y()}catch(I){k(I.message)}},S=ve.useMemo(()=>{if(!l.trim())return r;const U=l.toLowerCase();return r.filter(I=>{var M,V,D,E;return((M=I.leadId)==null?void 0:M.toLowerCase().includes(U))||((V=I.name)==null?void 0:V.toLowerCase().includes(U))||((D=I.phone)==null?void 0:D.includes(U))||((E=I.email)==null?void 0:E.toLowerCase().includes(U))})},[r,l]);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Admission Fees Collection"}),b&&e.jsx("button",{onClick:()=>c(!0),className:"bg-gold text-navy rounded-xl px-4 py-2 font-semibold",children:"Collect Admission Fees"})]}),h&&e.jsx("div",{className:"mb-2 text-green-700",children:h}),N&&e.jsx("div",{className:"mb-2 text-red-600",children:N}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Lead"}),e.jsx("th",{className:"p-3 text-left",children:"Course"}),e.jsx("th",{className:"p-3 text-left",children:"Total Amount"}),e.jsx("th",{className:"p-3 text-left",children:"Paid"}),e.jsx("th",{className:"p-3 text-left",children:"Due"}),e.jsx("th",{className:"p-3 text-left",children:"Method"}),e.jsx("th",{className:"p-3 text-left",children:"Payment Date"}),e.jsx("th",{className:"p-3 text-left",children:"Status"}),e.jsx("th",{className:"p-3 text-center",children:"Action"})]})}),e.jsxs("tbody",{children:[s.map(U=>{var I,M,V,D;return e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsxs("td",{className:"p-3",children:[(I=U.lead)==null?void 0:I.leadId,"  ",(M=U.lead)==null?void 0:M.name,e.jsxs("div",{className:"text-xs text-royal/70",children:[(V=U.lead)==null?void 0:V.phone," ",(D=U.lead)!=null&&D.email?` ${U.lead.email}`:""]})]}),e.jsx("td",{className:"p-3",children:U.courseName}),e.jsxs("td",{className:"p-3 font-semibold",children:[" ",U.totalAmount||0]}),e.jsxs("td",{className:"p-3 text-green-600 font-semibold",children:[" ",U.amount||0]}),e.jsxs("td",{className:"p-3 text-orange-600 font-semibold",children:[" ",U.dueAmount||0]}),e.jsx("td",{className:"p-3",children:U.method}),e.jsx("td",{className:"p-3",children:new Date(U.paymentDate).toLocaleDateString()}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${U.status==="Approved"?"bg-green-100 text-green-700":U.status==="Rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:U.status})}),e.jsx("td",{className:"p-3 text-center",children:e.jsxs("button",{onClick:()=>{p(U),x(!0)},className:"inline-flex items-center gap-1 px-3 py-1.5 bg-blue-500 text-white rounded-lg text-xs font-medium hover:bg-blue-600 transition-colors",children:[e.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View Details"]})})]},U._id)}),s.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:"9",children:"No fees yet"})})]})]})}),i&&b&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fadeIn",children:e.jsxs("form",{onSubmit:j,className:"bg-white rounded-2xl shadow-2xl p-5 w-full max-w-lg transform transition-all max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#053867]",children:"Collect Admission Fees"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Fill in the payment details"})]}),e.jsx("button",{type:"button",onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsxs("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Select Student (Your Assigned Leads - Not Admitted) *"]}),e.jsxs("div",{className:"relative mb-2",children:[e.jsx("input",{type:"text",placeholder:" Search by Lead ID, Name, Phone, or Email...",className:"w-full border border-blue-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 bg-blue-50",value:l,onChange:U=>o(U.target.value)}),l&&e.jsx("button",{type:"button",onClick:()=>o(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white max-h-48",required:!0,size:"5",value:v.leadId,onChange:U=>g(I=>({...I,leadId:U.target.value})),children:[e.jsx("option",{value:"",children:"Choose student..."}),S.length===0&&l&&e.jsxs("option",{value:"",disabled:!0,children:['No leads found matching "',l,'"']}),S.length===0&&!l&&e.jsx("option",{value:"",disabled:!0,children:"No eligible leads assigned to you"}),S.map(U=>e.jsxs("option",{value:U._id,children:[U.leadId,"  ",U.name," (",U.phone,")  Status: ",U.status]},U._id))]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[" Showing ",S.length," of ",r.length," eligible lead(s)"]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Course Name *"}),e.jsx("input",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0,placeholder:"e.g., Graphics Design Professional",value:v.courseName,onChange:U=>g(I=>({...I,courseName:U.target.value}))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Total Amount *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:""}),e.jsx("input",{type:"number",className:"w-full border border-green-300 rounded-lg pl-7 pr-3 py-2 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-green-400 bg-green-50",required:!0,placeholder:"0",min:"0",value:v.totalAmount||"",onChange:U=>g(I=>({...I,totalAmount:U.target.value}))})]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Now Paying *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:""}),e.jsx("input",{type:"number",className:"w-full border border-orange-300 rounded-lg pl-7 pr-3 py-2 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-orange-400 bg-orange-50",required:!0,placeholder:"0",min:"0",value:v.nowPaying||"",onChange:U=>g(I=>({...I,nowPaying:U.target.value}))})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Payment Method *"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white",value:v.method,onChange:U=>g(f={...f,method:U.target.value}),children:[e.jsx("option",{children:"Bkash"}),e.jsx("option",{children:"Nagad"}),e.jsx("option",{children:"Rocket"}),e.jsx("option",{children:"Bank Transfer"}),e.jsx("option",{children:"Cash on Hand"})]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Payment Date *"}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",required:!0,value:v.paymentDate,onChange:U=>g(f={...f,paymentDate:U.target.value})})]})})]}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Next Payment Date (Optional)"}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",value:v.nextPaymentDate||"",onChange:U=>g(I=>({...I,nextPaymentDate:U.target.value}))})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-xs font-semibold text-[#053867] mb-1.5 block",children:"Additional Note"}),e.jsx("textarea",{rows:"2",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400 resize-none",placeholder:"Add any additional information...",value:v.note||"",onChange:U=>g(I=>({...I,note:U.target.value}))})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-4 mt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 rounded-lg bg-gray-100 text-gray-700 text-sm font-medium hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-gradient-to-r from-[#F7BA23] to-[#f5a623] text-[#053867] text-sm font-bold hover:shadow-lg transition-all flex items-center gap-1.5",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Submit"]})]})]})}),u&&m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fadeIn",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-4 mb-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#053867]",children:"Fee Collection Details"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Complete information about this payment"})]}),e.jsx("button",{type:"button",onClick:()=>{x(!1),p(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-[#053867] mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Student Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Lead ID:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:(C=m.lead)==null?void 0:C.leadId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Name:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:(A=m.lead)==null?void 0:A.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:(R=m.lead)==null?void 0:R.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:((O=m.lead)==null?void 0:O.email)||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-[#053867] mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Payment Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Course:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:m.courseName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payment Method:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:m.method})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),e.jsxs("p",{className:"font-bold text-lg text-[#053867]",children:[" ",m.totalAmount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Amount Paid:"}),e.jsxs("p",{className:"font-bold text-lg text-green-600",children:[" ",m.amount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Due Amount:"}),e.jsxs("p",{className:"font-bold text-lg text-orange-600",children:[" ",m.dueAmount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("p",{children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${m.status==="Approved"?"bg-green-100 text-green-700":m.status==="Rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:m.status})})]})]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-[#053867] mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Important Dates"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payment Date:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:new Date(m.paymentDate).toLocaleDateString("en-GB")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Next Payment Date:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:m.nextPaymentDate?new Date(m.nextPaymentDate).toLocaleDateString("en-GB"):"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Submitted At:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:new Date(m.createdAt).toLocaleString("en-GB")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Last Updated:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:new Date(m.updatedAt).toLocaleString("en-GB")})]})]})]}),m.note&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-[#053867] mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Additional Notes"]}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:m.note})]})]}),e.jsx("div",{className:"flex justify-end mt-6 pt-4 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{x(!1),p(null)},className:"px-6 py-2 rounded-lg bg-gray-100 text-gray-700 text-sm font-medium hover:bg-gray-200 transition-colors",children:"Close"})})]})})]})}function zs(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function sw(){const{user:t}=ge(),[s,n]=d.useState("daily"),[r,a]=d.useState(""),[l,o]=d.useState(""),[i,c]=d.useState(null),[u,x]=d.useState(!1),[m,p]=d.useState([]),[h,w]=d.useState((t==null?void 0:t._id)||"me"),[N,k]=d.useState(!1),v=(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin",g=(t==null?void 0:t.role)==="Admission",b=v||g,[y,j]=d.useState(!1);d.useEffect(()=>{v&&B.listAdmissionUsers().then(O=>{p((O==null?void 0:O.users)||[])}).catch(()=>{})},[v]),d.useEffect(()=>{C()},[s,r,l,h]);function S(){if(s==="custom")return r&&l?{from:zs(r),to:zs(l)}:{from:null,to:null};const O=new Date;if(s==="daily"){const U=new Date(O);U.setHours(0,0,0,0);const I=new Date(O);return I.setHours(23,59,59,999),{from:zs(U),to:zs(I)}}if(s==="weekly"){const U=new Date(O);return U.setDate(O.getDate()-7),U.setHours(0,0,0,0),{from:zs(U),to:zs(O)}}if(s==="monthly"){const U=new Date(O);return U.setMonth(O.getMonth()-1),U.setHours(0,0,0,0),{from:zs(U),to:zs(O)}}return{from:null,to:null}}async function C(){x(!0);try{const O=S(),U=v?h==="me"?t._id:h==="all"?void 0:h:t._id,I=B.getAdmissionMetrics(U,O.from,O.to).catch(E=>(console.warn("getAdmissionMetrics failed",E),null)),M=B.getAdmissionReports(U,O.from,O.to).catch(E=>(console.warn("getAdmissionReports failed",E),null)),[V,D]=await Promise.all([I,M]);c({metricsResp:V,reportsResp:D})}catch(O){console.error("Failed to load metrics",O),c(null)}finally{x(!1)}}const A={counselingCount:0,followUpCount:0,admittedCount:0,interestedCount:0,notInterestedCount:0};if(i){const{metricsResp:O,reportsResp:U}=i;if(O&&(O.stats?(A.counselingCount=O.stats.counseling||0,A.followUpCount=O.stats.followUps||O.stats.followUp||0):(A.counselingCount=O.counselingCount||O.counseling||0,A.followUpCount=O.followUpCount||O.followUps||0)),U){const I=U.stats||{};A.admittedCount=I.admitted||0;let M=[];Array.isArray(U.leads)?M=U.leads:Array.isArray(U.reports)&&(M=[].concat(...U.reports.map(P=>P.leads||[])));const V=new Set(["Very Interested","Interested","Few Interested"]);let D=0,E=0;M.forEach(P=>{const $=P.priority;$&&V.has($)?D++:$==="Not Interested"&&E++}),D+E===0&&(I.interested!==void 0||I.notInterested!==void 0)&&(D=I.interested||0,E=I.notInterested||0),A.interestedCount=D,A.notInterestedCount=E}}async function R(){var O;k(!0);try{const U=S(),I=v?h==="all"?"all":h==="me"?t.name:((O=m.find(L=>L._id===h))==null?void 0:O.name)||"user":t.name,M=[];M.push(["Report For",I]),M.push(["Period",s==="custom"&&r&&l?`${r} to ${l}`:s]),M.push([]),M.push(["Metric","Value"]),M.push(["Total Counseling Calls",A.counselingCount]),M.push(["Total Follow-up Calls",A.followUpCount]),M.push(["Total Admitted",A.admittedCount]),M.push(["Total Interested",A.interestedCount]),M.push(["Total Not Interested",A.notInterestedCount]);const V=M.map(L=>L.map(W=>`"${String(W??"")}"`).join(",")).join(`
`),D=new Blob([V],{type:"text/csv;charset=utf-8;"}),E=URL.createObjectURL(D),P=document.createElement("a"),$=`admission-brief-${I.replace(/\s+/g,"-")}-${new Date().toISOString().slice(0,10)}.csv`;P.href=E,P.download=$,document.body.appendChild(P),P.click(),P.remove(),URL.revokeObjectURL(E)}catch(U){console.error("Download failed",U),alert(U.message||"Download failed")}finally{k(!1)}}return e.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Admission Metrics"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Counseling and Follow-up counts (today / weekly / monthly / custom)"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:s,onChange:O=>n(O.target.value),className:"px-3 py-2 border rounded-lg bg-white",children:[e.jsx("option",{value:"daily",children:"Today"}),e.jsx("option",{value:"weekly",children:"Last 7 days"}),e.jsx("option",{value:"monthly",children:"Last 30 days"}),e.jsx("option",{value:"lifetime",children:"Lifetime"}),e.jsx("option",{value:"custom",children:"Custom"})]}),s==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:r,onChange:O=>a(O.target.value),className:"px-3 py-2 border rounded-lg bg-white"}),e.jsx("span",{className:"text-sm text-gray-500",children:"to"}),e.jsx("input",{type:"date",value:l,onChange:O=>o(O.target.value),className:"px-3 py-2 border rounded-lg bg-white"})]})]})]}),b&&e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[v&&e.jsxs("select",{value:h||"all",onChange:O=>w(O.target.value),className:"px-3 py-2 border rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"Overall Team"}),e.jsx("option",{value:"me",children:"My Metrics"}),m.map(O=>e.jsxs("option",{value:O._id,children:[O.name," (",O.email,")"]},O._id))]}),e.jsx("button",{onClick:C,disabled:u,className:"px-3 py-2 border rounded-lg bg-white",children:"Refresh"}),e.jsxs("button",{onClick:R,disabled:N,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg",children:[e.jsx(ts,{className:"w-4 h-4"})," ",N?"Downloading...":"Download CSV"]}),e.jsxs("label",{className:"ml-2 text-sm text-gray-600 flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:O=>j(O.target.checked)})," Show raw data"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Counseling (New Calls)"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:u?"":A.counselingCount??0}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"New counseling calls in selected period"})]}),e.jsx("div",{className:"text-gray-300",children:e.jsx(fe,{className:"w-10 h-10"})})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Follow-up Calls"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:u?"":A.followUpCount??0}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Follow-up events (notes) in selected period"})]}),e.jsx("div",{className:"text-gray-300",children:e.jsx(fe,{className:"w-10 h-10"})})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Admitted"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:u?"":A.admittedCount??0}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Total admitted in period"})]}),e.jsx("div",{className:"text-gray-300",children:e.jsx(fe,{className:"w-10 h-10"})})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Interested"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:u?"":A.interestedCount??0}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Leads marked interested in period"})]}),e.jsx("div",{className:"text-gray-300",children:e.jsx(fe,{className:"w-10 h-10"})})]})}),e.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Not Interested"}),e.jsx("div",{className:"text-3xl font-bold mt-2",children:u?"":A.notInterestedCount??0}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Leads marked not interested in period"})]}),e.jsx("div",{className:"text-gray-300",children:e.jsx(fe,{className:"w-10 h-10"})})]})})]}),y&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-100",children:[e.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Raw Data (debug)"}),e.jsx("pre",{className:"text-xs text-gray-600 max-h-60 overflow-auto",children:u?"Loading...":i?JSON.stringify(i,null,2):"No data"})]}),i&&!i.reportsResp&&e.jsx("div",{className:"mt-4 text-sm text-yellow-700 bg-yellow-50 border border-yellow-100 rounded p-3",children:"Detailed report data is not available for this request. The summary metrics above are shown from aggregated data. If you expect non-zero values, try adjusting the date range or click Refresh."})]})}function nw(){var k,v,g,b,y;const{user:t}=ge();if((t==null?void 0:t.role)!=="Accountant")return e.jsx("div",{className:"text-royal",children:"Only Accountant can approve fees."});const[s,n]=d.useState("Pending"),[r,a]=d.useState([]),[l,o]=d.useState(!1),[i,c]=d.useState(null),[u,x]=d.useState(null),[m,p]=d.useState(null),h=async()=>{try{const{fees:j}=await B.listFeesForApproval(s);a(j||[]),p(null)}catch(j){p(j.message)}};d.useEffect(()=>{h()},[s]);const w=async j=>{x(null),p(null);try{await B.approveFee(j),x("Approved"),h()}catch(S){p(S.message)}},N=async j=>{x(null),p(null);try{await B.rejectFee(j),x("Rejected"),h()}catch(S){p(S.message)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Fees Approval"}),e.jsxs("select",{value:s,onChange:j=>n(j.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{children:"Pending"}),e.jsx("option",{children:"Approved"}),e.jsx("option",{children:"Rejected"})]})]}),u&&e.jsx("div",{className:"mb-2 text-green-700",children:u}),m&&e.jsx("div",{className:"mb-2 text-red-600",children:m}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Lead"}),e.jsx("th",{className:"p-3 text-left",children:"Course"}),e.jsx("th",{className:"p-3 text-left",children:"Total Amount"}),e.jsx("th",{className:"p-3 text-left",children:"Paid"}),e.jsx("th",{className:"p-3 text-left",children:"Due"}),e.jsx("th",{className:"p-3 text-left",children:"Method"}),e.jsx("th",{className:"p-3 text-left",children:"Payment Date"}),e.jsx("th",{className:"p-3 text-left",children:"Submitted By"}),e.jsx("th",{className:"p-3 text-left",children:"Status"}),e.jsx("th",{className:"p-3 text-center",children:"Action"})]})}),e.jsxs("tbody",{children:[r.map(j=>{var S,C,A,R,O;return e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsxs("td",{className:"p-3",children:[(S=j.lead)==null?void 0:S.leadId,"  ",(C=j.lead)==null?void 0:C.name,e.jsxs("div",{className:"text-xs text-royal/70",children:[(A=j.lead)==null?void 0:A.phone," ",(R=j.lead)!=null&&R.email?` ${j.lead.email}`:""]})]}),e.jsx("td",{className:"p-3",children:j.courseName}),e.jsxs("td",{className:"p-3 font-semibold",children:[" ",j.totalAmount||0]}),e.jsxs("td",{className:"p-3 text-green-600 font-semibold",children:[" ",j.amount||0]}),e.jsxs("td",{className:"p-3 text-orange-600 font-semibold",children:[" ",j.dueAmount||0]}),e.jsx("td",{className:"p-3",children:j.method}),e.jsx("td",{className:"p-3",children:new Date(j.paymentDate).toLocaleDateString()}),e.jsx("td",{className:"p-3",children:((O=j.submittedBy)==null?void 0:O.name)||"-"}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j.status==="Approved"?"bg-green-100 text-green-700":j.status==="Rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:j.status})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{onClick:()=>{c(j),o(!0)},className:"inline-flex items-center gap-1 px-2.5 py-1.5 bg-blue-500 text-white rounded-lg text-xs font-medium hover:bg-blue-600 transition-colors",children:[e.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Details"]}),s==="Pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(j._id),className:"px-2.5 py-1.5 rounded-lg text-xs font-medium bg-green-500 text-white hover:bg-green-600 transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>N(j._id),className:"px-2.5 py-1.5 rounded-lg text-xs font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:"Reject"})]})]})})]},j._id)}),r.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:"10",children:"No items"})})]})]})}),l&&i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 animate-fadeIn",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-4 mb-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-[#053867]",children:"Fee Collection Details"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Complete information about this payment"})]}),e.jsx("button",{type:"button",onClick:()=>{o(!1),c(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-[#053867] mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Student Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Lead ID:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:(k=i.lead)==null?void 0:k.leadId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Name:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:(v=i.lead)==null?void 0:v.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:(g=i.lead)==null?void 0:g.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:((b=i.lead)==null?void 0:b.email)||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-[#053867] mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Payment Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Course:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:i.courseName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payment Method:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:i.method})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),e.jsxs("p",{className:"font-bold text-lg text-[#053867]",children:[" ",i.totalAmount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Amount Paid:"}),e.jsxs("p",{className:"font-bold text-lg text-green-600",children:[" ",i.amount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Due Amount:"}),e.jsxs("p",{className:"font-bold text-lg text-orange-600",children:[" ",i.dueAmount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("p",{children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${i.status==="Approved"?"bg-green-100 text-green-700":i.status==="Rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:i.status})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Submitted By:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:((y=i.submittedBy)==null?void 0:y.name)||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-[#053867] mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Important Dates"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payment Date:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:new Date(i.paymentDate).toLocaleDateString("en-GB")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Next Payment Date:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:i.nextPaymentDate?new Date(i.nextPaymentDate).toLocaleDateString("en-GB"):"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Submitted At:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:new Date(i.createdAt).toLocaleString("en-GB")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Last Updated:"}),e.jsx("p",{className:"font-semibold text-[#053867]",children:new Date(i.updatedAt).toLocaleString("en-GB")})]})]})]}),i.note&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-[#053867] mb-2 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Additional Notes"]}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:i.note})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t border-gray-200",children:[s==="Pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{w(i._id),o(!1),c(null)},className:"px-5 py-2 rounded-lg bg-green-500 text-white text-sm font-medium hover:bg-green-600 transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>{N(i._id),o(!1),c(null)},className:"px-5 py-2 rounded-lg bg-red-500 text-white text-sm font-medium hover:bg-red-600 transition-colors",children:"Reject"})]}),e.jsx("button",{onClick:()=>{o(!1),c(null)},className:"px-6 py-2 rounded-lg bg-gray-100 text-gray-700 text-sm font-medium hover:bg-gray-200 transition-colors",children:"Close"})]})]})})]})}function rw(){var U,I,M,V,D,E,P;const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState("Pending"),[l,o]=d.useState(!1),[i,c]=d.useState(null),[u,x]=d.useState(null),[m,p]=d.useState(!1),[h,w]=d.useState(null),[N,k]=d.useState(""),[v,g]=d.useState(!1),y=(t==null?void 0:t.role)==="Accountant",j=async()=>{o(!0),c(null);try{const $=await B.getDueCollections(r);n($.dueCollections||[])}catch($){c($.message)}finally{o(!1)}};d.useEffect(()=>{j()},[r]);const S=async $=>{g(!0),c(null),x(null);try{await B.approveDueCollection($,N),x("Due collection approved successfully!"),p(!1),k(""),j()}catch(L){c(L.message)}finally{g(!1)}},C=async $=>{if(!N.trim()){c("Please provide a reason for rejection");return}g(!0),c(null),x(null);try{await B.rejectDueCollection($,N),x("Due collection rejected"),p(!1),k(""),j()}catch(L){c(L.message)}finally{g(!1)}},A=$=>{w($),k($.reviewNote||""),p(!0),c(null)},R=$=>$?new Date($).toLocaleDateString("en-GB"):"",O=$=>$==="Approved"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-lg bg-green-100 text-green-700 text-xs font-semibold",children:[e.jsx(it,{className:"w-3 h-3"})," Approved"]}):$==="Rejected"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-lg bg-red-100 text-red-700 text-xs font-semibold",children:[e.jsx(js,{className:"w-3 h-3"})," Rejected"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-lg bg-yellow-100 text-yellow-700 text-xs font-semibold",children:[e.jsx(Bt,{className:"w-3 h-3"})," Pending"]});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-navy",children:"Due Collection Approval"}),e.jsx("p",{className:"text-royal/60 mt-1",children:"Review and approve due fee collections from coordinators"})]})}),u&&e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-lg",children:e.jsx("p",{className:"text-green-700 font-medium",children:u})}),i&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:e.jsx("p",{className:"text-red-700 font-medium",children:i})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft p-2 inline-flex gap-2",children:["Pending","Approved","Rejected","All"].map($=>e.jsx("button",{onClick:()=>a($==="All"?"":$),className:`px-4 py-2 rounded-xl font-medium transition-all ${r===($==="All"?"":$)?"bg-gradient-to-r from-gold to-yellow-500 text-navy shadow-md":"text-royal/60 hover:text-royal hover:bg-gray-50"}`,children:$},$))}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-hidden",children:l?e.jsx("div",{className:"p-8 text-center text-royal/60",children:"Loading..."}):s.length===0?e.jsx("div",{className:"p-8 text-center text-royal/60",children:"No due collections found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Lead ID"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Student Name"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Amount"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Payment Date"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Coordinator"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Status"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Submitted"}),e.jsx("th",{className:"p-3 text-left text-sm font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:s.map(($,L)=>{var W,F,z;return e.jsxs("tr",{className:`border-t border-gray-100 hover:bg-gray-50 transition-colors ${L%2===0?"bg-white":"bg-gray-50/30"}`,children:[e.jsx("td",{className:"p-3 text-sm font-medium text-royal",children:((W=$.lead)==null?void 0:W.leadId)||""}),e.jsx("td",{className:"p-3 text-sm text-royal",children:((F=$.lead)==null?void 0:F.name)||""}),e.jsx("td",{className:"p-3 text-sm font-bold text-green-600",children:Pe($.amount||0)}),e.jsx("td",{className:"p-3 text-sm text-royal",children:R($.paymentDate)}),e.jsx("td",{className:"p-3 text-sm text-royal",children:((z=$.coordinator)==null?void 0:z.name)||""}),e.jsx("td",{className:"p-3 text-sm",children:O($.status)}),e.jsx("td",{className:"p-3 text-sm text-royal/60",children:R($.submittedAt)}),e.jsx("td",{className:"p-3",children:e.jsxs("button",{onClick:()=>A($),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg bg-royal/10 text-royal hover:bg-royal/20 transition-colors text-sm font-medium",children:[e.jsx(Co,{className:"w-4 h-4"}),"View"]})})]},$._id)})})]})})}),m&&h&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>p(!1)}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl z-10 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-navy to-royal p-6 text-white",children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Due Collection Details"}),e.jsx("p",{className:"text-white/80 mt-1",children:"Review and take action on this due collection"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-navy flex items-center gap-2",children:[e.jsx(fr,{className:"w-5 h-5"}),"Student Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-royal/60",children:"Lead ID:"}),e.jsx("p",{className:"font-semibold text-royal",children:((U=h.lead)==null?void 0:U.leadId)||""})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-royal/60",children:"Name:"}),e.jsx("p",{className:"font-semibold text-royal",children:((I=h.lead)==null?void 0:I.name)||""})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-royal/60",children:"Phone:"}),e.jsx("p",{className:"font-semibold text-royal",children:((M=h.lead)==null?void 0:M.phone)||""})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-royal/60",children:"Email:"}),e.jsx("p",{className:"font-semibold text-royal",children:((V=h.lead)==null?void 0:V.email)||""})]})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-4 space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-navy flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5"}),"Payment Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-royal/60",children:"Amount Collected:"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:Pe(h.amount||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-royal/60",children:"Payment Method:"}),e.jsxs("p",{className:"font-semibold text-royal flex items-center gap-1",children:[e.jsx(vd,{className:"w-4 h-4"}),h.paymentMethod||"Cash"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-royal/60",children:"Payment Date:"}),e.jsxs("p",{className:"font-semibold text-royal flex items-center gap-1",children:[e.jsx(fe,{className:"w-4 h-4"}),R(h.paymentDate)]})]}),h.nextPaymentDate&&e.jsxs("div",{children:[e.jsx("span",{className:"text-royal/60",children:"Next Payment Date:"}),e.jsxs("p",{className:"font-semibold text-royal flex items-center gap-1",children:[e.jsx(fe,{className:"w-4 h-4"}),R(h.nextPaymentDate)]})]})]}),h.note&&e.jsxs("div",{className:"pt-2 border-t border-green-200",children:[e.jsx("span",{className:"text-royal/60 text-sm",children:"Coordinator Note:"}),e.jsx("p",{className:"text-royal mt-1",children:h.note})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-navy",children:"Collected By"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-royal",children:((D=h.coordinator)==null?void 0:D.name)||""}),e.jsx("p",{className:"text-royal/60",children:((E=h.coordinator)==null?void 0:E.email)||""}),e.jsxs("p",{className:"text-royal/60 text-xs mt-1",children:["Submitted: ",R(h.submittedAt)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-xl p-4",children:[e.jsx("span",{className:"text-sm font-medium text-royal",children:"Current Status:"}),O(h.status)]}),h.status==="Pending"&&y&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Review Note (Optional for approval, required for rejection)"}),e.jsx("textarea",{value:N,onChange:$=>k($.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gold focus:border-gold",placeholder:"Add your review comments..."})]}),h.status!=="Pending"&&h.reviewedBy&&e.jsxs("div",{className:"bg-purple-50 rounded-xl p-4 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-navy",children:"Review Information"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-royal/60",children:"Reviewed By:"})," ",e.jsx("span",{className:"font-semibold text-royal",children:((P=h.reviewedBy)==null?void 0:P.name)||""})]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-royal/60",children:"Reviewed At:"})," ",e.jsx("span",{className:"font-semibold text-royal",children:R(h.reviewedAt)})]}),h.reviewNote&&e.jsxs("div",{className:"pt-2 border-t border-purple-200",children:[e.jsx("span",{className:"text-royal/60",children:"Review Note:"}),e.jsx("p",{className:"text-royal mt-1",children:h.reviewNote})]})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 p-6 flex justify-end gap-3 border-t",children:[e.jsx("button",{type:"button",onClick:()=>p(!1),className:"px-6 py-2.5 rounded-xl border border-gray-300 hover:bg-gray-100 transition-colors font-medium",disabled:v,children:"Close"}),h.status==="Pending"&&y&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>C(h._id),className:"px-6 py-2.5 rounded-xl bg-red-600 text-white hover:bg-red-700 transition-colors font-medium disabled:opacity-50",disabled:v,children:v?"Processing...":"Reject"}),e.jsx("button",{type:"button",onClick:()=>S(h._id),className:"px-6 py-2.5 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700 transition-colors font-medium shadow-lg disabled:opacity-50",disabled:v,children:v?"Processing...":"Approve"})]})]})]})]})]})}function aw(){const{user:t}=ge(),s=(t==null?void 0:t.role)==="Accountant";if(!s&&(t==null?void 0:t.role)!=="Admin"&&(t==null?void 0:t.role)!=="SuperAdmin")return e.jsx("div",{className:"text-royal",children:"Access denied"});const[n,r]=d.useState([]),[a,l]=d.useState({date:new Date().toISOString().slice(0,10),source:"Other",amount:0,note:""}),[o,i]=d.useState(!1),c=Rn(),[u,x]=d.useState(null),[m,p]=d.useState(null),h=async()=>{try{const{income:N}=await B.listIncome();r(N||[])}catch(N){p(N.message)}};d.useEffect(()=>{h()},[]);const w=async N=>{var k;(k=N==null?void 0:N.preventDefault)==null||k.call(N),x(null),p(null);try{await B.addIncome(a),x("Income added"),l({...a,amount:0}),i(!1),h()}catch(v){p(v.message)}};return e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Income"})}),u&&e.jsx("div",{className:"mb-2 text-green-700",children:u}),m&&e.jsx("div",{className:"mb-2 text-red-600",children:m}),s&&e.jsx("div",{className:"mb-3",children:e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 bg-gold text-navy rounded-xl px-4 py-2",children:[e.jsx(cp,{className:"w-5 h-5"})," Add Income"]})}),o&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>i(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-4 z-10 w-full max-w-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Add Income"}),e.jsxs("form",{onSubmit:w,className:"grid grid-cols-1 gap-2",children:[e.jsx("input",{type:"date",className:"border rounded-xl px-3 py-2",value:a.date,onChange:N=>l(k=>({...k,date:N.target.value}))}),e.jsx(lw,{kind:"incomes",value:a.source,onChange:N=>l(k=>({...k,source:N}))}),e.jsx("div",{className:"text-right text-sm mt-1",children:e.jsx("button",{type:"button",onClick:()=>{i(!1),c("/accounting/dashboard?openHeads=1")},className:"text-blue-600 underline",children:"Manage Account Heads"})}),e.jsx("input",{type:"number",className:"border rounded-xl px-3 py-2",placeholder:"Amount",value:a.amount,onChange:N=>l(k=>({...k,amount:Number(N.target.value)}))}),e.jsx("input",{className:"border rounded-xl px-3 py-2",placeholder:"Note",value:a.note,onChange:N=>l(k=>({...k,note:N.target.value}))}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 rounded-xl border",children:"Cancel"}),e.jsx("button",{className:"bg-gold text-navy rounded-xl px-4 py-2",children:"Add"})]})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Date"}),e.jsx("th",{className:"p-3 text-left",children:"Source"}),e.jsx("th",{className:"p-3 text-left",children:"Amount"}),e.jsx("th",{className:"p-3 text-left",children:"Note"})]})}),e.jsxs("tbody",{children:[n.map(N=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",children:new Date(N.date).toLocaleDateString()}),e.jsx("td",{className:"p-3",children:N.source}),e.jsx("td",{className:"p-3",children:Pe(N.amount)}),e.jsx("td",{className:"p-3",children:N.note||"-"})]},N._id)),n.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:"4",children:"No entries"})})]})]})})]})}function lw({kind:t="incomes",value:s,onChange:n}){let r={};try{r=JSON.parse(localStorage.getItem("accountHeads")||"{}")}catch{r={}}const a=r&&r[t]?r[t]:[],[l,o]=d.useState(""),i=s||"",c=u=>{n(u==="__other__"?l:u)};return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Purpose"}),e.jsxs("select",{className:"border rounded-xl px-3 py-2 w-full mb-2",value:i||"",onChange:u=>c(u.target.value),children:[!a||a.length===0?e.jsx("option",{value:"",children:"No heads defined"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"-- select purpose --"}),a.map(u=>e.jsx("option",{value:u,children:u},u))]}),e.jsx("option",{value:"__other__",children:"Other (enter manually)"})]}),i==="__other__"||!i&&l?e.jsx("input",{className:"border rounded-xl px-3 py-2",placeholder:"Enter purpose",value:l,onChange:u=>{o(u.target.value),n(u.target.value)}}):null]})}function ow({kind:t="expenses",value:s,onChange:n}){let r={};try{r=JSON.parse(localStorage.getItem("accountHeads")||"{}")}catch{r={}}const a=r&&r[t]?r[t]:[],[l,o]=d.useState(""),i=s||"",c=u=>{n(u==="__other__"?l:u)};return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Purpose"}),e.jsxs("select",{className:"border rounded-xl px-3 py-2 w-full mb-2",value:i||"",onChange:u=>c(u.target.value),children:[!a||a.length===0?e.jsx("option",{value:"",children:"No heads defined"}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"-- select purpose --"}),a.map(u=>e.jsx("option",{value:u,children:u},u))]}),e.jsx("option",{value:"__other__",children:"Other (enter manually)"})]}),i==="__other__"||!i&&l?e.jsx("input",{className:"border rounded-xl px-3 py-2",placeholder:"Enter purpose",value:l,onChange:u=>{o(u.target.value),n(u.target.value)}}):null]})}function iw(){const{user:t}=ge(),s=(t==null?void 0:t.role)==="Accountant";if(!s&&(t==null?void 0:t.role)!=="Admin"&&(t==null?void 0:t.role)!=="SuperAdmin")return e.jsx("div",{className:"text-royal",children:"Access denied"});const[n,r]=d.useState([]),[a,l]=d.useState({date:new Date().toISOString().slice(0,10),purpose:"",amount:0,note:""}),[o,i]=d.useState(!1),c=Rn(),[u,x]=d.useState(null),[m,p]=d.useState(null),h=async()=>{try{const{expenses:k}=await B.listExpenses();r(k||[])}catch(k){p(k.message)}};d.useEffect(()=>{h()},[]);const w=async k=>{var v;(v=k==null?void 0:k.preventDefault)==null||v.call(k),x(null),p(null);try{await B.addExpense(a),x("Expense added"),l({...a,purpose:"",amount:0,note:""}),i(!1),h()}catch(g){p(g.message)}},N=async k=>{if(confirm("Delete expense?"))try{await B.deleteExpense(k),h()}catch(v){p(v.message)}};return e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Expense"})}),u&&e.jsx("div",{className:"mb-2 text-green-700",children:u}),m&&e.jsx("div",{className:"mb-2 text-red-600",children:m}),s&&e.jsx("div",{className:"mb-3",children:e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 bg-gold text-navy rounded-xl px-4 py-2",children:[e.jsx(cp,{className:"w-5 h-5"})," Add Expense"]})}),o&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>i(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-4 z-10 w-full max-w-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Add Expense"}),e.jsxs("form",{onSubmit:w,className:"grid grid-cols-1 gap-2",children:[e.jsx("input",{type:"date",className:"border rounded-xl px-3 py-2",value:a.date,onChange:k=>l(v=>({...v,date:k.target.value}))}),e.jsx(ow,{kind:"expenses",value:a.purpose,onChange:k=>l(v=>({...v,purpose:k}))}),e.jsx("div",{className:"text-right text-sm mt-1",children:e.jsx("button",{type:"button",onClick:()=>{i(!1),c("/accounting/dashboard?openHeads=1")},className:"text-blue-600 underline",children:"Manage Account Heads"})}),e.jsx("input",{type:"number",className:"border rounded-xl px-3 py-2",placeholder:"Amount",value:a.amount,onChange:k=>l(v=>({...v,amount:Number(k.target.value)}))}),e.jsx("input",{className:"border rounded-xl px-3 py-2",placeholder:"Note",value:a.note,onChange:k=>l(v=>({...v,note:k.target.value}))}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 rounded-xl border",children:"Cancel"}),e.jsx("button",{className:"bg-gold text-navy rounded-xl px-4 py-2",children:"Add"})]})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Date"}),e.jsx("th",{className:"p-3 text-left",children:"Purpose"}),e.jsx("th",{className:"p-3 text-left",children:"Amount"}),e.jsx("th",{className:"p-3 text-left",children:"Note"}),s&&e.jsx("th",{className:"p-3 text-left",children:"Action"})]})}),e.jsxs("tbody",{children:[n.map(k=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",children:new Date(k.date).toLocaleDateString()}),e.jsx("td",{className:"p-3",children:k.purpose}),e.jsx("td",{className:"p-3",children:Pe(k.amount)}),e.jsx("td",{className:"p-3",children:k.note||"-"}),s&&e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>N(k._id),className:"px-3 py-1 rounded-lg border hover:bg-red-50 text-red-700",children:"Delete"})})]},k._id)),n.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:s?5:4,children:"No entries"})})]})]})})]})}function dw(){const[t,s]=d.useState([]),[n,r]=d.useState([]),[a,l]=d.useState(!1),[o,i]=d.useState(null),[c,u]=d.useState({userId:"",accountNo:"",bankName:"",branchName:""});d.useEffect(()=>{(async()=>(await x(),m()))()},[]);const x=async()=>{try{const g=await(B.listUsersPublic?B.listUsersPublic():B.listUsers()),b=Array.isArray(g)?g:(g==null?void 0:g.users)||[];return s(b),b}catch(g){return console.error("Failed to load users",g),s([]),[]}},m=()=>{try{const g=localStorage.getItem("employeeBankRecords"),b=g?JSON.parse(g):[];r(b)}catch{r([])}},p=g=>{localStorage.setItem("employeeBankRecords",JSON.stringify(g)),r(g)},h=async()=>{const g=!t||t.length===0?await x():t;i(null),u({userId:g&&g[0]?g[0]._id:"",accountNo:"",bankName:"",branchName:""}),l(!0)},w=g=>{i(g.id),u({userId:g.userId,accountNo:g.accountNo,bankName:g.bankName,branchName:g.branchName}),l(!0)},N=g=>{var b;if((b=g==null?void 0:g.preventDefault)==null||b.call(g),!c.userId||!c.accountNo)return alert("Select employee and enter account number");if(o){const y=n.map(j=>j.id===o?{...j,...c}:j);p(y)}else{const j=[{id:`b_${Date.now()}`,...c},...n];p(j)}l(!1)},k=g=>{if(!confirm("Delete bank record?"))return;const b=n.filter(y=>y.id!==g);p(b)},v=g=>t.find(b=>b._id===g)||{};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Employee Bank Accounts"}),e.jsx("div",{children:e.jsx("button",{onClick:h,className:"bg-gold text-navy rounded-xl px-4 py-2",children:"+ Add Bank Account"})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Emp Id"}),e.jsx("th",{className:"p-3 text-left",children:"Name"}),e.jsx("th",{className:"p-3 text-left",children:"Designation"}),e.jsx("th",{className:"p-3 text-left",children:"Account No"}),e.jsx("th",{className:"p-3 text-left",children:"Bank Name"}),e.jsx("th",{className:"p-3 text-left",children:"Branch Name"}),e.jsx("th",{className:"p-3 text-left",children:"Action"})]})}),e.jsxs("tbody",{children:[n.map(g=>{const b=v(g.userId);return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",children:(b._id||"").slice(0,8)}),e.jsx("td",{className:"p-3",children:b.name||"-"}),e.jsx("td",{className:"p-3",children:b.designation||"-"}),e.jsx("td",{className:"p-3",children:g.accountNo}),e.jsx("td",{className:"p-3",children:g.bankName}),e.jsx("td",{className:"p-3",children:g.branchName}),e.jsxs("td",{className:"p-3",children:[e.jsx("button",{onClick:()=>w(g),className:"px-3 py-1 rounded-lg border mr-2",children:"Edit"}),e.jsx("button",{onClick:()=>k(g.id),className:"px-3 py-1 rounded-lg border hover:bg-red-50 text-red-700",children:"Delete"})]})]},g.id)}),n.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:7,children:"No bank accounts"})})]})]})}),a&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>l(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-4 z-10 w-full max-w-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:o?"Edit Bank Account":"Add Bank Account"}),e.jsxs("form",{onSubmit:N,className:"grid grid-cols-1 gap-2",children:[e.jsx("label",{className:"text-sm text-royal",children:"Employee"}),e.jsx("select",{className:"border rounded-xl px-3 py-2",value:c.userId,onChange:g=>u(b=>({...b,userId:g.target.value})),children:!t||t.length===0?e.jsx("option",{value:"",children:"Loading employees..."}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"-- select employee --"}),t.map(g=>e.jsxs("option",{value:g._id,children:[g.name," (",g.designation||"",")"]},g._id))]})}),e.jsx("input",{className:"border rounded-xl px-3 py-2",placeholder:"Account No",value:c.accountNo,onChange:g=>u(b=>({...b,accountNo:g.target.value}))}),e.jsx("input",{className:"border rounded-xl px-3 py-2",placeholder:"Bank Name",value:c.bankName,onChange:g=>u(b=>({...b,bankName:g.target.value}))}),e.jsx("input",{className:"border rounded-xl px-3 py-2",placeholder:"Branch Name",value:c.branchName,onChange:g=>u(b=>({...b,branchName:g.target.value}))}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 rounded-xl border",children:"Cancel"}),e.jsx("button",{className:"bg-gold text-navy rounded-xl px-4 py-2",children:o?"Save":"Add"})]})]})]})]})]})}function cw(){const[t,s]=d.useState([]),[n,r]=d.useState([]),[a,l]=d.useState(!1),[o,i]=d.useState(null),[c,u]=d.useState({userId:"",totalSalary:0});d.useEffect(()=>{(async()=>(await x(),m()))()},[]);const x=async()=>{try{const g=await(B.listUsersPublic?B.listUsersPublic():B.listUsers()),b=Array.isArray(g)?g:(g==null?void 0:g.users)||[];return s(b),b}catch{return s([]),[]}},m=()=>{try{const g=localStorage.getItem("employeeSalaryRecords");r(g?JSON.parse(g):[])}catch{r([])}},p=g=>{localStorage.setItem("employeeSalaryRecords",JSON.stringify(g)),r(g)},h=async()=>{const g=!t||t.length===0?await x():t;i(null),u({userId:g&&g[0]?g[0]._id:"",totalSalary:0}),l(!0)},w=g=>{i(g.id),u({userId:g.userId,totalSalary:g.totalSalary}),l(!0)},N=g=>{var b;if((b=g==null?void 0:g.preventDefault)==null||b.call(g),!c.userId)return alert("Select employee");if(o){const y=n.map(j=>j.id===o?{...j,...c}:j);p(y)}else{const j=[{id:`s_${Date.now()}`,...c},...n];p(j)}l(!1)},k=g=>{confirm("Delete salary record?")&&p(n.filter(b=>b.id!==g))},v=g=>t.find(b=>b._id===g)||{};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Employee Salary"}),e.jsx("div",{children:e.jsx("button",{onClick:h,className:"bg-gold text-navy rounded-xl px-4 py-2",children:"+ Add Salary"})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Emp Id"}),e.jsx("th",{className:"p-3 text-left",children:"Name"}),e.jsx("th",{className:"p-3 text-left",children:"Designation"}),e.jsx("th",{className:"p-3 text-left",children:"Total Salary"}),e.jsx("th",{className:"p-3 text-left",children:"Action"})]})}),e.jsxs("tbody",{children:[n.map(g=>{const b=v(g.userId);return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-3",children:(b._id||"").slice(0,8)}),e.jsx("td",{className:"p-3",children:b.name||"-"}),e.jsx("td",{className:"p-3",children:b.designation||"-"}),e.jsx("td",{className:"p-3",children:Pe(g.totalSalary||0)}),e.jsxs("td",{className:"p-3",children:[e.jsx("button",{onClick:()=>w(g),className:"px-3 py-1 rounded-lg border mr-2",children:"Edit"}),e.jsx("button",{onClick:()=>k(g.id),className:"px-3 py-1 rounded-lg border hover:bg-red-50 text-red-700",children:"Delete"})]})]},g.id)}),n.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-4 text-royal/70",colSpan:5,children:"No salary records"})})]})]})}),a&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:()=>l(!1)}),e.jsxs("div",{className:"bg-white rounded-xl p-4 z-10 w-full max-w-lg shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:o?"Edit Salary":"Add Salary"}),e.jsxs("form",{onSubmit:N,className:"grid grid-cols-1 gap-2",children:[e.jsx("label",{className:"text-sm text-royal",children:"Employee"}),e.jsx("select",{className:"border rounded-xl px-3 py-2",value:c.userId,onChange:g=>u(b=>({...b,userId:g.target.value})),children:!t||t.length===0?e.jsx("option",{value:"",children:"Loading employees..."}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"",children:"-- select employee --"}),t.map(g=>e.jsxs("option",{value:g._id,children:[g.name," (",g.designation||"",")"]},g._id))]})}),e.jsx("input",{type:"number",className:"border rounded-xl px-3 py-2",placeholder:"Total Salary",value:c.totalSalary,onChange:g=>u(b=>({...b,totalSalary:Number(g.target.value)}))}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 rounded-xl border",children:"Cancel"}),e.jsx("button",{className:"bg-gold text-navy rounded-xl px-4 py-2",children:o?"Save":"Add"})]})]})]})]})]})}const uw=[{key:"",label:"All"},{key:"pending",label:"Pending"},{key:"recruited",label:"Recruited"}];function mw(){const[t,s]=d.useState(""),[n,r]=d.useState([]),[a,l]=d.useState([]),[o,i]=d.useState([]),[c,u]=d.useState(!1),[x,m]=d.useState(null),p=async(h=t)=>{const w=await B.listCandidates(h);r(w)};return d.useEffect(()=>{p("")},[]),d.useEffect(()=>{(async()=>(l(await B.listEmployers()),i(await B.listJobs())))()},[]),d.useEffect(()=>{p(t)},[t]),e.jsxs("div",{className:"p-4 md:p-6 space-y-4 font-[Poppins]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold text-[#053867]",children:"Candidates"}),e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49]",children:"Add Candidate"})]}),e.jsx("div",{className:"flex gap-2",children:uw.map(h=>e.jsx("button",{onClick:()=>s(h.key),className:`px-3 py-1.5 rounded-full border ${h.key===t?"bg-[#253985] text-white":"bg-white text-[#253985] border-[#253985]"}`,children:h.label},h.key))}),e.jsx("div",{className:"bg-white shadow rounded-2xl p-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-[#053867]",children:[e.jsx("th",{className:"py-2",children:"CanID"}),e.jsx("th",{className:"py-2",children:"Name"}),e.jsx("th",{className:"py-2",children:"Interest"}),e.jsx("th",{className:"py-2",children:"Source"}),e.jsx("th",{className:"py-2",children:"Trained"}),e.jsx("th",{className:"py-2",children:"Date"}),e.jsx("th",{className:"py-2",children:"CV"}),e.jsx("th",{className:"py-2",children:"Action"})]})}),e.jsxs("tbody",{children:[n.map(h=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:h.canId}),e.jsx("td",{className:"py-2",children:h.name}),e.jsx("td",{className:"py-2",children:h.jobInterest}),e.jsx("td",{className:"py-2",children:h.source}),e.jsx("td",{className:"py-2",children:h.trained?"Yes":"No"}),e.jsx("td",{className:"py-2",children:new Date(h.date).toLocaleDateString("en-GB")}),e.jsx("td",{className:"py-2",children:h.cvLink?e.jsx("a",{className:"text-[#253985] underline",href:h.cvLink,target:"_blank",children:"View"}):"-"}),e.jsx("td",{className:"py-2",children:h.recruited?e.jsx("span",{className:"px-2 py-1 rounded bg-green-100 text-green-700",children:"Recruited"}):e.jsx("button",{onClick:()=>m(h),className:"px-3 py-1 rounded-xl bg-[#253985] text-white",children:"Recruit"})})]},h._id)),n.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"py-2 text-gray-500",colSpan:8,children:"No candidates"})})]})]})}),c&&e.jsx(xw,{onClose:()=>u(!1),onSaved:()=>{u(!1),p()}}),x&&e.jsx(hw,{candidate:x,employers:a,jobs:o.filter(h=>h.status==="Active"),onClose:()=>m(null),onSaved:()=>{m(null),p(t)}})]})}function xw({onClose:t,onSaved:s}){const[n,r]=d.useState({canId:"",name:"",jobInterest:"",source:"Facebook",trained:!1,cvLink:""}),[a,l]=d.useState(!1),[o,i]=d.useState(""),c=async m=>{if(!m.trim()){i("");return}l(!0);try{const h=(await B.listCandidates()).some(w=>w.canId.toLowerCase()===m.trim().toLowerCase());i(h?"This Candidate ID already exists":"")}catch(p){console.error("Validation error:",p)}finally{l(!1)}},u=m=>{r(p=>({...p,canId:m})),i("")},x=async()=>{if(!n.canId)return alert("Candidate ID is required");if(o)return alert(o);if(!n.name||!n.jobInterest)return alert("Name & Job Interest required");try{await B.addCandidate(n),s()}catch(m){alert(m.message||"Failed to add candidate")}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-6 w-full max-w-2xl space-y-6 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-[#053867]",children:"Add New Candidate"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Fill in the candidate information below"})]}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-2xl p-4",children:e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-[#253985]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.jsx("span",{className:"text-sm font-semibold text-[#053867]",children:"Candidate ID *"})]}),e.jsx("input",{type:"text",value:n.canId,onChange:m=>u(m.target.value),onBlur:()=>c(n.canId),className:`w-full border-2 rounded-xl px-4 py-3 text-lg font-mono focus:outline-none focus:ring-2 transition-all ${o?"border-red-400 focus:ring-red-400 bg-red-50":"border-blue-300 focus:ring-blue-400 bg-white"}`,placeholder:"e.g., CAN-2025-0001"}),e.jsxs("div",{className:"mt-2 min-h-[20px]",children:[a&&e.jsxs("span",{className:"text-xs text-blue-600 flex items-center gap-1",children:[e.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Checking availability..."]}),o&&e.jsxs("span",{className:"text-xs text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),o]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-[#053867] mb-2 block",children:"Name *"}),e.jsx("input",{type:"text",value:n.name,onChange:m=>r(p=>({...p,name:m.target.value})),className:"w-full border-2 border-gray-300 rounded-xl px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent transition-all",placeholder:"Full name"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-[#053867] mb-2 block",children:"Job Interest *"}),e.jsx("input",{type:"text",value:n.jobInterest,onChange:m=>r(p=>({...p,jobInterest:m.target.value})),className:"w-full border-2 border-gray-300 rounded-xl px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent transition-all",placeholder:"e.g., Software Developer"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-[#053867] mb-2 block",children:"CV Source"}),e.jsx("select",{value:n.source,onChange:m=>r(p=>({...p,source:m.target.value})),className:"w-full border-2 border-gray-300 rounded-xl px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent transition-all bg-white",children:["Facebook","LinkedIn","Bdjobs","Reference","Prime Academy","Others"].map(m=>e.jsx("option",{value:m,children:m},m))})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-[#053867] mb-2 block",children:"CV Link"}),e.jsx("input",{type:"url",value:n.cvLink,onChange:m=>r(p=>({...p,cvLink:m.target.value})),className:"w-full border-2 border-gray-300 rounded-xl px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent transition-all",placeholder:"Google Drive or OneDrive link"})]})})]}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n.trained,onChange:m=>r(p=>({...p,trained:m.target.checked})),className:"w-5 h-5 text-[#253985] border-2 border-gray-300 rounded focus:ring-2 focus:ring-[#253985] cursor-pointer"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-semibold text-[#053867]",children:"Trained by Prime Academy"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Check if this candidate completed training"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:t,className:"px-6 py-2.5 rounded-xl bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:x,disabled:a||!!o,className:"px-6 py-2.5 rounded-xl bg-gradient-to-r from-[#253985] to-[#053867] text-white font-medium hover:shadow-lg transform hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Candidate"]})]})]})})}function hw({candidate:t,employers:s,jobs:n,onClose:r,onSaved:a}){const[l,o]=d.useState({employerId:"",jobId:"",date:new Date().toISOString().slice(0,10)}),[i,c]=d.useState(!1),u=async()=>{if(!l.employerId||!l.jobId)return alert("Please select employer and job position");c(!0);try{await B.recruitCandidate(t._id,l),a()}catch(x){alert(x.message||"Failed to recruit candidate")}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-6 w-full max-w-lg space-y-6 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-[#253985]",children:"Recruit Candidate"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("span",{className:"font-semibold",children:t.name}),"  ",t.canId]})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-[#053867] mb-2 block",children:"Select Employer *"}),e.jsxs("select",{value:l.employerId,onChange:x=>o(m=>({...m,employerId:x.target.value})),className:"w-full border-2 border-gray-300 rounded-xl px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent transition-all bg-white",children:[e.jsx("option",{value:"",children:"Choose an employer..."}),s.map(x=>e.jsxs("option",{value:x._id,children:[x.name," (",x.empId,")"]},x._id))]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-[#053867] mb-2 block",children:"Select Job Position *"}),e.jsxs("select",{value:l.jobId,onChange:x=>o(m=>({...m,jobId:x.target.value})),className:"w-full border-2 border-gray-300 rounded-xl px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent transition-all bg-white",children:[e.jsx("option",{value:"",children:"Choose a job position..."}),n.map(x=>e.jsxs("option",{value:x._id,children:[x.position,"  ",x.jobId]},x._id))]})]})}),e.jsx("div",{children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-semibold text-[#053867] mb-2 block",children:"Recruitment Date"}),e.jsx("input",{type:"date",value:l.date,onChange:x=>o(m=>({...m,date:x.target.value})),className:"w-full border-2 border-gray-300 rounded-xl px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent transition-all"})]})})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:r,disabled:i,className:"px-6 py-2.5 rounded-xl bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:u,disabled:i,className:"px-6 py-2.5 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 text-white font-medium hover:shadow-lg transform hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Confirm Recruitment"]})})]})]})})}function pw(){const[t,s]=d.useState([]),[n,r]=d.useState([]),[a,l]=d.useState(!1),o=async()=>s(await B.listJobs());return d.useEffect(()=>{o(),(async()=>r(await B.listEmployers()))()},[]),e.jsxs("div",{className:"p-4 md:p-6 space-y-4 font-[Poppins]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold text-[#053867]",children:"Job Positions"}),e.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49]",children:"Add Job"})]}),e.jsx("div",{className:"bg-white shadow rounded-2xl p-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-[#053867]",children:[e.jsx("th",{className:"py-2",children:"JobID"}),e.jsx("th",{className:"py-2",children:"Position"}),e.jsx("th",{className:"py-2",children:"Employer"}),e.jsx("th",{className:"py-2",children:"Salary"}),e.jsx("th",{className:"py-2",children:"Deadline"}),e.jsx("th",{className:"py-2",children:"Status"})]})}),e.jsxs("tbody",{children:[t.map(i=>{var c;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:i.jobId}),e.jsx("td",{className:"py-2",children:i.position}),e.jsx("td",{className:"py-2",children:((c=i.employer)==null?void 0:c.name)||"-"}),e.jsx("td",{className:"py-2",children:i.salaryRange||"-"}),e.jsx("td",{className:"py-2",children:i.deadline?new Date(i.deadline).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{className:"py-2",children:i.status})]},i._id)}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"py-2 text-gray-500",colSpan:6,children:"No jobs"})})]})]})}),a&&e.jsx(fw,{employers:n,onClose:()=>l(!1),onSaved:()=>{l(!1),o()}})]})}function fw({employers:t,onClose:s,onSaved:n}){const[r,a]=d.useState({jobId:"",position:"",employerId:"",salaryRange:"",deadline:"",status:"Active"}),[l,o]=d.useState(!1),[i,c]=d.useState(""),u=async p=>{if(!p.trim()){c("");return}o(!0);try{const w=(await B.listJobs()).some(N=>N.jobId.toLowerCase()===p.trim().toLowerCase());c(w?"This Job ID already exists":"")}catch(h){console.error("Validation error:",h)}finally{o(!1)}},x=p=>{a(h=>({...h,jobId:p})),c("")},m=async()=>{if(!r.jobId)return alert("Job ID is required");if(i)return alert(i);if(!r.position||!r.employerId)return alert("Position & Employer required");await B.addJob(r),n()};return e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-full max-w-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-3",children:[e.jsx("h3",{className:"text-xl font-bold text-[#253985]",children:"Add Job Position"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-3",children:e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-[#253985]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.jsx("span",{className:"text-sm font-semibold text-[#053867]",children:"Job ID *"})]}),e.jsx("input",{type:"text",value:r.jobId,onChange:p=>x(p.target.value),onBlur:()=>u(r.jobId),className:`w-full border-2 rounded-xl px-4 py-2.5 text-lg font-mono focus:outline-none focus:ring-2 transition-all ${i?"border-red-400 focus:ring-red-400 bg-red-50":"border-blue-300 focus:ring-blue-400 bg-white"}`,placeholder:"e.g., JOB-2025-0001"}),e.jsxs("div",{className:"mt-2 min-h-[20px]",children:[l&&e.jsxs("span",{className:"text-xs text-blue-600 flex items-center gap-1",children:[e.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Checking availability..."]}),i&&e.jsxs("span",{className:"text-xs text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i]})]})]})}),e.jsx(Ni,{label:"Position *",value:r.position,onChange:p=>a(h=>({...h,position:p}))}),e.jsx(Im,{label:"Employer *",value:r.employerId,onChange:p=>a(h=>({...h,employerId:p})),options:t.map(p=>({label:`${p.name} (${p.empId})`,value:p._id}))}),e.jsx(Ni,{label:"Salary Range",value:r.salaryRange,onChange:p=>a(h=>({...h,salaryRange:p}))}),e.jsx(Ni,{label:"Deadline",type:"date",value:r.deadline,onChange:p=>a(h=>({...h,deadline:p}))}),e.jsx(Im,{label:"Status",value:r.status,onChange:p=>a(h=>({...h,status:p})),options:["Active","Inactive"].map(p=>({label:p,value:p}))}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:m,className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49]",children:"Save"})]})]})})}function Ni({label:t,value:s,onChange:n,type:r="text"}){return e.jsxs("label",{className:"text-sm text-[#053867] space-y-1 block",children:[e.jsx("span",{children:t}),e.jsx("input",{type:r,value:s,onChange:a=>n(a.target.value),className:"w-full border rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#253985]"})]})}function Im({label:t,value:s,onChange:n,options:r}){return e.jsxs("label",{className:"text-sm text-[#053867] space-y-1 block",children:[e.jsx("span",{children:t}),e.jsxs("select",{value:s,onChange:a=>n(a.target.value),className:"w-full border rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#253985]",children:[e.jsx("option",{value:"",children:"Select..."}),r.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]})}function gw(){const[t,s]=d.useState([]),[n,r]=d.useState(!1),a=async()=>s(await B.listEmployers());return d.useEffect(()=>{a()},[]),e.jsxs("div",{className:"p-4 md:p-6 space-y-4 font-[Poppins]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold text-[#053867]",children:"Employers"}),e.jsx("button",{onClick:()=>r(!0),className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49]",children:"Add Employer"})]}),e.jsx("div",{className:"bg-white shadow rounded-2xl p-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-[#053867]",children:[e.jsx("th",{className:"py-2",children:"EmpID"}),e.jsx("th",{className:"py-2",children:"Name"}),e.jsx("th",{className:"py-2",children:"Address"}),e.jsx("th",{className:"py-2",children:"Job Location"}),e.jsx("th",{className:"py-2",children:"MoU Date"})]})}),e.jsxs("tbody",{children:[t.map(l=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:l.empId}),e.jsx("td",{className:"py-2",children:l.name}),e.jsx("td",{className:"py-2",children:l.address||"-"}),e.jsx("td",{className:"py-2",children:l.jobLocation||"-"}),e.jsx("td",{className:"py-2",children:l.mouDate?new Date(l.mouDate).toLocaleDateString("en-GB"):"-"})]},l._id)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"py-2 text-gray-500",colSpan:5,children:"No employers"})})]})]})}),n&&e.jsx(yw,{onClose:()=>r(!1),onSaved:()=>{r(!1),a()}})]})}function yw({onClose:t,onSaved:s}){const[n,r]=d.useState({empId:"",name:"",address:"",jobLocation:"",mouDate:""}),[a,l]=d.useState(!1),[o,i]=d.useState(""),c=async m=>{if(!m.trim()){i("");return}l(!0);try{const h=(await B.listEmployers()).some(w=>w.empId.toLowerCase()===m.trim().toLowerCase());i(h?"This Employer ID already exists":"")}catch(p){console.error("Validation error:",p)}finally{l(!1)}},u=m=>{r(p=>({...p,empId:m})),i("")},x=async()=>{if(!n.empId)return alert("Employer ID is required");if(o)return alert(o);if(!n.name)return alert("Name is required");await B.addEmployer(n),s()};return e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-full max-w-xl space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-3",children:[e.jsx("h3",{className:"text-xl font-bold text-[#253985]",children:"Add Employer"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-3",children:e.jsxs("label",{className:"block",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-[#253985]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.jsx("span",{className:"text-sm font-semibold text-[#053867]",children:"Employer ID *"})]}),e.jsx("input",{type:"text",value:n.empId,onChange:m=>u(m.target.value),onBlur:()=>c(n.empId),className:`w-full border-2 rounded-xl px-4 py-2.5 text-lg font-mono focus:outline-none focus:ring-2 transition-all ${o?"border-red-400 focus:ring-red-400 bg-red-50":"border-blue-300 focus:ring-blue-400 bg-white"}`,placeholder:"e.g., EMP-2025-0001"}),e.jsxs("div",{className:"mt-2 min-h-[20px]",children:[a&&e.jsxs("span",{className:"text-xs text-blue-600 flex items-center gap-1",children:[e.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Checking availability..."]}),o&&e.jsxs("span",{className:"text-xs text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),o]})]})]})}),e.jsx(il,{label:"Name *",value:n.name,onChange:m=>r(p=>({...p,name:m}))}),e.jsx(il,{label:"Address",value:n.address,onChange:m=>r(p=>({...p,address:m}))}),e.jsx(il,{label:"Job Location",value:n.jobLocation,onChange:m=>r(p=>({...p,jobLocation:m}))}),e.jsx(il,{label:"MoU Date",type:"date",value:n.mouDate,onChange:m=>r(p=>({...p,mouDate:m}))}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:x,className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49]",children:"Save"})]})]})})}function il({label:t,value:s,onChange:n,type:r="text"}){return e.jsxs("label",{className:"text-sm text-[#053867] space-y-1 block",children:[e.jsx("span",{children:t}),e.jsx("input",{type:r,value:s,onChange:a=>n(a.target.value),className:"w-full border rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#253985]"})]})}function bw(){const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState(!1),[l,o]=d.useState(!1),[i,c]=d.useState("All"),[u,x]=d.useState(null),m=(t==null?void 0:t.role)==="Accountant"||(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin",p=(t==null?void 0:t.role)==="Recruitment"||(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin",h=async()=>{o(!0);try{const j=await B.listRecIncome();n(Array.isArray(j)?j:[])}finally{o(!1)}};d.useEffect(()=>{h()},[]);const w=d.useMemo(()=>i==="All"?s:s.filter(j=>j.status===i),[s,i]),N=d.useMemo(()=>s.filter(j=>j.status==="Approved").reduce((j,S)=>j+(Number(S.amount)||0),0),[s]),k=d.useMemo(()=>s.filter(j=>j.status==="Pending").reduce((j,S)=>j+(Number(S.amount)||0),0),[s]),v=async j=>{if(confirm("Approve this income entry?"))try{await B.approveRecIncome(j),h()}catch(S){alert(S.message||"Failed to approve")}},g=async(j,S)=>{try{await B.rejectRecIncome(j,S),x(null),h()}catch(C){alert(C.message||"Failed to reject")}},b=async j=>{if(confirm("Delete this income entry?"))try{await B.deleteRecIncome(j),h()}catch(S){alert(S.message||"Failed to delete")}},y=j=>{switch(j){case"Approved":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs font-medium",children:[e.jsx(it,{size:14}),"Approved"]});case"Rejected":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-medium",children:[e.jsx(js,{size:14}),"Rejected"]});case"Pending":default:return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs font-medium",children:[e.jsx(Bt,{size:14}),"Waiting for Approval"]})}};return e.jsxs("div",{className:"p-4 md:p-6 space-y-4 font-[Poppins]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold text-[#053867]",children:"Recruitment Income"}),p&&e.jsx("button",{onClick:()=>a(!0),className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49] font-medium",children:"Add Income"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl p-4 text-white shadow-lg",children:[e.jsx("div",{className:"text-sm opacity-90",children:"Approved Income"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:Zt(N)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-600 rounded-2xl p-4 text-white shadow-lg",children:[e.jsx("div",{className:"text-sm opacity-90",children:"Pending Approval"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:Zt(k)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-4 text-white shadow-lg",children:[e.jsx("div",{className:"text-sm opacity-90",children:"Total Entries"}),e.jsx("div",{className:"text-2xl font-bold mt-1",children:s.length})]})]}),e.jsx("div",{className:"flex gap-2 border-b border-gray-200",children:["All","Pending","Approved","Rejected"].map(j=>e.jsxs("button",{onClick:()=>c(j),className:`px-4 py-2 font-medium transition-colors ${i===j?"text-[#253985] border-b-2 border-[#253985]":"text-gray-500 hover:text-gray-700"}`,children:[j," (",s.filter(S=>j==="All"||S.status===j).length,")"]},j))}),e.jsxs("div",{className:"bg-white shadow rounded-2xl p-4 overflow-x-auto",children:[l&&e.jsx("div",{className:"text-sm text-gray-500 mb-3",children:"Loading"}),e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-[#053867] border-b-2",children:[e.jsx("th",{className:"py-3 px-2",children:"Date"}),e.jsx("th",{className:"py-3 px-2",children:"Source"}),e.jsx("th",{className:"py-3 px-2",children:"Income From"}),e.jsx("th",{className:"py-3 px-2",children:"Income For"}),e.jsx("th",{className:"py-3 px-2",children:"Description"}),e.jsx("th",{className:"py-3 px-2",children:"Amount"}),e.jsx("th",{className:"py-3 px-2",children:"Status"}),e.jsx("th",{className:"py-3 px-2",children:"Submitted By"}),m&&e.jsx("th",{className:"py-3 px-2",children:"Actions"})]})}),e.jsxs("tbody",{children:[w.map(j=>{var S,C,A;return e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-2",children:j.date?new Date(j.date).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{className:"py-3 px-2 font-medium",children:j.source||"-"}),e.jsx("td",{className:"py-3 px-2 text-gray-600",children:((S=j.incomeFrom)==null?void 0:S.name)||"-"}),e.jsx("td",{className:"py-3 px-2 text-gray-600",children:((C=j.incomeFor)==null?void 0:C.name)||"-"}),e.jsx("td",{className:"py-3 px-2 text-gray-600",children:j.description||"-"}),e.jsx("td",{className:"py-3 px-2 font-semibold",children:Zt(j.amount)}),e.jsx("td",{className:"py-3 px-2",children:y(j.status)}),e.jsx("td",{className:"py-3 px-2 text-gray-600",children:((A=j.submittedBy)==null?void 0:A.name)||"-"}),m&&e.jsx("td",{className:"py-3 px-2",children:e.jsxs("div",{className:"flex gap-2",children:[j.status==="Pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>v(j._id),className:"px-3 py-1 rounded-xl bg-green-100 text-green-700 hover:bg-green-200 text-xs font-medium",children:"Approve"}),e.jsx("button",{onClick:()=>x(j),className:"px-3 py-1 rounded-xl bg-red-100 text-red-700 hover:bg-red-200 text-xs font-medium",children:"Reject"})]}),((t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin")&&e.jsx("button",{onClick:()=>b(j._id),className:"px-3 py-1 rounded-xl bg-gray-100 text-gray-700 hover:bg-gray-200 text-xs font-medium",children:"Delete"})]})})]},j._id)}),w.length===0&&e.jsx("tr",{children:e.jsxs("td",{className:"py-8 text-center text-gray-500",colSpan:m?9:8,children:["No ",i!=="All"?i.toLowerCase():""," income entries"]})})]})]})]}),r&&e.jsx(vw,{onClose:()=>a(!1),onSaved:()=>{a(!1),h()}}),u&&e.jsx(jw,{income:u,onClose:()=>x(null),onReject:j=>g(u._id,j)})]})}function vw({onClose:t,onSaved:s}){const[n,r]=d.useState({date:new Date().toISOString().slice(0,10),source:"",amount:"",description:"",incomeFrom:"",incomeFor:""}),[a,l]=d.useState([]),[o,i]=d.useState([]),[c,u]=d.useState(!0);d.useEffect(()=>{(async()=>{try{const[p,h]=await Promise.all([B.listEmployers(),B.listRecruited()]);l(Array.isArray(p)?p:[]),i(Array.isArray(h)?h:[])}catch(p){console.error("Failed to load dropdown data:",p)}finally{u(!1)}})()},[]);const x=async()=>{if(!n.source)return alert("Source is required");const m=Number(n.amount);if(!m||m<=0)return alert("Enter a valid amount");if(!n.incomeFrom)return alert("Income From (Employer) is required");if(!n.incomeFor)return alert("Income For (Candidate) is required");try{await B.addRecIncome({date:n.date,source:n.source,amount:m,description:n.description,incomeFrom:n.incomeFrom,incomeFor:n.incomeFor}),s()}catch(p){alert(p.message||"Failed to submit income")}};return e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-lg space-y-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ut,{className:"text-[#253985]",size:24}),e.jsx("h3",{className:"text-lg font-semibold text-[#253985]",children:"Submit Income for Approval"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"This income will be sent to the Accountant for approval before being counted."}),c?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading form data..."}):e.jsxs(e.Fragment,{children:[e.jsx(Wr,{label:"Date",type:"date",value:n.date,onChange:m=>r(p=>({...p,date:m}))}),e.jsx(Wr,{label:"Source",value:n.source,onChange:m=>r(p=>({...p,source:m})),placeholder:"Commission, Training Fee, Placement Fee, etc."}),e.jsx(Rm,{label:"Income From (Employer) *",value:n.incomeFrom,onChange:m=>r(p=>({...p,incomeFrom:m})),options:a.map(m=>({value:m._id,label:m.name})),placeholder:"Select employer..."}),e.jsx(Rm,{label:"Income For (Recruited Candidate) *",value:n.incomeFor,onChange:m=>r(p=>({...p,incomeFor:m})),options:o.map(m=>({value:m._id,label:`${m.name} (${m.canId})`})),placeholder:"Select candidate..."}),e.jsx(Wr,{label:"Amount (BDT)",type:"number",value:n.amount,onChange:m=>r(p=>({...p,amount:m}))}),e.jsx(Wr,{label:"Description (Optional)",value:n.description,onChange:m=>r(p=>({...p,description:m})),placeholder:"Additional details about this income",multiline:!0}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200 font-medium",children:"Cancel"}),e.jsx("button",{onClick:x,className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49] font-medium",children:"Submit for Approval"})]})]})]})})}function Rm({label:t,value:s,onChange:n,options:r,placeholder:a}){const[l,o]=d.useState(""),[i,c]=d.useState(!1),u=r.filter(m=>m.label.toLowerCase().includes(l.toLowerCase())),x=r.find(m=>m.value===s);return e.jsxs("label",{className:"text-sm text-[#053867] space-y-1 block relative",children:[e.jsx("span",{className:"font-medium",children:t}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{onClick:()=>c(!i),className:"w-full border border-gray-300 rounded-xl px-3 py-2 cursor-pointer bg-white hover:border-[#253985] focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent flex justify-between items-center",children:[e.jsx("span",{className:x?"text-gray-900":"text-gray-400",children:x?x.label:a}),e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-xl shadow-lg max-h-60 overflow-hidden",children:[e.jsx("div",{className:"p-2 border-b",children:e.jsx("input",{type:"text",value:l,onChange:m=>o(m.target.value),placeholder:"Search...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#253985] text-sm",onClick:m=>m.stopPropagation()})}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:u.length===0?e.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"No results found"}):u.map(m=>e.jsx("div",{onClick:()=>{n(m.value),c(!1),o("")},className:`px-3 py-2 cursor-pointer hover:bg-gray-100 text-sm ${m.value===s?"bg-blue-50 text-[#253985] font-medium":""}`,children:m.label},m.value))})]})]}),i&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>c(!1)})]})}function jw({income:t,onClose:s,onReject:n}){var o;const[r,a]=d.useState(""),l=()=>{if(!r.trim())return alert("Please provide a rejection reason");n(r)};return e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-lg space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(js,{className:"text-red-600",size:24}),e.jsx("h3",{className:"text-lg font-semibold text-red-600",children:"Reject Income Entry"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 text-sm",children:[e.jsx("div",{className:"font-medium text-gray-700",children:t.source}),e.jsx("div",{className:"text-gray-600",children:Zt(t.amount)}),e.jsxs("div",{className:"text-gray-500 text-xs mt-1",children:["Submitted by: ",((o=t.submittedBy)==null?void 0:o.name)||"Unknown"]})]}),e.jsx(Wr,{label:"Rejection Reason",value:r,onChange:a,placeholder:"Explain why this income is being rejected",multiline:!0}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 rounded-2xl bg-gray-100 hover:bg-gray-200 font-medium",children:"Cancel"}),e.jsx("button",{onClick:l,className:"px-4 py-2 rounded-2xl bg-red-600 text-white hover:bg-red-700 font-medium",children:"Reject Entry"})]})]})})}function Wr({label:t,value:s,onChange:n,type:r="text",placeholder:a="",multiline:l=!1}){return e.jsxs("label",{className:"text-sm text-[#053867] space-y-1 block",children:[e.jsx("span",{className:"font-medium",children:t}),l?e.jsx("textarea",{value:s,placeholder:a,onChange:o=>n(o.target.value),rows:3,className:"w-full border border-gray-300 rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent"}):e.jsx("input",{type:r,value:s,placeholder:a,onChange:o=>n(o.target.value),className:"w-full border border-gray-300 rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#253985] focus:border-transparent"})]})}function Nw(){const[t,s]=d.useState([]),[n,r]=d.useState(!1),[a,l]=d.useState(!1),o=async()=>{l(!0);try{const u=await B.listRecExpense();s(Array.isArray(u)?u:[])}finally{l(!1)}};d.useEffect(()=>{o()},[]);const i=d.useMemo(()=>t.reduce((u,x)=>u+(Number(x.amount)||0),0),[t]),c=async u=>{confirm("Delete this expense entry?")&&(await B.deleteRecExpense(u),o())};return e.jsxs("div",{className:"p-4 md:p-6 space-y-4 font-[Poppins]",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-semibold text-[#053867]",children:"Recruitment Expense"}),e.jsx("button",{onClick:()=>r(!0),className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49]",children:"Add Expense"})]}),e.jsxs("div",{className:"bg-white shadow rounded-2xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"text-[#253985] font-semibold",children:["Total: ",e.jsx("span",{className:"font-bold",children:Zt(i)})]}),a&&e.jsx("div",{className:"text-sm text-gray-500",children:"Loading"})]}),e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-[#053867]",children:[e.jsx("th",{className:"py-2",children:"Date"}),e.jsx("th",{className:"py-2",children:"Purpose"}),e.jsx("th",{className:"py-2",children:"Amount"}),e.jsx("th",{className:"py-2",children:"Action"})]})}),e.jsxs("tbody",{children:[t.map(u=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:u.date?new Date(u.date).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{className:"py-2",children:u.purpose||"-"}),e.jsx("td",{className:"py-2",children:Zt(u.amount)}),e.jsx("td",{className:"py-2",children:e.jsx("button",{onClick:()=>c(u._id),className:"px-3 py-1 rounded-xl bg-red-100 text-red-700 hover:bg-red-200",children:"Delete"})})]},u._id)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"py-3 text-gray-500",colSpan:4,children:"No expense entries"})})]})]})]}),n&&e.jsx(ww,{onClose:()=>r(!1),onSaved:()=>{r(!1),o()}})]})}function ww({onClose:t,onSaved:s}){const[n,r]=d.useState({date:new Date().toISOString().slice(0,10),purpose:"",amount:""}),a=async()=>{if(!n.purpose)return alert("Purpose is required");const l=Number(n.amount);if(!l||l<=0)return alert("Enter a valid amount");await B.addRecExpense({date:n.date,purpose:n.purpose,amount:l}),s()};return e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow p-4 w-full max-w-lg space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-[#253985]",children:"Add Expense"}),e.jsx(wi,{label:"Date",type:"date",value:n.date,onChange:l=>r(o=>({...o,date:l}))}),e.jsx(wi,{label:"Purpose",value:n.purpose,onChange:l=>r(o=>({...o,purpose:l})),placeholder:"Candidate Screening / Travel / HR Event"}),e.jsx(wi,{label:"Amount (BDT)",type:"number",value:n.amount,onChange:l=>r(o=>({...o,amount:l}))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 rounded-2xl bg-gray-100",children:"Cancel"}),e.jsx("button",{onClick:a,className:"px-4 py-2 rounded-2xl bg-[#F7BA23] text-[#053867] hover:bg-[#F3CE49]",children:"Save"})]})]})})}function wi({label:t,value:s,onChange:n,type:r="text",placeholder:a=""}){return e.jsxs("label",{className:"text-sm text-[#053867] space-y-1 block",children:[e.jsx("span",{children:t}),e.jsx("input",{type:r,value:s,placeholder:a,onChange:l=>n(l.target.value),className:"w-full border rounded-xl px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#253985]"})]})}function Sw(){const[t,s]=d.useState([]),[n,r]=d.useState({}),[a,l]=d.useState(!1),[o,i]=d.useState(""),[c,u]=d.useState(!1),[x,m]=d.useState(null),[p,h]=d.useState(!1),[w,N]=d.useState(""),[k,v]=d.useState([]),g=["Reel","Short","Explainer","Ad","Banner","Other"],b=["Facebook","Instagram","YouTube","TikTok","X","Other"],[y,j]=d.useState("monthly"),[S,C]=d.useState(""),[A,R]=d.useState(""),[O,U]=d.useState(""),[I,M]=d.useState("");async function V(){l(!0),i("");try{const[z,G]=await Promise.all([B.listMGWorks(),B.mgStats()]),ee=Array.isArray(z)?z:(z==null?void 0:z.list)||(z==null?void 0:z.items)||[];s(ee),r(G||{})}catch(z){i(z.message||"Failed to load")}finally{l(!1)}}async function D(z){h(!0),N("");try{if(!z.title||!z.date)throw new Error("Title and date are required");const G={...z||{}};if(G.assignedTo&&!L[G.assignedTo]){const ee=k.find(_=>_.name===G.assignedTo||_.email===G.assignedTo);ee&&(G.assignedTo=ee._id||ee.id||ee.email)}G._id?await B.updateMGWork(G._id,G):await B.createMGWork(G),await V(),u(!1)}catch(G){N(G.message||"Save failed")}finally{h(!1)}}function E(){m({}),N(""),u(!0)}function P(z){m(z||{}),N(""),u(!0)}async function $(z){if(z&&confirm("Delete this work item?"))try{await B.deleteMGWork(z),await V()}catch(G){alert(G.message||"Delete failed")}}d.useEffect(()=>{const z=new Date;let G=new Date;G.setMonth(z.getMonth()-1),C(G.toISOString().slice(0,10)),R(z.toISOString().slice(0,10)),V(),(async()=>{try{const ee=await B.listUsersPublic(),_=Array.isArray(ee)?ee:(ee==null?void 0:ee.users)||[];v(_)}catch{}})()},[]);const L=d.useMemo(()=>{const z={};return k.forEach(G=>{const ee=G._id||G.id||G.email;z[ee]=G.name||G.email||ee}),z},[k]);d.useEffect(()=>{(async()=>{try{r(await B.mgStats())}catch{}})()},[y,S,A]);const W=d.useMemo(()=>{const z=(I||"").trim().toLowerCase();let G=S?new Date(S):null,ee=A?new Date(A):null;return ee&&ee.setHours(23,59,59,999),t.filter(_=>{try{const te=_!=null&&_.date?new Date(_.date):_!=null&&_.createdAt?new Date(_.createdAt):null;if(G&&te&&te<G||ee&&te&&te>ee||O&&O!=="all"&&(_.status||"").toLowerCase()!==O.toLowerCase())return!1;if(!z)return!0;const K=_.assignedTo&&L[_.assignedTo]?L[_.assignedTo]:_.assignedTo||"";return`${_.title||""} ${K} ${_.type||""} ${_.platform||""} ${_.notes||""}`.toLowerCase().includes(z)}catch{return!0}})},[t,S,A,O,I]),F=d.useMemo(()=>{const z={total:t.length,queued:0,inProgress:0,review:0,done:0,hold:0};return t.forEach(G=>{const ee=(G.status||"").toLowerCase();ee==="queued"?z.queued++:ee==="inprogress"?z.inProgress++:ee==="review"?z.review++:ee==="done"?z.done++:ee==="hold"&&z.hold++}),z},[t]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-navy",children:"Motion Graphics  Production Log"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:V,className:"bg-royal text-white px-3 py-2 rounded-xl",children:"Refresh"})})]}),e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:gap-4 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-slate",children:"Range"}),e.jsxs("select",{value:y,onChange:z=>{const G=z.target.value;j(G);const ee=new Date;let _=new Date;G==="daily"?_.setDate(ee.getDate()-1):G==="weekly"?_.setDate(ee.getDate()-7):G==="monthly"?_.setMonth(ee.getMonth()-1):G==="yearly"?_.setFullYear(ee.getFullYear()-1):G==="lifetime"&&(_=null),G!=="custom"&&(_?C(_.toISOString().slice(0,10)):(C(""),R("")),R(ee.toISOString().slice(0,10)))},className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"lifetime",children:"Lifetime"}),e.jsx("option",{value:"custom",children:"Custom"})]}),y==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:S,onChange:z=>C(z.target.value),className:"border rounded-xl px-3 py-2"}),e.jsx("input",{type:"date",value:A,onChange:z=>R(z.target.value),className:"border rounded-xl px-3 py-2"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-slate",children:"Status"}),e.jsxs("select",{value:O,onChange:z=>U(z.target.value),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Queued",children:"Queued"}),e.jsx("option",{value:"InProgress",children:"In Progress"}),e.jsx("option",{value:"Review",children:"Review"}),e.jsx("option",{value:"Done",children:"Done"}),e.jsx("option",{value:"Hold",children:"Hold"})]})]}),e.jsx("div",{className:"flex-1 flex items-center",children:e.jsx("input",{placeholder:"Search title, assignee, notes...",value:I,onChange:z=>M(z.target.value),className:"w-full border rounded-xl px-3 py-2"})})]})}),o&&e.jsx("div",{className:"text-red-600",children:o}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{k:"total",label:"Total",v:F.total},{k:"queued",label:"Queued",v:F.queued},{k:"inProgress",label:"In Progress",v:F.inProgress},{k:"done",label:"Done",v:F.done}].map(z=>e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:[e.jsx("div",{className:"text-royal text-sm",children:z.label}),e.jsx("div",{className:"text-3xl font-extrabold",children:z.v??0})]},z.k))}),e.jsx("div",{children:a?e.jsx("div",{className:"bg-white p-4 rounded-xl shadow-sm",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3 md:hidden",children:[W.map(z=>e.jsxs("div",{className:"bg-white p-3 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-slate",children:Zu(z.date)}),e.jsx("div",{className:"font-semibold text-navy",children:z.title}),e.jsxs("div",{className:"text-xs text-slate",children:[z.type,"  ",z.platform,"  ",z.durationSec?`${Math.round(z.durationSec/60)}m`:""]})]}),e.jsxs("div",{className:"text-sm text-right",children:[e.jsx("div",{className:"px-2 py-1 rounded-full bg-slate-100 text-slate-800 text-xs",children:z.status}),e.jsx("div",{className:"text-xs text-slate mt-2",children:L[z.assignedTo]||z.assignedTo||"-"})]})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>P(z),className:"text-royal text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>$(z._id),className:"text-red-600 text-sm",children:"Delete"}),z.assetLink&&e.jsx("a",{className:"text-royal text-sm",href:z.assetLink,target:"_blank",rel:"noreferrer",children:"Asset"})]}),z.notes&&e.jsx("div",{className:"mt-2 text-xs text-slate",children:z.notes})]},z._id||`${z.title}-${z.date}`)),W.length===0&&e.jsx("div",{className:"text-slate",children:"No results"})]}),e.jsxs("div",{className:"hidden md:block bg-white rounded-xl shadow-sm overflow-auto",children:[e.jsxs("div",{className:"p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-slate",children:["Showing ",W.length," of ",t.length," items"]}),e.jsx("div",{children:e.jsx("button",{onClick:E,className:"bg-royal text-white px-3 py-2 rounded-xl",children:"New Work"})})]}),e.jsxs("table",{className:"min-w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-slate text-sm",children:[e.jsx("th",{className:"px-4 py-3",children:"Date"}),e.jsx("th",{className:"px-4 py-3",children:"Title"}),e.jsx("th",{className:"px-4 py-3",children:"Type"}),e.jsx("th",{className:"px-4 py-3",children:"Platform"}),e.jsx("th",{className:"px-4 py-3",children:"Assigned"}),e.jsx("th",{className:"px-4 py-3",children:"Duration"}),e.jsx("th",{className:"px-4 py-3",children:"Status"}),e.jsx("th",{className:"px-4 py-3",children:"Notes"}),e.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),e.jsxs("tbody",{children:[W.map(z=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3 align-top text-sm",children:Zu(z.date)}),e.jsx("td",{className:"px-4 py-3 align-top text-sm font-semibold",children:z.title}),e.jsx("td",{className:"px-4 py-3 align-top text-sm",children:z.type}),e.jsx("td",{className:"px-4 py-3 align-top text-sm",children:z.platform}),e.jsx("td",{className:"px-4 py-3 align-top text-sm",children:L[z.assignedTo]||z.assignedTo||"-"}),e.jsx("td",{className:"px-4 py-3 align-top text-sm",children:z.durationSec?`${Math.round(z.durationSec/60)}m`:"-"}),e.jsx("td",{className:"px-4 py-3 align-top text-sm",children:e.jsx("span",{className:"px-2 py-1 rounded-full bg-slate-100 text-slate-800 text-xs",children:z.status})}),e.jsx("td",{className:"px-4 py-3 align-top text-sm",children:z.notes?z.notes.length>120?`${z.notes.slice(0,120)}...`:z.notes:"-"}),e.jsx("td",{className:"px-4 py-3 align-top text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>P(z),className:"text-royal text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>$(z._id),className:"text-red-600 text-sm",children:"Delete"})]})})]},z._id||`${z.title}-${z.date}`)),W.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"p-6 text-slate",colSpan:9,children:"No results"})})]})]})]})]})}),e.jsx(kw,{visible:c,payload:x,setPayload:m,onClose:()=>u(!1),onSave:D,saving:p,error:w,users:k,types:g,platforms:b})]})}function kw({visible:t,payload:s,setPayload:n,onClose:r,onSave:a,saving:l,error:o,users:i,types:c,platforms:u}){const[x,m]=d.useState(""),[p,h]=d.useState(!1),[w,N]=d.useState(-1),k=d.useRef(null),[v,g]=d.useState("");if(d.useEffect(()=>{const S=setTimeout(()=>g(x||""),150);return()=>clearTimeout(S)},[x]),d.useEffect(()=>{if(!s){m("");return}const S=i&&i.find(A=>s.assignedTo&&(A._id===s.assignedTo||A.id===s.assignedTo));if(S){m(S.name||S.email);return}const C=i&&i.find(A=>A.name&&s.assignedTo&&A.name===s.assignedTo||A.email&&s.assignedTo&&A.email===s.assignedTo);m(C?C.name||C.email:s.assignedTo||"")},[s,i]),!t)return null;const b=v&&i?i.filter(S=>{const C=v.toLowerCase();return S.name&&S.name.toLowerCase().includes(C)||S.email&&S.email.toLowerCase().includes(C)}).slice(0,6):[];function y(S){const C=S._id||S.id||S.email,A=S.name||S.email||C;n(R=>({...R||{},assignedTo:C})),m(A),h(!1),N(-1)}function j(S){!b||b.length===0||(S.key==="ArrowDown"?(S.preventDefault(),N(C=>C>=b.length-1?0:C+1),h(!0)):S.key==="ArrowUp"?(S.preventDefault(),N(C=>C<=0?b.length-1:C-1),h(!0)):S.key==="Enter"?w>=0&&w<b.length&&(S.preventDefault(),y(b[w])):S.key==="Escape"&&(h(!1),N(-1)))}return e.jsx("div",{className:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[s&&s._id?"Edit":"New"," MG Work"]}),e.jsx("button",{onClick:r,className:"text-slate",children:"Close"})]}),o&&e.jsx("div",{className:"text-red-600 mt-2",children:o}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3",children:[e.jsx("input",{type:"date",value:(s==null?void 0:s.date)||"",onChange:S=>n(C=>({...C,date:S.target.value})),className:"border rounded-xl px-3 py-2"}),e.jsx("input",{placeholder:"Title",value:(s==null?void 0:s.title)||"",onChange:S=>n(C=>({...C,title:S.target.value})),className:"border rounded-xl px-3 py-2"}),e.jsx("select",{value:(s==null?void 0:s.type)||c[0],onChange:S=>n(C=>({...C,type:S.target.value})),className:"border rounded-xl px-3 py-2",children:c.map(S=>e.jsx("option",{value:S,children:S},S))}),e.jsx("select",{value:(s==null?void 0:s.platform)||u[0],onChange:S=>n(C=>({...C,platform:S.target.value})),className:"border rounded-xl px-3 py-2",children:u.map(S=>e.jsx("option",{value:S,children:S},S))}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:k,id:"mg-assigned-input","aria-autocomplete":"list","aria-controls":"mg-assigned-listbox","aria-expanded":p,"aria-activedescendant":w>=0&&b[w]?`mg-assigned-opt-${w}`:void 0,placeholder:"Assigned To (type to search)",value:x||"",onChange:S=>{m(S.target.value),n(C=>({...C,assignedTo:S.target.value})),h(!0),N(-1)},onFocus:()=>h(!0),onKeyDown:j,className:"border rounded-xl px-3 py-2 w-full"}),p&&b.length>0&&e.jsx("div",{id:"mg-assigned-listbox",role:"listbox","aria-labelledby":"mg-assigned-input",className:"absolute z-40 bg-white border mt-1 rounded-lg w-full max-h-44 overflow-auto shadow-sm",children:b.map((S,C)=>e.jsxs("div",{id:`mg-assigned-opt-${C}`,role:"option","aria-selected":C===w,onMouseDown:()=>y(S),className:`px-3 py-2 cursor-pointer ${C===w?"bg-slate-100":"hover:bg-slate-50"}`,children:[e.jsx("div",{className:"text-sm font-medium",children:S.name||S.email}),S.email&&e.jsx("div",{className:"text-xs text-slate",children:S.email})]},S._id||S.email))})]}),e.jsx("input",{placeholder:"Duration (sec)",type:"number",value:(s==null?void 0:s.durationSec)||"",onChange:S=>n(C=>({...C,durationSec:Number(S.target.value)})),className:"border rounded-xl px-3 py-2"}),e.jsx("input",{placeholder:"Asset Link",value:(s==null?void 0:s.assetLink)||"",onChange:S=>n(C=>({...C,assetLink:S.target.value})),className:"border rounded-xl px-3 py-2 md:col-span-2"}),e.jsxs("select",{value:(s==null?void 0:s.status)||"Queued",onChange:S=>n(C=>({...C,status:S.target.value})),className:"border rounded-xl px-3 py-2",children:[e.jsx("option",{children:"Queued"}),e.jsx("option",{children:"InProgress"}),e.jsx("option",{children:"Review"}),e.jsx("option",{children:"Done"}),e.jsx("option",{children:"Hold"})]}),e.jsx("textarea",{placeholder:"Notes",value:(s==null?void 0:s.notes)||"",onChange:S=>n(C=>({...C,notes:S.target.value})),className:"border rounded-xl px-3 py-2 md:col-span-2"})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:r,className:"px-3 py-2 rounded-xl border",children:"Cancel"}),e.jsx("button",{onClick:()=>a(s),disabled:l,className:"px-3 py-2 rounded-xl bg-royal text-white",children:l?"Saving...":"Save"})]})]})})}function Cw(){var L,W,F,z,G,ee,_,te,K,Y,oe,le;const{user:t}=ge();if((t==null?void 0:t.role)!=="Coordinator"&&(t==null?void 0:t.role)!=="Admin"&&(t==null?void 0:t.role)!=="SuperAdmin")return e.jsx("div",{className:"text-royal",children:"Access denied"});const[s,n]=d.useState([]),[r,a]=d.useState([]),[l,o]=d.useState(""),[i,c]=d.useState(!0),[u,x]=d.useState(!1),[m,p]=d.useState(null),[h,w]=d.useState(null),[N,k]=d.useState(!1),[v,g]=d.useState(!1),[b,y]=d.useState(null),[j,S]=d.useState(null),[C,A]=d.useState({followUpType:"Call",note:"",amountPromised:"",updatedNextPaymentDate:""}),[R,O]=d.useState({collectingAmount:"",paymentMethod:"Cash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""}),U=async()=>{try{const{students:Z}=await B.getStudentsWithDues();n(Z||[]),a(Z||[]);const T=sessionStorage.getItem("openPaymentId");if(T&&Z&&Z.length>0){const H=Z.find(re=>re._id===T);H&&(setTimeout(()=>{I(H)},100),sessionStorage.removeItem("openPaymentId"),sessionStorage.removeItem("openPaymentData"))}}catch(Z){S(Z.message)}finally{c(!1)}};d.useEffect(()=>{U()},[]),d.useEffect(()=>{if(l.trim()==="")a(s);else{const Z=l.toLowerCase(),T=s.filter(H=>{var re,se,me,he,ie,xe,pe;return((se=(re=H.lead)==null?void 0:re.leadId)==null?void 0:se.toLowerCase().includes(Z))||((he=(me=H.lead)==null?void 0:me.name)==null?void 0:he.toLowerCase().includes(Z))||((xe=(ie=H.lead)==null?void 0:ie.phone)==null?void 0:xe.includes(Z))||((pe=H.courseName)==null?void 0:pe.toLowerCase().includes(Z))});a(T)}},[l,s]);const I=async Z=>{p(Z),x(!0);try{const T=await B.getStudentHistory(Z._id);w(T)}catch(T){S(T.message)}},M=()=>{x(!1),p(null),w(null),k(!1),g(!1),A({followUpType:"Call",note:"",amountPromised:"",updatedNextPaymentDate:""}),O({collectingAmount:"",paymentMethod:"Cash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""})},V=Z=>{p(Z),g(!0),O({collectingAmount:"",paymentMethod:"Cash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""})},D=Z=>{p(Z),k(!0),A({followUpType:"Call",note:"",amountPromised:"",updatedNextPaymentDate:""})},E=async Z=>{if(Z.preventDefault(),y(null),S(null),(t==null?void 0:t.role)!=="Coordinator"){S("Only Coordinators can add follow-ups");return}try{await B.addFollowUp({admissionFeeId:m._id,leadId:m.lead._id,...C,amountPromised:Number(C.amountPromised)||0}),y("Follow-up added successfully"),k(!1),A({followUpType:"Call",note:"",amountPromised:"",updatedNextPaymentDate:""}),p(null),U()}catch(T){S(T.message)}},P=async Z=>{if(Z.preventDefault(),y(null),S(null),(t==null?void 0:t.role)!=="Coordinator"){S("Only Coordinators can collect payments");return}const T=Number(R.collectingAmount)||0;if(T<=0){S("Collecting amount must be greater than 0");return}if(T>m.dueAmount){S(`Cannot collect more than due amount (${m.dueAmount})`);return}try{await B.updateAdmissionFeePayment({admissionFeeId:m._id,additionalPayment:T,paymentMethod:R.paymentMethod,paymentDate:R.paymentDate,nextPaymentDate:R.nextPaymentDate,note:R.note}),y(`Successfully submitted due collection of ${T} for approval`),g(!1),O({collectingAmount:"",paymentMethod:"Cash",paymentDate:new Date().toISOString().slice(0,10),nextPaymentDate:"",note:""}),p(null),U()}catch(H){S(H.message)}};if(i)return e.jsx("div",{className:"p-6",children:"Loading..."});const $=Z=>{if(!Z)return!1;const T=new Date;return T.setHours(0,0,0,0),new Date(Z)<T};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-navy",children:"Due Fees Collection"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and follow up on pending student payments"})]})}),b&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg",children:b}),j&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg",children:j}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(An,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search by Lead ID, Name, Phone, or Course...",value:l,onChange:Z=>o(Z.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left",children:"Student"}),e.jsx("th",{className:"p-3 text-left",children:"Course"}),e.jsx("th",{className:"p-3 text-left",children:"Total Amount"}),e.jsx("th",{className:"p-3 text-left",children:"Paid"}),e.jsx("th",{className:"p-3 text-left",children:"Due"}),e.jsx("th",{className:"p-3 text-left",children:"Next Payment"}),e.jsx("th",{className:"p-3 text-left",children:"Admitted Date"}),e.jsx("th",{className:"p-3 text-center",children:"Action"})]})}),e.jsxs("tbody",{children:[r.map(Z=>{var T,H,re,se,me,he;return e.jsxs("tr",{className:`border-t hover:bg-gray-50 ${$(Z.nextPaymentDate)?"bg-red-50":""}`,children:[e.jsxs("td",{className:"p-3",children:[e.jsxs("div",{className:"font-semibold text-navy",children:[(T=Z.lead)==null?void 0:T.leadId,"  ",(H=Z.lead)==null?void 0:H.name]}),e.jsxs("div",{className:"text-xs text-gray-600 flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(jl,{size:12}),(re=Z.lead)==null?void 0:re.phone]}),((se=Z.lead)==null?void 0:se.email)&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(up,{size:12}),(me=Z.lead)==null?void 0:me.email]})]})]}),e.jsx("td",{className:"p-3",children:Z.courseName}),e.jsxs("td",{className:"p-3 font-semibold",children:[" ",Z.totalAmount||0]}),e.jsxs("td",{className:"p-3 text-green-600 font-semibold",children:[" ",Z.amount||0]}),e.jsxs("td",{className:"p-3 text-orange-600 font-bold",children:[" ",Z.dueAmount||0]}),e.jsx("td",{className:"p-3",children:Z.nextPaymentDate?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:new Date(Z.nextPaymentDate).toLocaleDateString("en-GB")}),$(Z.nextPaymentDate)&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-red-600 font-medium mt-1",children:[e.jsx(Ut,{size:12}),"Overdue"]})]}):e.jsx("span",{className:"text-gray-400",children:"Not set"})}),e.jsx("td",{className:"p-3",children:(he=Z.lead)!=null&&he.admittedAt?new Date(Z.lead.admittedAt).toLocaleDateString("en-GB"):"N/A"}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("button",{onClick:()=>V(Z),className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-500 text-white rounded-lg text-xs font-medium hover:bg-green-600 transition-colors",children:[e.jsx(He,{size:14}),"Collect Due"]}),e.jsxs("button",{onClick:()=>D(Z),className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-orange-500 text-white rounded-lg text-xs font-medium hover:bg-orange-600 transition-colors",children:[e.jsx(jl,{size:14}),"Follow Up"]}),e.jsxs("button",{onClick:()=>I(Z),className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-500 text-white rounded-lg text-xs font-medium hover:bg-blue-600 transition-colors",children:[e.jsx(Co,{size:14}),"Details"]})]})})]},Z._id)}),r.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"p-8 text-center text-gray-500",children:l?"No students found matching your search":"No students with due fees"})})]})]})}),u&&m&&h&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto my-8",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-navy",children:"Student Payment Details"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[(L=m.lead)==null?void 0:L.leadId,"  ",(W=m.lead)==null?void 0:W.name]})]}),e.jsx("button",{onClick:M,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"font-bold text-navy mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Student Information"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Lead ID:"})," ",e.jsx("span",{className:"font-semibold",children:(F=m.lead)==null?void 0:F.leadId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Name:"})," ",e.jsx("span",{className:"font-semibold",children:(z=m.lead)==null?void 0:z.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"})," ",e.jsx("span",{className:"font-semibold",children:(G=m.lead)==null?void 0:G.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email:"})," ",e.jsx("span",{className:"font-semibold",children:((ee=m.lead)==null?void 0:ee.email)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Admitted:"})," ",e.jsx("span",{className:"font-semibold",children:(_=m.lead)!=null&&_.admittedAt?new Date(m.lead.admittedAt).toLocaleDateString("en-GB"):"N/A"})]})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"font-bold text-navy mb-3 flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5"}),"Payment Summary"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Course:"})," ",e.jsx("span",{className:"font-semibold",children:m.courseName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount:"})," ",e.jsxs("span",{className:"font-bold text-lg",children:[" ",m.totalAmount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Amount Paid:"})," ",e.jsxs("span",{className:"font-bold text-lg text-green-600",children:[" ",m.amount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Due Amount:"})," ",e.jsxs("span",{className:"font-bold text-lg text-orange-600",children:[" ",m.dueAmount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payment Method:"})," ",e.jsx("span",{className:"font-semibold",children:m.method})]})]})]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"font-bold text-navy mb-3 flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"Important Dates"]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payment Date:"}),e.jsx("p",{className:"font-semibold",children:new Date(m.paymentDate).toLocaleDateString("en-GB")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Next Payment Date:"}),e.jsx("p",{className:"font-semibold",children:m.nextPaymentDate?new Date(m.nextPaymentDate).toLocaleDateString("en-GB"):"Not set"}),$(m.nextPaymentDate)&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-red-600 font-medium mt-1",children:[e.jsx(Ut,{size:12}),"Overdue"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Submitted:"}),e.jsx("p",{className:"font-semibold",children:new Date(m.createdAt).toLocaleDateString("en-GB")})]})]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"font-bold text-navy flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Follow-up History (",((te=h.followUps)==null?void 0:te.length)||0,")"]}),(t==null?void 0:t.role)==="Coordinator"&&e.jsx("button",{onClick:()=>k(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors",children:"Add Follow-up"})]}),h.followUps&&h.followUps.length>0?e.jsx("div",{className:"space-y-3",children:h.followUps.map(Z=>{var T;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("span",{className:"inline-block px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium mr-2",children:Z.followUpType}),e.jsxs("span",{className:"text-xs text-gray-600",children:["by ",(T=Z.coordinator)==null?void 0:T.name,"  ",new Date(Z.createdAt).toLocaleString("en-GB")]})]})}),e.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap mb-2",children:Z.note}),(Z.amountPromised>0||Z.updatedNextPaymentDate)&&e.jsxs("div",{className:"flex gap-4 text-xs text-gray-600 mt-2 pt-2 border-t",children:[Z.amountPromised>0&&e.jsxs("span",{children:["Amount Promised:  ",Z.amountPromised]}),Z.updatedNextPaymentDate&&e.jsxs("span",{children:["Next Payment Updated: ",new Date(Z.updatedNextPaymentDate).toLocaleDateString("en-GB")]})]})]},Z._id)})}):e.jsx("p",{className:"text-center text-gray-500 py-4",children:"No follow-ups yet"})]}),N&&(t==null?void 0:t.role)==="Coordinator"&&e.jsxs("div",{className:"bg-white border-2 border-blue-300 rounded-xl p-5",children:[e.jsx("h4",{className:"font-bold text-navy mb-4",children:"Add New Follow-up"}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Follow-up Type *"}),e.jsxs("select",{value:C.followUpType,onChange:Z=>A(T=>({...T,followUpType:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{children:"Call"}),e.jsx("option",{children:"SMS"}),e.jsx("option",{children:"Email"}),e.jsx("option",{children:"Visit"}),e.jsx("option",{children:"WhatsApp"}),e.jsx("option",{children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Notes *"}),e.jsx("textarea",{rows:"3",value:C.note,onChange:Z=>A(T=>({...T,note:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Enter follow-up details...",required:!0})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Amount Promised (Optional)"}),e.jsx("input",{type:"number",value:C.amountPromised,onChange:Z=>A(T=>({...T,amountPromised:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Update Next Payment Date (Optional)"}),e.jsx("input",{type:"date",value:C.updatedNextPaymentDate,onChange:Z=>A(T=>({...T,updatedNextPaymentDate:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>{k(!1),A({followUpType:"Call",note:"",amountPromised:"",updatedNextPaymentDate:""})},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors",children:"Save Follow-up"})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 p-4 flex justify-end",children:e.jsx("button",{onClick:M,className:"px-6 py-2 bg-gray-600 text-white rounded-lg font-medium hover:bg-gray-700 transition-colors",children:"Close"})})]})}),v&&m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg",children:[e.jsx("div",{className:"border-b border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-navy",children:"Collect Due Payment"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[(K=m.lead)==null?void 0:K.leadId,"  ",(Y=m.lead)==null?void 0:Y.name]})]}),e.jsx("button",{onClick:()=>{g(!1),p(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:P,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-xl p-4",children:[e.jsxs("h4",{className:"font-bold text-navy mb-3 flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5"}),"Payment Summary"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),e.jsxs("p",{className:"font-bold text-lg",children:[" ",m.totalAmount||0]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Paid So Far:"}),e.jsxs("p",{className:"font-bold text-lg text-green-600",children:[" ",m.amount||0]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"Due Amount:"}),e.jsxs("p",{className:"font-bold text-2xl text-orange-600",children:[" ",m.dueAmount||0]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Collecting Amount Now *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-semibold",children:""}),e.jsx("input",{type:"number",value:R.collectingAmount,onChange:Z=>O(T=>({...T,collectingAmount:Z.target.value})),className:"w-full border-2 border-green-300 rounded-lg pl-8 pr-3 py-3 text-lg font-bold focus:outline-none focus:ring-2 focus:ring-green-500 bg-green-50",placeholder:"0",min:"1",max:m.dueAmount,required:!0})]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Maximum:  ",m.dueAmount]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Payment Method *"}),e.jsxs("select",{value:R.paymentMethod,onChange:Z=>O(T=>({...T,paymentMethod:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select payment method"}),e.jsx("option",{value:"Cash",children:"Cash"}),e.jsx("option",{value:"Bank Transfer",children:"Bank Transfer"}),e.jsx("option",{value:"Mobile Banking (bKash)",children:"Mobile Banking (bKash)"}),e.jsx("option",{value:"Mobile Banking (Nagad)",children:"Mobile Banking (Nagad)"}),e.jsx("option",{value:"Mobile Banking (Rocket)",children:"Mobile Banking (Rocket)"}),e.jsx("option",{value:"Check",children:"Check"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Payment Date *"}),e.jsx("input",{type:"date",value:R.paymentDate,onChange:Z=>O(T=>({...T,paymentDate:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Next Payment Date (Optional)"}),e.jsx("input",{type:"date",value:R.nextPaymentDate,onChange:Z=>O(T=>({...T,nextPaymentDate:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),m.nextPaymentDate&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Current: ",new Date(m.nextPaymentDate).toLocaleDateString("en-GB")]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Set when customer will make next payment"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Note (Optional)"}),e.jsx("textarea",{rows:"2",value:R.note,onChange:Z=>O(T=>({...T,note:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Add any notes about this collection..."})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{g(!1),p(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg text-sm font-bold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(He,{size:16}),"Collect Payment"]})]})]})]})}),N&&m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg",children:[e.jsx("div",{className:"border-b border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-navy",children:"Add Follow-up"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[(oe=m.lead)==null?void 0:oe.leadId,"  ",(le=m.lead)==null?void 0:le.name]})]}),e.jsx("button",{onClick:()=>{k(!1),p(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("form",{onSubmit:E,className:"p-6 space-y-4",children:[e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Current Due Amount:"}),e.jsxs("span",{className:"font-bold text-xl text-orange-600",children:[" ",m.dueAmount||0]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Follow-up Type *"}),e.jsxs("select",{value:C.followUpType,onChange:Z=>A(T=>({...T,followUpType:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{children:"Call"}),e.jsx("option",{children:"SMS"}),e.jsx("option",{children:"Email"}),e.jsx("option",{children:"Visit"}),e.jsx("option",{children:"WhatsApp"}),e.jsx("option",{children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Notes *"}),e.jsx("textarea",{rows:"3",value:C.note,onChange:Z=>A(T=>({...T,note:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Enter follow-up details, conversation summary, student response...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Amount Promised (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:""}),e.jsx("input",{type:"number",value:C.amountPromised,onChange:Z=>A(T=>({...T,amountPromised:Z.target.value})),className:"w-full border border-gray-300 rounded-lg pl-8 pr-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",min:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-navy mb-1.5",children:"Update Next Payment Date (Optional)"}),e.jsx("input",{type:"date",value:C.updatedNextPaymentDate,onChange:Z=>A(T=>({...T,updatedNextPaymentDate:Z.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),m.nextPaymentDate&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Current: ",new Date(m.nextPaymentDate).toLocaleDateString("en-GB")]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{k(!1),p(null)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg text-sm font-bold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(jl,{size:16}),"Save Follow-up"]})]})]})]})})]})}function Aw(){const{user:t}=ge();if((t==null?void 0:t.role)!=="Coordinator"&&(t==null?void 0:t.role)!=="Admin"&&(t==null?void 0:t.role)!=="SuperAdmin")return e.jsx("div",{className:"text-royal",children:"Access denied"});const[s,n]=d.useState([]),[r,a]=d.useState(!0);if(d.useEffect(()=>{(async()=>{try{const{notifications:c}=await B.getPaymentNotifications();n(c||[])}catch(c){console.error(c)}finally{a(!1)}})()},[]),r)return e.jsx("div",{className:"p-6",children:"Loading..."});const l=s.filter(i=>i.isOverdue),o=s.filter(i=>!i.isOverdue);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-navy",children:"Payment Reminders"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Upcoming and overdue payment notifications"})]}),l.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ut,{className:"text-red-600",size:24}),e.jsxs("h2",{className:"text-xl font-bold text-red-600",children:["Overdue Payments (",l.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:l.map(i=>{var c,u,x,m;return e.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-xl p-5 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-bold text-navy",children:[(c=i.lead)==null?void 0:c.leadId,"  ",(u=i.lead)==null?void 0:u.name]}),e.jsx("span",{className:"px-3 py-1 bg-red-600 text-white rounded-full text-xs font-bold",children:"OVERDUE"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-2 text-sm text-gray-700",children:[e.jsxs("div",{children:[" ",(x=i.lead)==null?void 0:x.phone]}),((m=i.lead)==null?void 0:m.email)&&e.jsxs("div",{children:[" ",i.lead.email]}),e.jsxs("div",{children:[" Course: ",i.courseName]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(He,{size:14}),"Due:  ",i.dueAmount||0]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{size:14}),"Expected: ",new Date(i.nextPaymentDate).toLocaleDateString("en-GB")]})]})]}),e.jsx(ln,{to:"/coordinator/due-fees",className:"ml-4 px-4 py-2 bg-red-600 text-white rounded-lg text-sm font-medium hover:bg-red-700 transition-colors",children:"Follow Up"})]})},i._id)})})]}),o.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fe,{className:"text-orange-600",size:24}),e.jsxs("h2",{className:"text-xl font-bold text-orange-600",children:["Upcoming Payments (",o.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:o.map(i=>{var c,u,x,m;return e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-5 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-bold text-navy",children:[(c=i.lead)==null?void 0:c.leadId,"  ",(u=i.lead)==null?void 0:u.name]}),e.jsxs("span",{className:"px-3 py-1 bg-orange-500 text-white rounded-full text-xs font-bold",children:[i.daysUntil," DAYS LEFT"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-2 text-sm text-gray-700",children:[e.jsxs("div",{children:[" ",(x=i.lead)==null?void 0:x.phone]}),((m=i.lead)==null?void 0:m.email)&&e.jsxs("div",{children:[" ",i.lead.email]}),e.jsxs("div",{children:[" Course: ",i.courseName]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(He,{size:14}),"Due:  ",i.dueAmount||0]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{size:14}),"Due Date: ",new Date(i.nextPaymentDate).toLocaleDateString("en-GB")]})]})]}),e.jsx(ln,{to:"/coordinator/due-fees",className:"ml-4 px-4 py-2 bg-orange-500 text-white rounded-lg text-sm font-medium hover:bg-orange-600 transition-colors",children:"View Details"})]})},i._id)})})]}),s.length===0&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-soft p-12 text-center",children:[e.jsx(fe,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No upcoming or overdue payments"})]})]})}function Dw(){const{user:t}=ge(),[s,n]=d.useState("leave"),[r,a]=d.useState([]),[l,o]=d.useState([]),[i,c]=d.useState([]),[u,x]=d.useState([]),[m,p]=d.useState(!1),[h,w]=d.useState(!1),[N,k]=d.useState(null),[v,g]=d.useState(""),[b,y]=d.useState(""),[j,S]=d.useState(null),[C,A]=d.useState(null),[R,O]=d.useState(!1),[U,I]=d.useState(null),[M,V]=d.useState(null),[D,E]=d.useState({leaveType:"Casual Leave",startDate:"",endDate:"",reason:"",handoverTo:""}),[P,$]=d.useState({applicationType:"TA/DA",purpose:"",travelDate:"",destination:"",amount:"",description:""}),L=(t==null?void 0:t.role)==="SuperAdmin";d.useEffect(()=>{L||(W(),F(),z())},[]),d.useEffect(()=>{const T=async()=>{const H=sessionStorage.getItem("openHandoverRequestId"),re=sessionStorage.getItem("handoverNotificationId");if(H&&i.length>0){console.log(" Opening handover modal for request:",H);const se=i.find(me=>me._id===H);if(se&&(k(se),n("handover"),re))try{await B.markNotificationRead(re)}catch(me){console.error("Failed to mark notification as read:",me)}sessionStorage.removeItem("openHandoverRequestId"),sessionStorage.removeItem("handoverNotificationId")}};i.length>0&&T()},[i]);const W=async()=>{try{const[T,H]=await Promise.all([B.getMyLeaveApplications(),B.getMyTADAApplications()]);a(T.applications||[]),o(H.applications||[])}catch(T){A(T.message)}},F=async()=>{try{const T=await B.listUsers();x((T.users||[]).filter(H=>H.role!=="SuperAdmin"&&H._id!==(t==null?void 0:t.id)))}catch(T){console.error("Failed to load employees:",T)}},z=async()=>{try{const T=await B.getHandoverRequests();c(T.requests||[])}catch(T){console.error("Failed to load handover requests:",T)}},G=async T=>{T.preventDefault(),S(null),A(null),O(!0);try{const H={...D};H.handoverTo||delete H.handoverTo,U?(await B.updateLeaveApplication(U,H),S("Leave application updated successfully! "),I(null)):(await B.createLeaveApplication(H),S("Leave application submitted successfully! ")),E({leaveType:"Casual Leave",startDate:"",endDate:"",reason:"",handoverTo:""}),p(!1),W()}catch(H){A(H.message)}finally{O(!1)}},ee=async()=>{if(N){if(v==="deny"&&!b.trim()){A("Please provide a reason for denying the handover");return}O(!0),S(null),A(null);try{v==="accept"?(await B.acceptHandover(N._id,b),S("Handover request accepted successfully! ")):(await B.denyHandover(N._id,b),S("Handover request denied")),k(null),y(""),g(""),z(),W(),window.scrollTo({top:0,behavior:"smooth"})}catch(T){A(T.message)}finally{O(!1)}}},_=async T=>{T.preventDefault(),S(null),A(null),O(!0);try{M?(await B.updateTADAApplication(M,P),S("TA/DA application updated successfully! "),V(null)):(await B.createTADAApplication(P),S("TA/DA application submitted successfully! ")),$({applicationType:"TA/DA",purpose:"",travelDate:"",destination:"",amount:"",description:""}),w(!1),W()}catch(H){A(H.message)}finally{O(!1)}},te=T=>{var H;I(T._id),E({leaveType:T.leaveType,startDate:T.startDate.split("T")[0],endDate:T.endDate.split("T")[0],reason:T.reason,handoverTo:((H=T.handoverTo)==null?void 0:H._id)||""}),p(!0),window.scrollTo({top:0,behavior:"smooth"})},K=async T=>{if(confirm("Are you sure you want to delete this leave application? This action cannot be undone.")){O(!0),S(null),A(null);try{await B.deleteLeaveApplication(T),S("Leave application deleted successfully"),W(),window.scrollTo({top:0,behavior:"smooth"})}catch(H){A(H.message)}finally{O(!1)}}},Y=T=>{V(T._id),$({applicationType:T.applicationType,purpose:T.purpose,travelDate:T.travelDate.split("T")[0],destination:T.destination||"",amount:T.amount,description:T.description||""}),w(!0),window.scrollTo({top:0,behavior:"smooth"})},oe=async T=>{if(confirm("Are you sure you want to delete this TA/DA application? This action cannot be undone.")){O(!0),S(null),A(null);try{await B.deleteTADAApplication(T),S("TA/DA application deleted successfully"),W(),window.scrollTo({top:0,behavior:"smooth"})}catch(H){A(H.message)}finally{O(!1)}}},le=T=>({Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800",Paid:"bg-blue-100 text-blue-800"})[T]||"bg-gray-100 text-gray-800",Z=T=>{switch(T){case"Approved":return it;case"Rejected":return js;case"Paid":return it;default:return Bt}};return L?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("p",{className:"text-xl text-gray-600",children:"SuperAdmin cannot apply for leave or TA/DA."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"My Applications"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Apply for leave and travel allowance"})]}),j&&e.jsxs("div",{className:"p-4 bg-green-50 border-l-4 border-green-500 rounded-lg flex items-start gap-3",children:[e.jsx(it,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-green-800 font-medium",children:j})]}),C&&e.jsxs("div",{className:"p-4 bg-red-50 border-l-4 border-red-500 rounded-lg flex items-start gap-3",children:[e.jsx(Ut,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-red-800 font-medium",children:C})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>p(!0),className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl p-6 hover:shadow-lg transition-all flex items-center justify-center gap-3",children:[e.jsx(fe,{className:"w-6 h-6"}),e.jsx("span",{className:"text-lg font-semibold",children:"Apply for Leave"})]}),e.jsxs("button",{onClick:()=>w(!0),className:"bg-gradient-to-r from-orange-500 to-pink-600 text-white rounded-xl p-6 hover:shadow-lg transition-all flex items-center justify-center gap-3",children:[e.jsx(Zn,{className:"w-6 h-6"}),e.jsx("span",{className:"text-lg font-semibold",children:"Apply for TA/DA"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>n("leave"),className:`flex-1 px-6 py-4 font-semibold transition-colors flex items-center justify-center gap-2 ${s==="leave"?"bg-blue-50 text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(fe,{className:"w-5 h-5"}),"Leave Applications (",r.length,")"]}),e.jsxs("button",{onClick:()=>n("tada"),className:`flex-1 px-6 py-4 font-semibold transition-colors flex items-center justify-center gap-2 ${s==="tada"?"bg-orange-50 text-orange-600 border-b-2 border-orange-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Zn,{className:"w-5 h-5"}),"TA/DA Applications (",l.length,")"]}),e.jsxs("button",{onClick:()=>n("handover"),className:`flex-1 px-6 py-4 font-semibold transition-colors flex items-center justify-center gap-2 ${s==="handover"?"bg-green-50 text-green-600 border-b-2 border-green-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Me,{className:"w-5 h-5"}),"Handover Requests (",i.length,")"]})]}),e.jsxs("div",{className:"p-6",children:[s==="leave"&&e.jsx("div",{className:"space-y-4",children:r.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(fe,{className:"w-16 h-16 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No leave applications yet"})]}):r.map(T=>e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${le(T.status)}`,children:[ve.createElement(Z(T.status),{className:"w-4 h-4 inline mr-1"}),T.status]}),e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:T.leaveType})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(T.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Start Date"}),e.jsx("p",{className:"font-medium text-gray-800",children:new Date(T.startDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"End Date"}),e.jsx("p",{className:"font-medium text-gray-800",children:new Date(T.endDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Duration"}),e.jsxs("p",{className:"font-medium text-gray-800",children:[T.totalDays," day(s)"]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Reason"}),e.jsx("p",{className:"text-sm text-gray-700",children:T.reason})]}),T.handoverTo&&e.jsxs("div",{className:"p-3 rounded-lg bg-indigo-50 mb-3",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center gap-1",children:[e.jsx(Me,{className:"w-3 h-3"}),"Responsibility Handover"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-800",children:[T.handoverTo.name," (",T.handoverTo.role,")"]}),T.handoverNote&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:T.handoverNote})]}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T.handoverStatus==="Accepted"?"bg-green-100 text-green-800":T.handoverStatus==="Denied"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:[T.handoverStatus==="Accepted"&&e.jsx(er,{className:"w-3 h-3 inline mr-1"}),T.handoverStatus==="Denied"&&e.jsx(Hr,{className:"w-3 h-3 inline mr-1"}),T.handoverStatus==="Pending"&&e.jsx(Bt,{className:"w-3 h-3 inline mr-1"}),T.handoverStatus]})]})]}),T.reviewNote&&e.jsxs("div",{className:`p-3 rounded-lg ${T.status==="Approved"?"bg-green-50":"bg-red-50"}`,children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Review Note"}),e.jsx("p",{className:"text-sm text-gray-700",children:T.reviewNote}),T.reviewedBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",T.reviewedBy.name," on ",new Date(T.reviewedAt).toLocaleDateString()]})]}),T.status==="Pending"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("button",{onClick:()=>te(T),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(sm,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("button",{onClick:()=>K(T._id),className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(cn,{className:"w-4 h-4"}),"Delete"]})]})]},T._id))}),s==="tada"&&e.jsx("div",{className:"space-y-4",children:l.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(Zn,{className:"w-16 h-16 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No TA/DA applications yet"})]}):l.map(T=>e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${le(T.adminStatus)}`,children:[ve.createElement(Z(T.adminStatus),{className:"w-4 h-4 inline mr-1"}),"Admin: ",T.adminStatus]}),T.adminStatus==="Approved"&&e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${le(T.paymentStatus)}`,children:[ve.createElement(Z(T.paymentStatus),{className:"w-4 h-4 inline mr-1"}),"Payment: ",T.paymentStatus]}),e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium",children:T.applicationType})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(T.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Travel Date"}),e.jsx("p",{className:"font-medium text-gray-800",children:new Date(T.travelDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Amount"}),e.jsx("p",{className:"font-medium text-gray-800 text-lg",children:Pe(T.amount)})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Destination"}),e.jsx("p",{className:"font-medium text-gray-800",children:T.destination})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Purpose"}),e.jsx("p",{className:"text-sm text-gray-700",children:T.purpose})]}),T.description&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-700",children:T.description})]}),T.adminReviewNote&&e.jsxs("div",{className:`p-3 rounded-lg mb-2 ${T.adminStatus==="Approved"?"bg-green-50":"bg-red-50"}`,children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Admin Review"}),e.jsx("p",{className:"text-sm text-gray-700",children:T.adminReviewNote}),T.adminReviewedBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",T.adminReviewedBy.name," on ",new Date(T.adminReviewedAt).toLocaleDateString()]})]}),T.paymentNote&&e.jsxs("div",{className:"p-3 rounded-lg bg-blue-50",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Payment Note"}),e.jsx("p",{className:"text-sm text-gray-700",children:T.paymentNote}),T.paidBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Paid by ",T.paidBy.name," on ",new Date(T.paidAt).toLocaleDateString()]})]}),T.adminStatus==="Pending"&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("button",{onClick:()=>Y(T),className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(sm,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("button",{onClick:()=>oe(T._id),className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(cn,{className:"w-4 h-4"}),"Delete"]})]})]},T._id))}),s==="handover"&&e.jsx("div",{className:"space-y-4",children:i.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(Me,{className:"w-16 h-16 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No handover requests"})]}):i.map(T=>e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-white rounded-lg p-5 border border-indigo-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold",children:T.employee.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:T.employee.name}),e.jsx("p",{className:"text-xs text-gray-500",children:T.employee.role})]})]}),e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:T.leaveType})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(T.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3 p-3 bg-white rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Start Date"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:new Date(T.startDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"End Date"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:new Date(T.endDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Duration"}),e.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[T.totalDays," day(s)"]})]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Leave Reason"}),e.jsx("p",{className:"text-sm text-gray-700",children:T.reason})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{k(T),g("accept")},className:"flex-1 bg-gradient-to-r from-green-500 to-teal-600 text-white py-2.5 rounded-lg font-medium hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(er,{className:"w-5 h-5"}),"Accept Handover"]}),e.jsxs("button",{onClick:()=>{k(T),g("deny")},className:"flex-1 bg-gradient-to-r from-red-500 to-pink-600 text-white py-2.5 rounded-lg font-medium hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(Hr,{className:"w-5 h-5"}),"Deny Handover"]})]})]},T._id))})]})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-lg",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${v==="accept"?"bg-gradient-to-r from-green-500 to-teal-600":"bg-gradient-to-r from-red-500 to-pink-600"}`,children:v==="accept"?e.jsx(er,{className:"w-5 h-5 text-white"}):e.jsx(Hr,{className:"w-5 h-5 text-white"})}),e.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:[v==="accept"?"Accept":"Deny"," Handover"]})]})}),e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["From: ",e.jsx("span",{className:"font-semibold text-gray-800",children:N.employee.name})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Leave Type: ",e.jsx("span",{className:"font-semibold text-gray-800",children:N.leaveType})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Duration: ",e.jsxs("span",{className:"font-semibold text-gray-800",children:[N.totalDays," day(s)"]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:v==="accept"?"Note (Optional)":"Reason for Denial *"}),e.jsx("textarea",{rows:"3",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-blue-500 focus:outline-none resize-none",value:b,onChange:T=>y(T.target.value),placeholder:v==="accept"?"Add any notes...":"Please explain why you are denying this request...",required:v==="deny"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{g(""),y("")},className:"px-5 py-2.5 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:bg-gray-50",children:"Back"}),e.jsx("button",{onClick:ee,disabled:R||v==="deny"&&!b.trim(),className:`px-5 py-2.5 rounded-lg font-medium text-white ${v==="accept"?"bg-gradient-to-r from-green-500 to-teal-600 hover:shadow-lg":"bg-gradient-to-r from-red-500 to-pink-600 hover:shadow-lg"} disabled:opacity-50 transition-all`,children:R?"Processing...":v==="accept"?"Confirm Accept":"Confirm Deny"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg",children:e.jsx(Me,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Handover Request"})]}),e.jsx("button",{onClick:()=>{k(null),y(""),g("")},className:"text-gray-400 hover:text-gray-600",children:""})]}),e.jsxs("div",{className:"mb-6 p-4 bg-indigo-50 rounded-lg border border-indigo-200",children:[e.jsxs("p",{className:"text-sm font-semibold text-indigo-900 mb-3",children:[N.employee.name," has requested you to handle their responsibilities"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Leave Type:"}),e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:N.leaveType})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Duration:"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-800",children:[N.totalDays," day(s)"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"From:"}),e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:new Date(N.startDate).toLocaleDateString("en-GB")})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"To:"}),e.jsx("span",{className:"text-sm font-semibold text-gray-800",children:new Date(N.endDate).toLocaleDateString("en-GB")})]}),N.reason&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-indigo-200",children:[e.jsx("span",{className:"text-xs text-gray-600 block mb-1",children:"Reason:"}),e.jsx("p",{className:"text-sm text-gray-700",children:N.reason})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>g("deny"),className:"flex-1 px-5 py-3 rounded-lg border-2 border-red-200 text-red-600 font-medium hover:bg-red-50 transition flex items-center justify-center gap-2",children:[e.jsx(Hr,{size:18}),"Deny"]}),e.jsxs("button",{onClick:()=>g("accept"),className:"flex-1 px-5 py-3 rounded-lg bg-gradient-to-r from-green-500 to-teal-600 text-white font-medium hover:shadow-lg transition flex items-center justify-center gap-2",children:[e.jsx(er,{size:18}),"Accept"]})]})]})})}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("form",{onSubmit:G,className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg",children:e.jsx(fe,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:U?"Edit Leave Application":"Apply for Leave"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Leave Type *"}),e.jsxs("select",{className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-blue-500 focus:outline-none",value:D.leaveType,onChange:T=>E(H=>({...H,leaveType:T.target.value})),required:!0,children:[e.jsx("option",{children:"Sick Leave"}),e.jsx("option",{children:"Casual Leave"}),e.jsx("option",{children:"Annual Leave"}),e.jsx("option",{children:"Emergency Leave"}),e.jsx("option",{children:"Unpaid Leave"}),e.jsx("option",{children:"Other"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-blue-500 focus:outline-none",value:D.startDate,onChange:T=>E(H=>({...H,startDate:T.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),e.jsx("input",{type:"date",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-blue-500 focus:outline-none",value:D.endDate,onChange:T=>E(H=>({...H,endDate:T.target.value})),required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Responsibility Handover To"}),e.jsxs("select",{className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-blue-500 focus:outline-none",value:D.handoverTo,onChange:T=>E(H=>({...H,handoverTo:T.target.value})),children:[e.jsx("option",{value:"",children:"-- No Handover Required --"}),u.map(T=>e.jsxs("option",{value:T._id,children:[T.name," (",T.role,")"]},T._id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Optional: Select a colleague to handle your responsibilities during leave"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason *"}),e.jsx("textarea",{rows:"4",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-blue-500 focus:outline-none resize-none",value:D.reason,onChange:T=>E(H=>({...H,reason:T.target.value})),placeholder:"Please explain your reason for leave...",required:!0})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{p(!1),I(null),E({leaveType:"Casual Leave",startDate:"",endDate:"",reason:"",handoverTo:""})},className:"px-5 py-2.5 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:R,className:"px-5 py-2.5 rounded-lg bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold hover:shadow-lg transition-all flex items-center gap-2 disabled:opacity-50",children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Kl,{className:"w-4 h-4"}),"Submit Application"]})})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("form",{onSubmit:_,className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-orange-500 to-pink-600 rounded-lg",children:e.jsx(Zn,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:M?"Edit TA/DA Application":"Apply for TA/DA"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Application Type *"}),e.jsxs("select",{className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-orange-500 focus:outline-none",value:P.applicationType,onChange:T=>$(H=>({...H,applicationType:T.target.value})),required:!0,children:[e.jsx("option",{children:"TA"}),e.jsx("option",{children:"DA"}),e.jsx("option",{children:"TA/DA"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Travel Date *"}),e.jsx("input",{type:"date",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-orange-500 focus:outline-none",value:P.travelDate,onChange:T=>$(H=>({...H,travelDate:T.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (BDT) *"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-orange-500 focus:outline-none",value:P.amount,onChange:T=>$(H=>({...H,amount:T.target.value})),placeholder:"0.00",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destination *"}),e.jsx("input",{type:"text",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-orange-500 focus:outline-none",value:P.destination,onChange:T=>$(H=>({...H,destination:T.target.value})),placeholder:"e.g., Dhaka to Chittagong",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purpose *"}),e.jsx("input",{type:"text",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-orange-500 focus:outline-none",value:P.purpose,onChange:T=>$(H=>({...H,purpose:T.target.value})),placeholder:"e.g., Business meeting, Training session",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),e.jsx("textarea",{rows:"3",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-orange-500 focus:outline-none resize-none",value:P.description,onChange:T=>$(H=>({...H,description:T.target.value})),placeholder:"Additional details about your travel..."})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{w(!1),V(null),$({applicationType:"TA/DA",purpose:"",travelDate:"",destination:"",amount:"",description:""})},className:"px-5 py-2.5 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:R,className:"px-5 py-2.5 rounded-lg bg-gradient-to-r from-orange-500 to-pink-600 text-white font-semibold hover:shadow-lg transition-all flex items-center gap-2 disabled:opacity-50",children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Kl,{className:"w-4 h-4"}),"Submit Application"]})})]})]})})]})}function Tw(){const[t,s]=d.useState("leave"),[n,r]=d.useState("Pending"),[a,l]=d.useState("Pending"),[o,i]=d.useState([]),[c,u]=d.useState([]),[x,m]=d.useState(null),[p,h]=d.useState(!1),[w,N]=d.useState(""),[k,v]=d.useState(""),[g,b]=d.useState(!1),[y,j]=d.useState(null),[S,C]=d.useState(null);d.useEffect(()=>{A(),R()},[]),d.useEffect(()=>{A()},[n]),d.useEffect(()=>{R()},[a]);const A=async()=>{try{const D=await B.getAllLeaveApplications(n==="All"?"":n);i(D.applications||[])}catch(D){C(D.message)}},R=async()=>{try{const D=await B.getAdminTADAApplications(a==="All"?"":a);u(D.applications||[])}catch(D){C(D.message)}},O=async()=>{b(!0),C(null),j(null);try{k==="approve"?(await B.approveLeaveApplication(x._id,w),j(`Leave application approved for ${x.employee.name}`)):(await B.rejectLeaveApplication(x._id,w),j(`Leave application rejected for ${x.employee.name}`)),h(!1),N(""),A()}catch(D){C(D.message)}finally{b(!1)}},U=async()=>{b(!0),C(null),j(null);try{k==="approve"?(await B.approveTADAApplication(x._id,w),j(`TA/DA application approved for ${x.employee.name}`)):(await B.rejectTADAApplication(x._id,w),j(`TA/DA application rejected for ${x.employee.name}`)),h(!1),N(""),R()}catch(D){C(D.message)}finally{b(!1)}},I=(D,E)=>{m(D),v("approve"),h(!0)},M=(D,E)=>{m(D),v("reject"),N(""),h(!0)},V=D=>({Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"})[D]||"bg-gray-100 text-gray-800";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Application Approvals"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Review and approve leave and TA/DA applications"})]}),y&&e.jsx("div",{className:"p-4 bg-green-50 border-l-4 border-green-500 rounded-lg",children:e.jsx("p",{className:"text-green-800 font-medium",children:y})}),S&&e.jsx("div",{className:"p-4 bg-red-50 border-l-4 border-red-500 rounded-lg",children:e.jsx("p",{className:"text-red-800 font-medium",children:S})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>s("leave"),className:`flex-1 px-6 py-4 font-semibold transition-colors flex items-center justify-center gap-2 ${t==="leave"?"bg-blue-50 text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(fe,{className:"w-5 h-5"}),"Leave Applications"]}),e.jsxs("button",{onClick:()=>s("tada"),className:`flex-1 px-6 py-4 font-semibold transition-colors flex items-center justify-center gap-2 ${t==="tada"?"bg-orange-50 text-orange-600 border-b-2 border-orange-600":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(Zn,{className:"w-5 h-5"}),"TA/DA Applications"]})]}),e.jsxs("div",{className:"p-6",children:[t==="leave"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),e.jsxs("select",{value:n,onChange:D=>r(D.target.value),className:"border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{children:"All"}),e.jsx("option",{children:"Pending"}),e.jsx("option",{children:"Approved"}),e.jsx("option",{children:"Rejected"})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",o.length," applications)"]})]}),o.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(fe,{className:"w-16 h-16 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No leave applications"})]}):e.jsx("div",{className:"space-y-3",children:o.map(D=>e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold",children:D.employee.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:D.employee.name}),e.jsx("p",{className:"text-xs text-gray-500",children:D.employee.role})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${V(D.status)}`,children:D.status}),e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:D.leaveType})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-3 bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Start Date"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:new Date(D.startDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"End Date"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:new Date(D.endDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Duration"}),e.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[D.totalDays," day(s)"]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Reason"}),e.jsx("p",{className:"text-sm text-gray-700",children:D.reason})]}),D.handoverTo&&e.jsxs("div",{className:"mb-3 p-3 bg-indigo-50 rounded-lg border border-indigo-200",children:[e.jsxs("p",{className:"text-xs font-medium text-indigo-700 mb-2 flex items-center gap-1",children:[e.jsx(Me,{className:"w-3 h-3"}),"Responsibility Handover"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:D.handoverTo.name}),e.jsx("p",{className:"text-xs text-gray-600",children:D.handoverTo.role}),D.handoverNote&&e.jsxs("p",{className:"text-xs text-gray-600 mt-1 italic",children:['"',D.handoverNote,'"']})]}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${D.handoverStatus==="Accepted"?"bg-green-100 text-green-800":D.handoverStatus==="Denied"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:[D.handoverStatus==="Accepted"&&" ",D.handoverStatus==="Denied"&&" ",D.handoverStatus==="Pending"&&" ",D.handoverStatus]})]})]}),D.status==="Pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>I(D),className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg px-4 py-2 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>M(D),className:"flex-1 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg px-4 py-2 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(js,{className:"w-4 h-4"}),"Reject"]})]}),D.reviewNote&&e.jsxs("div",{className:`mt-3 p-3 rounded-lg ${D.status==="Approved"?"bg-green-50":"bg-red-50"}`,children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Review Note"}),e.jsx("p",{className:"text-sm text-gray-700",children:D.reviewNote}),D.reviewedBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",D.reviewedBy.name," on ",new Date(D.reviewedAt).toLocaleDateString()]})]})]},D._id))})]}),t==="tada"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Filter:"}),e.jsxs("select",{value:a,onChange:D=>l(D.target.value),className:"border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-orange-500 focus:outline-none",children:[e.jsx("option",{children:"All"}),e.jsx("option",{children:"Pending"}),e.jsx("option",{children:"Approved"}),e.jsx("option",{children:"Rejected"})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",c.length," applications)"]})]}),c.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(Zn,{className:"w-16 h-16 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No TA/DA applications"})]}):e.jsx("div",{className:"space-y-3",children:c.map(D=>e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-orange-500 to-pink-600 flex items-center justify-center text-white font-bold",children:D.employee.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:D.employee.name}),e.jsx("p",{className:"text-xs text-gray-500",children:D.employee.role})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${V(D.adminStatus)}`,children:D.adminStatus}),e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium",children:D.applicationType})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3 bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Travel Date"}),e.jsx("p",{className:"font-medium text-gray-800 text-sm",children:new Date(D.travelDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Amount"}),e.jsx("p",{className:"font-bold text-gray-800 text-lg",children:Pe(D.amount)})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Destination"}),e.jsx("p",{className:"font-medium text-gray-800",children:D.destination})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Purpose"}),e.jsx("p",{className:"text-sm text-gray-700",children:D.purpose})]}),D.description&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-700",children:D.description})]}),D.adminStatus==="Pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>I(D),className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg px-4 py-2 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),"Approve"]}),e.jsxs("button",{onClick:()=>M(D),className:"flex-1 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg px-4 py-2 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(js,{className:"w-4 h-4"}),"Reject"]})]}),D.adminReviewNote&&e.jsxs("div",{className:`mt-3 p-3 rounded-lg ${D.adminStatus==="Approved"?"bg-green-50":"bg-red-50"}`,children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Admin Review"}),e.jsx("p",{className:"text-sm text-gray-700",children:D.adminReviewNote}),D.adminReviewedBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",D.adminReviewedBy.name," on ",new Date(D.adminReviewedAt).toLocaleDateString()]})]}),D.adminStatus==="Approved"&&e.jsx("div",{className:"mt-3 p-3 rounded-lg bg-blue-50 border border-blue-200",children:e.jsxs("p",{className:"text-xs font-medium text-blue-800",children:[" Approved - Sent to Accountant for payment ",D.paymentStatus==="Paid"?"(Already Paid)":"(Pending Payment)"]})})]},D._id))})]})]})]}),p&&x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${k==="approve"?"bg-green-100":"bg-red-100"}`,children:k==="approve"?e.jsx(it,{className:"w-6 h-6 text-green-600"}):e.jsx(js,{className:"w-6 h-6 text-red-600"})}),e.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:[k==="approve"?"Approve":"Reject"," Application"]})]}),e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Employee:"}),e.jsx("p",{className:"font-semibold text-gray-800",children:x.employee.name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:k==="approve"?"Review Note (Optional)":"Rejection Reason *"}),e.jsx("textarea",{rows:"4",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-blue-500 focus:outline-none resize-none",value:w,onChange:D=>N(D.target.value),placeholder:k==="approve"?"Add any comments...":"Please provide a reason for rejection...",required:k==="reject"})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{h(!1),N("")},className:"px-5 py-2.5 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:t==="leave"?O:U,disabled:g||k==="reject"&&!w,className:`px-5 py-2.5 rounded-lg text-white font-semibold hover:shadow-lg transition-all flex items-center gap-2 disabled:opacity-50 ${k==="approve"?"bg-gradient-to-r from-green-500 to-green-600":"bg-gradient-to-r from-red-500 to-red-600"}`,children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[k==="approve"?e.jsx(it,{className:"w-4 h-4"}):e.jsx(js,{className:"w-4 h-4"}),"Confirm ",k==="approve"?"Approval":"Rejection"]})})]})]})})]})}function Ew(){const[t,s]=d.useState("Pending"),[n,r]=d.useState([]),[a,l]=d.useState(null),[o,i]=d.useState(!1),[c,u]=d.useState(""),[x,m]=d.useState(!1),[p,h]=d.useState(null),[w,N]=d.useState(null);d.useEffect(()=>{k()},[t]);const k=async()=>{try{const y=await B.getAccountantTADAApplications(t==="All"?"":t);r(y.applications||[])}catch(y){N(y.message)}},v=async()=>{m(!0),N(null),h(null);try{await B.payTADAApplication(a._id,c),h(`Payment processed for ${a.employee.name} - ${Pe(a.amount)}`),i(!1),u(""),k()}catch(y){N(y.message)}finally{m(!1)}},g=n.filter(y=>y.paymentStatus==="Pending").reduce((y,j)=>y+j.amount,0),b=n.filter(y=>y.paymentStatus==="Paid").reduce((y,j)=>y+j.amount,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"TA/DA Payments"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Process approved travel allowance and dearness allowance payments"})]}),p&&e.jsxs("div",{className:"p-4 bg-green-50 border-l-4 border-green-500 rounded-lg flex items-start gap-3",children:[e.jsx(it,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-green-800 font-medium",children:p})]}),w&&e.jsx("div",{className:"p-4 bg-red-50 border-l-4 border-red-500 rounded-lg",children:e.jsx("p",{className:"text-red-800 font-medium",children:w})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-600 rounded-xl p-6 shadow-lg text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/80 mb-1",children:"Pending Payments"}),e.jsx("p",{className:"text-3xl font-bold",children:Pe(g)})]}),e.jsx("div",{className:"p-3 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(Bt,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-teal-600 rounded-xl p-6 shadow-lg text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/80 mb-1",children:"Paid Total"}),e.jsx("p",{className:"text-3xl font-bold",children:Pe(b)})]}),e.jsx("div",{className:"p-3 bg-white/20 rounded-lg backdrop-blur-sm",children:e.jsx(it,{className:"w-8 h-8"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Payment Status:"}),e.jsxs("select",{value:t,onChange:y=>s(y.target.value),className:"border-2 border-gray-200 rounded-lg px-4 py-2 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{children:"All"}),e.jsx("option",{children:"Pending"}),e.jsx("option",{children:"Paid"})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",n.length," applications)"]})]})}),e.jsx("div",{className:"p-6",children:n.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(He,{className:"w-16 h-16 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No TA/DA applications for payment"})]}):e.jsx("div",{className:"space-y-4",children:n.map(y=>{var j,S;return e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-lg p-5 border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-lg",children:y.employee.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-800 text-lg",children:y.employee.name}),e.jsx("p",{className:"text-sm text-gray-500",children:y.employee.role})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[y.paymentStatus==="Pending"?e.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium flex items-center gap-1",children:[e.jsx(Bt,{className:"w-4 h-4"}),"Pending Payment"]}):e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium flex items-center gap-1",children:[e.jsx(it,{className:"w-4 h-4"}),"Paid"]}),e.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium",children:y.applicationType})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 bg-white rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3"}),"Travel Date"]}),e.jsx("p",{className:"font-medium text-gray-800",children:new Date(y.travelDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[e.jsx(qy,{className:"w-3 h-3"}),"Destination"]}),e.jsx("p",{className:"font-medium text-gray-800",children:y.destination})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[e.jsx(He,{className:"w-3 h-3"}),"Amount"]}),e.jsx("p",{className:"font-bold text-gray-800 text-xl",children:Pe(y.amount)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[e.jsx(St,{className:"w-3 h-3"}),"Purpose"]}),e.jsx("p",{className:"text-sm text-gray-700",children:y.purpose})]}),y.description&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-700",children:y.description})]}),y.adminReviewNote&&e.jsxs("div",{className:"mb-4 p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Admin Approval Note"}),e.jsx("p",{className:"text-sm text-gray-700",children:y.adminReviewNote}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Approved by ",(j=y.adminReviewedBy)==null?void 0:j.name," on ",new Date(y.adminReviewedAt).toLocaleDateString()]})]}),y.paymentStatus==="Pending"?e.jsxs("button",{onClick:()=>{l(y),i(!0)},className:"w-full bg-gradient-to-r from-green-500 to-teal-600 text-white rounded-lg px-6 py-3 font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(He,{className:"w-5 h-5"}),"Process Payment - ",Pe(y.amount)]}):e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Payment Confirmation"}),y.paymentNote&&e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:y.paymentNote}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Paid by ",(S=y.paidBy)==null?void 0:S.name," on ",new Date(y.paidAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]},y._id)})})})]}),o&&a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(He,{className:"w-6 h-6 text-green-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Process Payment"})]}),e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Employee:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:a.employee.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Type:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:a.applicationType})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Amount:"}),e.jsx("span",{className:"font-bold text-gray-800 text-xl",children:Pe(a.amount)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Note (Optional)"}),e.jsx("textarea",{rows:"3",className:"w-full border-2 border-gray-200 rounded-lg px-3 py-2 focus:border-green-500 focus:outline-none resize-none",value:c,onChange:y=>u(y.target.value),placeholder:"Add payment confirmation details or transaction reference..."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{i(!1),u("")},className:"px-5 py-2.5 rounded-lg border-2 border-gray-300 text-gray-700 font-medium hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:v,disabled:x,className:"px-5 py-2.5 rounded-lg bg-gradient-to-r from-green-500 to-teal-600 text-white font-semibold hover:shadow-lg transition-all flex items-center gap-2 disabled:opacity-50",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(it,{className:"w-4 h-4"}),"Confirm Payment"]})})]})]})})]})}function Mw(){const t=Rn(),{user:s}=ge(),[n,r]=d.useState([]),[a,l]=d.useState([]),[o,i]=d.useState([]),[c,u]=d.useState(0),[x,m]=d.useState(!0),[p,h]=d.useState("all"),[w,N]=d.useState("all"),[k,v]=d.useState(null),[g,b]=d.useState(null),[y,j]=d.useState(!1),[S,C]=d.useState(null);d.useEffect(()=>{s&&A()},[s]);const A=async()=>{try{m(!0);const E=await B.getNotifications(void 0,100);r(E.notifications||[]),u(E.unreadCount||0);try{const $=((await B.listMyTasks()).tasks||[]).filter(L=>{if(L.status==="Completed")return!1;const W=new Date;return new Date(L.dueDate)<W});l($)}catch(P){console.log("Could not load urgent tasks:",P.message)}if(s&&["Admission","Admin","SuperAdmin"].includes(s.role))try{const P=await B.getAdmissionFollowUpNotifications();console.log("Follow-up data received:",P);const $=new Date;$.setHours(0,0,0,0);const L=P.notifications||P.leads||[];console.log("Processing follow-up leads:",L.length);const W=L.map(F=>{if(!F.nextFollowUpDate)return{...F,isOverdue:!1};const z=new Date(F.nextFollowUpDate);z.setHours(0,0,0,0);const G=z<$;return{...F,isOverdue:G}});i(W),console.log("Set follow-up notifications:",W.length)}catch(P){console.error("Could not load follow-up notifications:",P),console.log("Could not load follow-up notifications:",P.message)}}catch(E){b(E.message)}finally{m(!1)}},R=async E=>{try{E.isRead||(await B.markNotificationRead(E._id),u(P=>Math.max(0,P-1)),r(P=>P.map($=>$._id===E._id?{...$,isRead:!0}:$))),E.type==="LEAVE_HANDOVER_REQUEST"?(sessionStorage.setItem("openHandoverRequestId",E.relatedId),sessionStorage.setItem("handoverNotificationId",E._id),t("/my-applications")):E.link&&t(E.link)}catch(P){console.error("Failed to handle notification:",P)}},O=async()=>{try{await B.markAllNotificationsRead(),v("All notifications marked as read "),r(E=>E.map(P=>({...P,isRead:!0}))),u(0),setTimeout(()=>v(null),3e3)}catch(E){b(E.message)}},U=async(E,P)=>{if(P.stopPropagation(),!!confirm("Delete this notification?"))try{await B.deleteNotification(E),r($=>$.filter(L=>L._id!==E)),v("Notification deleted"),setTimeout(()=>v(null),3e3)}catch($){b($.message)}},I=async E=>{try{b(null);const P=await B.getLeadHistory(E._id),$=P.lead||P;C($),j(!0)}catch(P){console.error("Failed to load lead details:",P),b("Failed to load lead details: "+P.message)}},M=n.filter(E=>!(p==="unread"&&E.isRead||p==="read"&&!E.isRead||w==="leave"&&!E.type.startsWith("LEAVE_")||w==="tada"&&!E.type.startsWith("TADA_")||w==="handover"&&!E.type.includes("HANDOVER")||w==="task"&&!E.type.startsWith("TASK_")||w==="urgent"||w==="followup")),V=E=>E.startsWith("LEAVE_")?e.jsx(fe,{className:"w-5 h-5 text-blue-600"}):E.startsWith("TADA_")?e.jsx(Ut,{className:"w-5 h-5 text-orange-600"}):E.includes("HANDOVER")?e.jsx(Me,{className:"w-5 h-5 text-purple-600"}):E.startsWith("TASK_")?e.jsx(it,{className:"w-5 h-5 text-green-600"}):e.jsx(Qt,{className:"w-5 h-5 text-gray-600"}),D=E=>E.startsWith("LEAVE_")?"border-blue-200 bg-blue-50":E.startsWith("TADA_")?"border-orange-200 bg-orange-50":E.includes("HANDOVER")?"border-purple-200 bg-purple-50":E.startsWith("TASK_")?"border-green-200 bg-green-50":"border-gray-200 bg-gray-50";return e.jsxs("div",{className:"p-4 md:p-6 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-navy flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg",children:e.jsx(Qt,{className:"w-6 h-6 text-white"})}),"All Notifications"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:c>0?`${c} unread notification${c>1?"s":""}`:"All caught up!"})]}),c>0&&e.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition",children:[e.jsx(dp,{size:18}),"Mark All Read"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ao,{size:16,className:"text-gray-500"}),e.jsxs("select",{value:p,onChange:E=>h(E.target.value),className:"px-3 py-2 border-2 border-gray-200 rounded-lg focus:border-indigo-500 focus:outline-none text-sm",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"unread",children:"Unread"}),e.jsx("option",{value:"read",children:"Read"})]})]}),e.jsxs("select",{value:w,onChange:E=>N(E.target.value),className:"px-3 py-2 border-2 border-gray-200 rounded-lg focus:border-indigo-500 focus:outline-none text-sm",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"urgent",children:"Urgent Tasks"}),e.jsx("option",{value:"followup",children:"Follow-up Due"}),e.jsx("option",{value:"leave",children:"Leave Applications"}),e.jsx("option",{value:"tada",children:"TA/DA Applications"}),e.jsx("option",{value:"handover",children:"Handover Requests"}),e.jsx("option",{value:"task",children:"Tasks"})]})]})]}),k&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 text-green-700 rounded-lg flex items-center gap-2",children:[e.jsx(it,{size:18}),k]}),g&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 text-red-700 rounded-lg flex items-center gap-2",children:[e.jsx(js,{size:18}),g]}),x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Loading notifications..."})]}):e.jsxs("div",{className:"space-y-6",children:[w==="all"||w==="urgent"?a.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(fe,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("h2",{className:"text-lg font-bold text-navy",children:["Urgent Tasks (",a.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:a.map(E=>e.jsx("div",{onClick:()=>t("/tasks"),className:"p-4 rounded-xl border-2 border-red-200 bg-red-50 cursor-pointer hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white",children:e.jsx(Ut,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-navy",children:E.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:E.description||"No description"})]}),e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-red-100 text-red-700 font-medium",children:"Overdue"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-gray-500",children:[e.jsx(fe,{size:12}),"Due: ",new Date(E.dueDate).toLocaleDateString("en-GB")]})]})]})},E._id))})]}):null,w==="all"||w==="followup"?o.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:e.jsx(Qt,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("h2",{className:"text-lg font-bold text-navy",children:["Follow-up Due (",o.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:o.map(E=>{const P=E.isOverdue;return e.jsx("div",{onClick:()=>I(E),className:`p-4 rounded-xl border-2 cursor-pointer hover:shadow-md transition-all ${P?"border-red-200 bg-red-50":"border-purple-200 bg-purple-50"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white",children:e.jsx(Me,{className:`w-5 h-5 ${P?"text-red-600":"text-purple-600"}`})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-base font-semibold text-navy",children:[E.leadId,"  ",E.name]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[E.interestedCourse||"No course","  ",E.status]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[E.phone," ",E.email&&` ${E.email}`]}),E.assignedTo&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[" Assigned to: ",E.assignedTo.name]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded font-medium ${P?"bg-red-100 text-red-700":"bg-purple-100 text-purple-700"}`,children:P?"OVERDUE":"DUE TODAY"}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-gray-500",children:[e.jsx(fe,{size:12}),new Date(E.nextFollowUpDate).toLocaleDateString("en-GB")]})]})]})})]})},E._id)})})]}):null,M.length===0&&a.length===0&&o.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-2xl",children:[e.jsx(Qt,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No notifications found"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Try adjusting your filters"})]}):null,M.length>0&&e.jsxs("div",{children:[(a.length>0||o.length>0)&&w==="all"&&e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-indigo-50 rounded-lg",children:e.jsx(Qt,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("h2",{className:"text-lg font-bold text-navy",children:["System Notifications (",M.length,")"]})]}),e.jsx("div",{className:"space-y-3",children:M.map(E=>{const P=E.type==="LEAVE_HANDOVER_REQUEST";return e.jsx("div",{onClick:()=>R(E),className:`p-4 rounded-xl border-2 cursor-pointer transition-all hover:shadow-md ${E.isRead?"bg-white border-gray-200":D(E.type)+" border-l-4"}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${E.isRead?"bg-gray-100":"bg-white"}`,children:V(E.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:`text-base ${E.isRead?"font-medium text-gray-700":"font-semibold text-navy"}`,children:[E.title,P&&!E.isRead&&e.jsx("span",{className:"ml-2 text-xs bg-purple-600 text-white px-2 py-0.5 rounded-full",children:"Action Required"}),!E.isRead&&!P&&e.jsx("span",{className:"ml-2 inline-block w-2 h-2 bg-indigo-500 rounded-full"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:E.message}),E.sender&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("img",{src:E.sender.avatar,alt:E.sender.name,className:"w-5 h-5 rounded-full"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["from ",E.sender.name]})]})]}),e.jsx("button",{onClick:$=>U(E._id,$),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete notification",children:e.jsx(cn,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-gray-400",children:[e.jsx(Bt,{size:12}),new Date(E.createdAt).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})},E._id)})})]})]}),y&&S&&e.jsx(hp,{lead:S,onClose:()=>{j(!1),C(null)},onUpdate:async()=>{try{const E=await B.getLeadHistory(S._id);C(E)}catch(E){console.error("Failed to reload lead:",E)}}})]})}function Lw(){const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState([]),[l,o]=d.useState(null),[i,c]=d.useState([]),[u,x]=d.useState(""),[m,p]=d.useState(""),[h,w]=d.useState(!0),[N,k]=d.useState(!1),v=d.useRef(null),g=d.useRef(null),b=()=>{var M;(M=v.current)==null||M.scrollIntoView({behavior:"smooth"})};d.useEffect(()=>{b()},[i]),d.useEffect(()=>{y(),j();const M=setInterval(y,5e3);return()=>clearInterval(M)},[]),d.useEffect(()=>{if(l){S(l._id);const M=setInterval(()=>S(l._id),3e3);return()=>clearInterval(M)}},[l]);const y=async()=>{try{const M=await B.getConversations();n(M.conversations||[])}catch(M){console.error("Error loading conversations:",M)}finally{w(!1)}},j=async()=>{try{const V=((await B.listUsers()).users||[]).filter(D=>D._id!==t.id);a(V)}catch(M){console.error("Error loading users:",M)}},S=async M=>{try{const V=await B.getMessages(M);c(V.messages||[]),await B.markMessagesAsRead(M),y()}catch(V){console.error("Error loading messages:",V)}},C=async M=>{if(M.preventDefault(),!(!u.trim()||!l))try{k(!0),await B.sendMessage({recipient:l._id,content:u.trim()}),x(""),S(l._id),y()}catch(V){console.error("Error sending message:",V),alert("Failed to send message")}finally{k(!1)}},A=M=>{o(M)},O=(()=>{const M=new Map;s.forEach(E=>{E.user&&E.user._id&&!M.has(E.user._id)&&M.set(E.user._id,{...E.user,hasConversation:!0,lastMessage:E.lastMessage,unreadCount:E.unreadCount||0})}),r.forEach(E=>{E&&E._id&&!M.has(E._id)&&M.set(E._id,{...E,hasConversation:!1,lastMessage:null,unreadCount:0})});const V=[],D=[];return M.forEach(E=>{E.hasConversation?V.push(E):D.push(E)}),D.sort((E,P)=>(E.name||"").localeCompare(P.name||"")),[...V,...D]})().filter(M=>{var V,D,E;return((V=M==null?void 0:M.name)==null?void 0:V.toLowerCase().includes(m.toLowerCase()))||((D=M==null?void 0:M.email)==null?void 0:D.toLowerCase().includes(m.toLowerCase()))||((E=M==null?void 0:M.designation)==null?void 0:E.toLowerCase().includes(m.toLowerCase()))}),U=M=>{if(!M)return"";const V=new Date(M),E=new Date-V,P=Math.floor(E/6e4),$=Math.floor(E/36e5),L=Math.floor(E/864e5);return P<1?"Just now":P<60?`${P}m ago`:$<24?`${$}h ago`:L<7?`${L}d ago`:V.toLocaleDateString()},I=M=>M?new Date(M).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return h?e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(gt,{size:48,className:"mx-auto text-gray-400 mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Loading messages..."})]})}):e.jsxs("div",{className:"h-[calc(100vh-64px)] flex bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"w-80 border-r flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-bold text-navy mb-3",children:"Messages"}),e.jsxs("div",{className:"relative",children:[e.jsx(An,{size:18,className:"absolute left-3 top-2.5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search conversations...",value:m,onChange:M=>p(M.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:O.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(gt,{size:48,className:"mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No colleagues found"}),e.jsx("p",{className:"text-sm mt-1",children:"Try adjusting your search"})]}):O.map(M=>e.jsx("div",{onClick:()=>A(M),className:`p-4 border-b cursor-pointer hover:bg-gray-50 transition ${(l==null?void 0:l._id)===M._id?"bg-blue-50 border-l-4 border-l-blue-500":""} ${M.hasConversation?"bg-gradient-to-r from-blue-50/30 to-transparent":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:M.avatar,alt:M.name,className:"w-12 h-12 rounded-full object-cover"}),M.hasConversation&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h3",{className:"font-semibold text-navy truncate",children:M.name}),M.lastMessage&&e.jsx("span",{className:"text-xs text-gray-500",children:U(M.lastMessage.createdAt)})]}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:M.designation||M.role}),M.lastMessage&&e.jsxs("p",{className:"text-sm text-gray-500 truncate mt-1",children:[M.lastMessage.sender.toString()===t.id?"You: ":"",M.lastMessage.content]}),M.unreadCount>0&&e.jsxs("span",{className:"inline-block mt-1 px-2 py-0.5 bg-red-500 text-white text-xs rounded-full",children:[M.unreadCount," new"]})]})]})},M._id))})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:l.avatar,alt:l.name,className:"w-10 h-10 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-navy",children:l.name}),e.jsx("p",{className:"text-sm text-gray-500",children:l.designation||l.role})]})]}),e.jsx("button",{onClick:()=>o(null),className:"p-2 hover:bg-gray-100 rounded-lg transition md:hidden",children:e.jsx(Do,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-50",children:i.length===0?e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(gt,{size:48,className:"mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No messages yet"}),e.jsx("p",{className:"text-sm mt-1",children:"Send a message to start the conversation"})]})}):e.jsxs("div",{className:"space-y-4",children:[i.map(M=>{var P,$,L,W,F;const V=(($=(P=M.sender)==null?void 0:P._id)==null?void 0:$.toString())||((L=M.sender)==null?void 0:L.toString()),D=((W=t==null?void 0:t.id)==null?void 0:W.toString())||((F=t==null?void 0:t._id)==null?void 0:F.toString()),E=V===D;return i.length>0&&M===i[0]&&console.log("Message alignment debug:",{senderId:V,currentUserId:D,isOwn:E}),e.jsx("div",{className:`flex ${E?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex gap-2 max-w-[70%] ${E?"flex-row-reverse":""}`,children:[!E&&e.jsx("img",{src:M.sender.avatar,alt:M.sender.name,className:"w-8 h-8 rounded-full object-cover flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:`p-3 rounded-lg ${E?"bg-blue-500 text-white":"bg-white text-gray-800 border"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:M.content})}),e.jsxs("div",{className:`flex items-center gap-2 mt-1 text-xs text-gray-500 ${E?"justify-end":""}`,children:[e.jsx("span",{children:I(M.createdAt)}),E&&e.jsx("span",{children:M.isRead?e.jsx(dp,{size:14,className:"text-blue-400"}):e.jsx(By,{size:14,className:"text-gray-400"})})]})]})]})},M._id)}),e.jsx("div",{ref:v})]})}),e.jsx("form",{onSubmit:C,className:"p-4 border-t bg-white",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:g,type:"text",value:u,onChange:M=>x(M.target.value),placeholder:"Type a message...",className:"flex-1 px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:N}),e.jsx("button",{type:"submit",disabled:!u.trim()||N,className:"p-3 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Kl,{size:20})})]})})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(gt,{size:64,className:"mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Select a conversation"}),e.jsx("p",{children:"Choose a colleague from the list to start messaging"})]})})})]})}function Pw(){const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState(!0),[l,o]=d.useState("all"),[i,c]=d.useState(""),[u,x]=d.useState(""),[m,p]=d.useState("all");d.useEffect(()=>{h()},[l,i,u,m]);const h=async()=>{try{a(!0);const j=(await B.listMyTasks()).tasks||[];let S=w(j);m==="completed"?S=S.filter(C=>C.status==="Completed"):m==="pending"&&(S=S.filter(C=>C.status!=="Completed")),S.sort((C,A)=>{const R=new Date(C.dueDate||C.createdAt);return new Date(A.dueDate||A.createdAt)-R}),n(S)}catch(y){console.error("Failed to load tasks:",y)}finally{a(!1)}},w=y=>{const j=new Date;switch(l){case"daily":{const S=new Date(j.getFullYear(),j.getMonth(),j.getDate());return y.filter(C=>new Date(C.dueDate||C.createdAt)>=S)}case"weekly":{const S=new Date(j);return S.setDate(j.getDate()-7),y.filter(C=>new Date(C.dueDate||C.createdAt)>=S)}case"monthly":{const S=new Date(j);return S.setMonth(j.getMonth()-1),y.filter(C=>new Date(C.dueDate||C.createdAt)>=S)}case"custom":{if(!i||!u)return y;const S=new Date(i),C=new Date(u);return C.setHours(23,59,59,999),y.filter(A=>{const R=new Date(A.dueDate||A.createdAt);return R>=S&&R<=C})}default:return y}},N={total:s.length,completed:s.filter(y=>y.status==="Completed").length,pending:s.filter(y=>y.status!=="Completed").length,overdue:s.filter(y=>y.status==="Completed"||!y.dueDate?!1:new Date(y.dueDate)<new Date).length},k=N.total>0?Math.round(N.completed/N.total*100):0,v=y=>{switch(y){case"Completed":return"bg-green-100 text-green-700";case"In Progress":return"bg-blue-100 text-blue-700";case"On Hold":return"bg-yellow-100 text-yellow-700";case"Blocked":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},g=y=>{switch(y){case"Critical":return"bg-red-100 text-red-700";case"High":return"bg-orange-100 text-orange-700";case"Medium":return"bg-yellow-100 text-yellow-700";case"Low":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},b=()=>{const y=["Title","Status","Priority","Due Date","Assigned By","Tags"],j=s.map(O=>{var U,I;return[O.title,O.status,O.priority,O.dueDate?new Date(O.dueDate).toLocaleDateString():"N/A",((U=O.assignedBy)==null?void 0:U.name)||"N/A",((I=O.tags)==null?void 0:I.join(", "))||"N/A"]}),S=[y.join(","),...j.map(O=>O.map(U=>`"${U}"`).join(","))].join(`
`),C=new Blob([S],{type:"text/csv"}),A=window.URL.createObjectURL(C),R=document.createElement("a");R.href=A,R.download=`task-report-${new Date().toISOString().split("T")[0]}.csv`,R.click(),window.URL.revokeObjectURL(A)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Task Report"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View and analyze your task performance"})]}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-navy text-white rounded-lg hover:bg-navy/90 transition",children:[e.jsx(ts,{size:18}),"Export CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Tasks"}),e.jsx("p",{className:"text-2xl font-bold text-navy mt-1",children:N.total})]}),e.jsx(Xl,{size:32,className:"text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-navy mt-1",children:N.completed})]}),e.jsx(kc,{size:32,className:"text-green-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-navy mt-1",children:N.pending})]}),e.jsx(Bt,{size:32,className:"text-yellow-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-bold text-navy mt-1",children:N.overdue})]}),e.jsx(Ut,{size:32,className:"text-red-500"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-navy flex items-center gap-2",children:[e.jsx(Ot,{size:20}),"Completion Rate"]}),e.jsxs("span",{className:"text-2xl font-bold text-navy",children:[k,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-4 rounded-full transition-all duration-500",style:{width:`${k}%`}})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-navy mb-4 flex items-center gap-2",children:[e.jsx(Ao,{size:20}),"Filters"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),e.jsxs("select",{value:l,onChange:y=>o(y.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"daily",children:"Today"}),e.jsx("option",{value:"weekly",children:"Last 7 Days"}),e.jsx("option",{value:"monthly",children:"Last 30 Days"}),e.jsx("option",{value:"custom",children:"Custom Range"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:m,onChange:y=>p(y.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"completed",children:"Completed Only"}),e.jsx("option",{value:"pending",children:"Pending Only"})]})]}),l==="custom"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:i,onChange:y=>c(y.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:u,onChange:y=>x(y.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h3",{className:"text-lg font-semibold text-navy",children:["Task List (",s.length," ",m==="completed"?"Completed":m==="pending"?"Pending":""," Tasks)"]})}),r?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Bt,{size:48,className:"mx-auto mb-3 animate-spin"}),e.jsx("p",{children:"Loading tasks..."})]}):s.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Xl,{size:48,className:"mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No tasks found for the selected filters"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Task"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned By"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tags"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(y=>{var j,S;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-navy",children:y.title}),y.description&&e.jsx("div",{className:"text-sm text-gray-500 mt-1 line-clamp-1",children:y.description})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${v(y.status)}`,children:y.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g(y.priority)}`,children:y.priority})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:y.dueDate?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{size:14}),new Date(y.dueDate).toLocaleDateString()]}):e.jsx("span",{className:"text-gray-400",children:"No due date"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:((j=y.assignedBy)==null?void 0:j.name)||"N/A"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(S=y.tags)==null?void 0:S.map((C,A)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded",children:C},A))})})]},y._id)})})]})})]})]})}function Iw(){var M;const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState([]),[l,o]=d.useState(!0),[i,c]=d.useState("all"),[u,x]=d.useState(""),[m,p]=d.useState(""),[h,w]=d.useState("all"),[N,k]=d.useState("all"),[v,g]=d.useState("");d.useEffect(()=>{b()},[]),d.useEffect(()=>{y()},[i,u,m,h,N]);const b=async()=>{try{const V=await B.listUsers();a(V.users||[])}catch(V){console.error("Failed to load users:",V)}},y=async()=>{try{o(!0);let D=(await B.listAllTasks()).tasks||[];N!=="all"&&(D=D.filter(P=>P.assignedTo&&P.assignedTo.includes(N)));let E=j(D);h==="completed"?E=E.filter(P=>P.status==="Completed"):h==="pending"&&(E=E.filter(P=>P.status!=="Completed")),E.sort((P,$)=>{const L=new Date(P.dueDate||P.createdAt);return new Date($.dueDate||$.createdAt)-L}),n(E)}catch(V){console.error("Failed to load tasks:",V)}finally{o(!1)}},j=V=>{const D=new Date;switch(i){case"daily":{const E=new Date(D.getFullYear(),D.getMonth(),D.getDate());return V.filter(P=>new Date(P.dueDate||P.createdAt)>=E)}case"weekly":{const E=new Date(D);return E.setDate(D.getDate()-7),V.filter(P=>new Date(P.dueDate||P.createdAt)>=E)}case"monthly":{const E=new Date(D);return E.setMonth(D.getMonth()-1),V.filter(P=>new Date(P.dueDate||P.createdAt)>=E)}case"custom":{if(!u||!m)return V;const E=new Date(u),P=new Date(m);return P.setHours(23,59,59,999),V.filter($=>{const L=new Date($.dueDate||$.createdAt);return L>=E&&L<=P})}default:return V}},S={total:s.length,completed:s.filter(V=>V.status==="Completed").length,pending:s.filter(V=>V.status!=="Completed").length,overdue:s.filter(V=>V.status==="Completed"||!V.dueDate?!1:new Date(V.dueDate)<new Date).length},C=S.total>0?Math.round(S.completed/S.total*100):0,A=V=>{switch(V){case"Completed":return"bg-green-100 text-green-700";case"In Progress":return"bg-blue-100 text-blue-700";case"On Hold":return"bg-yellow-100 text-yellow-700";case"Blocked":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},R=V=>{switch(V){case"Critical":return"bg-red-100 text-red-700";case"High":return"bg-orange-100 text-orange-700";case"Medium":return"bg-yellow-100 text-yellow-700";case"Low":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},O=()=>{const V=N!=="all"?r.find(z=>z._id===N):null,D=V?`task-report-${V.name.replace(/\s+/g,"-")}-${new Date().toISOString().split("T")[0]}.csv`:`task-report-all-${new Date().toISOString().split("T")[0]}.csv`,E=["Title","Status","Priority","Due Date","Assigned To","Assigned By","Tags"],P=s.map(z=>{var G,ee,_;return[z.title,z.status,z.priority,z.dueDate?new Date(z.dueDate).toLocaleDateString():"N/A",((G=z.assignedTo)==null?void 0:G.map(te=>{const K=r.find(Y=>Y._id===te);return(K==null?void 0:K.name)||"Unknown"}).join(", "))||"N/A",((ee=z.assignedBy)==null?void 0:ee.name)||"N/A",((_=z.tags)==null?void 0:_.join(", "))||"N/A"]}),$=[E.join(","),...P.map(z=>z.map(G=>`"${G}"`).join(","))].join(`
`),L=new Blob([$],{type:"text/csv"}),W=window.URL.createObjectURL(L),F=document.createElement("a");F.href=W,F.download=D,F.click(),window.URL.revokeObjectURL(W)},U=r.filter(V=>{var D,E,P;return((D=V.name)==null?void 0:D.toLowerCase().includes(v.toLowerCase()))||((E=V.email)==null?void 0:E.toLowerCase().includes(v.toLowerCase()))||((P=V.designation)==null?void 0:P.toLowerCase().includes(v.toLowerCase()))}),I=N==="all"?"All Employees":((M=r.find(V=>V._id===N))==null?void 0:M.name)||"Unknown";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Admin Task Report"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View and analyze employee task performance"})]}),e.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-navy text-white rounded-lg hover:bg-navy/90 transition",children:[e.jsx(ts,{size:18}),"Export CSV"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-navy mb-4 flex items-center gap-2",children:[e.jsx(Me,{size:20}),"Select Employee"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Employee"}),e.jsxs("div",{className:"relative",children:[e.jsx(An,{size:18,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name, email, or designation...",value:v,onChange:V=>g(V.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Employee (",I,")"]}),e.jsxs("select",{value:N,onChange:V=>k(V.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Employees"}),U.map(V=>e.jsxs("option",{value:V._id,children:[V.name," - ",V.designation||V.role]},V._id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Tasks"}),e.jsx("p",{className:"text-2xl font-bold text-navy mt-1",children:S.total})]}),e.jsx(Xl,{size:32,className:"text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-navy mt-1",children:S.completed})]}),e.jsx(kc,{size:32,className:"text-green-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-navy mt-1",children:S.pending})]}),e.jsx(Bt,{size:32,className:"text-yellow-500"})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-4 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-bold text-navy mt-1",children:S.overdue})]}),e.jsx(Ut,{size:32,className:"text-red-500"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-navy flex items-center gap-2",children:[e.jsx(Ot,{size:20}),"Completion Rate - ",I]}),e.jsxs("span",{className:"text-2xl font-bold text-navy",children:[C,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-4 rounded-full transition-all duration-500",style:{width:`${C}%`}})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-navy mb-4 flex items-center gap-2",children:[e.jsx(Ao,{size:20}),"Filters"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Period"}),e.jsxs("select",{value:i,onChange:V=>c(V.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"daily",children:"Today"}),e.jsx("option",{value:"weekly",children:"Last 7 Days"}),e.jsx("option",{value:"monthly",children:"Last 30 Days"}),e.jsx("option",{value:"custom",children:"Custom Range"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:h,onChange:V=>w(V.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"completed",children:"Completed Only"}),e.jsx("option",{value:"pending",children:"Pending Only"})]})]}),i==="custom"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:u,onChange:V=>x(V.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:m,onChange:V=>p(V.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h3",{className:"text-lg font-semibold text-navy",children:["Task List (",s.length," ",h==="completed"?"Completed":h==="pending"?"Pending":""," Tasks)"]})}),l?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Bt,{size:48,className:"mx-auto mb-3 animate-spin"}),e.jsx("p",{children:"Loading tasks..."})]}):s.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(Xl,{size:48,className:"mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No tasks found for the selected filters"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Task"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned To"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Due Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned By"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tags"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(V=>{var D,E,P;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-navy",children:V.title}),V.description&&e.jsx("div",{className:"text-sm text-gray-500 mt-1 line-clamp-1",children:V.description})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(D=V.assignedTo)==null?void 0:D.map($=>{const L=r.find(W=>W._id===$);return L?e.jsxs("div",{className:"flex items-center gap-1 text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded",children:[e.jsx("img",{src:L.avatar,alt:L.name,className:"w-4 h-4 rounded-full"}),L.name]},$):null})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${A(V.status)}`,children:V.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${R(V.priority)}`,children:V.priority})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:V.dueDate?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{size:14}),new Date(V.dueDate).toLocaleDateString()]}):e.jsx("span",{className:"text-gray-400",children:"No due date"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:((E=V.assignedBy)==null?void 0:E.name)||"N/A"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(P=V.tags)==null?void 0:P.map(($,L)=>e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded",children:$},L))})})]},V._id)})})]})})]})]})}function Rw(){var V;const[t,s]=d.useState("admission"),[n,r]=d.useState("student"),[a,l]=d.useState([]),[o,i]=d.useState([]),[c,u]=d.useState([]),[x,m]=d.useState(""),[p,h]=d.useState(""),[w,N]=d.useState(!1),[k,v]=d.useState(""),[g,b]=d.useState(""),[y,j]=d.useState({courseId:"",month:"",targetValue:"",assignedTo:"",note:""}),C=(()=>{const D=[],E=new Date,P=E.getFullYear(),$=E.getMonth();for(let L=0;L<12;L++){const W=P+Math.floor(($+L)/12),F=($+L)%12,z=`${W}-${String(F+1).padStart(2,"0")}`,ee=new Date(W,F,1).toLocaleDateString("en-US",{year:"numeric",month:"long"});D.push({value:z,label:ee})}return D})();d.useEffect(()=>{const D=new Date().toISOString().slice(0,7);m(D),j({...y,month:D})},[]),d.useEffect(()=>{(async()=>{try{const E=await B.listCourses();l((E==null?void 0:E.courses)||[])}catch(E){console.error("Failed to load courses:",E)}})()},[]),d.useEffect(()=>{(async()=>{try{const E=t==="admission"?"Admission":"Recruitment",P=await B.getTeamMembers(E);i((P==null?void 0:P.members)||[])}catch(E){console.error("Failed to load team members:",E)}})()},[t]),d.useEffect(()=>{x&&R()},[x,t,n,p]);const A=()=>t==="admission"?n==="student"?"AdmissionStudent":"AdmissionRevenue":n==="student"?"RecruitmentCandidate":"RecruitmentRevenue",R=async()=>{if(x){N(!0),v("");try{const D=A(),E=await B.getTargets(x,D,p||null);u((E==null?void 0:E.targets)||[])}catch(D){v("Failed to load targets: "+D.message)}finally{N(!1)}}},O=async D=>{D.preventDefault(),v(""),b("");const E=A();if(!y.month||!y.targetValue){v("Please fill all required fields");return}if(E==="AdmissionStudent"&&!y.courseId){v("Please select a course");return}try{const P={targetType:E,month:y.month,targetValue:parseInt(y.targetValue),...y.courseId&&{courseId:y.courseId},...y.assignedTo&&{assignedTo:y.assignedTo},...y.note&&{note:y.note}};await B.setTarget(P),b("Target set successfully!"),j({courseId:"",month:x,targetValue:"",assignedTo:"",note:""}),R()}catch(P){v("Failed to set target: "+P.message)}},U=async D=>{if(confirm("Delete this target?"))try{await B.deleteTarget(D),b("Target deleted successfully!"),R()}catch(E){v("Failed to delete target: "+E.message)}},I=()=>n==="student"?t==="admission"?"Students":"Candidates":"BDT",M=D=>n==="revenue"?`${D.toLocaleString()}`:D.toString();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg",children:e.jsx(Ht,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Targets"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Set and track performance targets for admission and recruitment teams"})]})]})}),k&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:k}),g&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg",children:g}),e.jsxs("div",{className:"flex gap-2 border-b",children:[e.jsx("button",{onClick:()=>{s("admission"),r("student")},className:`px-6 py-3 font-medium transition-colors border-b-2 ${t==="admission"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{size:18}),"Admission Targets"]})}),e.jsx("button",{onClick:()=>{s("recruitment"),r("student")},className:`px-6 py-3 font-medium transition-colors border-b-2 ${t==="recruitment"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ip,{size:18}),"Recruitment Targets"]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r("student"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="student"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:t==="admission"?"Student Target":"Candidate Target"}),e.jsx("button",{onClick:()=>r("revenue"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n==="revenue"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{size:16}),"Revenue Target"]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ss,{size:20}),"Set New Target"]}),e.jsxs("form",{onSubmit:O,className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[A()==="AdmissionStudent"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Course ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:y.courseId,onChange:D=>j({...y,courseId:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Course"}),a.map(D=>e.jsx("option",{value:D._id,children:D.name},D._id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Month ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{value:y.month,onChange:D=>j({...y,month:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",required:!0,children:C.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Target (",I(),") ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"0",value:y.targetValue,onChange:D=>j({...y,targetValue:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",placeholder:"Enter target",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign to Member (Optional)"}),e.jsxs("select",{value:y.assignedTo,onChange:D=>j({...y,assignedTo:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"",children:"Team Target"}),o.map(D=>e.jsx("option",{value:D._id,children:D.name},D._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note (Optional)"}),e.jsx("input",{type:"text",value:y.note,onChange:D=>j({...y,note:D.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",placeholder:"Add note"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"submit",className:"w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Set Target"})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 flex-wrap gap-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(Ot,{size:20}),"Targets & Achievement"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:p,onChange:D=>h(D.target.value),className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"",children:"All Team Members"}),o.map(D=>e.jsx("option",{value:D._id,children:D.name},D._id))]}),e.jsx("select",{value:x,onChange:D=>{console.log("[Month Filter] Changing from",x,"to",D.target.value),m(D.target.value)},className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500",children:C.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))})]})]}),(()=>{var $;const D=new Date().toISOString().slice(0,7),E=x>D,P=x===D;return console.log("[Banner] currentMonth:",D,"selectedMonth:",x,"isFuture:",E,"isCurrent:",P),E?e.jsxs("div",{className:"mb-4 bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg flex items-start gap-2",children:[e.jsx(fe,{size:18,className:"mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Future Month Selected"}),e.jsxs("p",{className:"text-sm",children:["You are viewing targets for ",($=C.find(L=>L.value===x))==null?void 0:$.label,". Achievement data will be calculated as the month progresses."]})]})]}):P?e.jsxs("div",{className:"mb-4 bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-lg flex items-start gap-2",children:[e.jsx(fe,{size:18,className:"mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Current Month"}),e.jsx("p",{className:"text-sm",children:"Achievement is calculated up to today. Final results will be available at month end."})]})]}):null})(),w?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading targets..."}):c.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:["No targets set for ",(V=C.find(D=>D.value===x))==null?void 0:V.label]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[A()==="AdmissionStudent"&&e.jsx("th",{className:"text-left px-4 py-3 text-sm font-semibold text-gray-700",children:"Course"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-semibold text-gray-700",children:"Assigned To"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Target"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Achieved"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Progress"}),c.some(D=>D.note)&&e.jsx("th",{className:"text-left px-4 py-3 text-sm font-semibold text-gray-700",children:"Note"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:c.map(D=>{var $;const E=D.percentage||0,P=E>=100?"green":E>=75?"blue":E>=50?"yellow":"red";return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[A()==="AdmissionStudent"&&e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-800",children:(($=D.course)==null?void 0:$.name)||"N/A"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:D.assignedTo?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:D.assignedTo.name}),e.jsx("div",{className:"text-xs text-gray-500",children:D.assignedTo.role})]}):e.jsx("span",{className:"text-gray-500 italic",children:"Team Target"})}),e.jsx("td",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:M(D.targetValue)}),e.jsx("td",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:M(D.achieved)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"flex-1 max-w-xs bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full bg-${P}-500`,style:{width:`${Math.min(E,100)}%`}})}),e.jsxs("span",{className:`text-sm font-semibold text-${P}-600`,children:[E,"%"]})]})}),c.some(L=>L.note)&&e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:D.note||"-"}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("button",{onClick:()=>U(D._id),className:"text-red-600 hover:text-red-800 p-2 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Target",children:e.jsx(cn,{size:16})})})]},D._id)})})]})})]})]})}function $w(){var w;const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState(""),[l,o]=d.useState(!1),[i,c]=d.useState(""),x=(()=>{const N=[],k=new Date,v=k.getFullYear(),g=k.getMonth();for(let b=0;b<12;b++){const y=v+Math.floor((g+b)/12),j=(g+b)%12,S=`${y}-${String(j+1).padStart(2,"0")}`,A=new Date(y,j,1).toLocaleDateString("en-US",{year:"numeric",month:"long"});N.push({value:S,label:A})}return N})();d.useEffect(()=>{const N=new Date().getFullYear(),k=new Date().getMonth()+1,v=`${N}-${String(k).padStart(2,"0")}`;a(v)},[]),d.useEffect(()=>{r&&t&&m()},[r,t]);const m=async()=>{if(!(!r||!t)){o(!0),c("");try{const N=await B.getTargets(r,"AdmissionStudent",t.id),k=await B.getTargets(r,"AdmissionRevenue",t.id),v=[...(N==null?void 0:N.targets)||[],...(k==null?void 0:k.targets)||[]];n(v)}catch(N){c("Failed to load targets: "+N.message)}finally{o(!1)}}},p=(N,k)=>k==="AdmissionRevenue"?`${N.toLocaleString()}`:N.toString(),h=N=>{switch(N){case"AdmissionStudent":return"Student Target";case"AdmissionRevenue":return"Revenue Target";default:return N}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg",children:e.jsx(Ht,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Targets"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View your assigned performance targets"})]})]})}),i&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:i}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(Ot,{size:20}),"Targets & Achievement"]}),e.jsx("select",{value:r,onChange:N=>a(N.target.value),className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:x.map(N=>e.jsx("option",{value:N.value,children:N.label},N.value))})]}),(()=>{var y;const N=new Date().getFullYear(),k=new Date().getMonth()+1,v=`${N}-${String(k).padStart(2,"0")}`,g=r>v,b=r===v;return g?e.jsxs("div",{className:"mb-4 bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg flex items-start gap-2",children:[e.jsx(fe,{size:18,className:"mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Future Month Selected"}),e.jsxs("p",{className:"text-sm",children:["You are viewing targets for ",(y=x.find(j=>j.value===r))==null?void 0:y.label,". Achievement data will be calculated as the month progresses."]})]})]}):b?e.jsxs("div",{className:"mb-4 bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-lg flex items-start gap-2",children:[e.jsx(fe,{size:18,className:"mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Current Month"}),e.jsx("p",{className:"text-sm",children:"Achievement is calculated up to today. Final results will be available at month end."})]})]}):null})(),l?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading targets..."}):s.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ht,{size:48,className:"mx-auto mb-3 opacity-30"}),e.jsxs("p",{className:"font-medium",children:["No targets assigned for ",(w=x.find(N=>N.value===r))==null?void 0:w.label]}),e.jsx("p",{className:"text-sm mt-1",children:"Your targets will appear here once they are set by your admin."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-semibold text-gray-700",children:"Target Type"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-semibold text-gray-700",children:"Course"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Target"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Achieved"}),e.jsx("th",{className:"text-center px-4 py-3 text-sm font-semibold text-gray-700",children:"Progress"}),s.some(N=>N.note)&&e.jsx("th",{className:"text-left px-4 py-3 text-sm font-semibold text-gray-700",children:"Note"})]})}),e.jsx("tbody",{children:s.map(N=>{var g;const k=N.percentage||0,v=k>=100?"green":k>=75?"blue":k>=50?"yellow":"red";return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-800",children:h(N.targetType)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:((g=N.course)==null?void 0:g.name)||"All Courses"}),e.jsx("td",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:p(N.targetValue,N.targetType)}),e.jsx("td",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:p(N.achieved,N.targetType)}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"flex-1 max-w-xs bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full bg-${v}-500`,style:{width:`${Math.min(k,100)}%`}})}),e.jsxs("span",{className:`text-sm font-semibold text-${v}-600 min-w-[45px] text-right`,children:[k,"%"]})]})}),s.some(b=>b.note)&&e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:N.note||"-"})]},N._id)})})]})})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"About Your Targets"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Student Target:"})," Number of students you need to admit for specific courses"]}),e.jsxs("li",{children:[" ",e.jsx("strong",{children:"Revenue Target:"})," Total admission fees you need to collect"]}),e.jsx("li",{children:" Progress is updated in real-time based on your actual admissions"}),e.jsx("li",{children:" Contact your admin if you have questions about your targets"})]})]})]})}function Fw(){var O,U;const{user:t}=ge(),[s,n]=d.useState([]),[r,a]=d.useState(!1),[l,o]=d.useState(!1),[i,c]=d.useState(null),[u,x]=d.useState(null),[m,p]=d.useState({batchName:"",category:"",targetedStudent:"",status:"Active"}),[h,w]=d.useState(null),[N,k]=d.useState(null),[v,g]=d.useState(!1),b=(t==null?void 0:t.role)==="Admin"||(t==null?void 0:t.role)==="SuperAdmin",y=async()=>{try{g(!0);const{batches:I}=await B.listBatches();n(I||[]),w(null)}catch(I){w(I.message)}finally{g(!1)}};d.useEffect(()=>{y()},[]);const j=()=>{x(null),p({batchName:"",category:"",targetedStudent:"",status:"Active"}),a(!0)},S=I=>{x(I._id),p({batchName:I.batchName,category:I.category,targetedStudent:I.targetedStudent,status:I.status}),a(!0)},C=async I=>{I.preventDefault(),w(null),k(null);try{u?(await B.updateBatch(u,m),k("Batch updated successfully")):(await B.createBatch(m),k("Batch created successfully")),a(!1),y()}catch(M){w(M.message)}},A=async(I,M)=>{if(M){alert("Cannot delete batch with admitted students");return}if(confirm("Delete this batch?"))try{await B.deleteBatch(I),k("Batch deleted successfully"),y()}catch(V){w(V.message)}},R=async I=>{try{const{batch:M}=await B.getBatchReport(I._id);c(M),o(!0)}catch(M){w(M.message)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-navy",children:"Batch Management"}),b&&e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-gold text-navy rounded-xl font-semibold hover:bg-lightgold",children:[e.jsx(ss,{size:18}),"Add Batch"]})]}),N&&e.jsx("div",{className:"mb-3 p-3 bg-green-100 text-green-700 rounded-xl",children:N}),h&&e.jsx("div",{className:"mb-3 p-3 bg-red-100 text-red-600 rounded-xl",children:h}),v?e.jsx("div",{className:"text-center py-8 text-royal",children:"Loading batches..."}):e.jsx("div",{className:"bg-white rounded-2xl shadow-soft overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-[#f3f6ff] text-royal",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Batch ID"}),e.jsx("th",{className:"text-left p-3",children:"Batch Name"}),e.jsx("th",{className:"text-left p-3",children:"Category"}),e.jsx("th",{className:"text-left p-3",children:"Targeted Students"}),e.jsx("th",{className:"text-left p-3",children:"Admitted Students"}),e.jsx("th",{className:"text-left p-3",children:"Progress"}),e.jsx("th",{className:"text-left p-3",children:"Status"}),e.jsx("th",{className:"text-left p-3",children:"Actions"})]})}),e.jsxs("tbody",{children:[s.map(I=>{var E;const M=((E=I.admittedStudents)==null?void 0:E.length)||0,V=I.targetedStudent||0,D=V>0?Math.round(M/V*100):0;return e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 font-mono text-xs",children:I.batchId}),e.jsx("td",{className:"p-3 font-semibold text-navy",children:I.batchName}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-lg text-xs font-medium",children:I.category})}),e.jsx("td",{className:"p-3 text-center",children:V}),e.jsx("td",{className:"p-3 text-center font-semibold text-blue-600",children:M}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${D>=100?"bg-green-500":D>=75?"bg-blue-500":D>=50?"bg-yellow-500":"bg-orange-500"}`,style:{width:`${Math.min(D,100)}%`}})}),e.jsxs("span",{className:"text-xs font-medium",children:[D,"%"]})]})}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${I.status==="Active"?"bg-green-100 text-green-700":I.status==="Completed"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:I.status})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>R(I),className:"p-2 rounded-lg bg-blue-50 text-blue-600 hover:bg-blue-100",title:"View Report",children:e.jsx(Co,{size:16})}),b&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>S(I),className:"p-2 rounded-lg border hover:bg-gray-100",title:"Edit",children:e.jsx(Ky,{size:16})}),e.jsx("button",{onClick:()=>A(I._id,M>0),className:"p-2 rounded-lg border hover:bg-red-50 text-red-600",title:"Delete",children:e.jsx(cn,{size:16})})]})]})})]},I._id)}),s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"p-4 text-center text-royal/70",children:"No batches found"})})]})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4 z-50",children:e.jsxs("form",{onSubmit:C,className:"bg-white rounded-2xl shadow-soft p-6 w-full max-w-lg",children:[e.jsx("h2",{className:"text-xl font-bold text-navy mb-4",children:u?"Edit Batch":"Add New Batch"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-royal mb-1",children:"Batch Name *"}),e.jsx("input",{type:"text",required:!0,value:m.batchName,onChange:I=>p({...m,batchName:I.target.value}),className:"w-full border rounded-xl px-3 py-2",placeholder:"e.g., Graphics Design Batch 1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-royal mb-1",children:"Category *"}),e.jsx("input",{type:"text",required:!0,value:m.category,onChange:I=>p({...m,category:I.target.value}),className:"w-full border rounded-xl px-3 py-2",placeholder:"e.g., Graphics Design"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-royal mb-1",children:"Targeted Students *"}),e.jsx("input",{type:"number",required:!0,min:"1",value:m.targetedStudent,onChange:I=>p({...m,targetedStudent:I.target.value}),className:"w-full border rounded-xl px-3 py-2",placeholder:"e.g., 25"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-royal mb-1",children:"Status"}),e.jsxs("select",{value:m.status,onChange:I=>p({...m,status:I.target.value}),className:"w-full border rounded-xl px-3 py-2",children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"px-4 py-2 rounded-xl border hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-xl bg-gold text-navy font-semibold hover:bg-lightgold",children:u?"Update":"Create"})]})]})}),l&&i&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-soft p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-navy",children:["Batch Report: ",i.batchName]}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:""})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-blue-600 mb-1",children:"Batch ID"}),e.jsx("div",{className:"text-lg font-bold text-blue-800",children:i.batchId})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-green-600 mb-1",children:"Admitted / Target"}),e.jsxs("div",{className:"text-lg font-bold text-green-800",children:[((O=i.admittedStudents)==null?void 0:O.length)||0," / ",i.targetedStudent]})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-sm text-purple-600 mb-1",children:"Category"}),e.jsx("div",{className:"text-lg font-bold text-purple-800",children:i.category})]})]}),e.jsx("h3",{className:"text-lg font-semibold text-navy mb-3",children:"Admitted Students"}),((U=i.admittedStudents)==null?void 0:U.length)>0?e.jsx("div",{className:"bg-gray-50 rounded-xl overflow-hidden",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-3",children:"Lead ID"}),e.jsx("th",{className:"text-left p-3",children:"Name"}),e.jsx("th",{className:"text-left p-3",children:"Phone"}),e.jsx("th",{className:"text-left p-3",children:"Course"}),e.jsx("th",{className:"text-left p-3",children:"Admitted Date"})]})}),e.jsx("tbody",{children:i.admittedStudents.map((I,M)=>{var V,D,E,P;return e.jsxs("tr",{className:"border-t border-gray-300",children:[e.jsx("td",{className:"p-3 font-mono text-xs",children:((V=I.lead)==null?void 0:V.leadId)||"-"}),e.jsx("td",{className:"p-3 font-medium",children:((D=I.lead)==null?void 0:D.name)||"-"}),e.jsx("td",{className:"p-3",children:((E=I.lead)==null?void 0:E.phone)||"-"}),e.jsx("td",{className:"p-3",children:((P=I.lead)==null?void 0:P.interestedCourse)||"-"}),e.jsx("td",{className:"p-3",children:I.admittedAt?new Date(I.admittedAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"-"})]},M)})})]})}):e.jsx("div",{className:"text-center py-8 text-royal/70",children:"No students admitted yet"}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>o(!1),className:"px-6 py-2 rounded-xl bg-navy text-white font-semibold hover:bg-navy/90",children:"Close"})})]})})]})}function Ow(){const{login:t}=ge(),s=Rn(),[n,r]=d.useState(""),[a,l]=d.useState(""),[o,i]=d.useState(null),[c,u]=d.useState(!1),x=async m=>{m.preventDefault(),i(null),u(!0);try{await t(n,a),s("/")}catch(p){i((p==null?void 0:p.message)||"Login failed")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-royal/10 to-gold/10",children:e.jsxs("form",{onSubmit:x,className:"bg-white shadow-soft rounded-2xl p-6 w-full max-w-md",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:"https://primeacademy.org/logo-full.png",alt:"Prime Academy",className:"w-56 object-contain"})}),e.jsx("h1",{className:"text-2xl font-bold text-navy mb-4",children:"Sign in"}),o&&e.jsx("div",{className:"mb-3 text-sm text-red-600",children:o}),e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Email"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2 mb-3",value:n,onChange:m=>r(m.target.value),placeholder:"you@domain.com"}),e.jsx("label",{className:"block text-sm text-royal mb-1",children:"Password"}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2 mb-4",type:"password",value:a,onChange:m=>l(m.target.value)}),e.jsx("button",{disabled:c,className:"w-full bg-gold text-navy rounded-xl py-2 font-semibold hover:bg-lightgold transition",children:c?"Signing in":"Sign In"})]})})}function _w(){return e.jsx("div",{className:"p-6",children:"Not Found"})}function zw(){const[t,s]=d.useState(!1);return e.jsxs("div",{className:"min-h-screen flex bg-[#f7f9fc]",children:[e.jsx(nb,{isOpen:t,setIsOpen:s}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(sb,{onMenuClick:()=>s(!0)}),e.jsx("main",{className:"p-4 md:p-6 flex-1 overflow-auto",children:e.jsx(Sc,{})})]})]})}function Uw(){return e.jsxs(rp,{children:[e.jsx(ce,{element:e.jsx(Iy,{}),children:e.jsxs(ce,{element:e.jsx(zw,{}),children:[e.jsx(ce,{path:"/",element:e.jsx(yb,{})}),e.jsx(ce,{path:"/profile",element:e.jsx(bb,{})}),e.jsx(ce,{path:"/my-tasks",element:e.jsx(Sb,{})}),e.jsx(ce,{path:"/tasks-board",element:e.jsx(ON,{})}),e.jsx(ce,{path:"/messages",element:e.jsx(Lw,{})}),e.jsx(ce,{path:"/task-report",element:e.jsx(Pw,{})}),e.jsx(ce,{element:e.jsx(Lt,{roles:["Admin","Accountant","Admission","Recruitment","DigitalMarketing","MotionGraphics","Coordinator"]}),children:e.jsx(ce,{path:"/my-applications",element:e.jsx(Dw,{})})}),e.jsx(ce,{path:"/notifications",element:e.jsx(Mw,{})}),e.jsxs(ce,{element:e.jsx(Lt,{roles:["SuperAdmin","Admin"]}),children:[e.jsx(ce,{path:"/assign-tasks",element:e.jsx(vb,{})}),e.jsx(ce,{path:"/employees",element:e.jsx(_N,{})}),e.jsx(ce,{path:"/reports-view",element:e.jsx(WN,{})}),e.jsx(ce,{path:"/leads-center-view",element:e.jsx(VN,{})}),e.jsx(ce,{path:"/admin-task-report",element:e.jsx(Iw,{})}),e.jsx(ce,{path:"/admission-targets",element:e.jsx(Rw,{})}),e.jsx(ce,{path:"/batches",element:e.jsx(Fw,{})}),e.jsx(ce,{path:"/admin/approvals",element:e.jsx(Tw,{})})]}),e.jsx(ce,{element:e.jsx(Lt,{roles:["SuperAdmin","Admin","DigitalMarketing","Admission","Recruitment","MotionGraphics"]}),children:e.jsx(ce,{path:"/courses",element:e.jsx(zN,{})})}),e.jsxs(ce,{element:e.jsx(Lt,{roles:["DigitalMarketing"]}),children:[e.jsx(ce,{path:"/lead-entry",element:e.jsx(GN,{})}),e.jsx(ce,{path:"/leads-center",element:e.jsx(YN,{})}),e.jsx(ce,{path:"/dm-metrics",element:e.jsx(JN,{})})]}),e.jsx(ce,{element:e.jsx(Lt,{roles:["DigitalMarketing","Admin","SuperAdmin"]}),children:e.jsx(ce,{path:"/dm/dashboard",element:e.jsx(vp,{})})}),e.jsxs(ce,{element:e.jsx(Lt,{roles:["Admission","Admin","SuperAdmin"]}),children:[e.jsx(ce,{path:"/admission/dashboard",element:e.jsx(bp,{})}),"   ",e.jsx(ce,{path:"/admission/metrics",element:e.jsx(sw,{})}),e.jsx(ce,{path:"/my-targets",element:e.jsx($w,{})}),e.jsx(ce,{path:"/admission/assigned",element:e.jsx(Or,{})}),e.jsx(ce,{path:"/admission/counseling",element:e.jsx(Or,{})}),e.jsx(ce,{path:"/admission/follow-up",element:e.jsx(Or,{})}),e.jsx(ce,{path:"/admission/admitted",element:e.jsx(Or,{})}),e.jsx(ce,{path:"/admission/not-admitted",element:e.jsx(Or,{})}),e.jsx(ce,{path:"/admission/fees",element:e.jsx(tw,{})})]}),e.jsxs(ce,{element:e.jsx(Lt,{roles:["Accountant","Admin","SuperAdmin"]}),children:[e.jsx(ce,{path:"/accounting/dashboard",element:e.jsx(pp,{})}),e.jsx(ce,{path:"/accounting/fees",element:e.jsx(nw,{})}),e.jsx(ce,{path:"/accounting/due-collections",element:e.jsx(rw,{})}),e.jsx(ce,{path:"/accounting/income",element:e.jsx(aw,{})}),e.jsx(ce,{path:"/accounting/expense",element:e.jsx(iw,{})}),e.jsx(ce,{path:"/accounting/tada-payments",element:e.jsx(Ew,{})})]}),e.jsxs(ce,{element:e.jsx(Lt,{roles:["SuperAdmin","Admin","Accountant"]}),children:[e.jsx(ce,{path:"/employee-accounts/bank",element:e.jsx(dw,{})}),e.jsx(ce,{path:"/employee-accounts/salary",element:e.jsx(cw,{})})]}),e.jsxs(ce,{element:e.jsx(Lt,{roles:["MotionGraphics","Admin","SuperAdmin"]}),children:[e.jsx(ce,{path:"/mg/dashboard",element:e.jsx(gp,{})}),e.jsx(ce,{path:"/mg/production",element:e.jsx(Sw,{})})]}),e.jsxs(ce,{element:e.jsx(Lt,{roles:["Recruitment","Admin","SuperAdmin"]}),children:[e.jsx(ce,{path:"/recruitment",element:e.jsx(fp,{})}),e.jsx(ce,{path:"/recruitment/candidates",element:e.jsx(mw,{})}),e.jsx(ce,{path:"/recruitment/jobs",element:e.jsx(pw,{})}),e.jsx(ce,{path:"/recruitment/employers",element:e.jsx(gw,{})}),e.jsx(ce,{path:"/recruitment/expenses",element:e.jsx(Nw,{})})]}),e.jsx(ce,{element:e.jsx(Lt,{roles:["Recruitment","Accountant"]}),children:e.jsx(ce,{path:"/recruitment/income",element:e.jsx(bw,{})})}),e.jsxs(ce,{element:e.jsx(Lt,{roles:["Coordinator","Admin","SuperAdmin"]}),children:[e.jsx(ce,{path:"/coordinator/dashboard",element:e.jsx(yp,{})}),e.jsx(ce,{path:"/coordinator/due-fees",element:e.jsx(Cw,{})}),e.jsx(ce,{path:"/coordinator/notifications",element:e.jsx(Aw,{})})]}),e.jsx(ce,{path:"*",element:e.jsx(Na,{to:"/",replace:!0})})]})}),e.jsx(ce,{path:"*",element:e.jsx(Na,{to:"/login",replace:!0})})]})}qh(document.getElementById("root")).render(e.jsx(ve.StrictMode,{children:e.jsx(Cy,{children:e.jsx(Py,{children:e.jsxs(rp,{children:[e.jsx(ce,{path:"/login",element:e.jsx(Ow,{})}),e.jsx(ce,{path:"/*",element:e.jsx(Uw,{})}),e.jsx(ce,{path:"*",element:e.jsx(_w,{})})]})})})}));
